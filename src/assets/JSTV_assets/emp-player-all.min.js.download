/**
 * @license
 * EMP-Player 2.2.124-498 
 * Copyright Ericsson, Inc. <https://www.ericsson.com/>
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.empPlayer=t()}(this,function(){"use strict";var d=function(e,t){var i,n=null;try{i=JSON.parse(e,t)}catch(e){n=e}return[n,i]};var _="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var T="undefined"!=typeof window?window:void 0!==_?_:"undefined"!=typeof self?self:{},i=Object.create||function(e){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return n.prototype=e,new n};function n(){}function u(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function m(e){function t(e,t,i,n){return 3600*(0|e)+60*(0|t)+(0|i)+(0|n)/1e3}var i=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return i?i[3]?t(i[1],i[2],i[3].replace(":",""),i[4]):59<i[1]?t(i[1],i[2],0,i[4]):t(0,i[1],i[2],i[4]):null}function c(){this.values=i(null)}function h(e,t,i,n){var r=n?e.split(n):[e];for(var a in r)if("string"==typeof r[a]){var s=r[a].split(i);if(2===s.length)t(s[0],s[1])}}function l(t,e,a){var i,n,s,r=t;function o(){var e=m(t);if(null===e)throw new u(u.Errors.BadTimeStamp,"Malformed timestamp: "+r);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function l(){t=t.replace(/^\s+/,"")}if(l(),e.startTime=o(),l(),"--\x3e"!==t.substr(0,3))throw new u(u.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);t=t.substr(3),l(),e.endTime=o(),l(),i=t,n=e,s=new c,h(i,function(e,t){switch(e){case"region":for(var i=a.length-1;0<=i;i--)if(a[i].id===t){s.set(e,a[i].region);break}break;case"vertical":s.alt(e,t,["rl","lr"]);break;case"line":var n=t.split(","),r=n[0];s.integer(e,r),s.percent(e,r)&&s.set("snapToLines",!1),s.alt(e,r,["auto"]),2===n.length&&s.alt("lineAlign",n[1],["start","middle","end"]);break;case"position":n=t.split(","),s.percent(e,n[0]),2===n.length&&s.alt("positionAlign",n[1],["start","middle","end"]);break;case"size":s.percent(e,t);break;case"align":s.alt(e,t,["start","middle","end","left","right"])}},/:/,/\s/),n.region=s.get("region",null),n.vertical=s.get("vertical",""),n.line=s.get("line","auto"),n.lineAlign=s.get("lineAlign","start"),n.snapToLines=s.get("snapToLines",!0),n.size=s.get("size",100),n.align=s.get("align","middle"),n.position=s.get("position",{start:0,left:0,middle:50,end:100,right:100},n.align),n.positionAlign=s.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},n.align)}((u.prototype=i(Error.prototype)).constructor=u).Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},c.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,i){for(var n=0;n<i.length;++n)if(t===i[n]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var g={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"‎","&rlm;":"‏","&nbsp;":" "},v={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},y={v:"title",lang:"lang"},b={rt:"ruby"};function a(a,i){function e(){if(!i)return null;var e,t=i.match(/^([^<]*)(<[^>]*>?)?/);return e=t[1]?t[1]:t[2],i=i.substr(e.length),e}function t(e){return g[e]}function n(e){for(;p=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(p[0],t);return e}function r(e,t){var i=v[e];if(!i)return null;var n=a.document.createElement(i);n.localName=i;var r=y[e];return r&&t&&(n[r]=t.trim()),n}for(var s,o,l,u=a.document.createElement("div"),c=u,h=[];null!==(s=e());)if("<"!==s[0])c.appendChild(a.document.createTextNode(n(s)));else{if("/"===s[1]){h.length&&h[h.length-1]===s.substr(2).replace(">","")&&(h.pop(),c=c.parentNode);continue}var d,f=m(s.substr(1,s.length-2));if(f){d=a.document.createProcessingInstruction("timestamp",f),c.appendChild(d);continue}var p=s.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!p)continue;if(!(d=r(p[1],p[3])))continue;if(o=c,b[(l=d).localName]&&b[l.localName]!==o.localName)continue;p[2]&&(d.className=p[2].substr(1).replace("."," ")),h.push(p[1]),c.appendChild(d),c=d}return u}var r=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function s(e){for(var t=0;t<r.length;t++){var i=r[t];if(e>=i[0]&&e<=i[1])return 1}}function o(){}function f(e,t,i){o.call(this),this.cue=t,this.cueDiv=a(e,t.text);var n={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(n,this.cueDiv),this.div=e.document.createElement("div"),n={direction:function(e){var t=[],i="";if(!e||!e.childNodes)return"ltr";function r(e,t){for(var i=t.childNodes.length-1;0<=i;i--)e.push(t.childNodes[i])}function a(e){if(!e||!e.length)return null;var t=e.pop(),i=t.textContent||t.innerText;if(i){var n=i.match(/^.*(\n|\r)/);return n?n[e.length=0]:i}return"ruby"===t.tagName?a(e):t.childNodes?(r(e,t),a(e)):void 0}for(r(t,e);i=a(t);)for(var n=0;n<i.length;n++)if(s(i.charCodeAt(n)))return"rtl";return"ltr"}(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:i.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(n),this.div.appendChild(this.cueDiv);var r=0;switch(t.positionAlign){case"start":r=t.position;break;case"middle":r=t.position-t.size/2;break;case"end":r=t.position-t.size}""===t.vertical?this.applyStyles({left:this.formatStyle(r,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(r,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function S(e){var t,i,n,r;if(e.div){i=e.div.offsetHeight,n=e.div.offsetWidth,r=e.div.offsetTop;var a=(a=e.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();e=e.div.getBoundingClientRect(),t=a?Math.max(a[0]&&a[0].height||0,e.height/a.length):0}this.left=e.left,this.right=e.right,this.top=e.top||r,this.height=e.height||i,this.bottom=e.bottom||r+(e.height||i),this.width=e.width||n,this.lineHeight=void 0!==t?t:e.lineHeight}function p(e,t,o,l){var i=new S(t),n=t.cue,r=function(e){if("number"==typeof e.line&&(e.snapToLines||0<=e.line&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,i=t.textTrackList,n=0,r=0;r<i.length&&i[r]!==t;r++)"showing"===i[r].mode&&n++;return-1*++n}(n),a=[];if(n.snapToLines){var s;switch(n.vertical){case"":a=["+y","-y"],s="height";break;case"rl":a=["+x","-x"],s="width";break;case"lr":a=["-x","+x"],s="width"}var u=i.lineHeight,c=u*Math.round(r),h=o[s]+u,d=a[0];Math.abs(c)>h&&(c=c<0?-1:1,c*=Math.ceil(h/u)*u),r<0&&(c+=""===n.vertical?o.height:o.width,a=a.reverse()),i.move(d,c)}else{var f=i.lineHeight/o.height*100;switch(n.lineAlign){case"middle":r-=f/2;break;case"end":r-=f}switch(n.vertical){case"":t.applyStyles({top:t.formatStyle(r,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(r,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(r,"%")})}a=["+y","-x","+x","-y"],i=new S(t)}var p=function(e,t){for(var i,n=new S(e),r=1,a=0;a<t.length;a++){for(;e.overlapsOppositeAxis(o,t[a])||e.within(o)&&e.overlapsAny(l);)e.move(t[a]);if(e.within(o))return e;var s=e.intersectPercentage(o);s<r&&(i=new S(e),r=s),e=new S(n)}return i||n}(i,a);t.move(p.toCSSCompatValues(o))}function E(){}o.prototype.applyStyles=function(e,t){for(var i in t=t||this.div,e)e.hasOwnProperty(i)&&(t.style[i]=e[i])},o.prototype.formatStyle=function(e,t){return 0===e?0:e+t},(f.prototype=i(o.prototype)).constructor=f,S.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},S.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},S.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},S.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},S.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},S.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},S.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},S.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,i=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,n=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||n,height:e.height||t,bottom:e.bottom||n+(e.height||t),width:e.width||i}},E.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},E.convertCueToDOMTree=function(e,t){return e&&t?a(e,t):null};E.processCues=function(n,r,e){if(!n||!r||!e)return null;for(;e.firstChild;)e.removeChild(e.firstChild);var a=n.document.createElement("div");if(a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.top="0",a.style.bottom="0",a.style.margin="1.5%",e.appendChild(a),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return 1}(r)){var s=[],o=S.getSimpleBoxPosition(a),l={font:Math.round(.05*o.height*100)/100+"px sans-serif"};!function(){for(var e,t,i=0;i<r.length;i++)t=r[i],e=new f(n,t,l),a.appendChild(e.div),p(0,e,o,s),t.displayState=e.div,s.push(S.getSimpleBoxPosition(e))}()}else for(var t=0;t<r.length;t++)a.appendChild(r[t].displayState)},(E.Parser=function(e,t,i){i||(i=t,t={}),t=t||{},this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=i||new TextDecoder("utf8"),this.regionList=[]}).prototype={reportOrThrowError:function(e){if(!(e instanceof u))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var a=this;function t(){for(var e=a.buffer,t=0;t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var i=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,a.buffer=e.substr(t),i}function i(e){e.match(/X-TIMESTAMP-MAP/)?h(e,function(e,t){switch(e){case"X-TIMESTAMP-MAP":i=t,n=new c,h(i,function(e,t){switch(e){case"MPEGT":n.integer(e+"S",t);break;case"LOCA":n.set(e+"L",m(t))}},/[^\d]:/,/,/),a.ontimestampmap&&a.ontimestampmap({MPEGTS:n.get("MPEGTS"),LOCAL:n.get("LOCAL")})}var i,n},/=/):h(e,function(e,t){switch(e){case"Region":!function(e){var r=new c;if(h(e,function(e,t){switch(e){case"id":r.set(e,t);break;case"width":r.percent(e,t);break;case"lines":r.integer(e,t);break;case"regionanchor":case"viewportanchor":var i=t.split(",");if(2!==i.length)break;var n=new c;if(n.percent("x",i[0]),n.percent("y",i[1]),!n.has("x")||!n.has("y"))break;r.set(e+"X",n.get("x")),r.set(e+"Y",n.get("y"));break;case"scroll":r.alt(e,t,["up"])}},/=/,/\s/),r.has("id")){var t=new(a.vttjs.VTTRegion||a.window.VTTRegion);t.width=r.get("width",100),t.lines=r.get("lines",3),t.regionAnchorX=r.get("regionanchorX",0),t.regionAnchorY=r.get("regionanchorY",100),t.viewportAnchorX=r.get("viewportanchorX",0),t.viewportAnchorY=r.get("viewportanchorY",100),t.scroll=r.get("scroll",""),a.onregion&&a.onregion(t),a.regionList.push({id:r.get("id"),region:t})}}(t)}},/:/)}e&&(a.buffer+=a.decoder.decode(e,{stream:!0}));try{var n;if("INITIAL"===a.state){if(!/\r\n|\n/.test(a.buffer))return this;var r=(n=t()).match(/^WEBVTT([ \t].*)?$/);if(!r||!r[0])throw new u(u.Errors.BadSignature);a.state="HEADER"}for(var s=!1;a.buffer;){if(!/\r\n|\n/.test(a.buffer))return this;switch(s?s=!1:n=t(),a.state){case"HEADER":/:/.test(n)?i(n):n||(a.state="ID");continue;case"NOTE":n||(a.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){a.state="NOTE";break}if(!n)continue;if(a.cue=new(a.vttjs.VTTCue||a.window.VTTCue)(0,0,""),a.state="CUE",-1===n.indexOf("--\x3e")){a.cue.id=n;continue}case"CUE":try{l(n,a.cue,a.regionList)}catch(e){a.reportOrThrowError(e),a.cue=null,a.state="BADCUE";continue}a.state="CUETEXT";continue;case"CUETEXT":var o=-1!==n.indexOf("--\x3e");if(!n||o&&(s=!0)){a.oncue&&a.oncue(a.cue),a.cue=null,a.state="ID";continue}a.cue.text&&(a.cue.text+="\n"),a.cue.text+=n;continue;case"BADCUE":n||(a.state="ID");continue}}}catch(e){a.reportOrThrowError(e),"CUETEXT"===a.state&&a.cue&&a.oncue&&a.oncue(a.cue),a.cue=null,a.state="INITIAL"===a.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),!t.cue&&"HEADER"!==t.state||(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state)throw new u(u.Errors.BadSignature)}catch(e){t.reportOrThrowError(e)}return t.onflush&&t.onflush(),this}};var w=E,C={"":1,lr:1,rl:1},k={start:1,middle:1,end:1,left:1,right:1};function A(e){return"string"==typeof e&&(!!k[e.toLowerCase()]&&e.toLowerCase())}function I(e,t,i){this.hasBeenReset=!1;var n="",r=!1,a=e,s=t,o=i,l=null,u="",c=!0,h="auto",d="start",f=50,p="middle",m=50,g="middle";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return n},set:function(e){n=""+e}},pauseOnExit:{enumerable:!0,get:function(){return r},set:function(e){r=!!e}},startTime:{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");a=e,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");s=e,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return o},set:function(e){o=""+e,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return l},set:function(e){l=e,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return u},set:function(e){var t,i="string"==typeof(t=e)&&!!C[t.toLowerCase()]&&t.toLowerCase();if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");u=i,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return c},set:function(e){c=!!e,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return h},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");h=e,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return d},set:function(e){var t=A(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");d=t,this.hasBeenReset=!0}},position:{enumerable:!0,get:function(){return f},set:function(e){if(e<0||100<e)throw new Error("Position must be between 0 and 100.");f=e,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return p},set:function(e){var t=A(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");p=t,this.hasBeenReset=!0}},size:{enumerable:!0,get:function(){return m},set:function(e){if(e<0||100<e)throw new Error("Size must be between 0 and 100.");m=e,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return g},set:function(e){var t=A(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");g=t,this.hasBeenReset=!0}}}),this.displayState=void 0}I.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var x=I,P={"":!0,up:!0};function L(e){return"number"==typeof e&&0<=e&&e<=100}function R(){var t=100,i=3,n=0,r=100,a=0,s=100,o="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return t},set:function(e){if(!L(e))throw new Error("Width must be between 0 and 100.");t=e}},lines:{enumerable:!0,get:function(){return i},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");i=e}},regionAnchorY:{enumerable:!0,get:function(){return r},set:function(e){if(!L(e))throw new Error("RegionAnchorX must be between 0 and 100.");r=e}},regionAnchorX:{enumerable:!0,get:function(){return n},set:function(e){if(!L(e))throw new Error("RegionAnchorY must be between 0 and 100.");n=e}},viewportAnchorY:{enumerable:!0,get:function(){return s},set:function(e){if(!L(e))throw new Error("ViewportAnchorY must be between 0 and 100.");s=e}},viewportAnchorX:{enumerable:!0,get:function(){return a},set:function(e){if(!L(e))throw new Error("ViewportAnchorX must be between 0 and 100.");a=e}},scroll:{enumerable:!0,get:function(){return o},set:function(e){var t,i="string"==typeof(t=e)&&!!P[t.toLowerCase()]&&t.toLowerCase();if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");o=i}}})}var O=t(function(e){var t=e.exports={WebVTT:w,VTTCue:x,VTTRegion:R};T.vttjs=t,T.WebVTT=t.WebVTT;var i=t.VTTCue,n=t.VTTRegion,r=T.VTTCue,a=T.VTTRegion;t.shim=function(){T.VTTCue=i,T.VTTRegion=n},t.restore=function(){T.VTTCue=r,T.VTTRegion=a},T.VTTCue||t.shim()});O.WebVTT,O.VTTCue,O.VTTRegion;var D=function(e){for(var t="",i=0;i<arguments.length;i++)t+=e[i].replace(/\n\r?\s*/g,"")+(arguments[i+1]||"");return t},N=void 0!==_?_:"undefined"!=typeof window?window:{},M="undefined"!=typeof document?document:N["__GLOBAL_DOCUMENT_CACHE@4"]||(N["__GLOBAL_DOCUMENT_CACHE@4"]={}),B=function(e){var t=U.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)},U=Object.prototype.toString;function F(e){return e.replace(/^\s+|\s+$/g,"")}var j=function(e){if(!e)return{};for(var t,i={},n=F(e).split("\n"),r=0;r<n.length;r++){var a=n[r],s=a.indexOf(":"),o=F(a.slice(0,s)).toLowerCase(),l=F(a.slice(s+1));void 0===i[o]?i[o]=l:(t=i[o],"[object Array]"===Object.prototype.toString.call(t)?i[o].push(l):i[o]=[i[o],l])}return i},H=function(){for(var e={},t=0;t<arguments.length;t++){var i=arguments[t];for(var n in i)G.call(i,n)&&(e[n]=i[n])}return e},G=Object.prototype.hasOwnProperty;var V=W;function K(e,t,i){var n=e;return B(t)?(i=t,"string"==typeof e&&(n={uri:e})):n=H(t,{uri:e}),n.callback=i,n}function W(e,t,i){return q(t=K(e,t,i))}function q(n){if(void 0===n.callback)throw new Error("callback argument missing");var r=!1,a=function(e,t,i){r||(r=!0,n.callback(e,t,i))};function s(){var e=void 0;if(e=u.response?u.response:u.responseText||function(e){if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}(u),m)try{e=JSON.parse(e)}catch(e){}return e}function t(e){return clearTimeout(l),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,a(e,g)}function e(){if(!o){var e;clearTimeout(l),e=n.useXDR&&void 0===u.status?200:1223===u.status?204:u.status;var t=g,i=null;return 0!==e?(t={body:s(),statusCode:e,method:h,headers:{},url:c,rawRequest:u},u.getAllResponseHeaders&&(t.headers=j(u.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),a(i,t,t.body)}}var i,o,l,u=n.xhr||null,c=(u=u||(n.cors||n.useXDR?new W.XDomainRequest:new W.XMLHttpRequest)).url=n.uri||n.url,h=u.method=n.method||"GET",d=n.body||n.data,f=u.headers=n.headers||{},p=!!n.sync,m=!1,g={body:void 0,headers:{},statusCode:0,method:h,url:c,rawRequest:u};if("json"in n&&!1!==n.json&&(m=!0,f.accept||f.Accept||(f.Accept="application/json"),"GET"!==h&&"HEAD"!==h&&(f["content-type"]||f["Content-Type"]||(f["Content-Type"]="application/json"),d=JSON.stringify(!0===n.json?d:n.json))),u.onreadystatechange=function(){4===u.readyState&&setTimeout(e,0)},u.onload=e,u.onerror=t,u.onprogress=function(){},u.onabort=function(){o=!0},u.ontimeout=t,u.open(h,c,!p,n.username,n.password),p||(u.withCredentials=!!n.withCredentials),!p&&0<n.timeout&&(l=setTimeout(function(){if(!o){o=!0,u.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",t(e)}},n.timeout)),u.setRequestHeader)for(i in f)f.hasOwnProperty(i)&&u.setRequestHeader(i,f[i]);else if(n.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return;return 1}(n.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in n&&(u.responseType=n.responseType),"beforeSend"in n&&"function"==typeof n.beforeSend&&n.beforeSend(u),u.send(d||null),u}W.XMLHttpRequest=T.XMLHttpRequest||function(){}
/**
     * @license
     * Video.js 7.4.1 <http://videojs.com/>
     * Copyright Brightcove, Inc. <https://www.brightcove.com/>
     * Available under Apache License Version 2.0
     * <https://github.com/videojs/video.js/blob/master/LICENSE>
     *
     * Includes vtt.js <https://github.com/mozilla/vtt.js>
     * Available under Apache License Version 2.0
     * <https://github.com/mozilla/vtt.js/blob/master/LICENSE>
     */,W.XDomainRequest="withCredentials"in new W.XMLHttpRequest?W.XMLHttpRequest:T.XDomainRequest,function(e,t){for(var i=0;i<e.length;i++)t(e[i])}(["get","put","post","patch","head","delete"],function(n){W["delete"===n?"del":n]=function(e,t,i){return(t=K(e,t,i)).method=n.toUpperCase(),q(t)}});function z(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function X(e,t,i){return(X=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(e){return}}}()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var r=new(Function.bind.apply(e,n));return i&&Y(r,i.prototype),r}).apply(null,arguments)}function $(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J(e,t){return t=t||e.slice(0),e.raw=t,e}var Q=[],Z=function(s,o){return function(e,t,i){var n=o.levels[t],r=new RegExp("^("+n+")$");if("log"!==e&&i.unshift(e.toUpperCase()+":"),i.unshift(s+":"),Q&&Q.push([].concat(i)),T.console){var a=T.console[e];a||"debug"!==e||(a=T.console.info||T.console.log),a&&n&&r.test(e)&&a[Array.isArray(i)?"apply":"call"](T.console,i)}}};var ee=function t(i){function n(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];r("log",a,t)}var r,a="info";return r=Z(i,n),n.createLogger=function(e){return t(i+": "+e)},n.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:a},n.level=function(e){if("string"==typeof e){if(!n.levels.hasOwnProperty(e))throw new Error('"'+e+'" in not a valid log level');a=e}return a},(n.history=function(){return Q?[].concat(Q):[]}).filter=function(t){return(Q||[]).filter(function(e){return new RegExp(".*"+t+".*").test(e[0])})},n.history.clear=function(){Q&&(Q.length=0)},n.history.disable=function(){null!==Q&&(Q.length=0,Q=null)},n.history.enable=function(){null===Q&&(Q=[])},n.error=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return r("error",a,t)},n.warn=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return r("warn",a,t)},n.debug=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return r("debug",a,t)},n}("VIDEOJS"),te=ee.createLogger,ie=Object.prototype.toString,ne=function(e){return se(e)?Object.keys(e):[]};function re(t,i){ne(t).forEach(function(e){return i(t[e],e)})}function ae(i){for(var e=arguments.length,t=new Array(1<e?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Object.assign?Object.assign.apply(Object,[i].concat(t)):(t.forEach(function(e){e&&re(e,function(e,t){i[t]=e})}),i)}function se(e){return!!e&&"object"==typeof e}function oe(e){return se(e)&&"[object Object]"===ie.call(e)&&e.constructor===Object}function le(e,t){if(!e||!t)return"";if("function"!=typeof T.getComputedStyle)return"";var i=T.getComputedStyle(e);return i?i[t]:""}function ue(){var e=J(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);return ue=function(){return e},e}function ce(e){return"string"==typeof e&&/\S/.test(e)}function he(e){if(/\s/.test(e))throw new Error("class has illegal whitespace characters")}function de(){return M===T.document}function fe(e){return se(e)&&1===e.nodeType}function pe(){try{return T.parent!==T.self}catch(e){return!0}}function me(n){return function(e,t){if(!ce(e))return M[n](null);ce(t)&&(t=M.querySelector(t));var i=fe(t)?t:M;return i[n]&&i[n](e)}}function ge(e,i,t,n){void 0===e&&(e="div"),void 0===i&&(i={}),void 0===t&&(t={});var r=M.createElement(e);return Object.getOwnPropertyNames(i).forEach(function(e){var t=i[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(ee.warn(D(ue(),e,t)),r.setAttribute(e,t)):"textContent"===e?ve(r,t):r[e]=t}),Object.getOwnPropertyNames(t).forEach(function(e){r.setAttribute(e,t[e])}),n&&Me(r,n),r}function ve(e,t){return void 0===e.textContent?e.innerText=t:e.textContent=t,e}function ye(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}function be(e,t){return he(t),e.classList?e.classList.contains(t):new RegExp("(^|\\s)"+t+"($|\\s)").test(e.className)}function _e(e,t){return e.classList?e.classList.add(t):be(e,t)||(e.className=(e.className+" "+t).trim()),e}function Te(e,t){return e.classList?e.classList.remove(t):(he(t),e.className=e.className.split(/\s+/).filter(function(e){return e!==t}).join(" ")),e}function Se(e,t,i){var n=be(e,t);if("function"==typeof i&&(i=i(e,t)),"boolean"!=typeof i&&(i=!n),i!==n)return(i?_e:Te)(e,t),e}function Ee(i,n){Object.getOwnPropertyNames(n).forEach(function(e){var t=n[e];null==t||!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?"":t)})}function we(e){var t={},i=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(e&&e.attributes&&0<e.attributes.length)for(var n=e.attributes,r=n.length-1;0<=r;r--){var a=n[r].name,s=n[r].value;"boolean"!=typeof e[a]&&-1===i.indexOf(","+a+",")||(s=null!==s),t[a]=s}return t}function Ce(e,t){return e.getAttribute(t)}function ke(e,t,i){e.setAttribute(t,i)}function Ae(e,t){e.removeAttribute(t)}function Ie(){M.body.focus(),M.onselectstart=function(){return!1}}function xe(){M.onselectstart=function(){return!0}}function Pe(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach(function(e){void 0!==t[e]&&(i[e]=t[e])}),i.height||(i.height=parseFloat(le(e,"height"))),i.width||(i.width=parseFloat(le(e,"width"))),i}}function Le(e){var t;if(e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect()),!t)return{left:0,top:0};var i=M.documentElement,n=M.body,r=i.clientLeft||n.clientLeft||0,a=T.pageXOffset||n.scrollLeft,s=t.left+a-r,o=i.clientTop||n.clientTop||0,l=T.pageYOffset||n.scrollTop,u=t.top+l-o;return{left:Math.round(s),top:Math.round(u)}}function Re(e,t){var i={},n=Le(e),r=e.offsetWidth,a=e.offsetHeight,s=n.top,o=n.left,l=t.pageY,u=t.pageX;return t.changedTouches&&(u=t.changedTouches[0].pageX,l=t.changedTouches[0].pageY),i.y=Math.max(0,Math.min(1,(s-l+a)/a)),i.x=Math.max(0,Math.min(1,(u-o)/r)),i}function Oe(e){return se(e)&&3===e.nodeType}function De(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function Ne(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map(function(e){return"function"==typeof e&&(e=e()),fe(e)||Oe(e)?e:"string"==typeof e&&/\S/.test(e)?M.createTextNode(e):void 0}).filter(function(e){return e})}function Me(t,e){return Ne(e).forEach(function(e){return t.appendChild(e)}),t}function Be(e,t){return Me(De(e),t)}function Ue(e){return void 0===e.button&&void 0===e.buttons||(0===e.button&&void 0===e.buttons||0===e.button&&1===e.buttons)}var Fe=me("querySelector"),je=me("querySelectorAll"),He=Object.freeze({isReal:de,isEl:fe,isInFrame:pe,createEl:ge,textContent:ve,prependTo:ye,hasClass:be,addClass:_e,removeClass:Te,toggleClass:Se,setAttributes:Ee,getAttributes:we,getAttribute:Ce,setAttribute:ke,removeAttribute:Ae,blockTextSelection:Ie,unblockTextSelection:xe,getBoundingClientRect:Pe,findPosition:Le,getPointerPosition:Re,isTextNode:Oe,emptyEl:De,normalizeContent:Ne,appendContent:Me,insertContent:Be,isSingleLeftClick:Ue,$:Fe,$$:je}),Ge=1;function Ve(){return Ge++}var Ke={},We="vdata"+(new Date).getTime();function qe(e){var t=e[We];return t=t||(e[We]=Ve()),Ke[t]||(Ke[t]={}),Ke[t]}function ze(e){var t=e[We];return t&&Object.getOwnPropertyNames(Ke[t]).length}function Ye(t){var e=t[We];if(e){delete Ke[e];try{delete t[We]}catch(e){t.removeAttribute?t.removeAttribute(We):t[We]=null}}}function Xe(e,t){var i=qe(e);0===i.handlers[t].length&&(delete i.handlers[t],e.removeEventListener?e.removeEventListener(t,i.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,i.dispatcher)),Object.getOwnPropertyNames(i.handlers).length<=0&&(delete i.handlers,delete i.dispatcher,delete i.disabled),0===Object.getOwnPropertyNames(i).length&&Ye(e)}function $e(t,i,e,n){e.forEach(function(e){t(i,e,n)})}function Je(e){function t(){return!0}function i(){return!1}if(!e||!e.isPropagationStopped){var n=e||T.event;for(var r in e={},n)"layerX"!==r&&"layerY"!==r&&"keyLocation"!==r&&"webkitMovementX"!==r&&"webkitMovementY"!==r&&("returnValue"===r&&n.preventDefault||(e[r]=n[r]));if(e.target||(e.target=e.srcElement||M),e.relatedTarget||(e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement),e.preventDefault=function(){n.preventDefault&&n.preventDefault(),e.returnValue=!1,n.returnValue=!1,e.defaultPrevented=!0},e.defaultPrevented=!1,e.stopPropagation=function(){n.stopPropagation&&n.stopPropagation(),e.cancelBubble=!0,n.cancelBubble=!0,e.isPropagationStopped=t},e.isPropagationStopped=i,e.stopImmediatePropagation=function(){n.stopImmediatePropagation&&n.stopImmediatePropagation(),e.isImmediatePropagationStopped=t,e.stopPropagation()},e.isImmediatePropagationStopped=i,null!==e.clientX&&void 0!==e.clientX){var a=M.documentElement,s=M.body;e.pageX=e.clientX+(a&&a.scrollLeft||s&&s.scrollLeft||0)-(a&&a.clientLeft||s&&s.clientLeft||0),e.pageY=e.clientY+(a&&a.scrollTop||s&&s.scrollTop||0)-(a&&a.clientTop||s&&s.clientTop||0)}e.which=e.charCode||e.keyCode,null!==e.button&&void 0!==e.button&&(e.button=1&e.button?0:4&e.button?1:2&e.button?2:0)}return e}var Qe=!1;!function(){try{var e=Object.defineProperty({},"passive",{get:function(){Qe=!0}});T.addEventListener("test",null,e),T.removeEventListener("test",null,e)}catch(e){}}();var Ze=["touchstart","touchmove"];function et(s,e,t){if(Array.isArray(e))return $e(et,s,e,t);var o=qe(s);if(o.handlers||(o.handlers={}),o.handlers[e]||(o.handlers[e]=[]),t.guid||(t.guid=Ve()),o.handlers[e].push(t),o.dispatcher||(o.disabled=!1,o.dispatcher=function(e,t){if(!o.disabled){e=Je(e);var i=o.handlers[e.type];if(i)for(var n=i.slice(0),r=0,a=n.length;r<a&&!e.isImmediatePropagationStopped();r++)try{n[r].call(s,e,t)}catch(e){ee.error(e)}}}),1===o.handlers[e].length)if(s.addEventListener){var i=!1;Qe&&-1<Ze.indexOf(e)&&(i={passive:!0}),s.addEventListener(e,o.dispatcher,i)}else s.attachEvent&&s.attachEvent("on"+e,o.dispatcher)}function tt(e,t,i){if(ze(e)){var n=qe(e);if(n.handlers){if(Array.isArray(t))return $e(tt,e,t,i);var r=function(e,t){n.handlers[t]=[],Xe(e,t)};if(void 0!==t){var a=n.handlers[t];if(a)if(i){if(i.guid)for(var s=0;s<a.length;s++)a[s].guid===i.guid&&a.splice(s--,1);Xe(e,t)}else r(e,t)}else for(var o in n.handlers)Object.prototype.hasOwnProperty.call(n.handlers||{},o)&&r(e,o)}}}function it(e,t,i){var n=ze(e)?qe(e):{},r=e.parentNode||e.ownerDocument;if("string"==typeof t?t={type:t,target:e}:t.target||(t.target=e),t=Je(t),n.dispatcher&&n.dispatcher.call(e,t,i),r&&!t.isPropagationStopped()&&!0===t.bubbles)it.call(null,r,t,i);else if(!r&&!t.defaultPrevented){var a=qe(t.target);t.target[t.type]&&(a.disabled=!0,"function"==typeof t.target[t.type]&&t.target[t.type](),a.disabled=!1)}return!t.defaultPrevented}function nt(e,t,i){if(Array.isArray(t))return $e(nt,e,t,i);function n(){tt(e,t,n),i.apply(this,arguments)}n.guid=i.guid=i.guid||Ve(),et(e,t,n)}var rt,at=Object.freeze({fixEvent:Je,on:et,off:tt,trigger:it,one:nt}),st=!1,ot=function(){if(de()&&!1!==rt.options.autoSetup){var e=Array.prototype.slice.call(M.getElementsByTagName("video")),t=Array.prototype.slice.call(M.getElementsByTagName("audio")),i=Array.prototype.slice.call(M.getElementsByTagName("video-js")),n=e.concat(t,i);if(n&&0<n.length)for(var r=0,a=n.length;r<a;r++){var s=n[r];if(!s||!s.getAttribute){lt(1);break}void 0===s.player&&null!==s.getAttribute("data-setup")&&rt(s)}else st||lt(1)}};function lt(e,t){t&&(rt=t),T.setTimeout(ot,e)}de()&&"complete"===M.readyState?st=!0:nt(T,"load",function(){st=!0});function ut(e){var t=M.createElement("style");return t.className=e,t}function ct(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t}function ht(e,t,i){function n(){return t.apply(e,arguments)}return t.guid||(t.guid=Ve()),n.guid=i?i+"_"+t.guid:t.guid,n}function dt(t,i){var n=Date.now();return function(){var e=Date.now();i<=e-n&&(t.apply(void 0,arguments),n=e)}}function ft(n,r,a,s){var o;function e(){var e=this,t=arguments,i=function(){i=o=null,a||n.apply(e,t)};!o&&a&&n.apply(e,t),s.clearTimeout(o),o=s.setTimeout(i,r)}return void 0===s&&(s=T),e.cancel=function(){s.clearTimeout(o),o=null},e}function pt(){}var mt;pt.prototype.allowedEvents_={},pt.prototype.addEventListener=pt.prototype.on=function(e,t){var i=this.addEventListener;this.addEventListener=function(){},et(this,e,t),this.addEventListener=i},pt.prototype.removeEventListener=pt.prototype.off=function(e,t){tt(this,e,t)},pt.prototype.one=function(e,t){var i=this.addEventListener;this.addEventListener=function(){},nt(this,e,t),this.addEventListener=i},pt.prototype.dispatchEvent=pt.prototype.trigger=function(e){var t=e.type||e;"string"==typeof e&&(e={type:t}),e=Je(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),it(this,e)},pt.prototype.queueTrigger=function(e){var t=this;mt=mt||new Map;var i=e.type||e,n=mt.get(this);n||(n=new Map,mt.set(this,n));var r=n.get(i);n.delete(i),T.clearTimeout(r);var a=T.setTimeout(function(){0===n.size&&(n=null,mt.delete(t)),t.trigger(e)},0);n.set(i,a)};function gt(e){return"string"==typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length}function vt(e){if(!e.nodeName&&!St(e))throw new Error("Invalid target; must be a DOM node or evented object.")}function yt(e){if(!gt(e))throw new Error("Invalid event type; must be a non-empty string or array.")}function bt(e){if("function"!=typeof e)throw new Error("Invalid listener; must be a function.")}function _t(e,t){var i,n,r,a=t.length<3||t[0]===e||t[0]===e.eventBusEl_;return r=a?(i=e.eventBusEl_,3<=t.length&&t.shift(),n=t[0],t[1]):(i=t[0],n=t[1],t[2]),vt(i),yt(n),bt(r),{isTargetingSelf:a,target:i,type:n,listener:r=ht(e,r)}}function Tt(e,t,i,n){vt(e),e.nodeName?at[t](e,i,n):e[t](i,n)}var St=function(t){return t instanceof pt||!!t.eventBusEl_&&["on","one","off","trigger"].every(function(e){return"function"==typeof t[e]})},Et={on:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=_t(this,i),a=r.isTargetingSelf,s=r.target,o=r.type,l=r.listener;if(Tt(s,"on",o,l),!a){var u=function(){return e.off(s,o,l)};u.guid=l.guid;var c=function(){return e.off("dispose",u)};c.guid=l.guid,Tt(this,"on","dispose",u),Tt(s,"on","dispose",c)}},one:function(){for(var r=this,e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=_t(this,t),a=n.isTargetingSelf,s=n.target,o=n.type,l=n.listener;if(a)Tt(s,"one",o,l);else{var u=function e(){r.off(s,o,e);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];l.apply(null,i)};u.guid=l.guid,Tt(s,"one",o,u)}},off:function(e,t,i){if(!e||gt(e))tt(this.eventBusEl_,e,t);else{var n=e,r=t;vt(n),yt(r),bt(i),i=ht(this,i),this.off("dispose",i),n.nodeName?(tt(n,r,i),tt(n,"dispose",i)):St(n)&&(n.off(r,i),n.off("dispose",i))}},trigger:function(e,t){return it(this.eventBusEl_,e,t)}};function wt(e,t){void 0===t&&(t={});var i=t.eventBusKey;if(i){if(!e[i].nodeName)throw new Error('The eventBusKey "'+i+'" does not refer to an element.');e.eventBusEl_=e[i]}else e.eventBusEl_=ge("span",{className:"vjs-event-bus"});return ae(e,Et),e.eventedCallbacks&&e.eventedCallbacks.forEach(function(e){e()}),e.on("dispose",function(){e.off(),T.setTimeout(function(){e.eventBusEl_=null},0)}),e}var Ct={state:{},setState:function(e){var i,n=this;return"function"==typeof e&&(e=e()),re(e,function(e,t){n.state[t]!==e&&((i=i||{})[t]={from:n.state[t],to:e}),n.state[t]=e}),i&&St(this)&&this.trigger({changes:i,type:"statechanged"}),i}};function kt(e,t){return ae(e,Ct),e.state=ae({},e.state,t),"function"==typeof e.handleStateChanged&&St(e)&&e.on("statechanged",e.handleStateChanged),e}function At(e){return"string"!=typeof e?e:e.charAt(0).toUpperCase()+e.slice(1)}function It(){for(var i={},e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach(function(e){e&&re(e,function(e,t){oe(e)?(oe(i[t])||(i[t]={}),i[t]=It(i[t],e)):i[t]=e})}),i}var xt=function(){function u(e,t,i){if(!e&&this.play?this.player_=e=this:this.player_=e,this.options_=It({},this.options_),t=this.options_=It(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){var n=e&&e.id&&e.id()||"no_player";this.id_=n+"_component_"+Ve()}this.name_=t.name||null,t.el?this.el_=t.el:!1!==t.createEl&&(this.el_=this.createEl()),!1!==t.evented&&wt(this,{eventBusKey:this.el_?"el_":null}),kt(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},!(this.childNameIndex_={})!==t.initChildren&&this.initChildren(),this.ready(i),!1!==t.reportTouchActivity&&this.enableTouchActivity()}var e=u.prototype;return e.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var e=this.children_.length-1;0<=e;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),Ye(this.el_),this.el_=null),this.player_=null},e.player=function(){return this.player_},e.options=function(e){return ee.warn("this.options() has been deprecated and will be moved to the constructor in 6.0"),e&&(this.options_=It(this.options_,e)),this.options_},e.el=function(){return this.el_},e.createEl=function(e,t,i){return ge(e,t,i)},e.localize=function(e,r,t){void 0===t&&(t=e);var i=this.player_.language&&this.player_.language(),n=this.player_.languages&&this.player_.languages(),a=n&&n[i],s=i&&i.split("-")[0],o=n&&n[s],l=t;return a&&a[e]?l=a[e]:o&&o[e]&&(l=o[e]),r&&(l=l.replace(/\{(\d+)\}/g,function(e,t){var i=r[t-1],n=i;return void 0===i&&(n=e),n})),l},e.contentEl=function(){return this.contentEl_||this.el_},e.id=function(){return this.id_},e.name=function(){return this.name_},e.children=function(){return this.children_},e.getChildById=function(e){return this.childIndex_[e]},e.getChild=function(e){if(e)return e=At(e),this.childNameIndex_[e]},e.addChild=function(e,t,i){var n,r;if(void 0===t&&(t={}),void 0===i&&(i=this.children_.length),"string"==typeof e){r=At(e);var a=t.componentClass||r;t.name=r;var s=u.getComponent(a);if(!s)throw new Error("Component "+a+" does not exist");if("function"!=typeof s)return null;n=new s(this.player_||this,t)}else n=e;if(this.children_.splice(i,0,n),"function"==typeof n.id&&(this.childIndex_[n.id()]=n),(r=r||n.name&&At(n.name()))&&(this.childNameIndex_[r]=n),"function"==typeof n.el&&n.el()){var o=this.contentEl().children[i]||null;this.contentEl().insertBefore(n.el(),o)}return n},e.removeChild=function(e){if("string"==typeof e&&(e=this.getChild(e)),e&&this.children_){for(var t=!1,i=this.children_.length-1;0<=i;i--)if(this.children_[i]===e){t=!0,this.children_.splice(i,1);break}if(t){this.childIndex_[e.id()]=null,this.childNameIndex_[e.name()]=null;var n=e.el();n&&n.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}}},e.initChildren=function(){var r=this,n=this.options_.children;if(n){var e,a=this.options_,i=u.getComponent("Tech");(e=Array.isArray(n)?n:Object.keys(n)).concat(Object.keys(this.options_).filter(function(t){return!e.some(function(e){return"string"==typeof e?t===e:t===e.name})})).map(function(e){var t,i;return i="string"==typeof e?n[t=e]||r.options_[t]||{}:(t=e.name,e),{name:t,opts:i}}).filter(function(e){var t=u.getComponent(e.opts.componentClass||At(e.name));return t&&!i.isTech(t)}).forEach(function(e){var t=e.name,i=e.opts;if(void 0!==a[t]&&(i=a[t]),!1!==i){!0===i&&(i={}),i.playerOptions=r.options_.playerOptions;var n=r.addChild(t,i);n&&(r[t]=n)}})}},e.buildCSSClass=function(){return""},e.ready=function(e,t){if(void 0===t&&(t=!1),e)return this.isReady_?void(t?e.call(this):this.setTimeout(e,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(e))},e.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var e=this.readyQueue_;this.readyQueue_=[],e&&0<e.length&&e.forEach(function(e){e.call(this)},this),this.trigger("ready")},1)},e.$=function(e,t){return Fe(e,t||this.contentEl())},e.$$=function(e,t){return je(e,t||this.contentEl())},e.hasClass=function(e){return be(this.el_,e)},e.addClass=function(e){_e(this.el_,e)},e.removeClass=function(e){Te(this.el_,e)},e.toggleClass=function(e,t){Se(this.el_,e,t)},e.show=function(){this.removeClass("vjs-hidden")},e.hide=function(){this.addClass("vjs-hidden")},e.lockShowing=function(){this.addClass("vjs-lock-showing")},e.unlockShowing=function(){this.removeClass("vjs-lock-showing")},e.getAttribute=function(e){return Ce(this.el_,e)},e.setAttribute=function(e,t){ke(this.el_,e,t)},e.removeAttribute=function(e){Ae(this.el_,e)},e.width=function(e,t){return this.dimension("width",e,t)},e.height=function(e,t){return this.dimension("height",e,t)},e.dimensions=function(e,t){this.width(e,!0),this.height(t)},e.dimension=function(e,t,i){if(void 0!==t)return null!==t&&t==t||(t=0),-1!==(""+t).indexOf("%")||-1!==(""+t).indexOf("px")?this.el_.style[e]=t:this.el_.style[e]="auto"===t?"":t+"px",void(i||this.trigger("componentresize"));if(!this.el_)return 0;var n=this.el_.style[e],r=n.indexOf("px");return-1!==r?parseInt(n.slice(0,r),10):parseInt(this.el_["offset"+At(e)],10)},e.currentDimension=function(e){var t=0;if("width"!==e&&"height"!==e)throw new Error("currentDimension only accepts width or height value");if("function"==typeof T.getComputedStyle){var i=T.getComputedStyle(this.el_);t=i.getPropertyValue(e)||i[e]}if(0===(t=parseFloat(t))){var n="offset"+At(e);t=this.el_[n]}return t},e.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},e.currentWidth=function(){return this.currentDimension("width")},e.currentHeight=function(){return this.currentDimension("height")},e.focus=function(){this.el_.focus()},e.blur=function(){this.el_.blur()},e.emitTapEvents=function(){var n,t=0,r=null;this.on("touchstart",function(e){1===e.touches.length&&(r={pageX:e.touches[0].pageX,pageY:e.touches[0].pageY},t=(new Date).getTime(),n=!0)}),this.on("touchmove",function(e){if(1<e.touches.length)n=!1;else if(r){var t=e.touches[0].pageX-r.pageX,i=e.touches[0].pageY-r.pageY;10<Math.sqrt(t*t+i*i)&&(n=!1)}});function e(){n=!1}this.on("touchleave",e),this.on("touchcancel",e),this.on("touchend",function(e){!(r=null)===n&&(new Date).getTime()-t<200&&(e.preventDefault(),this.trigger("tap"))})},e.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var e,t=ht(this.player(),this.player().reportUserActivity);this.on("touchstart",function(){t(),this.clearInterval(e),e=this.setInterval(t,250)});var i=function(){t(),this.clearInterval(e)};this.on("touchmove",t),this.on("touchend",i),this.on("touchcancel",i)}},e.setTimeout=function(e,t){var i,n,r=this;return e=ht(this,e),i=T.setTimeout(function(){r.off("dispose",n),e()},t),(n=function(){return r.clearTimeout(i)}).guid="vjs-timeout-"+i,this.on("dispose",n),i},e.clearTimeout=function(e){T.clearTimeout(e);function t(){}return t.guid="vjs-timeout-"+e,this.off("dispose",t),e},e.setInterval=function(e,t){var i=this;e=ht(this,e);function n(){return i.clearInterval(r)}var r=T.setInterval(e,t);return n.guid="vjs-interval-"+r,this.on("dispose",n),r},e.clearInterval=function(e){T.clearInterval(e);function t(){}return t.guid="vjs-interval-"+e,this.off("dispose",t),e},e.requestAnimationFrame=function(e){var t,i,n=this;return this.supportsRaf_?(e=ht(this,e),t=T.requestAnimationFrame(function(){n.off("dispose",i),e()}),(i=function(){return n.cancelAnimationFrame(t)}).guid="vjs-raf-"+t,this.on("dispose",i),t):this.setTimeout(e,1e3/60)},e.cancelAnimationFrame=function(e){if(this.supportsRaf_){T.cancelAnimationFrame(e);var t=function(){};return t.guid="vjs-raf-"+e,this.off("dispose",t),e}return this.clearTimeout(e)},u.registerComponent=function(e,t){if("string"!=typeof e||!e)throw new Error('Illegal component name, "'+e+'"; must be a non-empty string.');var i,n=u.getComponent("Tech"),r=n&&n.isTech(t),a=u===t||u.prototype.isPrototypeOf(t.prototype);if(r||!a)throw i=r?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error('Illegal component, "'+e+'"; '+i+".");e=At(e),u.components_||(u.components_={});var s=u.getComponent("Player");if("Player"===e&&s&&s.players){var o=s.players,l=Object.keys(o);if(o&&0<l.length&&l.map(function(e){return o[e]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return u.components_[e]=t},u.getComponent=function(e){if(e)return e=At(e),u.components_&&u.components_[e]?u.components_[e]:void 0},u}();xt.prototype.supportsRaf_="function"==typeof T.requestAnimationFrame&&"function"==typeof T.cancelAnimationFrame,xt.registerComponent("Component",xt);var Pt,Lt,Rt,Ot,Dt=T.navigator&&T.navigator.userAgent||"",Nt=/AppleWebKit\/([\d.]+)/i.exec(Dt),Mt=Nt?parseFloat(Nt.pop()):null,Bt=/iPad/i.test(Dt),Ut=/iPhone/i.test(Dt)&&!Bt,Ft=/iPod/i.test(Dt),jt=Ut||Bt||Ft,Ht=(Pt=Dt.match(/OS (\d+)_/i))&&Pt[1]?Pt[1]:null,Gt=/Android/i.test(Dt),Vt=function(){var e=Dt.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),i=e[2]&&parseFloat(e[2]);return t&&i?parseFloat(e[1]+"."+e[2]):t||null}(),Kt=Gt&&Vt<5&&Mt<537,Wt=/Firefox/i.test(Dt),qt=/Edge/i.test(Dt),zt=!qt&&(/Chrome/i.test(Dt)||/CriOS/i.test(Dt)),Yt=(Lt=Dt.match(/(Chrome|CriOS)\/(\d+)/))&&Lt[2]?parseFloat(Lt[2]):null,Xt=(Rt=/MSIE\s(\d+)\.\d/.exec(Dt),!(Ot=Rt&&parseFloat(Rt[1]))&&/Trident\/7.0/i.test(Dt)&&/rv:11.0/.test(Dt)&&(Ot=11),Ot),$t=/Safari/i.test(Dt)&&!zt&&!Gt&&!qt,Jt=($t||jt)&&!zt,Qt=de()&&("ontouchstart"in T||T.navigator.maxTouchPoints||T.DocumentTouch&&T.document instanceof T.DocumentTouch),Zt=Object.freeze({IS_IPAD:Bt,IS_IPHONE:Ut,IS_IPOD:Ft,IS_IOS:jt,IOS_VERSION:Ht,IS_ANDROID:Gt,ANDROID_VERSION:Vt,IS_NATIVE_ANDROID:Kt,IS_FIREFOX:Wt,IS_EDGE:qt,IS_CHROME:zt,CHROME_VERSION:Yt,IE_VERSION:Xt,IS_SAFARI:$t,IS_ANY_SAFARI:Jt,TOUCH_ENABLED:Qt});function ei(e,t,i,n){return function(e,t,i){if("number"!=typeof t||t<0||i<t)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+i+").")}(e,n,i.length-1),i[n][t]}function ti(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:ei.bind(null,"start",0,e),end:ei.bind(null,"end",1,e)}}function ii(e,t){return Array.isArray(e)?ti(e):void 0===e||void 0===t?ti():ti([[e,t]])}function ni(e,t){var i,n,r=0;if(!t)return 0;e&&e.length||(e=ii(0,0));for(var a=0;a<e.length;a++)i=e.start(a),t<(n=e.end(a))&&(n=t),r+=n-i;return r/t}for(var ri,ai={},si=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],oi=si[0],li=0;li<si.length;li++)if(si[li][1]in M){ri=si[li];break}if(ri)for(var ui=0;ui<ri.length;ui++)ai[oi[ui]]=ri[ui];function ci(e){if(e instanceof ci)return e;"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:se(e)&&("number"==typeof e.code&&(this.code=e.code),ae(this,e)),this.message||(this.message=ci.defaultMessages[this.code]||"")}ci.prototype.code=0,ci.prototype.message="",ci.prototype.status=null,ci.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],ci.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var hi=0;hi<ci.errorTypes.length;hi++)ci[ci.errorTypes[hi]]=hi,ci.prototype[ci.errorTypes[hi]]=hi;function di(e){return null!=e&&"function"==typeof e.then}function fi(e){di(e)&&e.then(null,function(e){})}function pi(n){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(e,t,i){return n[t]&&(e[t]=n[t]),e},{cues:n.cues&&Array.prototype.map.call(n.cues,function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}})})}var mi=function(e){var t=e.$$("track"),i=Array.prototype.map.call(t,function(e){return e.track});return Array.prototype.map.call(t,function(e){var t=pi(e.track);return e.src&&(t.src=e.src),t}).concat(Array.prototype.filter.call(e.textTracks(),function(e){return-1===i.indexOf(e)}).map(pi))},gi=function(e,i){return e.forEach(function(e){var t=i.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach(function(e){return t.addCue(e)})}),i.textTracks()},vi="vjs-modal-dialog",yi=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).opened_=i.hasBeenOpened_=i.hasBeenFilled_=!1,i.closeable(!i.options_.uncloseable),i.content(i.options_.content),i.contentEl_=ge("div",{className:vi+"-content"},{role:"document"}),i.descEl_=ge("p",{className:vi+"-description vjs-control-text",id:i.el().getAttribute("aria-describedby")}),ve(i.descEl_,i.description()),i.el_.appendChild(i.descEl_),i.el_.appendChild(i.contentEl_),i}z(e,n);var t=e.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},t.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,n.prototype.dispose.call(this)},t.buildCSSClass=function(){return vi+" vjs-hidden "+n.prototype.buildCSSClass.call(this)},t.handleKeyPress=function(e){27===e.which&&this.closeable()&&this.close()},t.label=function(){return this.localize(this.options_.label||"Modal Window")},t.description=function(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},t.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,!this.options_.fillAlways&&(this.hasBeenOpened_||this.hasBeenFilled_)||this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.closeable()&&this.on(this.el_.ownerDocument,"keydown",ht(this,this.handleKeyPress)),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},t.opened=function(e){return"boolean"==typeof e&&this[e?"open":"close"](),this.opened_},t.close=function(){if(this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.closeable()&&this.off(this.el_.ownerDocument,"keydown",ht(this,this.handleKeyPress)),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},t.closeable=function(e){if("boolean"==typeof e){var t=this.closeable_=!!e,i=this.getChild("closeButton");if(t&&!i){var n=this.contentEl_;this.contentEl_=this.el_,i=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=n,this.on(i,"close",this.close)}!t&&i&&(this.off(i,"close",this.close),this.removeChild(i),i.dispose())}return this.closeable_},t.fill=function(){this.fillWith(this.content())},t.fillWith=function(e){var t=this.contentEl(),i=t.parentNode,n=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,i.removeChild(t),this.empty(),Be(t,e),this.trigger("modalfill"),n?i.insertBefore(t,n):i.appendChild(t);var r=this.getChild("closeButton");r&&i.appendChild(r.el_)},t.empty=function(){this.trigger("beforemodalempty"),De(this.contentEl()),this.trigger("modalempty")},t.content=function(e){return void 0!==e&&(this.content_=e),this.content_},t.conditionalFocus_=function(){var e=M.activeElement,t=this.player_.el_;this.previouslyActiveEl_=null,!t.contains(e)&&t!==e||(this.previouslyActiveEl_=e,this.focus(),this.on(M,"keydown",this.handleKeyDown))},t.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null),this.off(M,"keydown",this.handleKeyDown)},t.handleKeyDown=function(e){if(9===e.which){for(var t,i=this.focusableEls_(),n=this.el_.querySelector(":focus"),r=0;r<i.length;r++)if(n===i[r]){t=r;break}M.activeElement===this.el_&&(t=0),e.shiftKey&&0===t?(i[i.length-1].focus(),e.preventDefault()):e.shiftKey||t!==i.length-1||(i[0].focus(),e.preventDefault())}},t.focusableEls_=function(){var e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,function(e){return(e instanceof T.HTMLAnchorElement||e instanceof T.HTMLAreaElement)&&e.hasAttribute("href")||(e instanceof T.HTMLInputElement||e instanceof T.HTMLSelectElement||e instanceof T.HTMLTextAreaElement||e instanceof T.HTMLButtonElement)&&!e.hasAttribute("disabled")||e instanceof T.HTMLIFrameElement||e instanceof T.HTMLObjectElement||e instanceof T.HTMLEmbedElement||e.hasAttribute("tabindex")&&-1!==e.getAttribute("tabindex")||e.hasAttribute("contenteditable")})},e}(xt);yi.prototype.options_={pauseOnOpen:!0,temporary:!0},xt.registerComponent("ModalDialog",yi);var bi=function(n){function e(e){var t;void 0===e&&(e=[]),(t=n.call(this)||this).tracks_=[],Object.defineProperty($($(t)),"length",{get:function(){return this.tracks_.length}});for(var i=0;i<e.length;i++)t.addTrack(e[i]);return t}z(e,n);var t=e.prototype;return t.addTrack=function(e){var t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}}),-1===this.tracks_.indexOf(e)&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack"}))},t.removeTrack=function(e){for(var t,i=0,n=this.length;i<n;i++)if(this[i]===e){(t=this[i]).off&&t.off(),this.tracks_.splice(i,1);break}t&&this.trigger({track:t,type:"removetrack"})},t.getTrackById=function(e){for(var t=null,i=0,n=this.length;i<n;i++){var r=this[i];if(r.id===e){t=r;break}}return t},e}(pt);for(var _i in bi.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},bi.prototype.allowedEvents_)bi.prototype["on"+_i]=null;function Ti(e,t){for(var i=0;i<e.length;i++)Object.keys(e[i]).length&&t.id!==e[i].id&&(e[i].enabled=!1)}function Si(e,t){for(var i=0;i<e.length;i++)Object.keys(e[i]).length&&t.id!==e[i].id&&(e[i].selected=!1)}function Ei(e){var t=["protocol","hostname","port","pathname","search","hash","host"],i=M.createElement("a");i.href=e;var n,r=""===i.host&&"file:"!==i.protocol;r&&((n=M.createElement("div")).innerHTML='<a href="'+e+'"></a>',i=n.firstChild,n.setAttribute("style","display:none; position:absolute;"),M.body.appendChild(n));for(var a={},s=0;s<t.length;s++)a[t[s]]=i[t[s]];return"http:"===a.protocol&&(a.host=a.host.replace(/:80$/,"")),"https:"===a.protocol&&(a.host=a.host.replace(/:443$/,"")),a.protocol||(a.protocol=T.location.protocol),r&&M.body.removeChild(n),a}function wi(e){if(!e.match(/^https?:\/\//)){var t=M.createElement("div");t.innerHTML='<a href="'+e+'">x</a>',e=t.firstChild.href}return e}function Ci(e){if("string"==typeof e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i.exec(e);if(t)return t.pop().toLowerCase()}return""}function ki(e){var t=T.location,i=Ei(e);return(":"===i.protocol?t.protocol:i.protocol)+i.host!==t.protocol+t.host}function Ai(e,t){var i=new T.WebVTT.Parser(T,T.vttjs,T.WebVTT.StringDecoder()),n=[];i.oncue=function(e){t.addCue(e)},i.onparsingerror=function(e){n.push(e)},i.onflush=function(){t.trigger({type:"loadeddata",target:t})},i.parse(e),0<n.length&&(T.console&&T.console.groupCollapsed&&T.console.groupCollapsed("Text Track parsing errors for "+t.src),n.forEach(function(e){return ee.error(e)}),T.console&&T.console.groupEnd&&T.console.groupEnd()),i.flush()}var Ii=function(n){function e(e){var t;void 0===e&&(e=[]);for(var i=e.length-1;0<=i;i--)if(e[i].enabled){Ti(e,e[i]);break}return(t=n.call(this,e)||this).changing_=!1,t}return z(e,n),e.prototype.addTrack=function(e){var t=this;e.enabled&&Ti(this,e),n.prototype.addTrack.call(this,e),e.addEventListener&&e.addEventListener("enabledchange",function(){t.changing_||(t.changing_=!0,Ti(t,e),t.changing_=!1,t.trigger("change"))})},e}(bi),xi=function(n){function e(e){var t;void 0===e&&(e=[]);for(var i=e.length-1;0<=i;i--)if(e[i].selected){Si(e,e[i]);break}return(t=n.call(this,e)||this).changing_=!1,Object.defineProperty($($(t)),"selectedIndex",{get:function(){for(var e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set:function(){}}),t}return z(e,n),e.prototype.addTrack=function(e){var t=this;e.selected&&Si(this,e),n.prototype.addTrack.call(this,e),e.addEventListener&&e.addEventListener("selectedchange",function(){t.changing_||(t.changing_=!0,Si(t,e),t.changing_=!1,t.trigger("change"))})},e}(bi),Pi=function(t){function e(){return t.apply(this,arguments)||this}return z(e,t),e.prototype.addTrack=function(e){t.prototype.addTrack.call(this,e),e.addEventListener("modechange",ht(this,function(){this.queueTrigger("change")}));-1===["metadata","chapters"].indexOf(e.kind)&&e.addEventListener("modechange",ht(this,function(){this.trigger("selectedlanguagechange")}))},e}(bi),Li=function(){function e(e){void 0===e&&(e=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,i=e.length;t<i;t++)this.addTrackElement_(e[t])}var t=e.prototype;return t.addTrackElement_=function(e){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}}),-1===this.trackElements_.indexOf(e)&&this.trackElements_.push(e)},t.getTrackElementByTrack_=function(e){for(var t,i=0,n=this.trackElements_.length;i<n;i++)if(e===this.trackElements_[i].track){t=this.trackElements_[i];break}return t},t.removeTrackElement_=function(e){for(var t=0,i=this.trackElements_.length;t<i;t++)if(e===this.trackElements_[t]){this.trackElements_.splice(t,1);break}},e}(),Ri=function(){function t(e){t.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var e=t.prototype;return e.setCues_=function(e){var t=this.length||0,i=0,n=e.length;this.cues_=e,this.length_=e.length;function r(e){""+e in this||Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})}if(t<n)for(i=t;i<n;i++)r.call(this,i)},e.getCueById=function(e){for(var t=null,i=0,n=this.length;i<n;i++){var r=this[i];if(r.id===e){t=r;break}}return t},t}(),Oi={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},Di={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},Ni={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Mi={disabled:"disabled",hidden:"hidden",showing:"showing"},Bi=function(a){function e(e){var t;void 0===e&&(e={}),t=a.call(this)||this;function i(e){Object.defineProperty($($(t)),e,{get:function(){return n[e]},set:function(){}})}var n={id:e.id||"vjs_track_"+Ve(),kind:e.kind||"",label:e.label||"",language:e.language||""};for(var r in n)i(r);return t}return z(e,a),e}(pt),Ui=Object.freeze({parseUrl:Ei,getAbsoluteURL:wi,getFileExtension:Ci,isCrossOrigin:ki}),Fi=function(u){function e(e){var t;if(void 0===e&&(e={}),!e.tech)throw new Error("A tech was not provided.");var i=It(e,{kind:Ni[e.kind]||"subtitles",language:e.language||e.srclang||""}),n=Mi[i.mode]||"disabled",r=i.default;"metadata"!==i.kind&&"chapters"!==i.kind||(n="hidden"),(t=u.call(this,i)||this).tech_=i.tech,t.cues_=[],t.activeCues_=[];var a=new Ri(t.cues_),s=new Ri(t.activeCues_),o=!1,l=ht($($(t)),function(){this.activeCues=this.activeCues,o&&(this.trigger("cuechange"),o=!1)});return"disabled"!==n&&t.tech_.ready(function(){t.tech_.on("timeupdate",l)},!0),Object.defineProperties($($(t)),{default:{get:function(){return r},set:function(){}},mode:{get:function(){return n},set:function(e){var t=this;Mi[e]&&("disabled"!==(n=e)?this.tech_.ready(function(){t.tech_.on("timeupdate",l)},!0):this.tech_.off("timeupdate",l),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?a:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return s;for(var e=this.tech_.currentTime(),t=[],i=0,n=this.cues.length;i<n;i++){var r=this.cues[i];(r.startTime<=e&&r.endTime>=e||r.startTime===r.endTime&&r.startTime<=e&&r.startTime+.5>=e)&&t.push(r)}if(o=!1,t.length!==this.activeCues_.length)o=!0;else for(var a=0;a<t.length;a++)-1===this.activeCues_.indexOf(t[a])&&(o=!0);return this.activeCues_=t,s.setCues_(this.activeCues_),s},set:function(){}}}),i.src?(t.src=i.src,function(e,r){var t={uri:e},i=ki(e);i&&(t.cors=i),V(t,ht(this,function(e,t,i){if(e)return ee.error(e,t);if(r.loaded_=!0,"function"!=typeof T.WebVTT){if(r.tech_){var n=function(){return Ai(i,r)};r.tech_.on("vttjsloaded",n),r.tech_.on("vttjserror",function(){ee.error("vttjs failed to load, stopping trying to process "+r.src),r.tech_.off("vttjsloaded",n)})}}else Ai(i,r)}))}(i.src,$($(t)))):t.loaded_=!0,t}z(e,u);var t=e.prototype;return t.addCue=function(e){var t=e;if(T.vttjs&&!(e instanceof T.vttjs.VTTCue)){for(var i in t=new T.vttjs.VTTCue(e.startTime,e.endTime,e.text),e)i in t||(t[i]=e[i]);t.id=e.id,t.originalCue_=e}for(var n=this.tech_.textTracks(),r=0;r<n.length;r++)n[r]!==this&&n[r].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)},t.removeCue=function(e){for(var t=this.cues_.length;t--;){var i=this.cues_[t];if(i===e||i.originalCue_&&i.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}},e}(Bi);Fi.prototype.allowedEvents_={cuechange:"cuechange"};var ji=function(r){function e(e){var t;void 0===e&&(e={});var i=It(e,{kind:Di[e.kind]||""});t=r.call(this,i)||this;var n=!1;return Object.defineProperty($($(t)),"enabled",{get:function(){return n},set:function(e){"boolean"==typeof e&&e!==n&&(n=e,this.trigger("enabledchange"))}}),i.enabled&&(t.enabled=i.enabled),t.loaded_=!0,t}return z(e,r),e}(Bi),Hi=function(r){function e(e){var t;void 0===e&&(e={});var i=It(e,{kind:Oi[e.kind]||""});t=r.call(this,i)||this;var n=!1;return Object.defineProperty($($(t)),"selected",{get:function(){return n},set:function(e){"boolean"==typeof e&&e!==n&&(n=e,this.trigger("selectedchange"))}}),i.selected&&(t.selected=i.selected),t}return z(e,r),e}(Bi),Gi=function(r){function e(e){var t,i;void 0===e&&(e={}),t=r.call(this)||this;var n=new Fi(e);return t.kind=n.kind,t.src=n.src,t.srclang=n.language,t.label=n.label,t.default=n.default,Object.defineProperties($($(t)),{readyState:{get:function(){return i}},track:{get:function(){return n}}}),i=0,n.addEventListener("loadeddata",function(){i=2,t.trigger({type:"load",target:$($(t))})}),t}return z(e,r),e}(pt);Gi.prototype.allowedEvents_={load:"load"},Gi.NONE=0,Gi.LOADING=1,Gi.LOADED=2,Gi.ERROR=3;var Vi={audio:{ListClass:Ii,TrackClass:ji,capitalName:"Audio"},video:{ListClass:xi,TrackClass:Hi,capitalName:"Video"},text:{ListClass:Pi,TrackClass:Fi,capitalName:"Text"}};Object.keys(Vi).forEach(function(e){Vi[e].getterName=e+"Tracks",Vi[e].privateName=e+"Tracks_"});var Ki={remoteText:{ListClass:Pi,TrackClass:Fi,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Li,TrackClass:Gi,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},Wi=It(Vi,Ki);Ki.names=Object.keys(Ki),Vi.names=Object.keys(Vi),Wi.names=[].concat(Ki.names).concat(Vi.names);var qi=function(t){function i(i,e){var n;return void 0===i&&(i={}),void 0===e&&(e=function(){}),i.reportTouchActivity=!1,(n=t.call(this,null,i,e)||this).hasStarted_=!1,n.on("playing",function(){this.hasStarted_=!0}),n.on("loadstart",function(){this.hasStarted_=!1}),Wi.names.forEach(function(e){var t=Wi[e];i&&i[t.getterName]&&(n[t.privateName]=i[t.getterName])}),n.featuresProgressEvents||n.manualProgressOn(),n.featuresTimeupdateEvents||n.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(e){!1===i["native"+e+"Tracks"]&&(n["featuresNative"+e+"Tracks"]=!1)}),!1===i.nativeCaptions||!1===i.nativeTextTracks?n.featuresNativeTextTracks=!1:!0!==i.nativeCaptions&&!0!==i.nativeTextTracks||(n.featuresNativeTextTracks=!0),n.featuresNativeTextTracks||n.emulateTextTracks(),n.autoRemoteTextTracks_=new Wi.text.ListClass,n.initTrackListeners(),i.nativeControlsForTouch||n.emitTapEvents(),n.constructor&&(n.name_=n.constructor.name||"Unknown Tech"),n}z(i,t);var e=i.prototype;return e.triggerSourceset=function(e){var t=this;this.isReady_||this.one("ready",function(){return t.setTimeout(function(){return t.triggerSourceset(e)},1)}),this.trigger({src:e,type:"sourceset"})},e.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},e.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},e.trackProgress=function(){this.stopTrackingProgress(),this.progressInterval=this.setInterval(ht(this,function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),1===(this.bufferedPercent_=e)&&this.stopTrackingProgress()}),500)},e.onDurationChange=function(){this.duration_=this.duration()},e.buffered=function(){return ii(0,0)},e.bufferedPercent=function(){return ni(this.buffered(),this.duration_)},e.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},e.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},e.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},e.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},e.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},e.dispose=function(){this.clearTracks(Vi.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),t.prototype.dispose.call(this)},e.clearTracks=function(e){var r=this;(e=[].concat(e)).forEach(function(e){for(var t=r[e+"Tracks"]()||[],i=t.length;i--;){var n=t[i];"text"===e&&r.removeRemoteTextTrack(n),t.removeTrack(n)}})},e.cleanupAutoTextTracks=function(){for(var e=this.autoRemoteTextTracks_||[],t=e.length;t--;){var i=e[t];this.removeRemoteTextTrack(i)}},e.reset=function(){},e.error=function(e){return void 0!==e&&(this.error_=new ci(e),this.trigger("error")),this.error_},e.played=function(){return this.hasStarted_?ii(0,0):ii()},e.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},e.initTrackListeners=function(){var r=this;Vi.names.forEach(function(e){function t(){r.trigger(e+"trackchange")}var i=Vi[e],n=r[i.getterName]();n.addEventListener("removetrack",t),n.addEventListener("addtrack",t),r.on("dispose",function(){n.removeEventListener("removetrack",t),n.removeEventListener("addtrack",t)})})},e.addWebVttScript_=function(){var e=this;if(!T.WebVTT)if(M.body.contains(this.el())){if(!this.options_["vtt.js"]&&oe(O)&&0<Object.keys(O).length)return void this.trigger("vttjsloaded");var t=M.createElement("script");t.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",t.onload=function(){e.trigger("vttjsloaded")},t.onerror=function(){e.trigger("vttjserror")},this.on("dispose",function(){t.onload=null,t.onerror=null}),T.WebVTT=!0,this.el().parentNode.appendChild(t)}else this.ready(this.addWebVttScript_)},e.emulateTextTracks=function(){function t(e){return n.addTrack(e.track)}function i(e){return n.removeTrack(e.track)}var e=this,n=this.textTracks(),r=this.remoteTextTracks();r.on("addtrack",t),r.on("removetrack",i),this.addWebVttScript_();function a(){return e.trigger("texttrackchange")}function s(){a();for(var e=0;e<n.length;e++){var t=n[e];t.removeEventListener("cuechange",a),"showing"===t.mode&&t.addEventListener("cuechange",a)}}s(),n.addEventListener("change",s),n.addEventListener("addtrack",s),n.addEventListener("removetrack",s),this.on("dispose",function(){r.off("addtrack",t),r.off("removetrack",i),n.removeEventListener("change",s),n.removeEventListener("addtrack",s),n.removeEventListener("removetrack",s);for(var e=0;e<n.length;e++){n[e].removeEventListener("cuechange",a)}})},e.addTextTrack=function(e,t,i){if(!e)throw new Error("TextTrack kind is required but was not provided");return function(e,t,i,n,r){void 0===r&&(r={});var a=e.textTracks();r.kind=t,i&&(r.label=i),n&&(r.language=n),r.tech=e;var s=new Wi.text.TrackClass(r);return a.addTrack(s),s}(this,e,t,i)},e.createRemoteTextTrack=function(e){var t=It(e,{tech:this});return new Ki.remoteTextEl.TrackClass(t)},e.addRemoteTextTrack=function(e,t){var i=this;void 0===e&&(e={});var n=this.createRemoteTextTrack(e);return!0!==t&&!1!==t&&(ee.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(n),this.remoteTextTracks().addTrack(n.track),!0!==t&&this.ready(function(){return i.autoRemoteTextTracks_.addTrack(n.track)}),n},e.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)},e.getVideoPlaybackQuality=function(){return{}},e.setPoster=function(){},e.playsinline=function(){},e.setPlaysinline=function(){},e.overrideNativeAudioTracks=function(){},e.overrideNativeVideoTracks=function(){},e.canPlayType=function(){return""},i.canPlayType=function(){return""},i.canPlaySource=function(e){return i.canPlayType(e.type)},i.isTech=function(e){return e.prototype instanceof i||e instanceof i||e===i},i.registerTech=function(e,t){if(i.techs_||(i.techs_={}),!i.isTech(t))throw new Error("Tech "+e+" must be a Tech");if(!i.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!i.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=At(e),i.techs_[e]=t,"Tech"!==e&&i.defaultTechOrder_.push(e),t},i.getTech=function(e){if(e)return e=At(e),i.techs_&&i.techs_[e]?i.techs_[e]:T&&T.videojs&&T.videojs[e]?(ee.warn("The "+e+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),T.videojs[e]):void 0},i}(xt);Wi.names.forEach(function(e){var t=Wi[e];qi.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}}),qi.prototype.featuresVolumeControl=!0,qi.prototype.featuresMuteControl=!0,qi.prototype.featuresFullscreenResize=!1,qi.prototype.featuresPlaybackRate=!1,qi.prototype.featuresProgressEvents=!1,qi.prototype.featuresSourceset=!1,qi.prototype.featuresTimeupdateEvents=!1,qi.prototype.featuresNativeTextTracks=!1,qi.withSourceHandlers=function(r){r.registerSourceHandler=function(e,t){var i=r.sourceHandlers;i=i||(r.sourceHandlers=[]),void 0===t&&(t=i.length),i.splice(t,0,e)},r.canPlayType=function(e){for(var t,i=r.sourceHandlers||[],n=0;n<i.length;n++)if(t=i[n].canPlayType(e))return t;return""},r.selectSourceHandler=function(e,t){for(var i=r.sourceHandlers||[],n=0;n<i.length;n++)if(i[n].canHandleSource(e,t))return i[n];return null},r.canPlaySource=function(e,t){var i=r.selectSourceHandler(e,t);return i?i.canHandleSource(e,t):""};["seekable","seeking","duration"].forEach(function(e){var t=this[e];"function"==typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})},r.prototype),r.prototype.setSource=function(e){var t=r.selectSourceHandler(e,this.options_);t||(r.nativeSourceHandler?t=r.nativeSourceHandler:ee.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),t!==r.nativeSourceHandler&&(this.currentSource_=e),this.sourceHandler_=t.handleSource(e,this,this.options_),this.on("dispose",this.disposeSourceHandler)},r.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},xt.registerComponent("Tech",qi),qi.registerTech("Tech",qi),qi.defaultTechOrder_=[];var zi={},Yi={},Xi={};function $i(e,t,i){e.setTimeout(function(){return function i(n,e,r,a,s,o){void 0===n&&(n={});void 0===e&&(e=[]);void 0===s&&(s=[]);void 0===o&&(o=!1);var t=e,l=t[0],u=t.slice(1);if("string"==typeof l)i(n,zi[l],r,a,s,o);else if(l){var c=nn(a,l);if(!c.setSource)return s.push(c),i(n,u,r,a,s,o);c.setSource(ae({},n),function(e,t){if(e)return i(n,u,r,a,s,o);s.push(c),i(t,n.type===t.type?u:zi[t.type],r,a,s,o)})}else u.length?i(n,u,r,a,s,o):o?r(n,s):i(n,zi["*"],r,a,s,!0)}(t,zi[t.type],i,e)},1)}function Ji(e,t,i,n){void 0===n&&(n=null);var r="call"+At(i),a=e.reduce(tn(r),n),s=a===Xi,o=s?null:t[i](a);return function(e,t,i,n){for(var r=e.length-1;0<=r;r--){var a=e[r];a[t]&&a[t](n,i)}}(e,i,o,s),o}var Qi={buffered:1,currentTime:1,duration:1,seekable:1,played:1,paused:1},Zi={setCurrentTime:1},en={play:1,pause:1};function tn(i){return function(e,t){return e===Xi?Xi:t[i]?t[i](e):e}}function nn(e,t){var i=Yi[e.id()],n=null;if(null==i)return n=t(e),Yi[e.id()]=[[t,n]],n;for(var r=0;r<i.length;r++){var a=i[r],s=a[0],o=a[1];s===t&&(n=o)}return null===n&&(n=t(e),i.push([t,n])),n}function rn(e){void 0===e&&(e="");var t=Ci(e);return an[t.toLowerCase()]||""}var an={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL"};function sn(e){var t=rn(e.src);return!e.type&&t&&(e.type=t),e}var on=function(u){function e(e,t,i){var n,r=It({createEl:!1},t);if(n=u.call(this,e,r,i)||this,t.playerOptions.sources&&0!==t.playerOptions.sources.length)e.src(t.playerOptions.sources);else for(var a=0,s=t.playerOptions.techOrder;a<s.length;a++){var o=At(s[a]),l=qi.getTech(o);if(o||(l=xt.getComponent(o)),l&&l.isSupported()){e.loadTech_(o);break}}return n}return z(e,u),e}(xt);xt.registerComponent("MediaLoader",on);var ln=function(r){function e(e,t){var i;return(i=r.call(this,e,t)||this).emitTapEvents(),i.enable(),i}z(e,r);var t=e.prototype;return t.createEl=function(e,t,i){void 0===e&&(e="div"),void 0===t&&(t={}),void 0===i&&(i={}),t=ae({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},t),"button"===e&&ee.error("Creating a ClickableComponent with an HTML element of "+e+" is not supported; use a Button instead."),i=ae({role:"button"},i),this.tabIndex_=t.tabIndex;var n=r.prototype.createEl.call(this,e,t,i);return this.createControlTextEl(n),n},t.dispose=function(){this.controlTextEl_=null,r.prototype.dispose.call(this)},t.createControlTextEl=function(e){return this.controlTextEl_=ge("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_},t.controlText=function(e,t){if(void 0===t&&(t=this.el()),void 0===e)return this.controlText_||"Need Text";var i=this.localize(e);this.controlText_=e,ve(this.controlTextEl_,i),this.nonIconControl||t.setAttribute("title",i)},t.buildCSSClass=function(){return"vjs-control vjs-button "+r.prototype.buildCSSClass.call(this)},t.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur))},t.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off(["tap","click"],this.handleClick),this.off("focus",this.handleFocus),this.off("blur",this.handleBlur)},t.handleClick=function(){},t.handleFocus=function(){et(M,"keydown",ht(this,this.handleKeyPress))},t.handleKeyPress=function(e){32===e.which||13===e.which?(e.preventDefault(),this.trigger("click")):r.prototype.handleKeyPress&&r.prototype.handleKeyPress.call(this,e)},t.handleBlur=function(){tt(M,"keydown",ht(this,this.handleKeyPress))},e}(xt);xt.registerComponent("ClickableComponent",ln);var un=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).update(),e.on("posterchange",ht($($(i)),i.update)),i}z(e,n);var t=e.prototype;return t.dispose=function(){this.player().off("posterchange",this.update),n.prototype.dispose.call(this)},t.createEl=function(){return ge("div",{className:"vjs-poster",tabIndex:-1})},t.update=function(){var e=this.player().poster();this.setSrc(e),e?this.show():this.hide()},t.setSrc=function(e){var t="";e&&(t='url("'+e+'")'),this.el_.style.backgroundImage=t},t.handleClick=function(){this.player_.controls()&&(this.player_.paused()?fi(this.player_.play()):this.player_.pause())},e}(ln);xt.registerComponent("PosterImage",un);var cn="#222",hn={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function dn(e,t){var i;if(4===e.length)i=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");i=e.slice(1)}return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+t+")"}function fn(e,t,i){try{e.style[t]=i}catch(e){return}}var pn=function(a){function e(i,e,t){var n;n=a.call(this,i,e,t)||this;var r=ht($($(n)),n.updateDisplay);return i.on("loadstart",ht($($(n)),n.toggleDisplay)),i.on("texttrackchange",r),i.on("loadedmetadata",ht($($(n)),n.preselectTrack)),i.ready(ht($($(n)),function(){if(i.tech_&&i.tech_.featuresNativeTextTracks)this.hide();else{i.on("fullscreenchange",r),i.on("playerresize",r),T.addEventListener("orientationchange",r),i.on("dispose",function(){return T.removeEventListener("orientationchange",r)});for(var e=this.options_.playerOptions.tracks||[],t=0;t<e.length;t++)this.player_.addRemoteTextTrack(e[t],!0);this.preselectTrack()}})),n}z(e,a);var t=e.prototype;return t.preselectTrack=function(){for(var e,t,i,n={captions:1,subtitles:1},r=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage,s=0;s<r.length;s++){var o=r[s];a&&a.enabled&&a.language&&a.language===o.language&&o.kind in n?i=o.kind!==a.kind&&i||o:a&&!a.enabled?t=e=i=null:o.default&&("descriptions"!==o.kind||e?o.kind in n&&!t&&(t=o):e=o)}i?i.mode="showing":t?t.mode="showing":e&&(e.mode="showing")},t.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},t.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},t.clearDisplay=function(){"function"==typeof T.WebVTT&&T.WebVTT.processCues(T,[],this.el_)},t.updateDisplay=function(){var e=this.player_.textTracks();this.clearDisplay();for(var t=null,i=null,n=e.length;n--;){var r=e[n];"showing"===r.mode&&("descriptions"===r.kind?t=r:i=r)}i?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(i)):t&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(t))},t.updateForTrack=function(e){if("function"==typeof T.WebVTT&&e.activeCues){for(var t=[],i=0;i<e.activeCues.length;i++)t.push(e.activeCues[i]);if(T.WebVTT.processCues(T,t,this.el_),this.player_.textTrackSettings)for(var n=this.player_.textTrackSettings.getValues(),r=t.length;r--;){var a=t[r];if(a){var s=a.displayState;if(n.color&&(s.firstChild.style.color=n.color),n.textOpacity&&fn(s.firstChild,"color",dn(n.color||"#fff",n.textOpacity)),n.backgroundColor&&(s.firstChild.style.backgroundColor=n.backgroundColor),n.backgroundOpacity&&fn(s.firstChild,"backgroundColor",dn(n.backgroundColor||"#000",n.backgroundOpacity)),n.windowColor&&(n.windowOpacity?fn(s,"backgroundColor",dn(n.windowColor,n.windowOpacity)):s.style.backgroundColor=n.windowColor),n.edgeStyle&&("dropshadow"===n.edgeStyle?s.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px "+cn:"raised"===n.edgeStyle?s.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px "+cn:"depressed"===n.edgeStyle?s.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px "+cn:"uniform"===n.edgeStyle&&(s.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px "+cn)),n.fontPercent&&1!==n.fontPercent){var o=T.parseFloat(s.style.fontSize);s.style.fontSize=o*n.fontPercent+"px",s.style.height="auto",s.style.top="auto",s.style.bottom="2px"}n.fontFamily&&"default"!==n.fontFamily&&("small-caps"===n.fontFamily?s.firstChild.style.fontVariant="small-caps":s.firstChild.style.fontFamily=hn[n.fontFamily])}}}},e}(xt);xt.registerComponent("TextTrackDisplay",pn);var mn=function(r){function e(){return r.apply(this,arguments)||this}return z(e,r),e.prototype.createEl=function(){var e=this.player_.isAudio(),t=this.localize(e?"Audio Player":"Video Player"),i=ge("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[t])}),n=r.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return n.appendChild(i),n},e}(xt);xt.registerComponent("LoadingSpinner",mn);var gn=function(t){function e(){return t.apply(this,arguments)||this}z(e,t);var i=e.prototype;return i.createEl=function(e,t,i){void 0===t&&(t={}),void 0===i&&(i={}),t=ae({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},t),i=ae({type:"button"},i);var n=xt.prototype.createEl.call(this,"button",t,i);return this.createControlTextEl(n),n},i.addChild=function(e,t){void 0===t&&(t={});var i=this.constructor.name;return ee.warn("Adding an actionable (user controllable) child to a Button ("+i+") is not supported; use a ClickableComponent instead."),xt.prototype.addChild.call(this,e,t)},i.enable=function(){t.prototype.enable.call(this),this.el_.removeAttribute("disabled")},i.disable=function(){t.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},i.handleKeyPress=function(e){32!==e.which&&13!==e.which&&t.prototype.handleKeyPress.call(this,e)},e}(ln);xt.registerComponent("Button",gn);var vn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).mouseused_=!1,i.on("mousedown",i.handleMouseDown),i}z(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-big-play-button"},t.handleClick=function(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY)fi(t);else{var i=this.player_.getChild("controlBar"),n=i&&i.getChild("playToggle");if(n){var r=function(){return n.focus()};di(t)?t.then(r,function(){}):this.setTimeout(r,1)}else this.player_.focus()}},t.handleKeyPress=function(e){this.mouseused_=!1,n.prototype.handleKeyPress.call(this,e)},t.handleMouseDown=function(){this.mouseused_=!0},e}(gn);vn.prototype.controlText_="Play Video",xt.registerComponent("BigPlayButton",vn);var yn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).controlText(t&&t.controlText||i.localize("Close")),i}z(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-close-button "+n.prototype.buildCSSClass.call(this)},t.handleClick=function(){this.trigger({type:"close",bubbles:!1})},e}(gn);xt.registerComponent("CloseButton",yn);var bn=function(n){function e(e,t){var i;return void 0===t&&(t={}),i=n.call(this,e,t)||this,t.replay=void 0===t.replay||t.replay,i.on(e,"play",i.handlePlay),i.on(e,"pause",i.handlePause),t.replay&&i.on(e,"ended",i.handleEnded),i}z(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-play-control "+n.prototype.buildCSSClass.call(this)},t.handleClick=function(){this.player_.paused()?this.player_.play():this.player_.pause()},t.handleSeeked=function(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)},t.handlePlay=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},t.handlePause=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},t.handleEnded=function(){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},e}(gn);bn.prototype.controlText_="Play",xt.registerComponent("PlayToggle",bn);function _n(e,t){e=e<0?0:e;var i=Math.floor(e%60),n=Math.floor(e/60%60),r=Math.floor(e/3600),a=Math.floor(t/60%60),s=Math.floor(t/3600);return!isNaN(e)&&e!==1/0||(r=n=i="-"),(r=0<r||0<s?r+":":"")+(n=((r||10<=a)&&n<10?"0"+n:n)+":")+(i=i<10?"0"+i:i)}var Tn=_n;function Sn(e,t){return void 0===t&&(t=e),Tn(e,t)}var En=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).throttledUpdateContent=dt(ht($($(i)),i.updateContent),25),i.on(e,"timeupdate",i.throttledUpdateContent),i}z(e,n);var t=e.prototype;return t.createEl=function(){var e=this.buildCSSClass(),t=n.prototype.createEl.call(this,"div",{className:e+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text" role="presentation">'+this.localize(this.labelText_)+" </span>"});return this.contentEl_=ge("span",{className:e+"-display"},{"aria-live":"off",role:"presentation"}),this.updateTextNode_(),t.appendChild(this.contentEl_),t},t.dispose=function(){this.contentEl_=null,this.textNode_=null,n.prototype.dispose.call(this)},t.updateTextNode_=function(){if(this.contentEl_){for(;this.contentEl_.firstChild;)this.contentEl_.removeChild(this.contentEl_.firstChild);this.textNode_=M.createTextNode(this.formattedTime_||this.formatTime_(0)),this.contentEl_.appendChild(this.textNode_)}},t.formatTime_=function(e){return Sn(e)},t.updateFormattedTime_=function(e){var t=this.formatTime_(e);t!==this.formattedTime_&&(this.formattedTime_=t,this.requestAnimationFrame(this.updateTextNode_))},t.updateContent=function(){},e}(xt);En.prototype.labelText_="Time",En.prototype.controlText_="Time",xt.registerComponent("TimeDisplay",En);var wn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).on(e,"ended",i.handleEnded),i}z(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-current-time"},t.updateContent=function(){var e=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateFormattedTime_(e)},t.handleEnded=function(){this.player_.duration()&&this.updateFormattedTime_(this.player_.duration())},e}(En);wn.prototype.labelText_="Current Time",wn.prototype.controlText_="Current Time",xt.registerComponent("CurrentTimeDisplay",wn);var Cn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).on(e,"durationchange",i.updateContent),i.on(e,"loadstart",i.updateContent),i.on(e,"loadedmetadata",i.throttledUpdateContent),i}z(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-duration"},t.updateContent=function(){var e=this.player_.duration();this.duration_!==e&&(this.duration_=e,this.updateFormattedTime_(e))},e}(En);Cn.prototype.labelText_="Duration",Cn.prototype.controlText_="Duration",xt.registerComponent("DurationDisplay",Cn);var kn=function(e){function t(){return e.apply(this,arguments)||this}return z(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"},{"aria-hidden":!0})},t}(xt);xt.registerComponent("TimeDivider",kn);var An=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).on(e,"durationchange",i.throttledUpdateContent),i.on(e,"ended",i.handleEnded),i}z(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-remaining-time"},t.formatTime_=function(e){return"-"+n.prototype.formatTime_.call(this,e)},t.updateContent=function(){this.player_.duration()&&(this.player_.remainingTimeDisplay?this.updateFormattedTime_(this.player_.remainingTimeDisplay()):this.updateFormattedTime_(this.player_.remainingTime()))},t.handleEnded=function(){this.player_.duration()&&this.updateFormattedTime_(0)},e}(En);An.prototype.labelText_="Remaining Time",An.prototype.controlText_="Remaining Time",xt.registerComponent("RemainingTimeDisplay",An);var In=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).updateShowing(),i.on(i.player(),"durationchange",i.updateShowing),i}z(e,n);var t=e.prototype;return t.createEl=function(){var e=n.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=ge("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+" </span>"+this.localize("LIVE")},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},t.dispose=function(){this.contentEl_=null,n.prototype.dispose.call(this)},t.updateShowing=function(){this.player().duration()===1/0?this.show():this.hide()},e}(xt);xt.registerComponent("LiveDisplay",In);var xn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).updateLiveEdgeStatus(),i.player_.liveTracker&&i.on(i.player_.liveTracker,"liveedgechange",i.updateLiveEdgeStatus),i}z(e,n);var t=e.prototype;return t.createEl=function(){var e=n.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=ge("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e},t.updateLiveEdgeStatus=function(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},t.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},t.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus),this.textEl_=null,n.prototype.dispose.call(this)},e}(gn);xn.prototype.controlText_="Seek to live, currently playing live",xt.registerComponent("SeekToLive",xn);var Pn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).bar=i.getChild(i.options_.barName),i.vertical(!!i.options_.vertical),i.enable(),i}z(e,n);var t=e.prototype;return t.enabled=function(){return this.enabled_},t.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},t.disable=function(){if(this.enabled()){var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("focus",this.handleFocus),this.off("blur",this.handleBlur),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},t.createEl=function(e,t,i){return void 0===t&&(t={}),void 0===i&&(i={}),t.className=t.className+" vjs-slider",t=ae({tabIndex:0},t),i=ae({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},i),n.prototype.createEl.call(this,e,t,i)},t.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;"mousedown"===e.type&&e.preventDefault(),"touchstart"!==e.type||zt||e.preventDefault(),Ie(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchmove",this.handleMouseMove),this.on(t,"touchend",this.handleMouseUp),this.handleMouseMove(e)},t.handleMouseMove=function(){},t.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;xe(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.update()},t.update=function(){if(this.el_){var e=this.getPercent(),t=this.bar;if(t){("number"!=typeof e||e!=e||e<0||e===1/0)&&(e=0);var i=(100*e).toFixed(2)+"%",n=t.el().style;return this.vertical()?n.height=i:n.width=i,e}}},t.calculateDistance=function(e){var t=Re(this.el_,e);return this.vertical()?t.y:t.x},t.handleFocus=function(){this.on(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},t.handleKeyPress=function(e){37===e.which||40===e.which?(e.preventDefault(),this.stepBack()):38!==e.which&&39!==e.which||(e.preventDefault(),this.stepForward())},t.handleBlur=function(){this.off(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},t.handleClick=function(e){e.stopImmediatePropagation(),e.preventDefault()},t.vertical=function(e){if(void 0===e)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},e}(xt);xt.registerComponent("Slider",Pn);var Ln=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).partEls_=[],i.on(e,"progress",i.update),i}z(e,n);var t=e.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+'</span>: <span class="vjs-control-text-loaded-percentage">0%</span></span>'})},t.dispose=function(){this.partEls_=null,n.prototype.dispose.call(this)},t.update=function(){function e(e,t,i){var n=e/t||0;return n=100*(1<=n?1:n),i&&(n=n.toFixed(2)),n+"%"}var t=this.player_.liveTracker,i=this.player_.buffered(),n=t&&t.isLive()?t.seekableEnd():this.player_.duration(),r=this.player_.bufferedEnd(),a=this.partEls_,s=this.$(".vjs-control-text-loaded-percentage");this.el_.style.width=e(r,n),ve(s,e(r,n,!0));for(var o=0;o<i.length;o++){var l=i.start(o),u=i.end(o),c=a[o];c||(c=this.el_.appendChild(ge()),a[o]=c),c.style.left=e(l,r),c.style.width=e(u-l,r)}for(var h=a.length;h>i.length;h--)this.el_.removeChild(a[h-1]);a.length=i.length},e}(xt);xt.registerComponent("LoadProgressBar",Ln);var Rn=function(e){function t(){return e.apply(this,arguments)||this}z(t,e);var i=t.prototype;return i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},i.update=function(e,t,i){var n=Pe(this.el_),r=Pe(this.player_.el()),a=e.width*t;if(r&&n){var s=e.left-r.left+a,o=e.width-a+(r.right-e.right),l=n.width/2;s<l?l+=l-s:o<l&&(l=o),l<0?l=0:l>n.width&&(l=n.width),this.el_.style.right="-"+l+"px",ve(this.el_,i)}},i.updateTime=function(r,a,s,o){var l=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var e,t=l.player_.duration();if(l.player_.liveTracker&&l.player_.liveTracker.isLive()){var i=l.player_.liveTracker.liveWindow(),n=i-a*i;e=(n<1?"":"-")+Sn(n,i)}else e=Sn(s,t);l.update(r,a,e),o&&o()})},t}(xt);xt.registerComponent("TimeTooltip",Rn);var On=function(e){function t(){return e.apply(this,arguments)||this}z(t,e);var i=t.prototype;return i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},i.update=function(e,t){var i=this.getChild("timeTooltip");if(i){var n=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();i.updateTime(e,t,n)}},t}(xt);On.prototype.options_={children:[]},jt||Gt||On.prototype.options_.children.push("timeTooltip"),xt.registerComponent("PlayProgressBar",On);var Dn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).update=dt(ht($($(i)),i.update),25),i}z(e,n);var t=e.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},t.update=function(e,t){var i=this,n=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,n,function(){i.el_.style.left=e.width*t+"px"})},e}(xt);Dn.prototype.options_={children:["timeTooltip"]},xt.registerComponent("MouseTimeDisplay",Dn);var Nn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).setEventHandlers_(),i}z(e,n);var t=e.prototype;return t.setEventHandlers_=function(){var t=this;this.update=dt(ht(this,this.update),30),this.on(this.player_,"timeupdate",this.update),this.on(this.player_,"ended",this.handleEnded),this.on(this.player_,"durationchange",this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.on(this.player_,["playing"],function(){t.clearInterval(t.updateInterval),t.updateInterval=t.setInterval(function(){t.requestAnimationFrame(function(){t.update()})},30)}),this.on(this.player_,["ended","pause","waiting"],function(e){t.player_.liveTracker&&t.player_.liveTracker.isLive()&&"ended"!==e.type||t.clearInterval(t.updateInterval)}),this.on(this.player_,["timeupdate","ended"],this.update)},t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},t.update_=function(e,t){var i=this.player_.liveTracker,n=this.player_.duration();i&&i.isLive()&&(n=this.player_.liveTracker.liveCurrentTime()),i&&i.seekableEnd()===1/0?this.disable():this.enable(),this.el_.setAttribute("aria-valuenow",(100*t).toFixed(2)),this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[Sn(e,n),Sn(n,n)],"{1} of {2}")),this.bar.update(Pe(this.el_),t)},t.update=function(){var e=n.prototype.update.call(this);return this.update_(this.getCurrentTime_(),e),e},t.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},t.handleEnded=function(){this.update_(this.player_.duration(),1)},t.getPercent=function(){var e,t=this.getCurrentTime_(),i=this.player_.liveTracker;return i&&i.isLive()?(e=(t-i.seekableStart())/i.liveWindow(),i.atLiveEdge()&&(e=1)):e=t/this.player_.duration(),1<=e?1:e||0},t.handleMouseDown=function(e){Ue(e)&&(e.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),n.prototype.handleMouseDown.call(this,e))},t.handleMouseMove=function(e){if(Ue(e)){var t,i=this.calculateDistance(e),n=this.player_.liveTracker;if(n&&n.isLive()){var r=n.seekableStart(),a=n.liveCurrentTime();if(a<=(t=r+i*n.liveWindow())&&(t=a),t<=r&&(t=r+.1),t===1/0)return}else(t=i*this.player_.duration())===this.player_.duration()&&(t-=.1);this.player_.currentTime(t)}},t.enable=function(){n.prototype.enable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.show()},t.disable=function(){n.prototype.disable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.hide()},t.handleMouseUp=function(e){n.prototype.handleMouseUp.call(this,e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying&&fi(this.player_.play())},t.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},t.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},t.handleAction=function(){this.player_.paused()?this.player_.play():this.player_.pause()},t.handleKeyPress=function(e){32===e.which||13===e.which?(e.preventDefault(),this.handleAction(e)):n.prototype.handleKeyPress&&n.prototype.handleKeyPress.call(this,e)},e}(Pn);Nn.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},jt||Gt||Nn.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),Nn.prototype.playerEvent="timeupdate",xt.registerComponent("SeekBar",Nn);var Mn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).handleMouseMove=dt(ht($($(i)),i.handleMouseMove),25),i.throttledHandleMouseSeek=dt(ht($($(i)),i.handleMouseSeek),25),i.enable(),i}z(e,n);var t=e.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},t.handleMouseMove=function(e){var t=this.getChild("seekBar");if(t){var i=t.getChild("mouseTimeDisplay"),n=t.el(),r=Pe(n),a=Re(n,e).x;1<a?a=1:a<0&&(a=0),i&&i.update(r,a)}},t.handleMouseSeek=function(e){var t=this.getChild("seekBar");t&&t.handleMouseMove(e)},t.enabled=function(){return this.enabled_},t.disable=function(){this.children().forEach(function(e){return e.disable&&e.disable()}),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},t.enable=function(){this.children().forEach(function(e){return e.enable&&e.enable()}),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},t.handleMouseDown=function(e){var t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},t.handleMouseUp=function(e){var t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseUp(e),this.off(t,"mousemove",this.throttledHandleMouseSeek),this.off(t,"touchmove",this.throttledHandleMouseSeek),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},e}(xt);Mn.prototype.options_={children:["seekBar"]},xt.registerComponent("ProgressControl",Mn);var Bn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).on(e,"fullscreenchange",i.handleFullscreenChange),!1===M[ai.fullscreenEnabled]&&i.disable(),i}z(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-fullscreen-control "+n.prototype.buildCSSClass.call(this)},t.handleFullscreenChange=function(){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},t.handleClick=function(){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},e}(gn);Bn.prototype.controlText_="Fullscreen",xt.registerComponent("FullscreenToggle",Bn);var Un=function(e){function t(){return e.apply(this,arguments)||this}return z(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},t}(xt);xt.registerComponent("VolumeLevel",Un);var Fn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).on("slideractive",i.updateLastVolume_),i.on(e,"volumechange",i.updateARIAAttributes),e.ready(function(){return i.updateARIAAttributes()}),i}z(e,n);var t=e.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},t.handleMouseDown=function(e){Ue(e)&&n.prototype.handleMouseDown.call(this,e)},t.handleMouseMove=function(e){Ue(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))},t.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},t.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},t.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},t.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},t.updateARIAAttributes=function(){var e=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",e),this.el_.setAttribute("aria-valuetext",e+"%")},t.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},t.updateLastVolume_=function(){var e=this,t=this.player_.volume();this.one("sliderinactive",function(){0===e.player_.volume()&&e.player_.lastVolume_(t)})},e}(Pn);Fn.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},Fn.prototype.playerEvent="volumechange",xt.registerComponent("VolumeBar",Fn);var jn=function(a){function e(e,t){var i,n,r;return void 0===t&&(t={}),t.vertical=t.vertical||!1,void 0!==t.volumeBar&&!oe(t.volumeBar)||(t.volumeBar=t.volumeBar||{},t.volumeBar.vertical=t.vertical),i=a.call(this,e,t)||this,n=$($(i)),(r=e).tech_&&!r.tech_.featuresVolumeControl&&n.addClass("vjs-hidden"),n.on(r,"loadstart",function(){r.tech_.featuresVolumeControl?n.removeClass("vjs-hidden"):n.addClass("vjs-hidden")}),i.throttledHandleMouseMove=dt(ht($($(i)),i.handleMouseMove),25),i.on("mousedown",i.handleMouseDown),i.on("touchstart",i.handleMouseDown),i.on(i.volumeBar,["focus","slideractive"],function(){i.volumeBar.addClass("vjs-slider-active"),i.addClass("vjs-slider-active"),i.trigger("slideractive")}),i.on(i.volumeBar,["blur","sliderinactive"],function(){i.volumeBar.removeClass("vjs-slider-active"),i.removeClass("vjs-slider-active"),i.trigger("sliderinactive")}),i}z(e,a);var t=e.prototype;return t.createEl=function(){var e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),a.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+e})},t.handleMouseDown=function(){var e=this.el_.ownerDocument;this.on(e,"mousemove",this.throttledHandleMouseMove),this.on(e,"touchmove",this.throttledHandleMouseMove),this.on(e,"mouseup",this.handleMouseUp),this.on(e,"touchend",this.handleMouseUp)},t.handleMouseUp=function(){var e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseMove),this.off(e,"touchmove",this.throttledHandleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchend",this.handleMouseUp)},t.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)},e}(xt);jn.prototype.options_={children:["volumeBar"]},xt.registerComponent("VolumeControl",jn);var Hn=function(a){function e(e,t){var i,n,r;return i=a.call(this,e,t)||this,n=$($(i)),(r=e).tech_&&!r.tech_.featuresMuteControl&&n.addClass("vjs-hidden"),n.on(r,"loadstart",function(){r.tech_.featuresMuteControl?n.removeClass("vjs-hidden"):n.addClass("vjs-hidden")}),i.on(e,["loadstart","volumechange"],i.update),i}z(e,a);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-mute-control "+a.prototype.buildCSSClass.call(this)},t.handleClick=function(){var e=this.player_.volume(),t=this.player_.lastVolume_();if(0===e){var i=t<.1?.1:t;this.player_.volume(i),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},t.update=function(){this.updateIcon_(),this.updateControlText_()},t.updateIcon_=function(){var e=this.player_.volume(),t=3;jt&&this.player_.muted(this.player_.tech_.el_.muted),0===e||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2);for(var i=0;i<4;i++)Te(this.el_,"vjs-vol-"+i);_e(this.el_,"vjs-vol-"+t)},t.updateControlText_=function(){var e=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)},e}(gn);Hn.prototype.controlText_="Mute",xt.registerComponent("MuteToggle",Hn);var Gn=function(n){function e(e,t){var i;return void 0===t&&(t={}),void 0!==t.inline?t.inline=t.inline:t.inline=!0,void 0!==t.volumeControl&&!oe(t.volumeControl)||(t.volumeControl=t.volumeControl||{},t.volumeControl.vertical=!t.inline),(i=n.call(this,e,t)||this).on(e,["loadstart"],i.volumePanelState_),i.on(i.volumeControl,["slideractive"],i.sliderActive_),i.on(i.volumeControl,["sliderinactive"],i.sliderInactive_),i}z(e,n);var t=e.prototype;return t.sliderActive_=function(){this.addClass("vjs-slider-active")},t.sliderInactive_=function(){this.removeClass("vjs-slider-active")},t.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},t.createEl=function(){var e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),n.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+e})},e}(xt);Gn.prototype.options_={children:["muteToggle","volumeControl"]},xt.registerComponent("VolumePanel",Gn);var Vn=function(n){function e(e,t){var i;return i=n.call(this,e,t)||this,t&&(i.menuButton_=t.menuButton),i.focusedChild_=-1,i.on("keydown",i.handleKeyPress),i}z(e,n);var t=e.prototype;return t.addItem=function(t){this.addChild(t),t.on("blur",ht(this,this.handleBlur)),t.on(["tap","click"],ht(this,function(e){this.menuButton_&&(this.menuButton_.unpressButton(),"CaptionSettingsMenuItem"!==t.name()&&this.menuButton_.focus())}))},t.createEl=function(){var e=this.options_.contentElType||"ul";this.contentEl_=ge(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var t=n.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return t.appendChild(this.contentEl_),et(t,"click",function(e){e.preventDefault(),e.stopImmediatePropagation()}),t},t.dispose=function(){this.contentEl_=null,n.prototype.dispose.call(this)},t.handleBlur=function(e){var t=e.relatedTarget||M.activeElement;if(!this.children().some(function(e){return e.el()===t})){var i=this.menuButton_;i&&i.buttonPressed_&&t!==i.el().firstChild&&i.unpressButton()}},t.handleKeyPress=function(e){37===e.which||40===e.which?(e.preventDefault(),this.stepForward()):38!==e.which&&39!==e.which||(e.preventDefault(),this.stepBack())},t.stepForward=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)},t.stepBack=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)},t.focus=function(e){void 0===e&&(e=0);var t=this.children().slice();t.length&&t[0].className&&/vjs-menu-title/.test(t[0].className)&&t.shift(),0<t.length&&(e<0?e=0:e>=t.length&&(e=t.length-1),t[this.focusedChild_=e].el_.focus())},e}(xt);xt.registerComponent("Menu",Vn);var Kn=function(r){function e(e,t){var i;void 0===t&&(t={}),(i=r.call(this,e,t)||this).menuButton_=new gn(e,t),i.menuButton_.controlText(i.controlText_),i.menuButton_.el_.setAttribute("aria-haspopup","true");var n=gn.prototype.buildCSSClass();return i.menuButton_.el_.className=i.buildCSSClass()+" "+n,i.menuButton_.removeClass("vjs-control"),i.addChild(i.menuButton_),i.update(),i.enabled_=!0,i.on(i.menuButton_,"tap",i.handleClick),i.on(i.menuButton_,"click",i.handleClick),i.on(i.menuButton_,"focus",i.handleFocus),i.on(i.menuButton_,"blur",i.handleBlur),i.on(i.menuButton_,"mouseenter",function(){i.menu.show()}),i.on("keydown",i.handleSubmenuKeyPress),i}z(e,r);var t=e.prototype;return t.update=function(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},t.createMenu=function(){var e=new Vn(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var t=ge("li",{className:"vjs-menu-title",innerHTML:At(this.options_.title),tabIndex:-1});this.hideThreshold_+=1,e.children_.unshift(t),ye(t,e.contentEl())}if(this.items=this.createItems(),this.items)for(var i=0;i<this.items.length;i++)e.addItem(this.items[i]);return e},t.createItems=function(){},t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},t.buildWrapperCSSClass=function(){var e="vjs-menu-button";return!0===this.options_.inline?e+="-inline":e+="-popup","vjs-menu-button "+e+" "+gn.prototype.buildCSSClass()+" "+r.prototype.buildCSSClass.call(this)},t.buildCSSClass=function(){var e="vjs-menu-button";return!0===this.options_.inline?e+="-inline":e+="-popup","vjs-menu-button "+e+" "+r.prototype.buildCSSClass.call(this)},t.controlText=function(e,t){return void 0===t&&(t=this.menuButton_.el()),this.menuButton_.controlText(e,t)},t.handleClick=function(){this.buttonPressed_?this.unpressButton():this.pressButton()},t.focus=function(){this.menuButton_.focus()},t.blur=function(){this.menuButton_.blur()},t.handleFocus=function(){et(M,"keydown",ht(this,this.handleKeyPress))},t.handleBlur=function(){tt(M,"keydown",ht(this,this.handleKeyPress))},t.handleKeyPress=function(e){27===e.which||9===e.which?(this.buttonPressed_&&this.unpressButton(),9!==e.which&&(e.preventDefault(),this.menuButton_.el_.focus())):13!==e.which&&38!==e.which&&40!==e.which||this.buttonPressed_||(this.pressButton(),e.preventDefault())},t.handleSubmenuKeyPress=function(e){27!==e.which&&9!==e.which||(this.buttonPressed_&&this.unpressButton(),9!==e.which&&(e.preventDefault(),this.menuButton_.el_.focus()))},t.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),jt&&pe())return;this.menu.focus()}},t.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},t.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},t.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},e}(xt);xt.registerComponent("MenuButton",Kn);var Wn=function(a){function e(e,t){var i,n=t.tracks;if((i=a.call(this,e,t)||this).items.length<=1&&i.hide(),!n)return $(i);var r=ht($($(i)),i.update);return n.addEventListener("removetrack",r),n.addEventListener("addtrack",r),i.player_.on("ready",r),i.player_.on("dispose",function(){n.removeEventListener("removetrack",r),n.removeEventListener("addtrack",r)}),i}return z(e,a),e}(Kn);xt.registerComponent("TrackButton",Wn);var qn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).selectable=t.selectable,i.isSelected_=t.selected||!1,i.multiSelectable=t.multiSelectable,i.selected(i.isSelected_),i.selectable?i.multiSelectable?i.el_.setAttribute("role","menuitemcheckbox"):i.el_.setAttribute("role","menuitemradio"):i.el_.setAttribute("role","menuitem"),i}z(e,n);var t=e.prototype;return t.createEl=function(e,t,i){return this.nonIconControl=!0,n.prototype.createEl.call(this,"li",ae({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},t),i)},t.handleClick=function(){this.selected(!0)},t.selected=function(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},e}(ln);xt.registerComponent("MenuItem",qn);var zn=function(l){function e(e,t){var n,i=t.track,r=e.textTracks();t.label=i.label||i.language||"Unknown",t.selected="showing"===i.mode,(n=l.call(this,e,t)||this).track=i;function a(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.handleTracksChange.apply($($(n)),t)}function s(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.handleSelectedLanguageChange.apply($($(n)),t)}var o;e.on(["loadstart","texttrackchange"],a),r.addEventListener("change",a),r.addEventListener("selectedlanguagechange",s),n.on("dispose",function(){e.off(["loadstart","texttrackchange"],a),r.removeEventListener("change",a),r.removeEventListener("selectedlanguagechange",s)}),void 0===r.onchange&&n.on(["tap","click"],function(){if("object"!=typeof T.Event)try{o=new T.Event("change")}catch(e){}o||(o=M.createEvent("Event")).initEvent("change",!0,!0),r.dispatchEvent(o)});return n.handleTracksChange(),n}z(e,l);var t=e.prototype;return t.handleClick=function(e){var t=this.track.kind,i=this.track.kinds,n=this.player_.textTracks();if(i=i||[t],l.prototype.handleClick.call(this,e),n)for(var r=0;r<n.length;r++){var a=n[r];a===this.track&&-1<i.indexOf(a.kind)?"showing"!==a.mode&&(a.mode="showing"):"disabled"!==a.mode&&(a.mode="disabled")}},t.handleTracksChange=function(){var e="showing"===this.track.mode;e!==this.isSelected_&&this.selected(e)},t.handleSelectedLanguageChange=function(){if("showing"===this.track.mode){var e=this.player_.cache_.selectedLanguage;if(e&&e.enabled&&e.language===this.track.language&&e.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},t.dispose=function(){this.track=null,l.prototype.dispose.call(this)},e}(qn);xt.registerComponent("TextTrackMenuItem",zn);var Yn=function(i){function e(e,t){return t.track={player:e,kind:t.kind,kinds:t.kinds,default:!1,mode:"disabled"},t.kinds||(t.kinds=[t.kind]),t.label?t.track.label=t.label:t.track.label=t.kinds.join(" and ")+" off",t.selectable=!0,t.multiSelectable=!1,i.call(this,e,t)||this}z(e,i);var t=e.prototype;return t.handleTracksChange=function(){for(var e=this.player().textTracks(),t=!0,i=0,n=e.length;i<n;i++){var r=e[i];if(-1<this.options_.kinds.indexOf(r.kind)&&"showing"===r.mode){t=!1;break}}t!==this.isSelected_&&this.selected(t)},t.handleSelectedLanguageChange=function(){for(var e=this.player().textTracks(),t=!0,i=0,n=e.length;i<n;i++){var r=e[i];if(-1<["captions","descriptions","subtitles"].indexOf(r.kind)&&"showing"===r.mode){t=!1;break}}t&&(this.player_.cache_.selectedLanguage={enabled:!1})},e}(zn);xt.registerComponent("OffTextTrackMenuItem",Yn);var Xn=function(i){function e(e,t){return void 0===t&&(t={}),t.tracks=e.textTracks(),i.call(this,e,t)||this}return z(e,i),e.prototype.createItems=function(e,t){var i;void 0===e&&(e=[]),void 0===t&&(t=zn),this.label_&&(i=this.label_+" off"),e.push(new Yn(this.player_,{kinds:this.kinds_,kind:this.kind_,label:i})),this.hideThreshold_+=1;var n=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var r=0;r<n.length;r++){var a=n[r];if(-1<this.kinds_.indexOf(a.kind)){var s=new t(this.player_,{track:a,selectable:!0,multiSelectable:!1});s.addClass("vjs-"+a.kind+"-menu-item"),e.push(s)}}return e},e}(Wn);xt.registerComponent("TextTrackButton",Xn);var $n=function(s){function e(e,t){var i,n=t.track,r=t.cue,a=e.currentTime();return t.selectable=!0,t.multiSelectable=!1,t.label=r.text,t.selected=r.startTime<=a&&a<r.endTime,(i=s.call(this,e,t)||this).track=n,i.cue=r,n.addEventListener("cuechange",ht($($(i)),i.update)),i}z(e,s);var t=e.prototype;return t.handleClick=function(){s.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},t.update=function(){var e=this.cue,t=this.player_.currentTime();this.selected(e.startTime<=t&&t<e.endTime)},e}(qn);xt.registerComponent("ChaptersTrackMenuItem",$n);var Jn=function(n){function e(e,t,i){return n.call(this,e,t,i)||this}z(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-chapters-button "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-chapters-button "+n.prototype.buildWrapperCSSClass.call(this)},t.update=function(e){this.track_&&(!e||"addtrack"!==e.type&&"removetrack"!==e.type)||this.setTrack(this.findChaptersTrack()),n.prototype.update.call(this)},t.setTrack=function(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";var i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.addEventListener("load",this.updateHandler_)}}},t.findChaptersTrack=function(){for(var e=this.player_.textTracks()||[],t=e.length-1;0<=t;t--){var i=e[t];if(i.kind===this.kind_)return i}},t.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(At(this.kind_))},t.createMenu=function(){return this.options_.title=this.getMenuCaption(),n.prototype.createMenu.call(this)},t.createItems=function(){var e=[];if(!this.track_)return e;var t=this.track_.cues;if(!t)return e;for(var i=0,n=t.length;i<n;i++){var r=t[i],a=new $n(this.player_,{track:this.track_,cue:r});e.push(a)}return e},e}(Xn);Jn.prototype.kind_="chapters",Jn.prototype.controlText_="Chapters",xt.registerComponent("ChaptersButton",Jn);var Qn=function(s){function e(e,t,i){var n;n=s.call(this,e,t,i)||this;var r=e.textTracks(),a=ht($($(n)),n.handleTracksChange);return r.addEventListener("change",a),n.on("dispose",function(){r.removeEventListener("change",a)}),n}z(e,s);var t=e.prototype;return t.handleTracksChange=function(){for(var e=this.player().textTracks(),t=!1,i=0,n=e.length;i<n;i++){var r=e[i];if(r.kind!==this.kind_&&"showing"===r.mode){t=!0;break}}t?this.disable():this.enable()},t.buildCSSClass=function(){return"vjs-descriptions-button "+s.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+s.prototype.buildWrapperCSSClass.call(this)},e}(Xn);Qn.prototype.kind_="descriptions",Qn.prototype.controlText_="Descriptions",xt.registerComponent("DescriptionsButton",Qn);var Zn=function(n){function e(e,t,i){return n.call(this,e,t,i)||this}z(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-subtitles-button "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+n.prototype.buildWrapperCSSClass.call(this)},e}(Xn);Zn.prototype.kind_="subtitles",Zn.prototype.controlText_="Subtitles",xt.registerComponent("SubtitlesButton",Zn);var er=function(n){function e(e,t){var i;return t.track={player:e,kind:t.kind,label:t.kind+" settings",selectable:!1,default:!1,mode:"disabled"},t.selectable=!1,t.name="CaptionSettingsMenuItem",(i=n.call(this,e,t)||this).addClass("vjs-texttrack-settings"),i.controlText(", opens "+t.kind+" settings dialog"),i}return z(e,n),e.prototype.handleClick=function(){this.player().getChild("textTrackSettings").open()},e}(zn);xt.registerComponent("CaptionSettingsMenuItem",er);var tr=function(n){function e(e,t,i){return n.call(this,e,t,i)||this}z(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-captions-button "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-captions-button "+n.prototype.buildWrapperCSSClass.call(this)},t.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new er(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),n.prototype.createItems.call(this,e)},e}(Xn);tr.prototype.kind_="captions",tr.prototype.controlText_="Captions",xt.registerComponent("CaptionsButton",tr);var ir=function(r){function e(){return r.apply(this,arguments)||this}return z(e,r),e.prototype.createEl=function(e,t,i){var n='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"captions"===this.options_.track.kind&&(n+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "),n+="</span>",r.prototype.createEl.call(this,e,ae({innerHTML:n},t),i)},e}(zn);xt.registerComponent("SubsCapsMenuItem",ir);var nr=function(n){function e(e,t){var i;return void 0===t&&(t={}),(i=n.call(this,e,t)||this).label_="subtitles",-1<["en","en-us","en-ca","fr-ca"].indexOf(i.player_.language_)&&(i.label_="captions"),i.menuButton_.controlText(At(i.label_)),i}z(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-subs-caps-button "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+n.prototype.buildWrapperCSSClass.call(this)},t.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new er(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=n.prototype.createItems.call(this,e,ir)},e}(Xn);nr.prototype.kinds_=["captions","subtitles"],nr.prototype.controlText_="Subtitles",xt.registerComponent("SubsCapsButton",nr);var rr=function(s){function e(e,t){var n,i=t.track,r=e.audioTracks();t.label=i.label||i.language||"Unknown",t.selected=i.enabled,(n=s.call(this,e,t)||this).track=i,n.addClass("vjs-"+i.kind+"-menu-item");function a(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.handleTracksChange.apply($($(n)),t)}return r.addEventListener("change",a),n.on("dispose",function(){r.removeEventListener("change",a)}),n}z(e,s);var t=e.prototype;return t.createEl=function(e,t,i){var n='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"main-desc"===this.options_.track.kind&&(n+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "),n+="</span>",s.prototype.createEl.call(this,e,ae({innerHTML:n},t),i)},t.handleClick=function(e){var t=this.player_.audioTracks();s.prototype.handleClick.call(this,e);for(var i=0;i<t.length;i++){var n=t[i];n.enabled=n===this.track}},t.handleTracksChange=function(){this.selected(this.track.enabled)},e}(qn);xt.registerComponent("AudioTrackMenuItem",rr);var ar=function(i){function e(e,t){return void 0===t&&(t={}),t.tracks=e.audioTracks(),i.call(this,e,t)||this}z(e,i);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-audio-button "+i.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-audio-button "+i.prototype.buildWrapperCSSClass.call(this)},t.createItems=function(e){void 0===e&&(e=[]),this.hideThreshold_=1;for(var t=this.player_.audioTracks(),i=0;i<t.length;i++){var n=t[i];e.push(new rr(this.player_,{track:n,selectable:!0,multiSelectable:!1}))}return e},e}(Wn);ar.prototype.controlText_="Audio Track",xt.registerComponent("AudioTrackButton",ar);var sr=function(a){function e(e,t){var i,n=t.rate,r=parseFloat(n,10);return t.label=n,t.selected=1===r,t.selectable=!0,t.multiSelectable=!1,(i=a.call(this,e,t)||this).label=n,i.rate=r,i.on(e,"ratechange",i.update),i}z(e,a);var t=e.prototype;return t.handleClick=function(){a.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},t.update=function(){this.selected(this.player().playbackRate()===this.rate)},e}(qn);sr.prototype.contentElType="button",xt.registerComponent("PlaybackRateMenuItem",sr);var or=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).updateVisibility(),i.updateLabel(),i.on(e,"loadstart",i.updateVisibility),i.on(e,"ratechange",i.updateLabel),i}z(e,n);var t=e.prototype;return t.createEl=function(){var e=n.prototype.createEl.call(this);return this.labelEl_=ge("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),e.appendChild(this.labelEl_),e},t.dispose=function(){this.labelEl_=null,n.prototype.dispose.call(this)},t.buildCSSClass=function(){return"vjs-playback-rate "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-playback-rate "+n.prototype.buildWrapperCSSClass.call(this)},t.createMenu=function(){var e=new Vn(this.player()),t=this.playbackRates();if(t)for(var i=t.length-1;0<=i;i--)e.addChild(new sr(this.player(),{rate:t[i]+"x"}));return e},t.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},t.handleClick=function(){for(var e=this.player().playbackRate(),t=this.playbackRates(),i=t[0],n=0;n<t.length;n++)if(t[n]>e){i=t[n];break}this.player().playbackRate(i)},t.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},t.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&0<this.playbackRates().length},t.updateVisibility=function(){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},t.updateLabel=function(){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},e}(Kn);or.prototype.controlText_="Playback Rate",xt.registerComponent("PlaybackRateMenuButton",or);var lr=function(e){function t(){return e.apply(this,arguments)||this}z(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)},i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t}(xt);xt.registerComponent("Spacer",lr);var ur=function(t){function e(){return t.apply(this,arguments)||this}z(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-custom-control-spacer "+t.prototype.buildCSSClass.call(this)},i.createEl=function(){var e=t.prototype.createEl.call(this,{className:this.buildCSSClass()});return e.innerHTML=" ",e},e}(lr);xt.registerComponent("CustomControlSpacer",ur);var cr=function(e){function t(){return e.apply(this,arguments)||this}return z(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},t}(xt);cr.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},xt.registerComponent("ControlBar",cr);var hr=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).on(e,"error",i.open),i}z(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-error-display "+n.prototype.buildCSSClass.call(this)},t.content=function(){var e=this.player().error();return e?this.localize(e.message):""},e}(yi);hr.prototype.options_=It(yi.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),xt.registerComponent("ErrorDisplay",hr);var dr="vjs-text-track-settings",fr=["#000","Black"],pr=["#00F","Blue"],mr=["#0FF","Cyan"],gr=["#0F0","Green"],vr=["#F0F","Magenta"],yr=["#F00","Red"],br=["#FFF","White"],_r=["#FF0","Yellow"],Tr=["1","Opaque"],Sr=["0.5","Semi-Transparent"],Er=["0","Transparent"],wr={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[fr,br,yr,gr,pr,_r,vr,mr]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[Tr,Sr,Er]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[br,fr,yr,gr,pr,_r,vr,mr]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Tr,Sr]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Er,Sr,Tr]}};function Cr(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}wr.windowColor.options=wr.backgroundColor.options;var kr=function(n){function e(e,t){var i;return t.temporary=!1,(i=n.call(this,e,t)||this).updateDisplay=ht($($(i)),i.updateDisplay),i.fill(),i.hasBeenOpened_=i.hasBeenFilled_=!0,i.endDialog=ge("p",{className:"vjs-control-text",textContent:i.localize("End of dialog window.")}),i.el().appendChild(i.endDialog),i.setDefaults(),void 0===t.persistTextTrackSettings&&(i.options_.persistTextTrackSettings=i.options_.playerOptions.persistTextTrackSettings),i.on(i.$(".vjs-done-button"),"click",function(){i.saveSettings(),i.close()}),i.on(i.$(".vjs-default-button"),"click",function(){i.setDefaults(),i.updateDisplay()}),re(wr,function(e){i.on(i.$(e.selector),"change",i.updateDisplay)}),i.options_.persistTextTrackSettings&&i.restoreSettings(),i}z(e,n);var t=e.prototype;return t.dispose=function(){this.endDialog=null,n.prototype.dispose.call(this)},t.createElSelect_=function(e,t,i){var n=this;void 0===t&&(t=""),void 0===i&&(i="label");var r=wr[e],a=r.id.replace("%s",this.id_),s=[t,a].join(" ").trim();return["<"+i+' id="'+a+'" class="'+("label"===i?"vjs-label":"")+'">',this.localize(r.label),"</"+i+">",'<select aria-labelledby="'+s+'">'].concat(r.options.map(function(e){var t=a+"-"+e[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+s+" "+t+'">',n.localize(e[1]),"</option>"].join("")})).concat("</select>").join("")},t.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},t.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},t.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},t.createElColors_=function(){return ge("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},t.createElFont_=function(){return ge("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},t.createElControls_=function(){var e=this.localize("restore all settings to the default values");return ge("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},t.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},t.label=function(){return this.localize("Caption Settings Dialog")},t.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},t.buildCSSClass=function(){return n.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},t.getValues=function(){var i,n,e,s=this;return n=function(e,t,i){var n,r,a=(n=s.$(t.selector),r=t.parser,Cr(n.options[n.options.selectedIndex].value,r));return void 0!==a&&(e[i]=a),e},void 0===(e={})&&(e=0),ne(i=wr).reduce(function(e,t){return n(e,i[t],t)},e)},t.setValues=function(i){var n=this;re(wr,function(e,t){!function(e,t,i){if(t)for(var n=0;n<e.options.length;n++)if(Cr(e.options[n].value,i)===t){e.selectedIndex=n;break}}(n.$(e.selector),i[t],e.parser)})},t.setDefaults=function(){var i=this;re(wr,function(e){var t=e.hasOwnProperty("default")?e.default:0;i.$(e.selector).selectedIndex=t})},t.restoreSettings=function(){var e;try{e=JSON.parse(T.localStorage.getItem(dr))}catch(e){ee.warn(e)}e&&this.setValues(e)},t.saveSettings=function(){if(this.options_.persistTextTrackSettings){var e=this.getValues();try{Object.keys(e).length?T.localStorage.setItem(dr,JSON.stringify(e)):T.localStorage.removeItem(dr)}catch(e){ee.warn(e)}}},t.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},t.conditionalBlur_=function(){this.previouslyActiveEl_=null,this.off(M,"keydown",this.handleKeyDown);var e=this.player_.controlBar,t=e&&e.subsCapsButton,i=e&&e.captionsButton;t?t.focus():i&&i.focus()},e}(yi);xt.registerComponent("TextTrackSettings",kr);var Ar=function(a){function e(e,t){var i,n=t.ResizeObserver||T.ResizeObserver;null===t.ResizeObserver&&(n=!1);var r=It({createEl:!n,reportTouchActivity:!1},t);return(i=a.call(this,e,r)||this).ResizeObserver=t.ResizeObserver||T.ResizeObserver,i.loadListener_=null,i.resizeObserver_=null,i.debouncedHandler_=ft(function(){i.resizeHandler()},100,!1,$($(i))),n?(i.resizeObserver_=new i.ResizeObserver(i.debouncedHandler_),i.resizeObserver_.observe(e.el())):(i.loadListener_=function(){i.el_&&i.el_.contentWindow&&et(i.el_.contentWindow,"resize",i.debouncedHandler_)},i.one("load",i.loadListener_)),i}z(e,a);var t=e.prototype;return t.createEl=function(){return a.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager"})},t.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},t.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.el_&&this.el_.contentWindow&&tt(this.el_.contentWindow,"resize",this.debouncedHandler_),this.loadListener_&&this.off("load",this.loadListener_),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null},e}(xt);xt.registerComponent("ResizeManager",Ar);var Ir=function(r){function e(e,t){var i,n=It({createEl:!1},t);return(i=r.call(this,e,n)||this).reset_(),i.on(i.player_,"durationchange",i.handleDurationchange),i}z(e,r);var t=e.prototype;return t.isBehind_=function(){if(!this.timeupdateSeen_)return!1;var e=this.liveCurrentTime(),t=this.player_.currentTime(),i=this.seekableIncrement_;return e!==1/0&&t<=e-(2*i+.07)},t.trackLive_=function(){this.pastSeekEnd_=this.pastSeekEnd_;var e=this.player_.seekable();if(e&&e.length){var t=this.seekableEnd();t!==this.lastSeekEnd_&&(this.lastSeekEnd_&&(this.seekableIncrement_=Math.abs(t-this.lastSeekEnd_)),this.pastSeekEnd_=0,this.lastSeekEnd_=t,this.trigger("seekableendchange")),this.pastSeekEnd_=this.pastSeekEnd()+.03,this.isBehind_()!==this.behindLiveEdge()&&(this.behindLiveEdge_=this.isBehind_(),this.trigger("liveedgechange"))}},t.handleDurationchange=function(){this.player_.duration()===1/0?this.startTracking():this.stopTracking()},t.startTracking=function(){var e=this;this.isTracking()||(this.trackingInterval_=this.setInterval(this.trackLive_,30),this.trackLive_(),this.on(this.player_,"play",this.trackLive_),this.on(this.player_,"pause",this.trackLive_),this.one(this.player_,"play",this.handlePlay),this.timeupdateSeen_||(this.handleTimeupdate=function(){e.timeupdateSeen_=!0,e.handleTimeupdate=null},this.one(this.player_,"timeupdate",this.handleTimeupdate)))},t.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)},t.reset_=function(){this.pastSeekEnd_=0,this.lastSeekEnd_=null,this.behindLiveEdge_=null,this.timeupdateSeen_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.seekableIncrement_=12,this.off(this.player_,"play",this.trackLive_),this.off(this.player_,"pause",this.trackLive_),this.off(this.player_,"play",this.handlePlay),this.off(this.player_,"timeupdate",this.seekToLiveEdge),this.handleTimeupdate&&(this.off(this.player_,"timeupdate",this.handleTimeupdate),this.handleTimeupdate=null)},t.stopTracking=function(){this.isTracking()&&this.reset_()},t.seekableEnd=function(){for(var e=this.player_.seekable(),t=[],i=e?e.length:0;i--;)t.push(e.end(i));return t.length?t.sort()[t.length-1]:1/0},t.seekableStart=function(){for(var e=this.player_.seekable(),t=[],i=e?e.length:0;i--;)t.push(e.start(i));return t.length?t.sort()[0]:0},t.liveWindow=function(){var e=this.liveCurrentTime();return e===1/0?1/0:e-this.seekableStart()},t.isLive=function(){return this.isTracking()},t.atLiveEdge=function(){return!this.behindLiveEdge()},t.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},t.pastSeekEnd=function(){return this.pastSeekEnd_},t.behindLiveEdge=function(){return this.behindLiveEdge_},t.isTracking=function(){return"number"==typeof this.trackingInterval_},t.seekToLiveEdge=function(){this.atLiveEdge()||(this.player_.currentTime(this.liveCurrentTime()),this.player_.paused()&&this.player_.play())},t.dispose=function(){this.stopTracking(),r.prototype.dispose.call(this)},e}(xt);xt.registerComponent("LiveTracker",Ir);function xr(e){var t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),1;var i=e.$$("source"),n=[],r="";if(i.length){for(var a=0;a<i.length;a++){var s=i[a].src;s&&-1===n.indexOf(s)&&n.push(s)}return!!n.length&&(1===n.length&&(r=n[0]),e.triggerSourceset(r),!0)}}function Pr(e,t){for(var i={},n=0;n<e.length&&!((i=Object.getOwnPropertyDescriptor(e[n],t))&&i.set&&i.get);n++);return i.enumerable=!0,i.configurable=!0,i}function Lr(a){var s=a.el();if(!s.resetSourceWatch_){var t={},e=Pr([a.el(),T.HTMLMediaElement.prototype,T.Element.prototype,Or],"innerHTML"),i=function(r){return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=r.apply(s,t);return xr(a),n}};["append","appendChild","insertAdjacentHTML"].forEach(function(e){s[e]&&(t[e]=s[e],s[e]=i(t[e]))}),Object.defineProperty(s,"innerHTML",It(e,{set:i(e.set)})),s.resetSourceWatch_=function(){s.resetSourceWatch_=null,Object.keys(t).forEach(function(e){s[e]=t[e]}),Object.defineProperty(s,"innerHTML",e)},a.one("sourceset",s.resetSourceWatch_)}}function Rr(n){if(n.featuresSourceset){var r=n.el();if(!r.resetSourceset_){var i=Pr([n.el(),T.HTMLMediaElement.prototype,Dr],"src"),a=r.setAttribute,t=r.load;Object.defineProperty(r,"src",It(i,{set:function(e){var t=i.set.call(r,e);return n.triggerSourceset(r.src),t}})),r.setAttribute=function(e,t){var i=a.call(r,e,t);return/src/i.test(e)&&n.triggerSourceset(r.src),i},r.load=function(){var e=t.call(r);return xr(n)||(n.triggerSourceset(""),Lr(n)),e},r.currentSrc?n.triggerSourceset(r.currentSrc):xr(n)||Lr(n),r.resetSourceset_=function(){r.resetSourceset_=null,r.load=t,r.setAttribute=a,Object.defineProperty(r,"src",i),r.resetSourceWatch_&&r.resetSourceWatch_()}}}}var Or=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(e){var t=M.createElement(this.nodeName.toLowerCase());t.innerHTML=e;for(var i=M.createDocumentFragment();t.childNodes.length;)i.appendChild(t.childNodes[0]);return this.innerText="",T.Element.prototype.appendChild.call(this,i),this.innerHTML}}),Dr=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?wi(T.Element.prototype.getAttribute.call(this,"src")):""},set:function(e){return T.Element.prototype.setAttribute.call(this,"src",e),e}});function Nr(){var e=J(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]);return Nr=function(){return e},e}var Mr=function(c){function o(e,t){var i;i=c.call(this,e,t)||this;var n=e.source,r=!1;if(n&&(i.el_.currentSrc!==n.src||e.tag&&3===e.tag.initNetworkState_)?i.setSource(n):i.handleLateInit_(i.el_),e.enableSourceset&&i.setupSourcesetHandling_(),i.el_.hasChildNodes()){for(var a=i.el_.childNodes,s=a.length,o=[];s--;){var l=a[s];"track"===l.nodeName.toLowerCase()&&(i.featuresNativeTextTracks?(i.remoteTextTrackEls().addTrackElement_(l),i.remoteTextTracks().addTrack(l.track),i.textTracks().addTrack(l.track),r||i.el_.hasAttribute("crossorigin")||!ki(l.src)||(r=!0)):o.push(l))}for(var u=0;u<o.length;u++)i.el_.removeChild(o[u])}return i.proxyNativeTracks_(),i.featuresNativeTextTracks&&r&&ee.warn(D(Nr())),i.restoreMetadataTracksInIOSNativePlayer_(),(Qt||Ut||Kt)&&!0===e.nativeControlsForTouch&&i.setControls(!0),i.proxyWebkitFullscreen_(),i.triggerReady(),i}z(o,c);var e=o.prototype;return e.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),o.disposeMediaElement(this.el_),this.options_=null,c.prototype.dispose.call(this)},e.setupSourcesetHandling_=function(){Rr(this)},e.restoreMetadataTracksInIOSNativePlayer_=function(){function e(){i=[];for(var e=0;e<n.length;e++){var t=n[e];"metadata"===t.kind&&i.push({track:t,storedMode:t.mode})}}var i,n=this.textTracks();e(),n.addEventListener("change",e),this.on("dispose",function(){return n.removeEventListener("change",e)});function r(){for(var e=0;e<i.length;e++){var t=i[e];"disabled"===t.track.mode&&t.track.mode!==t.storedMode&&(t.track.mode=t.storedMode)}n.removeEventListener("change",r)}this.on("webkitbeginfullscreen",function(){n.removeEventListener("change",e),n.removeEventListener("change",r),n.addEventListener("change",r)}),this.on("webkitendfullscreen",function(){n.removeEventListener("change",e),n.addEventListener("change",e),n.removeEventListener("change",r)})},e.overrideNative_=function(e,t){var i=this;if(t===this["featuresNative"+e+"Tracks"]){var n=e.toLowerCase();this[n+"TracksListeners_"]&&Object.keys(this[n+"TracksListeners_"]).forEach(function(e){i.el()[n+"Tracks"].removeEventListener(e,i[n+"TracksListeners_"][e])}),this["featuresNative"+e+"Tracks"]=!t,this[n+"TracksListeners_"]=null,this.proxyNativeTracksForType_(n)}},e.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)},e.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)},e.proxyNativeTracksForType_=function(e){var n=this,t=Vi[e],r=this.el()[t.getterName],a=this[t.getterName]();if(this["featuresNative"+t.capitalName+"Tracks"]&&r&&r.addEventListener){var s={change:function(){a.trigger({type:"change",target:a,currentTarget:a,srcElement:a})},addtrack:function(e){a.addTrack(e.track)},removetrack:function(e){a.removeTrack(e.track)}},i=function(){for(var e=[],t=0;t<a.length;t++){for(var i=!1,n=0;n<r.length;n++)if(r[n]===a[t]){i=!0;break}i||e.push(a[t])}for(;e.length;)a.removeTrack(e.shift())};this[t.getterName+"Listeners_"]=s,Object.keys(s).forEach(function(t){var i=s[t];r.addEventListener(t,i),n.on("dispose",function(e){return r.removeEventListener(t,i)})}),this.on("loadstart",i),this.on("dispose",function(e){return n.off("loadstart",i)})}},e.proxyNativeTracks_=function(){var t=this;Vi.names.forEach(function(e){t.proxyNativeTracksForType_(e)})},e.createEl=function(){var e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){var t=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(t,e),o.disposeMediaElement(e),e=t}else{e=M.createElement("video");var i=It({},this.options_.tag&&we(this.options_.tag));Qt&&!0===this.options_.nativeControlsForTouch||delete i.controls,Ee(e,ae(i,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}void 0!==this.options_.preload&&ke(e,"preload",this.options_.preload);for(var n=["loop","muted","playsinline","autoplay"],r=0;r<n.length;r++){var a=n[r],s=this.options_[a];void 0!==s&&(s?ke(e,a,a):Ae(e,a),e[a]=s)}return e},e.handleLateInit_=function(e){if(0!==e.networkState&&3!==e.networkState){if(0===e.readyState){var t=!1,i=function(){t=!0};this.on("loadstart",i);var n=function(){t||this.trigger("loadstart")};return this.on("loadedmetadata",n),void this.ready(function(){this.off("loadstart",i),this.off("loadedmetadata",n),t||this.trigger("loadstart")})}var r=["loadstart"];r.push("loadedmetadata"),2<=e.readyState&&r.push("loadeddata"),3<=e.readyState&&r.push("canplay"),4<=e.readyState&&r.push("canplaythrough"),this.ready(function(){r.forEach(function(e){this.trigger(e)},this)})}},e.setCurrentTime=function(e){try{this.el_.currentTime=e}catch(e){ee(e,"Video is not ready. (Video.js)")}},e.duration=function(){var t=this;if(this.el_.duration===1/0&&Gt&&zt&&0===this.el_.currentTime){return this.on("timeupdate",function e(){0<t.el_.currentTime&&(t.el_.duration===1/0&&t.trigger("durationchange"),t.off("timeupdate",e))}),NaN}return this.el_.duration||NaN},e.width=function(){return this.el_.offsetWidth},e.height=function(){return this.el_.offsetHeight},e.proxyWebkitFullscreen_=function(){var e=this;if("webkitDisplayingFullscreen"in this.el_){var t=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},i=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",t),this.trigger("fullscreenchange",{isFullscreen:!0}))};this.on("webkitbeginfullscreen",i),this.on("dispose",function(){e.off("webkitbeginfullscreen",i),e.off("webkitendfullscreen",t)})}},e.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var e=T.navigator&&T.navigator.userAgent||"";if(/Android/.test(e)||!/Chrome|Mac OS X 10.5/.test(e))return!0}return!1},e.enterFullScreen=function(){var e=this.el_;e.paused&&e.networkState<=e.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){e.pause(),e.webkitEnterFullScreen()},0)):e.webkitEnterFullScreen()},e.exitFullScreen=function(){this.el_.webkitExitFullScreen()},e.src=function(e){if(void 0===e)return this.el_.src;this.setSrc(e)},e.reset=function(){o.resetMediaElement(this.el_)},e.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},e.setControls=function(e){this.el_.controls=!!e},e.addTextTrack=function(e,t,i){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,i):c.prototype.addTextTrack.call(this,e,t,i)},e.createRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return c.prototype.createRemoteTextTrack.call(this,e);var t=M.createElement("track");return e.kind&&(t.kind=e.kind),e.label&&(t.label=e.label),(e.language||e.srclang)&&(t.srclang=e.language||e.srclang),e.default&&(t.default=e.default),e.id&&(t.id=e.id),e.src&&(t.src=e.src),t},e.addRemoteTextTrack=function(e,t){var i=c.prototype.addRemoteTextTrack.call(this,e,t);return this.featuresNativeTextTracks&&this.el().appendChild(i),i},e.removeRemoteTextTrack=function(e){if(c.prototype.removeRemoteTextTrack.call(this,e),this.featuresNativeTextTracks)for(var t=this.$$("track"),i=t.length;i--;)e!==t[i]&&e!==t[i].track||this.el().removeChild(t[i])},e.getVideoPlaybackQuality=function(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var e={};return void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),T.performance&&"function"==typeof T.performance.now?e.creationTime=T.performance.now():T.performance&&T.performance.timing&&"number"==typeof T.performance.timing.navigationStart&&(e.creationTime=T.Date.now()-T.performance.timing.navigationStart),e},o}(qi);if(de()){Mr.TEST_VID=M.createElement("video");var Br=M.createElement("track");Br.kind="captions",Br.srclang="en",Br.label="English",Mr.TEST_VID.appendChild(Br)}Mr.isSupported=function(){try{Mr.TEST_VID.volume=.5}catch(e){return!1}return!(!Mr.TEST_VID||!Mr.TEST_VID.canPlayType)},Mr.canPlayType=function(e){return Mr.TEST_VID.canPlayType(e)},Mr.canPlaySource=function(e,t){return Mr.canPlayType(e.type)},Mr.canControlVolume=function(){try{var e=Mr.TEST_VID.volume;return Mr.TEST_VID.volume=e/2+.1,e!==Mr.TEST_VID.volume}catch(e){return!1}},Mr.canMuteVolume=function(){try{var e=Mr.TEST_VID.muted;return Mr.TEST_VID.muted=!e,Mr.TEST_VID.muted?ke(Mr.TEST_VID,"muted","muted"):Ae(Mr.TEST_VID,"muted"),e!==Mr.TEST_VID.muted}catch(e){return!1}},Mr.canControlPlaybackRate=function(){if(Gt&&zt&&Yt<58)return!1;try{var e=Mr.TEST_VID.playbackRate;return Mr.TEST_VID.playbackRate=e/2+.1,e!==Mr.TEST_VID.playbackRate}catch(e){return!1}},Mr.canOverrideAttributes=function(){try{var e=function(){};Object.defineProperty(M.createElement("video"),"src",{get:e,set:e}),Object.defineProperty(M.createElement("audio"),"src",{get:e,set:e}),Object.defineProperty(M.createElement("video"),"innerHTML",{get:e,set:e}),Object.defineProperty(M.createElement("audio"),"innerHTML",{get:e,set:e})}catch(e){return!1}return!0},Mr.supportsNativeTextTracks=function(){return Jt||jt&&zt},Mr.supportsNativeVideoTracks=function(){return!(!Mr.TEST_VID||!Mr.TEST_VID.videoTracks)},Mr.supportsNativeAudioTracks=function(){return!(!Mr.TEST_VID||!Mr.TEST_VID.audioTracks)},Mr.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],Mr.prototype.featuresVolumeControl=Mr.canControlVolume(),Mr.prototype.featuresMuteControl=Mr.canMuteVolume(),Mr.prototype.featuresPlaybackRate=Mr.canControlPlaybackRate(),Mr.prototype.featuresSourceset=Mr.canOverrideAttributes(),Mr.prototype.movingMediaElementInDOM=!jt,Mr.prototype.featuresFullscreenResize=!0,Mr.prototype.featuresProgressEvents=!0,Mr.prototype.featuresTimeupdateEvents=!0,Mr.prototype.featuresNativeTextTracks=Mr.supportsNativeTextTracks(),Mr.prototype.featuresNativeVideoTracks=Mr.supportsNativeVideoTracks(),Mr.prototype.featuresNativeAudioTracks=Mr.supportsNativeAudioTracks();var Ur=Mr.TEST_VID&&Mr.TEST_VID.constructor.prototype.canPlayType,Fr=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;function jr(){var e=J(["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "]);return jr=function(){return e},e}Mr.patchCanPlayType=function(){4<=Vt&&!Wt&&!zt&&(Mr.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&Fr.test(e)?"maybe":Ur.call(this,e)})},Mr.unpatchCanPlayType=function(){var e=Mr.TEST_VID.constructor.prototype.canPlayType;return Mr.TEST_VID.constructor.prototype.canPlayType=Ur,e},Mr.patchCanPlayType(),Mr.disposeMediaElement=function(e){if(e){for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},Mr.resetMediaElement=function(e){if(e){for(var t=e.querySelectorAll("source"),i=t.length;i--;)e.removeChild(t[i]);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(e){Mr.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(t){Mr.prototype["set"+At(t)]=function(e){(this.el_[t]=e)?this.el_.setAttribute(t,t):this.el_.removeAttribute(t)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach(function(e){Mr.prototype[e]=function(){return this.el_[e]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate"].forEach(function(t){Mr.prototype["set"+At(t)]=function(e){this.el_[t]=e}}),["pause","load","play"].forEach(function(e){Mr.prototype[e]=function(){return this.el_[e]()}}),qi.withSourceHandlers(Mr),Mr.nativeSourceHandler={},Mr.nativeSourceHandler.canPlayType=function(e){try{return Mr.TEST_VID.canPlayType(e)}catch(e){return""}},Mr.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return Mr.nativeSourceHandler.canPlayType(e.type);if(e.src){var i=Ci(e.src);return Mr.nativeSourceHandler.canPlayType("video/"+i)}return""},Mr.nativeSourceHandler.handleSource=function(e,t,i){t.setSrc(e.src)},Mr.nativeSourceHandler.dispose=function(){},Mr.registerSourceHandler(Mr.nativeSourceHandler),qi.registerTech("Html5",Mr);var Hr=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Gr={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Vr=["tiny","xsmall","small","medium","large","xlarge","huge"],Kr={};Vr.forEach(function(e){var t="x"===e.charAt(0)?"x-"+e.substring(1):e;Kr[e]="vjs-layout-"+t});var Wr={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},qr=function(c){function h(e,t,i){var n;if(e.id=e.id||t.id||"vjs_video_"+Ve(),(t=ae(h.getTagSettings(e),t)).initChildren=!1,t.createEl=!1,t.evented=!1,t.reportTouchActivity=!1,!t.language)if("function"==typeof e.closest){var r=e.closest("[lang]");r&&r.getAttribute&&(t.language=r.getAttribute("lang"))}else for(var a=e;a&&1===a.nodeType;){if(we(a).hasOwnProperty("lang")){t.language=a.getAttribute("lang");break}a=a.parentNode}if((n=c.call(this,null,t,i)||this).log=te(n.id_),n.isPosterFromTech_=!1,n.queuedCallbacks_=[],n.isReady_=!1,n.hasStarted_=!1,n.userActive_=!1,!n.options_||!n.options_.techOrder||!n.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(n.tag=e,n.tagAttributes=e&&we(e),n.language(n.options_.language),t.languages){var s={};Object.getOwnPropertyNames(t.languages).forEach(function(e){s[e.toLowerCase()]=t.languages[e]}),n.languages_=s}else n.languages_=h.prototype.options_.languages;n.cache_={},n.poster_=t.poster||"",n.controls_=!!t.controls,n.cache_.lastVolume=1,e.controls=!1,e.removeAttribute("controls"),e.hasAttribute("autoplay")?n.options_.autoplay=!0:n.autoplay(n.options_.autoplay),n.scrubbing_=!1,n.el_=n.createEl(),n.cache_.lastPlaybackRate=n.defaultPlaybackRate(),wt($($(n)),{eventBusKey:"el_"}),n.fluid_&&n.on("playerreset",n.updateStyleEl_);var o=It(n.options_);if(t.plugins){var l=t.plugins;Object.keys(l).forEach(function(e){if("function"!=typeof this[e])throw new Error('plugin "'+e+'" does not exist');this[e](l[e])},$($(n)))}n.options_.playerOptions=o,n.middleware_=[],n.initChildren(),n.isAudio("audio"===e.nodeName.toLowerCase()),n.controls()?n.addClass("vjs-controls-enabled"):n.addClass("vjs-controls-disabled"),n.el_.setAttribute("role","region"),n.isAudio()?n.el_.setAttribute("aria-label",n.localize("Audio Player")):n.el_.setAttribute("aria-label",n.localize("Video Player")),n.isAudio()&&n.addClass("vjs-audio"),n.flexNotSupported_()&&n.addClass("vjs-no-flex"),jt||n.addClass("vjs-workinghover"),h.players[n.id_]=$($(n));var u="7.4.1".split(".")[0];return n.addClass("vjs-v"+u),n.userActive(!0),n.reportUserActivity(),n.one("play",n.listenForUserActivity_),n.on("fullscreenchange",n.handleFullscreenChange_),n.on("stageclick",n.handleStageClick_),n.breakpoints(n.options_.breakpoints),n.responsive(n.options_.responsive),n.changingSrc_=!1,n.playWaitingForReady_=!1,n.playOnLoadstart_=null,n}z(h,c);var e=h.prototype;return e.dispose=function(){this.trigger("dispose"),this.off("dispose"),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),h.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),Yi[this.id()]=null,c.prototype.dispose.call(this)},e.createEl=function(){var t,i=this.tag,e=this.playerElIngest_=i.parentNode&&i.parentNode.hasAttribute&&i.parentNode.hasAttribute("data-vjs-player"),n="video-js"===this.tag.tagName.toLowerCase();e?t=this.el_=i.parentNode:n||(t=this.el_=c.prototype.createEl.call(this,"div"));var r=we(i);if(n){for(t=this.el_=i,i=this.tag=M.createElement("video");t.children.length;)i.appendChild(t.firstChild);be(t,"video-js")||_e(t,"video-js"),t.appendChild(i),e=this.playerElIngest_=t,Object.keys(t).forEach(function(e){i[e]=t[e]})}if(i.setAttribute("tabindex","-1"),r.tabindex="-1",Xt&&(i.setAttribute("role","application"),r.role="application"),i.removeAttribute("width"),i.removeAttribute("height"),"width"in r&&delete r.width,"height"in r&&delete r.height,Object.getOwnPropertyNames(r).forEach(function(e){n&&"class"===e||t.setAttribute(e,r[e]),n&&i.setAttribute(e,r[e])}),i.playerId=i.id,i.id+="_html5_api",i.className="vjs-tech",i.player=t.player=this,this.addClass("vjs-paused"),!0!==T.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=ut("vjs-styles-dimensions");var a=Fe(".vjs-styles-defaults"),s=Fe("head");s.insertBefore(this.styleEl_,a?a.nextSibling:s.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio);for(var o=i.getElementsByTagName("a"),l=0;l<o.length;l++){var u=o.item(l);_e(u,"vjs-hidden"),u.setAttribute("hidden","hidden")}return i.initNetworkState_=i.networkState,i.parentNode&&!e&&i.parentNode.insertBefore(t,i),ye(i,t),this.children_.unshift(i),this.el_.setAttribute("lang",this.language_),this.el_=t},e.width=function(e){return this.dimension("width",e)},e.height=function(e){return this.dimension("height",e)},e.dimension=function(e,t){var i=e+"_";if(void 0===t)return this[i]||0;if(""===t)return this[i]=void 0,void this.updateStyleEl_();var n=parseFloat(t);isNaN(n)?ee.error('Improper value "'+t+'" supplied for for '+e):(this[i]=n,this.updateStyleEl_())},e.fluid=function(e){if(void 0===e)return!!this.fluid_;var t,i;this.fluid_=!!e,St(this)&&this.off("playerreset",this.updateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),St(t=function(){this.on("playerreset",this.updateStyleEl_)})?i():(t.eventedCallbacks||(t.eventedCallbacks=[]),t.eventedCallbacks.push(i))):this.removeClass("vjs-fluid"),this.updateStyleEl_()},e.fill=function(e){if(void 0===e)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},e.aspectRatio=function(e){if(void 0===e)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()},e.updateStyleEl_=function(){if(!0!==T.VIDEOJS_NO_DYNAMIC_STYLE){var e,t,i,n=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:0<this.videoWidth()?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),r=n[1]/n[0];e=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/r:this.videoWidth()||300,t=void 0!==this.height_?this.height_:e*r,i=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(i),ct(this.styleEl_,"\n      ."+i+" {\n        width: "+e+"px;\n        height: "+t+"px;\n      }\n\n      ."+i+".vjs-fluid {\n        padding-top: "+100*r+"%;\n      }\n    ")}else{var a="number"==typeof this.width_?this.width_:this.options_.width,s="number"==typeof this.height_?this.height_:this.options_.height,o=this.tech_&&this.tech_.el();o&&(0<=a&&(o.width=a),0<=s&&(o.height=s))}},e.loadTech_=function(e,t){var i=this;this.tech_&&this.unloadTech_();var n=At(e),r=e.charAt(0).toLowerCase()+e.slice(1);"Html5"!==n&&this.tag&&(qi.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=n,this.isReady_=!1;var a={source:t,autoplay:"string"!=typeof this.autoplay()&&this.autoplay(),nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+r+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};Wi.names.forEach(function(e){var t=Wi[e];a[t.getterName]=i[t.privateName]}),ae(a,this.options_[n]),ae(a,this.options_[r]),ae(a,this.options_[e.toLowerCase()]),this.tag&&(a.tag=this.tag),t&&t.src===this.cache_.src&&0<this.cache_.currentTime&&(a.startTime=this.cache_.currentTime);var s=qi.getTech(e);if(!s)throw new Error("No Tech named '"+n+"' exists! '"+n+"' should be registered using videojs.registerTech()'");this.tech_=new s(a),this.tech_.ready(ht(this,this.handleTechReady_),!0),gi(this.textTracksJson_||[],this.tech_),Hr.forEach(function(e){i.on(i.tech_,e,i["handleTech"+At(e)+"_"])}),Object.keys(Gr).forEach(function(t){i.on(i.tech_,t,function(e){0===i.tech_.playbackRate()&&i.tech_.seeking()?i.queuedCallbacks_.push({callback:i["handleTech"+Gr[t]+"_"].bind(i),event:e}):i["handleTech"+Gr[t]+"_"](e)})}),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===n&&this.tag||ye(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},e.unloadTech_=function(){var i=this;Wi.names.forEach(function(e){var t=Wi[e];i[t.privateName]=i[t.getterName]()}),this.textTracksJson_=mi(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},e.tech=function(e){return void 0===e&&ee.warn(D(jr())),this.tech_},e.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mousedown",this.handleTechClick_),this.on(this.tech_,"dblclick",this.handleTechDoubleClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},e.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mousedown",this.handleTechClick_),this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},e.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},e.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},e.manualAutoplay_=function(t){var i=this;if(this.tech_&&"string"==typeof t){var e,n=function(){var t=i.muted();i.muted(!0);var e=i.play();if(e&&e.then&&e.catch)return e.catch(function(e){i.muted(t)})};if("any"===t?(e=this.play())&&e.then&&e.catch&&e.catch(function(){return n()}):e="muted"===t?n():this.play(),e&&e.then&&e.catch)return e.then(function(){i.trigger({type:"autoplay-success",autoplay:t})}).catch(function(e){i.trigger({type:"autoplay-failure",autoplay:t})})}},e.updateSourceCaches_=function(e){void 0===e&&(e="");var t=e,i="";"string"!=typeof t&&(t=e.src,i=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!i&&(i=function(e,t){if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;var i=e.cache_.sources.filter(function(e){return e.src===t});if(i.length)return i[0].type;for(var n=e.$$("source"),r=0;r<n.length;r++){var a=n[r];if(a.type&&a.src&&a.src===t)return a.type}return rn(t)}(this,t)),this.cache_.source=It({},e,{src:t,type:i});for(var n=this.cache_.sources.filter(function(e){return e.src&&e.src===t}),r=[],a=this.$$("source"),s=[],o=0;o<a.length;o++){var l=we(a[o]);r.push(l),l.src&&l.src===t&&s.push(l.src)}s.length&&!n.length?this.cache_.sources=r:n.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t},e.handleTechSourceset_=function(e){var n=this;if(!this.changingSrc_){var t=function(e){return n.updateSourceCaches_(e)},i=this.currentSource().src,r=e.src;if(i&&!/^blob:/.test(i)&&/^blob:/.test(r)&&(this.lastSource_&&(this.lastSource_.tech===r||this.lastSource_.player===i)||(t=function(){})),t(r),!e.src){this.tech_.one(["sourceset","loadstart"],function e(t){if("sourceset"!==t.type){var i=n.techGet("currentSrc");n.lastSource_.tech=i,n.updateSourceCaches_(i)}n.tech_.off(["sourceset","loadstart"],e)})}}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})},e.hasStarted=function(e){if(void 0===e)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},e.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},e.handleTechRateChange_=function(){0<this.tech_.playbackRate()&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach(function(e){return e.callback(e.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},e.handleTechWaiting_=function(){var t=this;this.addClass("vjs-waiting"),this.trigger("waiting");var i=this.currentTime();this.on("timeupdate",function e(){i!==t.currentTime()&&(t.removeClass("vjs-waiting"),t.off("timeupdate",e))})},e.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},e.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},e.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},e.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},e.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.trigger("seeked")},e.handleTechFirstPlay_=function(){this.options_.starttime&&(ee.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},e.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},e.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},e.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},e.handleTechClick_=function(e){Ue(e)&&this.controls_&&(this.paused()?fi(this.play()):this.pause())},e.handleTechDoubleClick_=function(t){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(e){return e.contains(t.target)})||(this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))},e.handleTechTap_=function(){this.userActive(!this.userActive())},e.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},e.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},e.handleTechTouchEnd_=function(e){e.preventDefault()},e.handleFullscreenChange_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},e.handleStageClick_=function(){this.reportUserActivity()},e.handleTechFullscreenChange_=function(e,t){t&&this.isFullscreen(t.isFullscreen),this.trigger("fullscreenchange")},e.handleTechError_=function(){var e=this.tech_.error();this.error(e)},e.handleTechTextData_=function(e,t){var i=null;1<arguments.length&&(i=t),this.trigger("textdata",i)},e.getCache=function(){return this.cache_},e.techCall_=function(r,a){this.ready(function(){if(r in Zi)return e=this.middleware_,t=this.tech_,n=a,t[i=r](e.reduce(tn(i),n));if(r in en)return Ji(this.middleware_,this.tech_,r,a);var e,t,i,n;try{this.tech_&&this.tech_[r](a)}catch(e){throw ee(e),e}},!0)},e.techGet_=function(t){if(this.tech_&&this.tech_.isReady_){if(t in Qi)return e=this.middleware_,i=this.tech_,n=t,e.reduceRight(tn(n),i[n]());if(t in en)return Ji(this.middleware_,this.tech_,t);var e,i,n;try{return this.tech_[t]()}catch(e){if(void 0===this.tech_[t])throw ee("Video.js: "+t+" method not defined for "+this.techName_+" playback technology.",e),e;if("TypeError"===e.name)throw ee("Video.js: "+t+" unavailable on "+this.techName_+" playback technology element.",e),this.tech_.isReady_=!1,e;throw ee(e),e}}},e.play=function(){var t=this,e=this.options_.Promise||T.Promise;return e?new e(function(e){t.play_(e)}):this.play_()},e.play_=function(e){var t=this;if(void 0===e&&(e=fi),this.playOnLoadstart_&&this.off("loadstart",this.playOnLoadstart_),this.isReady_){if(!this.changingSrc_&&(this.src()||this.currentSrc()))return void e(this.techGet_("play"));this.playOnLoadstart_=function(){t.playOnLoadstart_=null,e(t.play())},this.one("loadstart",this.playOnLoadstart_)}else{if(this.playWaitingForReady_)return;this.playWaitingForReady_=!0,this.ready(function(){t.playWaitingForReady_=!1,e(t.play())})}},e.pause=function(){this.techCall_("pause")},e.paused=function(){return!1!==this.techGet_("paused")},e.played=function(){return this.techGet_("played")||ii(0,0)},e.scrubbing=function(e){if(void 0===e)return this.scrubbing_;this.scrubbing_=!!e,e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},e.currentTime=function(e){return void 0!==e?(e<0&&(e=0),void this.techCall_("setCurrentTime",e)):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},e.duration=function(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(e=parseFloat(e))<0&&(e=1/0),e!==this.cache_.duration&&((this.cache_.duration=e)===1/0?(this.addClass("vjs-live"),this.options_.liveui&&this.player_.liveTracker&&this.addClass("vjs-liveui")):(this.removeClass("vjs-live"),this.removeClass("vjs-liveui")),isNaN(e)||this.trigger("durationchange"))},e.remainingTime=function(){return this.duration()-this.currentTime()},e.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},e.buffered=function(){var e=this.techGet_("buffered");return e&&e.length||(e=ii(0,0)),e},e.bufferedPercent=function(){return ni(this.buffered(),this.duration())},e.bufferedEnd=function(){var e=this.buffered(),t=this.duration(),i=e.end(e.length-1);return t<i&&(i=t),i},e.volume=function(e){var t;return void 0!==e?(t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall_("setVolume",t),void(0<t&&this.lastVolume_(t))):(t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t)},e.muted=function(e){if(void 0===e)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)},e.defaultMuted=function(e){return void 0!==e?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1},e.lastVolume_=function(e){if(void 0===e||0===e)return this.cache_.lastVolume;this.cache_.lastVolume=e},e.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},e.isFullscreen=function(e){if(void 0===e)return!!this.isFullscreen_;this.isFullscreen_=!!e},e.requestFullscreen=function(){var i=ai;this.isFullscreen(!0),i.requestFullscreen?(et(M,i.fullscreenchange,ht(this,function e(t){this.isFullscreen(M[i.fullscreenElement]),!1===this.isFullscreen()&&tt(M,i.fullscreenchange,e),this.trigger("fullscreenchange")})),this.el_[i.requestFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange"))},e.exitFullscreen=function(){var e=ai;this.isFullscreen(!1),e.requestFullscreen?M[e.exitFullscreen]():this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange"))},e.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=M.documentElement.style.overflow,et(M,"keydown",ht(this,this.fullWindowOnEscKey)),M.documentElement.style.overflow="hidden",_e(M.body,"vjs-full-window"),this.trigger("enterFullWindow")},e.fullWindowOnEscKey=function(e){27===e.keyCode&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},e.exitFullWindow=function(){this.isFullWindow=!1,tt(M,"keydown",this.fullWindowOnEscKey),M.documentElement.style.overflow=this.docOrigOverflow,Te(M.body,"vjs-full-window"),this.trigger("exitFullWindow")},e.canPlayType=function(e){for(var t,i=0,n=this.options_.techOrder;i<n.length;i++){var r=n[i],a=qi.getTech(r);if(a=a||xt.getComponent(r)){if(a.isSupported()&&(t=a.canPlayType(e)))return t}else ee.error('The "'+r+'" tech is undefined. Skipped browser support check for that tech.')}return""},e.selectSource=function(e){function t(e,i,n){var r;return e.some(function(t){return i.some(function(e){if(r=n(t,e))return!0})}),r}function i(e,t){var i=e[0];if(e[1].canPlaySource(t,r.options_[i.toLowerCase()]))return{source:t,tech:i}}var n,r=this,a=this.options_.techOrder.map(function(e){return[e,qi.getTech(e)]}).filter(function(e){var t=e[0],i=e[1];return i?i.isSupported():(ee.error('The "'+t+'" tech is undefined. Skipped browser support check for that tech.'),!1)});return(this.options_.sourceOrder?t(e,a,(n=i,function(e,t){return n(t,e)})):t(a,e,i))||!1},e.src=function(e){var r=this;if(void 0===e)return this.cache_.src||"";var a=function t(e){if(Array.isArray(e)){var i=[];e.forEach(function(e){e=t(e),Array.isArray(e)?i=i.concat(e):se(e)&&i.push(e)}),e=i}else e="string"==typeof e&&e.trim()?[sn({src:e})]:se(e)&&"string"==typeof e.src&&e.src&&e.src.trim()?[sn(e)]:[];return e}(e);a.length?(this.changingSrc_=!0,this.cache_.sources=a,this.updateSourceCaches_(a[0]),$i(this,a[0],function(e,t){var i,n;if(r.middleware_=t,r.cache_.sources=a,r.updateSourceCaches_(e),r.src_(e))return 1<a.length?r.src(a.slice(1)):(r.changingSrc_=!1,r.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),void r.triggerReady());i=t,n=r.tech_,i.forEach(function(e){return e.setTech&&e.setTech(n)})})):this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)},e.src_=function(e){var t,i,n=this,r=this.selectSource([e]);return!r||(t=r.tech,i=this.techName_,At(t)!==At(i)?(this.changingSrc_=!0,this.loadTech_(r.tech,r.source),this.tech_.ready(function(){n.changingSrc_=!1})):this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1)},e.load=function(){this.techCall_("load")},e.reset=function(){this.tech_&&this.tech_.clearTracks("text"),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),St(this)&&this.trigger("playerreset")},e.currentSources=function(){var e=this.currentSource(),t=[];return 0!==Object.keys(e).length&&t.push(e),this.cache_.sources||t},e.currentSource=function(){return this.cache_.source||{}},e.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},e.currentType=function(){return this.currentSource()&&this.currentSource().type||""},e.preload=function(e){return void 0!==e?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")},e.autoplay=function(e){if(void 0===e)return this.options_.autoplay||!1;var t;"string"==typeof e&&/(any|play|muted)/.test(e)?(this.options_.autoplay=e,this.manualAutoplay_(e),t=!1):this.options_.autoplay=!!e,t=t||this.options_.autoplay,this.tech_&&this.techCall_("setAutoplay",t)},e.playsinline=function(e){return void 0!==e?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")},e.loop=function(e){return void 0!==e?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")},e.poster=function(e){if(void 0===e)return this.poster_;(e=e||"")!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))},e.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},e.controls=function(e){if(void 0===e)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},e.usingNativeControls=function(e){if(void 0===e)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},e.error=function(e){return void 0===e?this.error_||null:null===e?(this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close())):(this.error_=new ci(e),this.addClass("vjs-error"),ee.error("(CODE:"+this.error_.code+" "+ci.errorTypes[this.error_.code]+")",this.error_.message,this.error_),void this.trigger("error"))},e.reportUserActivity=function(){this.userActivity_=!0},e.userActive=function(e){if(void 0===e)return this.userActive_;if((e=!!e)!==this.userActive_){if(this.userActive_=e,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",function(e){e.stopPropagation(),e.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},e.listenForUserActivity_=function(){var e,t,i,n,r=ht(this,this.reportUserActivity);this.on("mousedown",function(){r(),this.clearInterval(e),e=this.setInterval(r,250)}),this.on("mousemove",function(e){e.screenX===t&&e.screenY===i||(t=e.screenX,i=e.screenY,r())}),this.on("mouseup",function(){r(),this.clearInterval(e)}),this.on("keydown",r),this.on("keyup",r),this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(n);var e=this.options_.inactivityTimeout;e<=0||(n=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},e))}},250)},e.playbackRate=function(e){if(void 0===e)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)},e.defaultPlaybackRate=function(e){return void 0!==e?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},e.isAudio=function(e){if(void 0===e)return!!this.isAudio_;this.isAudio_=!!e},e.addTextTrack=function(e,t,i){if(this.tech_)return this.tech_.addTextTrack(e,t,i)},e.addRemoteTextTrack=function(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)},e.removeRemoteTextTrack=function(e){void 0===e&&(e={});var t=e.track;if(t=t||e,this.tech_)return this.tech_.removeRemoteTextTrack(t)},e.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},e.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},e.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},e.language=function(e){if(void 0===e)return this.language_;this.language_=String(e).toLowerCase()},e.languages=function(){return It(h.prototype.options_.languages,this.languages_)},e.toJSON=function(){var e=It(this.options_),t=e.tracks;e.tracks=[];for(var i=0;i<t.length;i++){var n=t[i];(n=It(n)).player=void 0,e.tracks[i]=n}return e},e.createModal=function(e,t){var i=this;(t=t||{}).content=e||"";var n=new yi(this,t);return this.addChild(n),n.on("dispose",function(){i.removeChild(n)}),n.open(),n},e.updateCurrentBreakpoint_=function(){if(this.responsive())for(var e=this.currentBreakpoint(),t=this.currentWidth(),i=0;i<Vr.length;i++){var n=Vr[i];if(t<=this.breakpoints_[n]){if(e===n)return;e&&this.removeClass(Kr[e]),this.addClass(Kr[n]),this.breakpoint_=n;break}}},e.removeCurrentBreakpoint_=function(){var e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)},e.breakpoints=function(e){return void 0===e||(this.breakpoint_="",this.breakpoints_=ae({},Wr,e),this.updateCurrentBreakpoint_()),ae(this.breakpoints_)},e.responsive=function(e){return void 0===e?this.responsive_:(e=Boolean(e))!==this.responsive_?((this.responsive_=e)?(this.on("playerresize",this.updateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e):void 0},e.currentBreakpoint=function(){return this.breakpoint_},e.currentBreakpointClass=function(){return Kr[this.breakpoint_]||""},h.getTagSettings=function(e){var t={sources:[],tracks:[]},i=we(e),n=i["data-setup"];if(be(e,"vjs-fill")&&(i.fill=!0),be(e,"vjs-fluid")&&(i.fluid=!0),null!==n){var r=d(n||"{}"),a=r[0],s=r[1];a&&ee.error(a),ae(i,s)}if(ae(t,i),e.hasChildNodes())for(var o=e.childNodes,l=0,u=o.length;l<u;l++){var c=o[l],h=c.nodeName.toLowerCase();"source"===h?t.sources.push(we(c)):"track"===h&&t.tracks.push(we(c))}return t},e.flexNotSupported_=function(){var e=M.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)},h}(xt);Wi.names.forEach(function(e){var t=Wi[e];qr.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}}),qr.players={};var zr=T.navigator;qr.prototype.options_={techOrder:qi.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:zr&&(zr.languages&&zr.languages[0]||zr.userLanguage||zr.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(e){qr.prototype[e]=function(){return this.techGet_(e)}}),Hr.forEach(function(e){qr.prototype["handleTech"+At(e)+"_"]=function(){return this.trigger(e)}}),xt.registerComponent("Player",qr);function Yr(e){return ia.hasOwnProperty(e)}function Xr(e){return Yr(e)?ia[e]:void 0}function $r(e,t){e[ta]=e[ta]||{},e[ta][t]=!0}function Jr(e,t,i){var n=(i?"before":"")+"pluginsetup";e.trigger(n,t),e.trigger(n+":"+t.name,t)}function Qr(t,i){function n(){Jr(this,{name:t,plugin:i,instance:null},!0);var e=i.apply(this,arguments);return $r(this,t),Jr(this,{name:t,plugin:i,instance:e}),e}return Object.keys(i).forEach(function(e){n[e]=i[e]}),n}function Zr(r,a){return a.prototype.name=r,function(){Jr(this,{name:r,plugin:a,instance:null},!0);for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=X(a,[this].concat(t));return this[r]=function(){return n},Jr(this,n.getEventHash()),n}}var ea="plugin",ta="activePlugins_",ia={},na=function(){function i(e){if(this.constructor===i)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,wt(this),delete this.trigger,kt(this,this.constructor.defaultState),$r(e,this.name),this.dispose=ht(this,this.dispose),e.on("dispose",this.dispose)}var e=i.prototype;return e.version=function(){return this.constructor.VERSION},e.getEventHash=function(e){return void 0===e&&(e={}),e.name=this.name,e.plugin=this.constructor,e.instance=this,e},e.trigger=function(e,t){return void 0===t&&(t={}),it(this.eventBusEl_,e,this.getEventHash(t))},e.handleStateChanged=function(){},e.dispose=function(){var e=this.name,t=this.player;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t[ta][e]=!1,this.player=this.state=null,t[e]=Zr(e,ia[e])},i.isBasic=function(e){var t="string"==typeof e?Xr(e):e;return"function"==typeof t&&!i.prototype.isPrototypeOf(t.prototype)},i.registerPlugin=function(e,t){if("string"!=typeof e)throw new Error('Illegal plugin name, "'+e+'", must be a string, was '+typeof e+".");if(Yr(e))ee.warn('A plugin named "'+e+'" already exists. You may want to avoid re-registering plugins!');else if(qr.prototype.hasOwnProperty(e))throw new Error('Illegal plugin name, "'+e+'", cannot share a name with an existing player method!');if("function"!=typeof t)throw new Error('Illegal plugin for "'+e+'", must be a function, was '+typeof t+".");return ia[e]=t,e!==ea&&(i.isBasic(t)?qr.prototype[e]=Qr(e,t):qr.prototype[e]=Zr(e,t)),t},i.deregisterPlugin=function(e){if(e===ea)throw new Error("Cannot de-register base plugin.");Yr(e)&&(delete ia[e],delete qr.prototype[e])},i.getPlugins=function(e){var i;return void 0===e&&(e=Object.keys(ia)),e.forEach(function(e){var t=Xr(e);t&&((i=i||{})[e]=t)}),i},i.getPluginVersion=function(e){var t=Xr(e);return t&&t.VERSION||""},i}();na.getPlugin=Xr,na.BASE_PLUGIN_NAME=ea,na.registerPlugin(ea,na),qr.prototype.usingPlugin=function(e){return!!this[ta]&&!0===this[ta][e]},qr.prototype.hasPlugin=function(e){return!!Yr(e)};var ra=function(e){return 0===e.indexOf("#")?e.slice(1):e};function aa(e,i,t){var n=aa.getPlayer(e);if(n)return i&&ee.warn('Player "'+e+'" is already initialised. Options will not be applied.'),t&&n.ready(t),n;var r="string"==typeof e?Fe("#"+ra(e)):e;if(!fe(r))throw new TypeError("The element or ID supplied is not valid. (videojs)");M.body.contains(r)||ee.warn("The element supplied is not included in the DOM"),i=i||{},aa.hooks("beforesetup").forEach(function(e){var t=e(r,It(i));se(t)&&!Array.isArray(t)?i=It(i,t):ee.error("please return an object in beforesetup hooks")});var a=xt.getComponent("Player");return n=new a(r,i,t),aa.hooks("setup").forEach(function(e){return e(n)}),n}if(aa.hooks_={},aa.hooks=function(e,t){return aa.hooks_[e]=aa.hooks_[e]||[],t&&(aa.hooks_[e]=aa.hooks_[e].concat(t)),aa.hooks_[e]},aa.hook=function(e,t){aa.hooks(e,t)},aa.hookOnce=function(i,e){aa.hooks(i,[].concat(e).map(function(t){return function e(){return aa.removeHook(i,e),t.apply(void 0,arguments)}}))},aa.removeHook=function(e,t){var i=aa.hooks(e).indexOf(t);return!(i<=-1)&&(aa.hooks_[e]=aa.hooks_[e].slice(),aa.hooks_[e].splice(i,1),!0)},!0!==T.VIDEOJS_NO_DYNAMIC_STYLE&&de()){var sa=Fe(".vjs-styles-defaults");if(!sa){sa=ut("vjs-styles-defaults");var oa=Fe("head");oa&&oa.insertBefore(sa,oa.firstChild),ct(sa,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}function la(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ua(e,t,i){return t&&la(e.prototype,t),i&&la(e,i),e}function ca(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function ha(e){return(ha=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function da(e,t){return(da=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fa(e,t,i){return(fa=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(e){return}}}()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var r=new(Function.bind.apply(e,n));return i&&da(r,i.prototype),r}).apply(null,arguments)}function pa(e){var n="function"==typeof Map?new Map:void 0;return(pa=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,i)}function i(){return fa(e,arguments,ha(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),da(i,e)})(e)}function ma(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}lt(1,aa),aa.VERSION="7.4.1",aa.options=qr.prototype.options_,aa.getPlayers=function(){return qr.players},aa.getPlayer=function(e){var t,i=qr.players;if("string"==typeof e){var n=ra(e),r=i[n];if(r)return r;t=Fe("#"+n)}else t=e;if(fe(t)){var a=t.player,s=t.playerId;if(a||i[s])return a||i[s]}},aa.getAllPlayers=function(){return Object.keys(qr.players).map(function(e){return qr.players[e]}).filter(Boolean)},aa.players=qr.players,aa.getComponent=xt.getComponent,aa.registerComponent=function(e,t){qi.isTech(t)&&ee.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),xt.registerComponent.call(xt,e,t)},aa.getTech=qi.getTech,aa.registerTech=qi.registerTech,aa.use=function(e,t){zi[e]=zi[e]||[],zi[e].push(t)},Object.defineProperty(aa,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(aa.middleware,"TERMINATOR",{value:Xi,writeable:!1,enumerable:!0}),aa.browser=Zt,aa.TOUCH_ENABLED=Qt,aa.extend=function(e,t){void 0===t&&(t={});var i=function(){e.apply(this,arguments)},n={};for(var r in"object"==typeof t?(t.constructor!==Object.prototype.constructor&&(i=t.constructor),n=t):"function"==typeof t&&(i=t),function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.super_=t)}(i,e),n)n.hasOwnProperty(r)&&(i.prototype[r]=n[r]);return i},aa.mergeOptions=It,aa.bind=ht,aa.registerPlugin=na.registerPlugin,aa.deregisterPlugin=na.deregisterPlugin,aa.plugin=function(e,t){return ee.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),na.registerPlugin(e,t)},aa.getPlugins=na.getPlugins,aa.getPlugin=na.getPlugin,aa.getPluginVersion=na.getPluginVersion,aa.addLanguage=function(e,t){var i;return e=(""+e).toLowerCase(),aa.options.languages=It(aa.options.languages,((i={})[e]=t,i)),aa.options.languages[e]},aa.log=ee,aa.createLogger=te,aa.createTimeRange=aa.createTimeRanges=ii,aa.formatTime=Sn,aa.setFormatTime=function(e){Tn=e},aa.resetFormatTime=function(){Tn=_n},aa.parseUrl=Ei,aa.isCrossOrigin=ki,aa.EventTarget=pt,aa.on=et,aa.one=nt,aa.off=tt,aa.trigger=it,aa.xhr=V,aa.TextTrack=Fi,aa.AudioTrack=ji,aa.VideoTrack=Hi,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(e){aa[e]=function(){return ee.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead"),He[e].apply(null,arguments)}}),aa.computedStyle=le,aa.dom=He,aa.url=Ui,window.videojs=aa;var ga=T.videojs,va=new function(){this.ENDED="ended",this.ERROR="error",this.LOADED_DATA="loadeddata",this.TIMESHIFT_CHANGE="timeshiftchange",this.DURATION_CHANGE="durationchange",this.LOADED_METADATA="loadedmetadata",this.SEEKING="seeking",this.TIME_UPDATE="timeupdate",this.USER_ACTIVE="useractive",this.USERIN_ACTIVE="userinactive",this.VOLUME_CHANGE="volumechange",this.LOAD_START="loadstart",this.CAN_PLAY="canplay",this.PLAYING="playing",this.WAITING="waiting",this.SEEKED="seeked",this.ABORT="abort",this.PLAY="play",this.PAUSE="pause",this.DISPOSE="dispose",this.MODE_CHANGE="modechange",this.CHANGE="change",this.ADD_TRACK="addtrack",this.REMOVE_TRACK="removetrack",this.METRIC_CHANGED="metricchanged",this.RECOVERABLE_ASSET_ERROR="recoverableasseterror",this.BITRATE_CHANGED="bitratechanged",this.CLOSE="close",this.READY="ready",this.RESIZE="resize",this.TAP="tap",this.CLICK="click",this.FOCUS="focus",this.BLUR="blur",this.BEFORE_MODAL_OPEN="beforemodalopen",this.MODAL_OPEN="modalopen",this.BEFORE_MODAL_CLOSE="beforemodalclose",this.MODAL_CLOSE="modalclose",this.BEFORE_MODAL_FILL="beforemodalfill",this.MODAL_FILL="modalfill",this.BEFORE_MODAL_EMPTY="beforemodalempty",this.MODAL_EMPTY="modalempty",this.CAN_PLAY_THROUGH="canplaythrough",this.FIRST_PLAY="firstplay",this.PROGRESS="progress",this.SUSPEND="suspend",this.EMPTIED="emptied",this.STALLED="stalled",this.RATE_CHANGE="ratechange",this.TEXT_TRACK_CHANGE="texttrackchange",this.TRACK_CHANGE="trackchanged",this.POSTER_CHANGE="posterchange",this.KEY_DOWN="keydown",this.KEY_UP="keyup",this.MOUSE_DOWN="mousedown",this.MOUSE_MOVE="mousemove",this.MOUSE_UP="mouseup",this.TOUCH_START="touchstart",this.TOUCH_MOVE="touchmove",this.TOUCH_END="touchend",this.TOUCH_LEAVE="touchleave",this.TOUCH_CANCEL="touchcancel",this.FULLSCREEN_CHANGE="fullscreenchange",this.ENTER_FULL_WINDOW="enterFullWindow",this.EXIT_FULL_WINDOW="exitFullWindow",this.CONTROLS_ENABLED="controlsenabled",this.CONTROLS_DISABLED="controlsdisabled",this.USING_NATIVE_CONTROLS="usingnativecontrols",this.USING_CUSTOM_CONTROLS="usingcustomcontrols",this.SLIDER_ACTIVE="slideractive",this.SLIDER_INACTIVE="sliderinactive",this.ENTITLEMENT_CHANGE="entitlementchange",this.ENTITLEMENT_LOAD_START="entitlementloadstart",this.PLAYER_CREATED="playercreated",this.RESTARTING="restarting",this.AD_TIMELINE_CHANGED="adtimelinechanged",this.CHROMECAST_CASTING="chromecastcasting",this.CHROMECAST_STOPPED="chromecaststopped",this.CHROMECAST_JOIN="chromecastjoin",this.STOPPED="stopped",this.READY_TO_PLAY="readytoplay",this.PROGRAM_CHANGED="programchanged",this.ASSET_CHANGED="assetchanged",this.SEGMENT_MISSING="segmentmissing",this.AIRPLAY_START="airplayStart",this.REPLAY="replay",this.DOWNLOAD_PROGRESS="downloadprogress",this.DRM_SESSION_UPDATE="drmsessionupdate",this.PIP_START="pipStart",this.PLAYLIST_CHANGE="playlistchange",this.CC_QUE_CHANGE="ccquechange"},ya=Object.prototype.toString,ba=function(e){return Sa(e)?Object.keys(e):[]};function _a(t,i){ba(t).forEach(function(e){return i(t[e],e)})}function Ta(i){for(var e=arguments.length,t=new Array(1<e?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Object.assign?Object.assign.apply(Object,[i].concat(t)):(t.forEach(function(e){e&&_a(e,function(e,t){i[t]=e})}),i)}function Sa(e){return!!e&&"object"==typeof e}function Ea(e){return Sa(e)&&"[object Object]"===ya.call(e)&&e.constructor===Object}function wa(e){return 0===ba(e).length}function Ca(n,r){var a={};return Object.keys(n).forEach(function(e){var t=n[e],i=r[e]||e;a[i]=t}),a}function ka(e){for(var t=atob(e),i=t.length,n=new Uint8Array(new ArrayBuffer(i)),r=0;r<i;r++)n[r]=t.charCodeAt(r);return n}function Aa(e){for(var t,i,n,r,a,s,o,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=0,c="";u<e.length;)r=(t=e[u++])>>2,a=(3&t)<<4|(i=u<e.length?e[u++]:Number.NaN)>>4,s=(15&i)<<2|(n=u<e.length?e[u++]:Number.NaN)>>6,o=63&n,isNaN(i)?s=o=64:isNaN(n)&&(o=64),c+=l.charAt(r)+l.charAt(a)+l.charAt(s)+l.charAt(o);return c}function Ia(e){return"string"==typeof e||e&&"object"==typeof e&&"[object String]"===Object.prototype.toString.call(e)}function xa(t){var i={assetId:void 0,programId:void 0,channelId:void 0};try{i=JSON.parse(t)}catch(e){i.assetId=t}return i}function Pa(e){if(Array.isArray(e)){var t=[];e.forEach(function(e){e=Pa(e),Array.isArray(e)?t=t.concat(e):Sa(e)&&t.push(e)}),e=t}else e="string"==typeof e&&e.trim()?[{src:e}]:Sa(e)&&"string"==typeof e.src&&e.src&&e.src.trim()?[e]:[];return e}function La(e,t){e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function Ra(e){return new RegExp(/^.*\//).exec(e)[0]}function Oa(e,t){return Math.ceil(e*Math.pow(10,t))/Math.pow(10,t)}function Da(e,t){for(var i=[],n=0;n<t.length;n++){var r={src:t[n].media.contentId,type:t[n].media.contentType,title:t[n].media.metadata?t[n].media.metadata.title:"",keySystems:t[n].customData?t[n].customData.keySystems:void 0,licenseServer:t[n].customData?t[n].customData.licenseServer:void 0,certificateServer:t[n].customData?t[n].customData.certificateServer:void 0,playToken:t[n].playToken?t[n].customData.playToken:void 0,selected:e===t[n].itemId};i.push(r)}return i}var Na={UNKNOWN:100,LOAD_ASSET:101,ENTITLEMENT:102,ENTITLEMENT2:103,SHAKA_TECH:200,HLS_TECH:300,CHROMECAST_TECH:500,HLS_MSE_TECH:1e4,DASHIF_TECH:2e4,SMOOTH_TECH:3e4},Ma=function(r){function a(e,t,i){var n;return void 0===t&&(t=Na.UNKNOWN),void 0===i&&(i=null),(n=r.call(this)||this).code=t,Ia(e)?n.message=e:e.message&&(n.message=e.message),n.status=i,Error.captureStackTrace&&Error.captureStackTrace(ma(n),a),n}return ca(a,r),ua(a,[{key:"codes",get:function(){return Na}}]),a}(pa(Error)),Ba=!1,Ua=function(){Ba&&Ha(null,arguments)};T.EMP_DEBUG_LOG&&(Ua=T.console&&T.console.log&&console.log.bind(console)||function(){});var Fa=Ua;if(Fa.history=[],Fa.error=function(){Ha("error",arguments)},Fa.warn=function(){Ha("warn",arguments)},Fa.debug=function(){Ha("debug",arguments)},T.EMP_DEBUG_LOG){var ja=function(){};Fa.debug=T.console&&T.console.debug&&console.debug.bind(console)||ja,Fa.warn=T.WARN=T.console&&T.console.warn&&console.warn.bind(console)||ja,Fa.error=T.ERROR=T.console&&T.console.error&&console.error.bind(console)||ja}function Ha(e,t){function i(){}var n=Array.prototype.slice.call(t),r=T.console||{log:i,warn:i,error:i,trace:i};e?n.unshift(e.toUpperCase()+":"):e="log",n.unshift("EMPPlayer:"),r[e].apply?r[e].apply(r,n):r[e](n.join(" "))}Fa.setLogToBrowserConsole=function(e){void 0===e&&(e=!1),Ba=e};var Ga=1;function Va(e,t,i){function n(){return t.apply(e,arguments)}return t.guid||(t.guid=Ga++),n.guid=i?i+"_"+t.guid:t.guid,n}function Ka(t,i){var n=Date.now();return function(){var e=Date.now();i<=e-n&&(t.apply(void 0,arguments),n=e)}}var Wa=ga.getComponent("MenuItem"),qa=ga.getComponent("Component"),za=function(r){function e(e,t){var i,n=t.bitrate;return t.label=0===n?"auto":Math.max(0,Math.round(n/1e3))+" kbps",t.selected=0===n,(i=r.call(this,e,t)||this).bitrate=n,i.bitrateChangedBind=i.bitrateChanged.bind(ma(i)),i.player_.on(va.BITRATE_CHANGED,i.bitrateChangedBind),i}ca(e,r);var t=e.prototype;return t.handleClick=function(){this.player_.bitrate(this.bitrate)},t.dispose=function(){this.player_.off(va.BITRATE_CHANGED,this.bitrateChangedBind),r.prototype.dispose.call(this)},t.bitrateChanged=function(e,t){this.el()&&(0===this.bitrate?this.selected(t.auto):this.selected(!t.auto&&t.bitrate===this.bitrate))},e}(Wa);qa.registerComponent("BitrateMenuItem",za);var Ya=ga.getComponent("MenuButton"),Xa=ga.getComponent("Component"),$a=function(r){function e(e,t){var i;(i=r.call(this,e,t)||this).el_.setAttribute("aria-label","Bitrate menu"),i.hide();var n=Va(ma(i),i.update);return i.player_.on(va.LOADED_DATA,n),i.player_.on(va.CHROMECAST_CASTING,n),i.player_.on(va.ENDED,function(){return i.hide()}),i.player_.on(va.PLAYING,function(){i.items&&1<i.items.length&&"EmpHLS"!==i.player_.techName_&&i.show()}),i.player_.on(va.DISPOSE,function(){this.player_.on(va.LOADED_DATA,n)}),i}ca(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-bitrate-button "+r.prototype.buildCSSClass.call(this)},t.createItems=function(e){void 0===e&&(e=[]);var t=this.player_.bitrates();if(!t||1===t.length||"EmpHLS"===this.player_.techName_)return this.hide(),e;0<t.length&&e.push(new za(this.player_,{selectable:!0,bitrate:0}));for(var i=0;i<t.length;i++){var n=t[i];e.push(new za(this.player_,{selectable:!0,bitrate:n}))}return this.show(),e},e}(Ya);function Ja(e,t){if(!e||!t)return"";if("function"!=typeof T.getComputedStyle)return e.currentStyle[t]||"";var i=T.getComputedStyle(e);return i?i[t]:""}function Qa(){var e,t,i=(e=["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."],t=t||e.slice(0),e.raw=t,e);return Qa=function(){return i},i}function Za(){return M===T.document&&void 0!==M.createElement}function es(e,r,t,i){void 0===e&&(e="div"),void 0===r&&(r={}),void 0===t&&(t={});var n,a=M.createElement(e);return Object.getOwnPropertyNames(r).forEach(function(e){var t,i,n=r[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(Fa.warn(D(Qa(),e,n)),a.setAttribute(e,n)):"textContent"===e?(i=n,void 0===(t=a).textContent?t.innerText=i:t.textContent=i):a[e]=n}),Object.getOwnPropertyNames(t).forEach(function(e){a.setAttribute(e,t[e])}),i&&(n=a,function(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map(function(e){return"function"==typeof e&&(e=e()),Sa(i=e)&&1===i.nodeType||Sa(t=e)&&3===t.nodeType?e:"string"==typeof e&&/\S/.test(e)?M.createTextNode(e):void 0;var t,i}).filter(function(e){return e})}(i).forEach(function(e){return n.appendChild(e)})),a}$a.prototype.controlText_="Bitrate",Xa.registerComponent("BitrateButton",$a);var ts={bitrates:function(e){return e.tech_&&void 0!==e.tech_.bitrates?e.techGet_("bitrates"):[]},bitrate:function(e,t){return e.tech_&&void 0!==e.tech_.bitrate?(void 0!==t&&e.techCall_("bitrate",t),e.techGet_("bitrate")):0},canRestart:function(e){return!e.tech_||void 0===e.tech_.canRestart||e.techGet_("canRestart")},restart:function(e,t,i){e.currentSource()&&(e.options_.startTime=0,e.options_.absoluteStartTime=void 0,e.previousAbsoluteStartTime=void 0,e.options_.autoplay||(e.options_.autoplay=!0,e.one("play",function(){e.options_.autoplay=!1})),e.trigger(va.RESTARTING),i?(e.options_.absoluteStartTime=i,e.options_.useLastViewedOffset=!1):e.options_.useLastViewedOffset=t,e.trigger(va.REPLAY))},getSelectedAudioTrack:function(e){for(var t=e.audioTracks(),i=t.length;i--;){var n=t[i];if(n.enabled)return n.language}return null},getSelectedTextTrack:function(e){for(var t=e.textTracks(),i=t.length;i--;){var n=t[i];if("showing"===n.mode)return n.language}return null},loadAsset:function(e,t,i,n,r){void 0===r&&(r=function(){});var a={assetId:t,programId:i,channelId:n};e.one(va.LOADED_DATA,function(){r(e.entitlement)}),e.startResetAndReloadTimer_&&e.startResetAndReloadTimer_(),e.src({type:"video/emp",src:JSON.stringify(a)})},currentAsset:function(e,t,i,n){if(!t&&!i&&!n){var r=e.cache_.source;return r&&r.src&&"video/emp"===r.type&&!r.streamInfo?xa(r.src):r&&r.assetId?{assetId:r.assetId,programId:r.programId,channelId:r.channelId}:null}Fa("Update currentAsset",t,i,n),"EmpCast"===e.techName_?e.cache_.source={type:"video/emp",src:JSON.stringify({assetId:t,programId:i,channelId:n})}:e.cache_.source&&"video/emp"===e.cache_.source.type?e.cache_.source.src=JSON.stringify({assetId:t,programId:i,channelId:n}):e.cache_.source&&e.cache_.source.assetId?(e.cache_.source.assetId=t,e.cache_.source.programId=i,e.cache_.source.channelId=n):e.cache_.source={type:"video/emp",src:JSON.stringify({assetId:t,programId:i,channelId:n})},"EmpCast"===e.techName_&&(e.cache_.sources=[e.cache_.source])},getAbsoluteTime:function(e){if(!e.tech_||void 0===e.tech_.getAbsoluteTime)return new Date(0);var t=this.getServerTime(e),i=e.tech_.getAbsoluteTime(t);if("EmpCast"!==e.techName_){var n=this.getEntitlement(e);i&&n&&n.isStaticCachupAsLive?i=new Date(i.getTime()+n.streamInfo.start.getTime()):n&&n.isDynamicCachupAsLive&&"HLS"===e.streamType&&(i=new Date(1e3*e.tech_.baseCurrentTime()+n.streamInfo.start.getTime()))}return i&&i.getTime?i:new Date(0)},getPlayheadTime:function(e){var t=this.getAbsoluteTime(e);return t?t.getTime():0},timeBehindLive:function(e){if(!e.tech_||void 0===e.tech_.timeBehindLive)return 0;var t=0,i=this.getServerTime(e),n=this.getEntitlement(e);return(t=n&&n.isStaticCachupAsLive?(i-this.getPlayheadTime(e))/1e3:e.tech_.timeBehindLive(i))!==1/0&&t?Math.round(t):0},liveDelay:function(e){var t=0;return this.isLive(e)&&(t=e.tech_&&void 0!==e.tech_.liveDelay?e.tech_.liveDelay():(this.getServerTime(e)-this.getSeekTimerange(e).end)/1e3),parseFloat(t+"").toFixed(2)},stop:function(e,t){e.stopProgramService&&e.stopProgramService(),e.sourceChanging_=!1,e.cache_.sources=[],e.tech_&&void 0!==e.tech_.stop?(e.techCall_("stop",t),e.techCall_("stopTrackingCurrentTime")):(e.techCall_("stopTrackingCurrentTime"),t&&t())},timeShiftEnabled:function(e){return!e.tech_||void 0===e.tech_.timeShiftEnabled||e.techGet_("timeShiftEnabled")},baseCurrentTime:function(e){return e.tech_&&void 0!==e.tech_.baseCurrentTime?e.techGet_("baseCurrentTime"):e.currentTime()},baseDuration:function(e){return e.tech_&&void 0!==e.tech_.duration?e.techGet_("duration"):0},startTimeLive:function(e){if(!e.tech_||void 0===e.tech_.startTimeLive)return 0;var t=this.getServerTime(e),i=e.tech_.startTimeLive(t),n=this.getEntitlement(e);return n&&n.isDynamicCachupAsLive&&"HLS"===e.streamType&&(i=n.streamInfo.referenceTime),n&&n.isStaticCachupAsLive&&"EmpCast"!==e.techName_&&(i=n.streamInfo.referenceTime),i},driftingTime:function(e){if(!e.tech_||!this.isLive(e)||"EmpShaka"!==e.techName_)return NaN;var t=this.getEntitlement(e);if(!t)return NaN;var i=e.tech_.getPresentationStartTime();return i=(t.streamInfo.referenceTime-i)/1e3,Math.round(i)},isLive:function(e){return!(!e.tech_||void 0===e.tech_.live)&&e.techGet_("live")},isCatchupAsLive:function(e){var t=this.getEntitlement(e);return!this.isLive(e)&&t&&t.live},getBitrate:function(e){return e.tech_&&void 0!==e.tech_.getBitrate?e.techGet_("getBitrate"):0},duration:function(e,t){return e.tech_&&void 0!==e.tech_.duration?(e.duration(t),e.techGet_("duration")):e.duration(t)},techVersion:function(e){return e.tech_&&void 0!==e.tech_.techVersion?e.techGet_("techVersion"):"2.x.x"},canSeekTo:function(e,t){if(!1===this.timeShiftEnabled(e)||!e.hasStarted())return!1;var i=this.getEntitlement(e);return!(i&&e.cache_&&!1===i.ffEnabled&&e.cache_.currentTime<=t)&&!(i&&e.cache_&&!1===i.rwEnabled&&e.cache_.currentTime>=t)},remainingTime:function(e){if(e.tech_&&void 0!==e.tech_.remainingTime)return e.techGet_("remainingTime");var t=e.duration();return t===1/0||0===t?1/0:t-e.currentTime()},casting:function(e,t){return!(!e.castPlugin||!e.castPlugin().canOverride("Cast"))&&(e.cache_.sources=t,e.cache_.source=t[0],e.castPlugin().cast(),!0)},setAbsoluteTime:function(e,t){if(e.tech_&&void 0!==e.tech_.setAbsoluteTime){var i=this.getServerTime(e);if("EmpCast"!==e.techName_){var n=this.getEntitlement(e);if(n&&n.isStaticCachupAsLive){if(t.getTime()<n.streamInfo.start.getTime())Fa("setAbsoluteTime","playPreviousProgram"),this.playProgram(e,t),t=0;else{if(t.getTime()>=n.streamInfo.end.getTime())return Fa("setAbsoluteTime","playNextProgram"),void this.playProgram(e,t);t=t.getTime()-n.streamInfo.start.getTime()}return void e.techCall_("setCurrentTime",t/1e3)}if(n&&n.isDynamicCachupAsLive)if(t.getTime()<n.streamInfo.start.getTime()){if(Fa("setAbsoluteTime","playPreviousProgram"),this.playProgram(e,t),"HLS"===e.streamType)return void e.techCall_("setCurrentTime",0);t=new Date(n.streamInfo.start.getTime())}else if("HLS"===e.streamType)return t-=n.streamInfo.start.getTime(),void e.techCall_("setCurrentTime",t/1e3)}e.techCall_("setAbsoluteTime",{date:t,nowDate:i})}else{var r=(t.getTime()-new Date(0))/1e3;e.currentTime(r)}},gotoLive:function(e){if(e.sourceChanging_)Fa("gotoLive ignore sourceChanging");else{var t=this.getEntitlement(e),i=e.programService().currentProgram,n=1e3*this.timeBehindLive(e)+this.getPlayheadTime(e);if(this.getIsProgramEvent(e)&&i&&t&&t.live&&n+5e3>=i.end.getTime())Fa("gotoLive ignore, livepoint is beyond event program end");else if(t&&!t.live&&e.isProgramEvent)Fa("gotoLive ignore, event program is not live");else if(e.tech_.gotoLive)e.techCall_("gotoLive");else if(t&&t.isDynamicCachupAsLive)this.setAbsoluteTime(e,new Date(e.getServerTime()));else if(t&&t.isStaticCachupAsLive){var r=this.currentAsset(e);r&&r.channelId&&e.startPlayback(null,r.channelId,null)}else if(this.isLive(e)){var a=e.duration();e.currentTime(a)}else Fa.warn("Not suppoted for VOD")}},setPlayheadTime:function(e,t){this.setAbsoluteTime(e,new Date(t))},supportsEpgProgramChange:function(e){if(e.tech_&&void 0!==e.tech_.supportsEpgProgramChange)return e.techGet_("supportsEpgProgramChange")},program:function(e){return e.tech_&&void 0!==e.tech_.program?e.techGet_("program"):null},playPreviousProgram:function(r,a){if(!r.sourceChanging_)return r.isProgramEvent?(Fa("playPreviousProgram ignore, isProgramEvent"),void r.gotoBeginning()):void(r.programService&&(r.sourceChanging_=!0,r.programService().getPreviousProgram(function(e,t){if(t)r.sourceChanging_=!1,Fa.warn("playPreviousProgram",t&&t.messsage?t.messsage:t);else{var i={};if(a){i.playFrom="startTime";var n=new Date(e.endTime);n.setSeconds(n.getSeconds()-30),i.startTime=n}else i.playFrom="beginning";r.startPlayback(e.assetId,e.channelId,e.programId,i)}})));Fa("playPreviousProgram ignore, sourceChanging")},playNextProgram:function(n){n.sourceChanging_||n.isProgramEvent?Fa("playNextProgram ignore"):n.programService&&n.programService().currentProgram?this.getServerTime(n)>n.programService().currentProgram.end.getTime()&&(n.sourceChanging_=!0,n.programService().getNextProgram(function(e,t){if(t)n.sourceChanging_=!1,Fa.warn("playNextProgram",t&&t.messsage?t.messsage:t);else{var i={playFrom:"beginning"};n.startPlayback(e.assetId,e.channelId,e.programId,i)}})):Fa.warn("playNextProgram No Current Program")},playProgram:function(n,r){n.sourceChanging_?Fa("playProgram ignore sourceChanging"):n.programService&&(n.sourceChanging_=!0,n.programService().getProgram(r,function(e,t){if(t)n.sourceChanging_=!1,Fa.warn("getProgram",t);else{var i={playFrom:"startTime"};i.startTime=r,n.startPlayback(e.assetId,e.channelId,e.programId,i)}}))},getServerTime:function(e){return e.programService&&e.programService()&&e.programService().exposure?e.programService().exposure.getCachedServerTime():Date.now()},getEntitlement:function(e){if(e.programService)return e.programService().entitlement();if(e.tech_){var t=e.tech_.options_;if(t&&t.source&&t.source.playSessionId)return t.source}return null},getIsProgramEvent:function(e){return!!e.programService&&e.programService().isProgramEvent},getSeekTimerange:function(e){var t={start:0,end:0};if(!e.tech_||void 0===e.tech_.seekable||e.seeking())return t;var i=e.techGet_("seekable");if(i&&0<i.length){var n=this.getEntitlement(e),r=0;if(n&&n.isDynamicCachupAsLive&&"HLS"===e.streamType&&(r=n.streamInfo.referenceTime),t.start=1e3*i.start(i.length-1)+r,t.end=1e3*i.end(i.length-1)+r,"EmpCast"===e.techName_){var a=this.liveDelay(e);t.end>this.getServerTime(e)-1e3*a&&(t.end=this.getServerTime(e)-1e3*a)}}return t},getBufferedTimerange:function(e){var t={start:0,end:0};if(!e.tech_||void 0===e.tech_.buffered||e.seeking())return t;var i=e.techGet_("buffered");return i&&0<i.length&&(t.start=Math.round(1e3*i.start(i.length-1)),t.end=Math.round(1e3*i.end(i.length-1))),t},setTechProgram:function(e,t){e.tech_&&void 0!==e.tech_.program&&e.techCall_("program",t)},setTechVOD:function(e,t){e.tech_&&void 0!==e.tech_.VOD&&e.techCall_("VOD",t)}},is=ga.getComponent("Button"),ns=ga.getComponent("Component"),rs=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).updateShowing(),i.on(i.player(),va.PLAYING,function(){return i.updateShowing()}),i.on(i.player(),va.DURATION_CHANGE,function(){return i.updateShowing()}),i.on(i.player(),va.TIME_UPDATE,function(){return i.timeUpdate()}),i.on(i.player(),va.ENDED,function(){return i.hide()}),i}ca(e,n);var t=e.prototype;return t.createEl=function(){var e=n.prototype.createEl.call(this,"button",{className:"emp-live-control vjs-control vjs-button"});return this.contentEl_=es("div",{className:"emp-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},t.updateShowing=function(){var e=this.player().getProgramDetails(),t=1e3*this.player().timeBehindLive()+this.player().playheadTime();!(ts.getIsProgramEvent(this.player())&&e&&this.entitlement&&this.entitlement.live&&t+5e3>=e.end.getTime())&&(this.player().isLive()&&!ts.getIsProgramEvent(this.player())||this.entitlement&&this.entitlement.isStaticCachupAsLive&&!ts.getIsProgramEvent(this.player())||this.entitlement&&this.entitlement.live)?this.show():this.hide()},t.timeUpdate=function(){if(this.player().isLive()||this.entitlement&&this.entitlement.isStaticCachupAsLive){var e=this.player().timeBehindLive();this.player().isLive()&&e<20?this.addClass("emp-live-edge"):this.removeClass("emp-live-edge")}},t.handleClick=function(){this.player().gotoLive()},ua(e,[{key:"entitlement",get:function(){return ts.getEntitlement(this.player())}}]),e}(is);function as(e,t){void 0===t&&(t=e),e=e<0?0:e;var i=Math.floor(e%60),n=Math.floor(e/60%60),r=Math.floor(e/3600),a=Math.floor(t/60%60),s=Math.floor(t/3600);return!isNaN(e)&&e!==1/0||(r=n=i="-"),(r=0<r||0<s?r+":":"")+(n=((r||10<=a)&&n<10?"0"+n:n)+":")+(i=i<10?"0"+i:i)}ns.registerComponent("EmpLiveDisplay",rs);var ss=ga.getComponent("Component"),os=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).on(i.player(),va.PLAYING,function(){return i.updateVisibility()}),i.on(i.player(),va.DURATION_CHANGE,function(){return i.updateVisibility()}),i.on(i.player(),va.SEEKED,function(){return i.updateVisibility()}),i.addClass("vjs-hidden"),i}ca(e,n);var t=e.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"emp-ad-marker"})},t.buildCSSClass=function(){return"emp-ad-marker "+n.prototype.buildCSSClass.call(this)},t.updateVisibility=function(){if(this.player_.duration()){var e=this.options_.element;e.offset+e.duration<this.player_.currentTime()?this.addClass("emp-ad-past"):this.removeClass("emp-ad-past");var t=e.offset/this.player_.duration();1<=t&&(t=1);var i=e.duration/this.player_.duration();1<=i&&(i=1),this.el_.style.left=(100*t).toFixed(2)+"%",this.el_.style.width=(100*i).toFixed(2)+"%",this.show()}},t.dispose=function(){n.prototype.dispose.call(this)},e}(ss);ss.registerComponent("EmpMarker",os);var ls=ga.getComponent("Component"),us=function(i){function e(e,t){return i.call(this,e,t)||this}return ca(e,i),e.prototype.update=function(i,n){var r=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var e=r.player_.duration(),t=as(n*e,e);r.el_.style.left=i.width*n+"px",r.getChild("timeTooltip").update(i,n,t)})},e}(ga.getComponent("MouseTimeDisplay"));ls.registerComponent("MouseTimeDisplay",us);var cs,hs,ds,fs,ps=T.navigator&&T.navigator.userAgent||"",ms=/AppleWebKit\/([\d.]+)/i.exec(ps),gs=(ms&&parseFloat(ms.pop()),/iPad/i.test(ps)),vs=0<=T.navigator.userAgent.indexOf("CrKey"),ys=/iPhone/i.test(ps)&&!gs,bs=/iPod/i.test(ps),_s=ys||gs||bs,Ts=((cs=ps.match(/OS (\d+)_/i))&&cs[1]&&cs[1],/Android/i.test(ps)),Ss=function(){var e=ps.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),i=e[2]&&parseFloat(e[2]);return t&&i?parseFloat(e[1]+"."+e[2]):t||null}(),Es=(Ts&&/webkit/i.test(ps),/Win/i.test(T.navigator.platform)),ws=/Firefox/i.test(ps),Cs=/Edge/i.test(ps),ks=/Edg/i.test(ps)&&!Cs,As=!ks&&!Cs&&/Chrome/i.test(ps),Is=((hs=ps.match(/Chrome\/(\d+)/))&&hs[1]&&parseFloat(hs[1]),/MSIE\s8\.0/.test(ps),ds=/MSIE\s(\d+)\.\d/.exec(ps),!(fs=ds&&parseFloat(ds[1]))&&/Trident\/7.0/i.test(ps)&&/rv:11.0/.test(ps)&&(fs=11),fs),xs=/Tizen/i.test(ps),Ps=/webOS/i.test(ps)||/Web0S/i.test(ps)||/WebOS/i.test(ps)||/NetCast/i.test(ps),Ls=/SmartTV/i.test(ps)||Ps||xs,Rs=/Safari/i.test(ps)&&!As&&!Ts&&!Cs&&!ks,Os=Cs||null!==Is;Za()&&("ontouchstart"in T||T.DocumentTouch&&(T.document,T.DocumentTouch)),Za()&&T.document.createElement("video").style;function Ds(){try{var e=T.navigator,t=T.screen,i=e.mimeTypes.length;return i+=e.userAgent.replace(/\D+/g,""),i+=e.plugins.length,i+=t.height||"",i+=t.width||"",i+=t.pixelDepth||""}catch(e){}return 0}var Ns=ga.getComponent("Component"),Ms=ga.getComponent("Slider"),Bs=vs||T.EMP_DEBUG_CHROMECAST?1e3:30,Us=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).markers=[],i.update=Ka(Va(ma(i),i.update),Bs),i.on(e,va.TIME_UPDATE,i.update),i.on(e,va.ENDED,i.handleEnded),i.on(e,va.AD_TIMELINE_CHANGED,i.updateMarkers),i.updateInterval=null,i.on(e,["playing"],function(){i.updateInterval&&(i.clearInterval(i.updateInterval),i.updateInterval=null),vs||T.EMP_DEBUG_CHROMECAST||(i.updateInterval=i.setInterval(function(){i.requestAnimationFrame(function(){i.update()})},Bs))}),i.on(e,["ended","pause","waiting"],function(){i.updateInterval&&(i.clearInterval(i.updateInterval),i.updateInterval=null)}),i.on(e,["timeupdate","ended"],i.update),i}ca(e,n);var t=e.prototype;return t.updateMarkers=function(e,t){var i=this.markers,n=Array.isArray(i),r=0;for(i=n?i:i[Symbol.iterator]();;){var a;if(n){if(r>=i.length)break;a=i[r++]}else{if((r=i.next()).done)break;a=r.value}var s=a;this.removeChild(s)}if(t&&t.timeline){var o=t.timeline.getAllElements(),l=Array.isArray(o),u=0;for(o=l?o:o[Symbol.iterator]();;){var c;if(l){if(u>=o.length)break;c=o[u++]}else{if((u=o.next()).done)break;c=u.value}if("advert"===c.type){var h=new os(this.player_,{element:c});this.markers.push(h),this.addChild(h),h.updateVisibility()}}}},t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},t.update_=function(e,t){var i=this.player_.duration();this.el_.setAttribute("aria-valuenow",(100*t).toFixed(2)),this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[as(e,i),as(i,i)],"{1} of {2}")),vs||T.EMP_DEBUG_CHROMECAST||this.bar.update(function(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach(function(e){void 0!==t[e]&&(i[e]=t[e])}),i.height||(i.height=parseFloat(Ja(e,"height"))),i.width||(i.width=parseFloat(Ja(e,"width"))),i}}(this.el_),t)},t.update=function(){var e=n.prototype.update.call(this);return this.update_(this.getCurrentTime_(),e),e},t.getCurrentTime_=function(){return this.player_.scrubbing()?(this.player_.getCache().currentTime,this.player_.getCache().currentTime):(this.player_.getCache().currentTime=this.player_.currentTime(),this.player_.currentTime())},t.handleEnded=function(){this.update_(this.player_.duration(),1);var e=this.markers,t=Array.isArray(e),i=0;for(e=t?e:e[Symbol.iterator]();;){var n;if(t){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var r=n;this.removeChild(r)}},t.getPercent=function(){var e=this.getCurrentTime_()/this.player_.duration();return 1<=e?1:e},t.handleMouseDown=function(e){this.player_.scrubbing(!0),n.prototype.handleMouseDown.call(this,e)},t.handleMouseMove=function(e){var t=this.calculateDistance(e)*this.player_.duration();t===this.player_.duration()&&(t-=.1),this.setCurrentTime(t)},t.setCurrentTime=function(e){var t=0===(this.player_.src()?this.player_.src():"").indexOf("offline:"),i=this.player_.buffered().start(0),n=this.player_.buffered().end(0);!(t||i<=e&&e<=n)&&this.player_.scrubbing()?this.player_.getCache().currentTime=e:this.player_.currentTime(e),this.player_.getCache().currentTime=e},t.throttleSetCurrentTime=function(e){null!==this.seekTimeoutId_&&T.clearTimeout(this.seekTimeoutId_);var t=this.player_.buffered().start(0),i=this.player_.buffered().end(0);t<=e&&e<=i?(this.player_.scrubbing(!1),this.player_.currentTime(e),this.player_.getCache().currentTime=e):(this.player_.scrubbing(!0),this.player_.getCache().currentTime=e,this.seekTimeoutId_=T.setTimeout(this.onSeekInputTimeout_.bind(this,e),1e3))},t.onSeekInputTimeout_=function(e){this.seekTimeoutId_=null,this.player_.scrubbing(!1),this.player_.currentTime(e),this.player_.getCache().currentTime=e},t.enable=function(){n.prototype.enable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.show()},t.disable=function(){n.prototype.disable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.hide()},t.handleMouseUp=function(e){n.prototype.handleMouseUp.call(this,e),this.player_.scrubbing(!1),this.setCurrentTime(this.player_.getCache().currentTime)},t.stepForward=function(){this.throttleSetCurrentTime(this.player_.getCache().currentTime+5)},t.stepBack=function(){this.throttleSetCurrentTime(this.player_.getCache().currentTime-5)},t.handleAction=function(){this.player_.paused()?this.player_.play():this.player_.pause()},t.handleKeyPress=function(e){32===e.which||13===e.which?(e.preventDefault(),this.handleAction(e)):n.prototype.handleKeyPress&&n.prototype.handleKeyPress.call(this,e)},e}(Ms);function Fs(e){var t;void 0!==(t=e)&&"function"==typeof t.then&&e.then(null,function(e){})}Us.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},Is&&!(8<Is)||_s||Ts||Us.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),Us.prototype.playerEvent="timeupdate",Ns.registerComponent("SeekBar",Us);var js=ga.getComponent("Button"),Hs=ga.getComponent("Component"),Gs=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).shouldRestart_=!0,i.updateShowing(),i.on(i.player(),va.LOADED_METADATA,i.updateShowing),i.on(i.player(),va.PLAYING,function(){i.shouldRestart_=!1,i.updateShowing()}),i.on(i.player(),va.ERROR,function(){i.shouldRestart_=!0}),e.on(va.PROGRAM_CHANGED,function(){return i.updateEnabled()}),e.on(va.DURATION_CHANGE,function(){return i.updateEnabled()}),i.updateEnabled(),i}ca(e,n);var t=e.prototype;return t.updateEnabled=function(){this.entitlement&&!this.entitlement.rwEnabled||!this.player().timeShiftEnabled()?(this.disable(),this.controlText("Restart restricted")):(this.enable(),this.show(),this.controlText("Restart"))},t.buildCSSClass=function(){return"emp-restart-control "+n.prototype.buildCSSClass.call(this)},t.updateShowing=function(){this.player().canRestart()?this.show():this.hide()},t.handleClick=function(){if(!0===this.shouldRestart_)this.player_.restart();else{this.player_.scrubbing(!0);var e=!this.player_.paused();this.player_.pause(),this.player_.currentTime(.1),this.player_.scrubbing(!1),e&&Fs(this.player_.play())}},ua(e,[{key:"entitlement",get:function(){return ts.getEntitlement(this.player())}}]),e}(js);Gs.prototype.controlText_="Restart",Hs.registerComponent("EmpRestartButton",Gs);var Vs=ga.getComponent("Button"),Ks=ga.getComponent("Component"),Ws=function(n){function e(e,t){var i;return t=Ta({seconds:30},t),(i=n.call(this,e,t)||this).controlText("Forward "+t.seconds+"s"),e.on(va.TIMESHIFT_CHANGE,function(){return i.updateEnabled()}),e.on(va.PROGRAM_CHANGED,function(){return i.updateEnabled()}),e.on(va.DURATION_CHANGE,function(){return i.updateEnabled()}),i.updateEnabled(),i}ca(e,n);var t=e.prototype;return t.updateEnabled=function(){this.entitlement&&!this.entitlement.ffEnabled||!this.player().timeShiftEnabled()?(this.disable(),this.controlText("Forward restricted")):(this.enable(),this.show(),this.controlText("Forward "+this.options_.seconds+"s"))},t.buildCSSClass=function(){return"emp-forward-control "+n.prototype.buildCSSClass.call(this)},t.handleClick=function(){if(!this.player().ended()){this.player().scrubbing(!0);var e=this.player().currentTime()+this.options_.seconds;this.player().currentTime(e),this.player().scrubbing(!1),this.player().vttThumbnails()&&this.player().vttThumbnails().hasThumbnail()&&this.player().vttThumbnails().showThumbnailHolder(!0)}},ua(e,[{key:"entitlement",get:function(){return ts.getEntitlement(this.player())}}]),e}(Vs);Ws.prototype.controlText_="Forward",Ks.registerComponent("EmpForwardButton",Ws);var qs=ga.getComponent("Button"),zs=ga.getComponent("Component"),Ys=function(n){function e(e,t){var i;return t=Ta({seconds:30},t),(i=n.call(this,e,t)||this).controlText("Rewind "+t.seconds+"s"),e.on(va.TIMESHIFT_CHANGE,function(){return i.updateEnabled()}),e.on(va.PROGRAM_CHANGED,function(){return i.updateEnabled()}),e.on(va.DURATION_CHANGE,function(){return i.updateEnabled()}),i.updateEnabled(),i}ca(e,n);var t=e.prototype;return t.updateEnabled=function(){this.entitlement&&!this.entitlement.rwEnabled||!this.player().timeShiftEnabled()?(this.disable(),this.controlText("Rewind restricted")):(this.enable(),this.show(),this.controlText("Rewind "+this.options_.seconds+"s"))},t.buildCSSClass=function(){return"emp-rewind-control "+n.prototype.buildCSSClass.call(this)},t.handleClick=function(){if(!this.player().ended()){this.player().scrubbing(!0);var e=this.player().currentTime()-this.options_.seconds;this.player().currentTime(e),this.player().scrubbing(!1),this.player().vttThumbnails()&&this.player().vttThumbnails().hasThumbnail()&&this.player().vttThumbnails().showThumbnailHolder(!0)}},ua(e,[{key:"entitlement",get:function(){return ts.getEntitlement(this.player())}}]),e}(qs);Ys.prototype.controlText_="Rewind",zs.registerComponent("EmpRewindButton",Ys);var Xs=ga.getComponent("Button"),$s=ga.getComponent("Component"),Js=function(i){function e(e,t){return i.call(this,e,t)||this}ca(e,i);var t=e.prototype;return t.buildCSSClass=function(){return"emp-reload-control "+i.prototype.buildCSSClass.call(this)},t.handleClick=function(){this.player_.restart()},e}(Xs);Js.prototype.controlText_="Reload",$s.registerComponent("EmpReloadButton",Js);var Qs=ga.getComponent("Component"),Zs=vs||T.EMP_DEBUG_CHROMECAST?1e3:30,eo=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).mode_=t.mode||"remainingTime",i.throttledUpdateContent=Ka(Va(ma(i),i.updateContent),Zs),i.on(e,va.TIME_UPDATE,i.throttledUpdateContent),i.on(e,va.DURATION_CHANGE,i.updateContent),e.on(va.ENDED,function(){i.hide()}),e.on(va.PLAYING,function(){i.show()}),i}ca(e,n);var t=e.prototype;return t.createEl=function(){var e="emp-time vjs-time-control vjs-remaining-time vjs-control";this.options_&&"remainingTime"===this.options_.mode?e+=" emp-remaining-time":e+=" emp-currentTime-time";var t=n.prototype.createEl.call(this,"div",{className:e});return this.contentEl_=es("div",{className:"emp-time-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Remaining Time")+"</span>0:00"},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},t.updateContent=function(){if("currentTime"===this.mode_){var e=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),t=this.localize("Current Time"),i=as(e,this.player_.duration());i!==this.formattedTime_&&(this.formattedTime_=i,this.contentEl_.innerHTML='<span class="vjs-control-text">'+t+"</span>"+i)}else{var n=this.player_.duration();if(n){var r,a=this.localize("Remaining Time");if(4294967295<n)(r="")!==this.formattedTime_&&(this.formattedTime_=r,this.contentEl_.innerHTML='<span class="vjs-control-text">'+a+"</span>"+r);else{var s=this.player_.remainingTime();s<0&&(s=0),(r=as(s))!==this.formattedTime_&&(this.formattedTime_=r,this.contentEl_.innerHTML='<span class="vjs-control-text">'+a+"</span>"+r)}}}},e}(Qs);Qs.registerComponent("EmpTimeDisplay",eo),Qs.registerComponent("EmpTimeDisplay2",eo);var to=ga.getComponent("Button"),io=ga.getComponent("Component"),no=function(r){function e(e,t,i){var n;return(n=r.call(this,e,t,i)||this).el_.setAttribute("aria-label","Stop Playback"),e.on(va.TIMESHIFT_CHANGE,function(){return n.onTimeshift()}),e.on(va.PLAYING,function(){return n.onTimeshift()}),e.on(va.ENDED,function(){return n.hide()}),n}ca(e,r);var t=e.prototype;return t.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.hide():this.show())},t.handleClick=function(){this.player()&&this.player().stop()},t.buildCSSClass=function(){return"emp-stop-control vjs-icon-square "+r.prototype.buildCSSClass.call(this)},e}(to);no.prototype.kind_="stop",no.prototype.controlText_="Stop",io.registerComponent("EmpStopButton",no);var ro=ga.getComponent("PlayToggle"),ao=ga.getComponent("Component"),so=function(r){function e(e,t,i){var n;return(n=r.call(this,e,t,i)||this).el_.setAttribute("aria-label","Play Toggle"),e.on(va.TIMESHIFT_CHANGE,function(){return n.onTimeshift()}),e.on(va.PLAYING,function(){return n.onTimeshift()}),n}ca(e,r);var t=e.prototype;return t.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.show():this.hide())},t.handleClick=function(e){r.prototype.handleClick.call(this,e)},t.buildCSSClass=function(){return""+r.prototype.buildCSSClass.call(this)},e}(ro);so.prototype.kind_="playToggle",so.prototype.controlText_="playToggle",ao.registerComponent("EmpPlayToggle",so);var oo=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).addClass("vjs-hidden"),e.ready(function(){i.initAirPlay()}),i}ca(e,n);var t=e.prototype;return t.initAirPlay=function(){var t=this.player();T.WebKitPlaybackTargetAvailabilityEvent&&t.el().getElementsByTagName("video")[0].addEventListener("webkitplaybacktargetavailabilitychanged",function(e){switch(e.availability){case"available":Fa("Airplay available"),t.on("loadeddata",function(){t.controlBar.childNameIndex_.hasOwnProperty("AirplayToggle")&&(this.entitlement&&this.entitlement.airplayBlocked?t.controlBar.airplayToggle.hide():t.controlBar.airplayToggle.show())});break;case"not-available":Fa("Airplay not-available")}})},t.buildCSSClass=function(){return"vjs-airplay-control "+n.prototype.buildCSSClass.call(this)},t.handleClick=function(){this.entitlement&&this.entitlement.airplayBlocked?Fa("Airplay Blocked"):(this.player().el().getElementsByTagName("video")[0].webkitShowPlaybackTargetPicker(),this.player().trigger(va.AIRPLAY_START))},ua(e,[{key:"entitlement",get:function(){return ts.getEntitlement(this.player())}}]),e}(ga.getComponent("Button"));oo.prototype.controlText_="Airplay",ga.registerComponent("AirplayToggle",oo);var lo=ga.getComponent("Button"),uo=ga.getComponent("Component"),co=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).controlText("Next program"),i.updateShowing(),i.on(i.player(),va.PLAYING,function(){return i.updateShowing()}),i.on(i.player(),va.DURATION_CHANGE,function(){return i.updateShowing()}),i.on(i.player(),va.PROGRAM_CHANGED,function(e,t){return i.updateShowing(t&&t.program)}),i}ca(e,n);var t=e.prototype;return t.updateShowing=function(e){e=e||this.player().getProgramDetails(),!this.player().noEPG()&&this.entitlement&&e&&!ts.getIsProgramEvent(this.player())?(this.show(),this.enable()):this.hide(),e&&Date.now()<e.end.getTime()&&this.disable(),this.entitlement&&(this.entitlement.isDynamicCachupAsLive||this.entitlement.isStaticCachupAsLive)||this.hide()},t.buildCSSClass=function(){return"emp-next-control "+n.prototype.buildCSSClass.call(this)},t.handleClick=function(){this.player().ended()||this.player().playNextProgram()},ua(e,[{key:"entitlement",get:function(){return ts.getEntitlement(this.player())}}]),e}(lo);co.prototype.controlText_="Next",uo.registerComponent("EmpNextButton",co);var ho=ga.getComponent("Button"),fo=ga.getComponent("Component"),po=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).controlText("Previous Program"),i.updateShowing(),i.on(i.player(),va.PLAYING,function(){return i.updateShowing()}),i.on(i.player(),va.DURATION_CHANGE,function(){return i.updateShowing()}),i.on(i.player(),va.PROGRAM_CHANGED,function(){return i.updateShowing()}),i}ca(e,n);var t=e.prototype;return t.updateShowing=function(){var e=this.player().getProgramDetails();!this.player().noEPG()&&this.entitlement&&e&&!ts.getIsProgramEvent(this.player())?this.show():this.hide(),this.entitlement&&(this.entitlement.isDynamicCachupAsLive||this.entitlement.isStaticCachupAsLive)||this.hide()},t.buildCSSClass=function(){return"emp-previous-control "+n.prototype.buildCSSClass.call(this)},t.handleClick=function(){this.player().ended()||this.player().playPreviousProgram()},ua(e,[{key:"entitlement",get:function(){return ts.getEntitlement(this.player())}}]),e}(ho);po.prototype.controlText_="Previous",fo.registerComponent("EmpPreviousButton",po);var mo=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).addClass("vjs-hidden"),e.ready(function(){i.initPip()}),i}ca(e,n);var t=e.prototype;return t.initPip=function(){var e=this;if(this.isPipSupported_){var t=this.player();Fa("picture-in-picture supported"),t.on(va.LOADED_DATA,function(){e.toggleShowing_()}),t.on(va.TRACK_CHANGE,function(){e.toggleShowing_()}),t.on(va.CHROMECAST_CASTING,function(){e.videoEl_&&e.exitPictureInPicture_()})}else Fa("picture-in-picture not supported")},t.exitPictureInPicture_=function(){if(this.isPipSupported_){if(M.pictureInPictureElement===this.videoEl_)return M.exitPictureInPicture(),!0;if("picture-in-picture"===this.videoEl_.webkitPresentationMode)return this.videoEl_.webkitSetPresentationMode("inline"),!0}return!1},t.toggleShowing_=function(){var e=this.player();e.controlBar.childNameIndex_.hasOwnProperty("PipToggle")&&(e.isAudioOnly()||e.isCasting()?e.controlBar.pipToggle.hide():e.controlBar.pipToggle.show())},t.buildCSSClass=function(){return"vjs-pip-button "+n.prototype.buildCSSClass.call(this)},t.handleClick=function(){if(this.videoEl_){var e=this.player();this.exitPictureInPicture_()||(this.isPipSupported_?!e.isPlaying()||e.isAudioOnly()||e.isCasting()||("pictureInPictureEnabled"in M?this.videoEl_.requestPictureInPicture():this.videoEl_.webkitSetPresentationMode("picture-in-picture"),e.trigger(va.PIP_START)):Fa("picture-in-picture not supported"))}},ua(e,[{key:"isPipSupported_",get:function(){return!!this.videoEl_&&(this.videoEl_.webkitSupportsPresentationMode&&"function"==typeof this.videoEl_.webkitSetPresentationMode||"pictureInPictureEnabled"in M)}},{key:"videoEl_",get:function(){return this.player().el()?this.player().el().getElementsByTagName("video")[0]:null}}]),e}(ga.getComponent("Button"));mo.prototype.controlText_="picture-in-picture",ga.registerComponent("PipToggle",mo);var go=ga.getComponent("MenuItem"),vo=ga.getComponent("Component"),yo=function(n){function e(e,t){var i;return Fa("PlaylistMenuItem","create"),t.label=t.source&&t.source.title?t.source.title:function(e){var t=e;try{var i=e.split("/"),n=i.pop().split("#")[0].split("?")[0];(t=n.substr(0,n.lastIndexOf("."))||n)&&0!==n.lastIndexOf(".")||(t=(n=i.pop().split("#")[0].split("?")[0]).substr(0,n.lastIndexOf("."))||n)}catch(e){}return t}(t.source.src),(i=n.call(this,e,t)||this).source=t.source,i.selected(i.source.selected),i}return ca(e,n),e.prototype.handleClick=function(){this.player().playList().currentSource(this.source)},ua(e,[{key:"itemAsset",get:function(){return xa(this.source.src)}}]),e}(go);vo.registerComponent("PlaylistMenuItem",yo);var bo=ga.getComponent("MenuButton"),_o=ga.getComponent("Component"),To=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).el_.setAttribute("aria-label","Playlist menu"),i.hide(),i.loadedDataBind=i.loadedData.bind(ma(i)),i.player_.on(va.LOADED_DATA,i.loadedDataBind),i.playListChangeBind=i.playListChange.bind(ma(i)),i.player_.on(va.PLAYLIST_CHANGE,i.playListChangeBind),i}ca(e,n);var t=e.prototype;return t.playListChange=function(){this.update()},t.loadedData=function(){this.items&&0<this.items.length&&this.show()},t.dispose=function(){this.player_.off(va.LOADED_DATA,this.loadedDataBind),this.player_.off(va.PLAYLIST_CHANGE,this.playListChangeBind),n.prototype.dispose.call(this)},t.buildCSSClass=function(){return"vjs-playlist-button vjs-icon-chapters "+n.prototype.buildCSSClass.call(this)},t.createItems=function(e){void 0===e&&(e=[]);var t=this.player_.playList?this.player_.playList().sources_:[];if(!t||1===t.length)return this.hide(),e;for(var i=0;i<t.length;i++){var n=t[i];e.push(new yo(this.player_,{selectable:!0,source:n}))}return this.show(),e},e}(bo);To.prototype.controlText_="Playlist",_o.registerComponent("PlaylistButton",To);var So=ga.getComponent("ControlBar"),Eo=ga.getComponent("Component"),wo=function(e){function t(){return e.apply(this,arguments)||this}return ca(t,e),t}(So);function Co(e,t){return Array.isArray(e)?ko(e):void 0===e||void 0===t?ko():ko([[e,t]])}function ko(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:Ao.bind(null,"start",0,e),end:Ao.bind(null,"end",1,e)}}function Ao(e,t,i,n){return void 0===n&&(Fa.warn("DEPRECATED: Function '"+e+"' on 'TimeRanges' called without an index argument."),n=0),function(e,t,i){if(t<0||i<t)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is greater than or equal to the maximum bound ("+i+").")}(e,n,i.length-1),i[n][t]}wo.prototype.options_={loadEvent:"play",children:{empPlayToggle:{},empReloadButton:{},empStopButton:{},empPreviousButton:{},empRewindButton:{},empForwardButton:{},empNextButton:{},volumePanel:{inline:!1},empTimeDisplay:{mode:"currentTime"},timeDivider:{},durationDisplay:{},empLiveDisplay:{},progressControl:{},empTimeDisplay2:{mode:"remainingTime"},customControlSpacer:{},empRestartButton:{},playbackRateMenuButton:{},chaptersButton:{},bitrateButton:{},audioTrackButton:{},subsCapsButton:{},playlistButton:{},pipToggle:{},airplayToggle:{},fullscreenToggle:{}}},Eo.registerComponent("ControlBar",wo);var Io=ga.getComponent("Component"),xo="#222",Po={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Lo(e,t){return"rgba("+parseInt(e[1]+e[1],16)+","+parseInt(e[2]+e[2],16)+","+parseInt(e[3]+e[3],16)+","+t+")"}var Ro=function(r){function e(i,e,t){var n;return n=r.call(this,i,e,t)||this,i.on("loadstart",Va(ma(n),n.toggleDisplay)),i.on("texttrackchange",Va(ma(n),n.updateDisplay)),i.on("loadstart",Va(ma(n),n.preselectTrack)),i.ready(Va(ma(n),function(){if(i.tech_&&i.tech_.featuresNativeTextTracks)this.hide();else if("DASH"!==i.streamType&&"HLS"!==i.streamType&&"EmpCast"!==i.techName_){i.on("fullscreenchange",Va(this,this.updateDisplay));for(var e=this.options_.playerOptions.tracks||[],t=0;t<e.length;t++)this.player_.addRemoteTextTrack(e[t],!0);this.preselectTrack()}else this.hide()})),n}ca(e,r);var t=e.prototype;return t.preselectTrack=function(){for(var e,t,i,n={captions:1,subtitles:1},r=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage,s=0;s<r.length;s++){var o=r[s];a&&a.enabled&&a.language===o.language?i=o.kind!==a.kind&&i||o:a&&!a.enabled?t=e=i=null:o.default&&("descriptions"!==o.kind||e?o.kind in n&&!t&&(t=o):e=o)}i?i.mode="showing":t?t.mode="showing":e&&(e.mode="showing")},t.toggleDisplay=function(){"DASH"===this.player_.streamType||"HLS"===this.player_.streamType||"EmpCast"===this.player_.techName_||this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},t.clearDisplay=function(){"function"==typeof T.WebVTT&&T.WebVTT.processCues(T,[],this.el_)},t.removeStyles=function(e){var t=M.getElementById(e);return t&&M.getElementsByTagName("head")[0].removeChild(t),t},t.writeStyles=function(e,t){var i=this.removeStyles(e);(i=M.createElement("style")).type="text/css",i.id=e,i.innerHTML=t,M.getElementsByTagName("head")[0].appendChild(i)},t.getStyle=function(e){var t,i,n,r,a,s,o,l,u,c;return e.color&&(t="color: "+e.color),e.textOpacity&&(t="color: "+Lo(e.color||"#fff",e.textOpacity)),e.backgroundColor&&(i="background-color: "+e.backgroundColor),e.backgroundOpacity&&(i="background-color: "+Lo(e.backgroundColor||"#000",e.backgroundOpacity)),e.windowColor&&(c=e.windowOpacity?"outline: "+Lo(e.windowColor,e.windowOpacity)+" solid 10px":"outline: "+e.windowColor+" solid 10px"),e.edgeStyle&&("dropshadow"===e.edgeStyle?n="text-shadow: 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, black 0.1em 0.1em 0.2em":"raised"===e.edgeStyle?n="text-shadow: 1px 1px #222, 2px 2px #222, 3px 3px "+xo:"depressed"===e.edgeStyle?n="text-shadow: 1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px "+xo:"uniform"===e.edgeStyle&&(n="text-shadow: 0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px "+xo)),e.fontPercent&&1!==e.fontPercent&&(r="font-size: "+e.fontPercent+"em",a="height: auto",s="top: auto",o="bottom: 2px"),e.fontFamily&&"default"!==e.fontFamily&&("small-caps"===e.fontFamily?l="font-variant: small-caps":u="font-family: "+Po[e.fontFamily]),(t?t+"; ":"")+(i?i+"; ":"")+(n?n+"; ":"")+(r?r+"; ":"")+(a?a+"; ":"")+(s?s+"; ":"")+(o?o+"; ":"")+(l?l+"; ":"")+(u?u+"; ":"")+(c?c+"; ":"")},t.getSafariStyle=function(e){var t;return e.backgroundColor&&(t="background-color: "+e.backgroundColor),e.backgroundOpacity&&(t="background-color: "+Lo(e.backgroundColor||"#000",e.backgroundOpacity)),t?"video::-webkit-media-text-track-display-backdrop {"+t+" !important;overflow: visible !important;}":""},t.updateDisplay=function(){if(this.player_.textTrackSettings){var e;e=this.player_.options_.textTrackStyle?this.player_.options_.textTrackStyle:this.player_.textTrackSettings.getValues();var t="styles_cue";if("DASH"===this.player_.streamType||"EmpHLS"===this.player_.techName_||"HLS"===this.player_.streamType){var i=this.getStyle(e);return"EmpHLS"===this.player_.techName_?this.writeStyles(t,"video::cue {"+i+"}\n"+this.getSafariStyle(e)):this.writeStyles(t,"video::cue {"+i+"}"),void this.clearDisplay()}this.removeStyles(t)}else this.writeStyles("style_no_texttrack_settings",".vjs-texttrack-settings {display: none;}")},t.updateForTrack=function(){},e}(Io);Io.registerComponent("TextTrackDisplay",Ro);var Oo=ga.getComponent("Component"),Do=ga.getComponent("ModalDialog"),No="vjs-text-track-settings",Mo=["#000","Black"],Bo=["#00F","Blue"],Uo=["#0FF","Cyan"],Fo=["#0F0","Green"],jo=["#F0F","Magenta"],Ho=["#F00","Red"],Go=["#FFF","White"],Vo=["#FF0","Yellow"],Ko=["1","Opaque"],Wo=["0.5","Semi-Transparent"],qo=["0","Transparent"],zo={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Mo,Go,Ho,Fo,Bo,Vo,jo,Uo]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[qo,Wo,Ko]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Go,Mo,Ho,Fo,Bo,Vo,jo,Uo]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]],default:4},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.25","25%"],["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["2.50","250%"]],default:3,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Ko,Wo]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[qo,Wo,Ko]}};function Yo(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}zo.windowColor.options=zo.backgroundColor.options;var Xo=function(n){function e(e,t){var i;return t.temporary=!1,(i=n.call(this,e,t)||this).updateDisplay=Va(ma(i),i.updateDisplay),i.fill(),i.hasBeenOpened_=i.hasBeenFilled_=!0,i.endDialog=es("p",{className:"vjs-control-text",textContent:i.localize("End of dialog window.")}),i.el().appendChild(i.endDialog),i.setDefaults(),void 0===t.persistTextTrackSettings&&(i.options_.persistTextTrackSettings=i.options_.playerOptions.persistTextTrackSettings),i.on(i.$(".vjs-done-button"),"click",function(){i.saveSettings(),i.close()}),i.on(i.$(".vjs-default-button"),"click",function(){i.setDefaults(),i.updateDisplay()}),_a(zo,function(e){i.on(i.$(e.selector),"change",i.updateDisplay)}),i.options_.persistTextTrackSettings&&i.restoreSettings(),i}ca(e,n);var t=e.prototype;return t.dispose=function(){this.endDialog=null,n.prototype.dispose.call(this)},t.createElSelect_=function(e,i,t){var n=this;void 0===i&&(i=""),void 0===t&&(t="label");var r=zo[e],a=r.id.replace("%s",this.id_);return["<"+t+' id="'+a+'" class="'+("label"===t?"vjs-label":"")+'">',this.localize(r.label),"</"+t+">",'<select aria-labelledby="'+(""!==i?i+" ":"")+a+'">'].concat(r.options.map(function(e){var t=a+"-"+e[1];return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+(""!==i?i+" ":"")+a+" "+t+'">',n.localize(e[1]),"</option>"].join("")})).concat("</select>").join("")},t.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},t.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},t.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},t.createElColors_=function(){return es("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},t.createElFont_=function(){return es("div",{className:'vjs-track-settings-font">',innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},t.createElControls_=function(){var e=this.localize("restore all settings to the default values");return es("div",{className:"vjs-track-settings-controls",innerHTML:['<button class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},t.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},t.label=function(){return this.localize("Caption Settings Dialog")},t.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},t.buildCSSClass=function(){return n.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},t.getValues=function(){var i,n,e,s=this;return n=function(e,t,i){var n,r,a=(n=s.$(t.selector),r=t.parser,Yo(n.options[n.options.selectedIndex].value,r));return void 0!==a&&(e[i]=a),e},void 0===(e={})&&(e=0),ba(i=zo).reduce(function(e,t){return n(e,i[t],t)},e)},t.setValues=function(i){var n=this;_a(zo,function(e,t){!function(e,t,i){if(t)for(var n=0;n<e.options.length;n++)if(Yo(e.options[n].value,i)===t){e.selectedIndex=n;break}}(n.$(e.selector),i[t],e.parser)})},t.setDefaults=function(){var i=this;_a(zo,function(e){var t=e.hasOwnProperty("default")?e.default:0;i.$(e.selector).selectedIndex=t})},t.restoreSettings=function(){var e;try{e=JSON.parse(T.localStorage.getItem(No))}catch(e){Fa.warn(e)}e&&this.setValues(e)},t.saveSettings=function(){var e=this.getValues();if(this.player_.options_.textTrackStyle=void 0,"EmpCast"===this.player_.techName_&&this.player_.techCall_("sendTextTrackStyle",e),this.options_.persistTextTrackSettings)try{Object.keys(e).length?T.localStorage.setItem(No,JSON.stringify(e)):T.localStorage.removeItem(No)}catch(e){Fa.warn(e)}},t.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},t.conditionalBlur_=function(){this.previouslyActiveEl_=null,this.off(M,"keydown",this.handleKeyDown);var e=this.player_.controlBar,t=e&&e.subsCapsButton,i=e&&e.captionsButton;t?t.focus():i&&i.focus()},e}(Do);Oo.registerComponent("TextTrackSettings",Xo);var $o=ga.getComponent("Component"),Jo=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).assetMetadata=null,i.on(i.player(),va.ENDED,function(){i.clearAll()}),i.on(i.player(),va.ABORT,function(){i.clearAll()}),i.on(i.player(),va.CHROMECAST_CASTING,function(){i.clearAll()}),i.on(i.player(),va.PLAYING,function(){i.getAssetMetadata_(),i.show()}),i.on(i.player(),va.PROGRAM_CHANGED,function(e,t){(t&&t.program?t.program.programId:null)?(i.assetMetadata=i.player().programService().extractAssetMetadata(t.program.asset),i.assetMetadata.channelInfo=t.program.channelInfo,i.updateMediaInformation_(i.assetMetadata)):i.player().options().mediaInfo&&i.player().options().mediaInfo.title||i.clearAll()}),i.on(i.player(),va.ASSET_CHANGED,function(e,t){t&&t.asset?(i.assetMetadata=i.player().programService().extractAssetMetadata(t.asset),i.updateMediaInformation_(i.assetMetadata)):i.player().options().mediaInfo&&i.player().options().mediaInfo.title||i.clearAll()}),i.on(i.player(),va.DISPOSE,function(){i.clearAll()}),i.fillEl(),i}ca(e,n);var t=e.prototype;return t.getAssetMetadata_=function(){var e=this.player().getProgramDetails(),t=e?e.asset:null;if(t=t||this.player().getAssetDetails())this.assetMetadata=this.player().programService().extractAssetMetadata(t),this.assetMetadata.channelInfo=e?e.channelInfo:null,this.updateMediaInformation_(this.assetMetadata);else{var i=this.player().options();i.mediaInfo&&this.updateMediaInformation_({title:i.mediaInfo.title,subtitle:i.mediaInfo.subtitle,images:i.mediaInfo.artworkUrl?[{url:i.mediaInfo.artworkUrl}]:[],channelInfo:{images:i.mediaInfo.logoUrl?[{url:i.mediaInfo.logoUrl}]:[]}})}},t.clearAll=function(){this.hide(),this.clearEl(),this.assetMetadata=null},t.buildCSSClass=function(){return"emp-mediainfo-bar "+n.prototype.buildCSSClass.call(this)},t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"emp-mediainfo-bar"})},t.imageSelector=function(e,t){var i;0<e.length&&(i=e[0]);for(var n=0;n<e.length;n++)if(e[n].url&&e[n].type===t)return e[n];return i},t.updateMediaInformation_=function(e){if(this.el_&&(this.show(),this.player().options().mediaInfo)){this.fillEl();var t=this.el_.getElementsByClassName("emp-media-artwork"),i=this.el_.getElementsByClassName("emp-media-logo"),n=this.el_.getElementsByClassName("emp-media-title"),r=this.el_.getElementsByClassName("emp-media-subtitle"),a=this.el_.getElementsByClassName("emp-media-text"),s=t.length?t[0]:null,o=i.length?i[0]:null,l=n.length?n[0]:null,u=r.length?r[0]:null,c=a.length?a[0]:null;if(l&&(l.innerHTML=e.title||""),u&&(u.innerHTML=e.subtitle||""),c&&(e.subtitle||e.title?c.style.display="block":c.style.display="none"),s&&e.images&&0<e.images.length){var h=this.imageSelector(e.images,"chromecast");s.style.backgroundImage='url("'+h.url+'")',s.style.display="block"}else s&&(s.style.display="none",s.style.backgroundImage="none");if(o&&e.channelInfo){var d=this.imageSelector(e.channelInfo.images,"thumbnail");d&&d.url?(o.style.backgroundImage='url("'+d.url+'")',o.style.display="block"):(o.style.display="none",o.style.backgroundImage="none")}this.player().userActive(!0)}},t.clearEl=function(){this.el_&&(this.el_.innerHTML="")},t.fillEl=function(){var e=this.player().options();if(e.mediaInfo){var t="";e.mediaInfo.artworkEnable&&(t+='<div class="emp-media-artwork"></div>'),(e.mediaInfo.titleEnable||e.mediaInfo.subtitleEnable)&&(t+='<div class="emp-media-text">'),e.mediaInfo.titleEnable&&(t+='<div class="emp-media-title"></div>'),e.mediaInfo.subtitleEnable&&(t+='<div class="emp-media-subtitle"></div>'),(e.mediaInfo.titleEnable||e.mediaInfo.subtitleEnable)&&(t+="</div>"),e.mediaInfo.logoEnable&&(t+='<div class="emp-media-logo"></div>'),this.el_.innerHTML=t}else this.el_.innerHTML=""},e}($o);Jo.prototype.controlText_="MediaInfo",$o.registerComponent("EmpMediaInfoBar",Jo);var Qo=function(n){function e(e,t){var i;return i=n.call(this,e,t)||this,Fa("vttThumbnailsPlugin","create"),i.options_=t||{src:"sprites/sprites.vtt"},i.enabled_=!0,i.registeredEvents={},i.scale=1,i.on(e,[va.FIRST_PLAY],function(){i.resetPlugin(),i.initializeThumbnails(),Fa("vttThumbnailsPlugin","FIRST_PLAY")}),i.on(e,[va.USERIN_ACTIVE],function(){i.thumbnailHolder&&(i.thumbnailHolder.style.opacity="0")}),i.on(e,[va.ENDED],function(){i.thumbnailHolder&&(i.thumbnailHolder.style.opacity="0")}),i}ca(e,n);var t=e.prototype;return t.src=function(e){this.resetPlugin(),this.options_.src=e,this.initializeThumbnails()},t.detach=function(){this.resetPlugin()},t.options=function(e){if(!e)return this.options_;this.options_=ga.mergeOptions(this.options_,e)},t.resetPlugin=function(){this.thumbnailHolder&&this.thumbnailHolder.parentNode.removeChild(this.thumbnailHolder),this.progressBar&&(this.progressBar.removeEventListener("mouseenter",this.registeredEvents.progressBarMouseEnter),this.progressBar.removeEventListener("mouseleave",this.registeredEvents.progressBarMouseLeave),this.progressBar.removeEventListener("mousemove",this.registeredEvents.progressBarMouseMove)),delete this.registeredEvents.progressBarMouseEnter,delete this.registeredEvents.progressBarMouseLeave,delete this.registeredEvents.progressBarMouseMove,delete this.progressBar,delete this.vttData,delete this.thumbnailHolder,delete this.lastStyle},t.initializeThumbnails=function(){var t=this;if(this.options_.src&&this.enabled_&&!this.player.isCasting()&&this.player.currentSource()&&this.player.currentSource().src&&!this.player.currentSource().isDynamicCachupAsLive&&!this.player.currentSource().isStaticCachupAsLive&&"video/emp"!==this.player.currentSource().type){var e=this.getBaseUrl_(),i=this.getFullyQualifiedUrl(this.options_.src,e);this.getVttFile(i).then(function(e){t.vttData=t.processVtt(e),t.setupThumbnailElement()})}},t.getBaseUrl_=function(){var e=Ra(this.player.currentSource().src);return Ra(e=e.replace(/\/$/,""))},t.getVttFile=function(n){var r=this;return new Promise(function(e,t){var i=new XMLHttpRequest;i.data={resolve:e},i.addEventListener("load",r.vttFileLoaded),i.open("GET",n),i.send()})},t.vttFileLoaded=function(){this.data.resolve(this.responseText)},t.setupThumbnailElement=function(){var e=this,t=this.player.$(".vjs-mouse-display");this.progressBar=this.player.$(".vjs-progress-control");var i=M.createElement("div");i.setAttribute("class","vjs-vtt-thumbnail-display"),this.progressBar.appendChild(i),this.thumbnailHolder=i,t&&t.classList.add("vjs-hidden"),this.registeredEvents.progressBarMouseEnter=function(){return e.onBarMouseenter()},this.registeredEvents.progressBarMouseLeave=function(){return e.onBarMouseleave()},this.progressBar.addEventListener("mouseenter",this.registeredEvents.progressBarMouseEnter),this.progressBar.addEventListener("mouseleave",this.registeredEvents.progressBarMouseLeave)},t.onBarMouseenter=function(){var t=this;this.mouseMoveCallback=function(e){t.onBarMousemove(e)},this.registeredEvents.progressBarMouseMove=this.mouseMoveCallback,this.progressBar.addEventListener("mousemove",this.registeredEvents.progressBarMouseMove),this.showThumbnailHolder()},t.onBarMouseleave=function(){this.registeredEvents.progressBarMouseMove&&this.progressBar.removeEventListener("mousemove",this.registeredEvents.progressBarMouseMove),this.hideThumbnailHolder()},t.getXCoord=function(e,t){var i=e.getBoundingClientRect(),n=M.documentElement;return t-(i.left+(T.pageXOffset||n.scrollLeft||0))},t.onBarMousemove=function(e){this.updateThumbnailStyle(this.getXCoord(this.progressBar,e.clientX),this.progressBar.offsetWidth)},t.getStyleForTime=function(e){for(var t=0;t<this.vttData.length;++t){var i=this.vttData[t];if(e>=i.start&&e<i.end)return i.css}},t.showThumbnailHolder=function(e){this.thumbnailHolder&&(e&&this.updateThumbnailStyle(this.player.currentTime()/this.player.duration()*this.progressBar.offsetWidth,this.progressBar.offsetWidth),this.thumbnailHolder.style.opacity="1")},t.hideThumbnailHolder=function(){this.thumbnailHolder&&(this.thumbnailHolder.style.opacity="0")},t.hasThumbnail=function(){return void 0!==this.thumbnailHolder},t.updateThumbnailStyle=function(e,t){var i=(1-(t-e)/t)*this.player.duration(),n=this.getStyleForTime(i);if(n){var r=Math.round((1-(t-e)/t)*t);if(this.options_.scale)this.scale=this.options_.scale;else{var a=this.player.currentWidth();this.scale=a<=300?.3:a/(parseInt(n.width,10)/160*160*5)}var s="",o="";if(1!==this.scale){var l=parseInt(n.height,10),u=Math.round((l*this.scale-l)/2/this.scale);o=" translateY("+(u*=-1)+"px)",r/=this.scale,s="scale("+this.scale+") "}var c=s+("translateX("+r+"px)")+o;if(this.thumbnailHolder.style.msTransform=c,this.thumbnailHolder.style.webkitTransform=c,this.thumbnailHolder.style.MozTransform=c,this.thumbnailHolder.style.transform=c,this.thumbnailHolder.style.marginLeft="-"+parseInt(n.width,10)/2+"px",this.thumbnailHolder.style.borderRadius="3px",!this.lastStyle||this.lastStyle!==n)for(var h in this.lastStyle=n)n.hasOwnProperty(h)&&(this.thumbnailHolder.style[h]=n[h])}else this.hideThumbnailHolder()},t.processVtt=function(e){var o=this,l=[];return e.split(/[\r\n][\r\n]/i).forEach(function(e){if(e.match(/([0-9]{2}:)?([0-9]{2}:)?[0-9]{2}(.[0-9]{3})?( ?--> ?)([0-9]{2}:)?([0-9]{2}:)?[0-9]{2}(.[0-9]{3})?[\r\n]{1}.*/gi)){var t=e.split(/[\r\n]/i),i=t[0].split(/ ?--> ?/i),n=i[0],r=i[1],a=t[1],s=o.getVttCss(a);l.push({start:o.getSecondsFromTimestamp(n),end:o.getSecondsFromTimestamp(r),css:s})}}),l},t.getFullyQualifiedUrl=function(e,t){return 0<=e.indexOf("//")?e:0===t.indexOf("//")?[t.replace(/\/$/gi,""),this.trim(e,"/")].join("/"):0<t.indexOf("//")?[this.trim(t,"/"),this.trim(e,"/")].join("/"):e},t.getPropsFromDef=function(e){var t=e.split(/#xywh=/i),i=t[0],n=t[1].match(/[0-9]+/gi);return{x:n[0],y:n[1],w:n[2],h:n[3],image:i}},t.getVttCss=function(e){var t,i={};if(t=0<=this.options_.src.indexOf("//")?this.options_.src.split(/([^\/]*)$/gi).shift():this.getBaseUrl_()+this.options_.src.split(/([^\/]*)$/gi).shift(),!(e=this.getFullyQualifiedUrl(e,t)).match(/#xywh=/i))return i.background='url("'+e+'")',i;var n=this.getPropsFromDef(e);return i.background='url("'+n.image+'") no-repeat -'+n.x+"px -"+n.y+"px",i.width=n.w+"px",i.height=n.h+"px",i},t.doconstructTimestamp=function(e){var t=e.split("."),i=t[0].split(":");return{milliseconds:parseInt(t[1],10)||0,seconds:parseInt(i.pop(),10)||0,minutes:parseInt(i.pop(),10)||0,hours:parseInt(i.pop(),10)||0}},t.getSecondsFromTimestamp=function(e){var t=this.doconstructTimestamp(e);return parseInt(3600*t.hours+60*t.minutes+t.seconds+t.milliseconds/1e3,10)},t.trim=function(e,t){var i=[" ","\n","\r","\t","\f","\v"," "," "," "," "," "," "," "," "," "," "," "," ","​","\u2028","\u2029","　"].join(""),n=0,r=0;for(e+="",t&&(i=(t+"").replace(/([[\]().?/*{}+$^:])/g,"$1")),n=e.length,r=0;r<n;r++)if(-1===i.indexOf(e.charAt(r))){e=e.substring(r);break}for(r=(n=e.length)-1;0<=r;r--)if(-1===i.indexOf(e.charAt(r))){e=e.substring(0,r+1);break}return-1===i.indexOf(e.charAt(0))?e:""},ua(e,[{key:"enabled",get:function(){return this.enabled_},set:function(e){this.enabled_=e}}]),e}(ga.getPlugin("plugin"));function Zo(e){if(e instanceof Zo)return e;"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:Sa(e)&&("number"==typeof e.code&&(this.code=e.code),e.message&&(this.message=e.message),e.status&&(this.status=e.status),Ta(this,e)),this.message||(this.message=Zo.defaultMessages[this.code]||"")}Qo.VERSION="2.2.124-498",ga.getPlugin("vttThumbnails")?ga.log.warn('A plugin named "vttThumbnails" already exists.'):ga.registerPlugin("vttThumbnails",Qo),Zo.prototype.code=0,Zo.prototype.message="",Zo.prototype.status=null,Zo.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],Zo.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var el=0;el<Zo.errorTypes.length;el++)Zo[Zo.errorTypes[el]]=el,Zo.prototype[Zo.errorTypes[el]]=el;function tl(e,t){if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;var i=e.cache_.sources.filter(function(e){return e.src===t});if(i.length)return i[0].type;for(var n=e.$$("source"),r=0;r<n.length;r++){var a=n[r];if(a.type&&a.src&&a.src===t)return a.type}return function(e){void 0===e&&(e="");var t=function(e){if("string"==typeof e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i.exec(e);if(t)return t.pop().toLowerCase()}return""}(e);return il[t.toLowerCase()]||""}(t)}var il={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"};var nl=function(n){function e(e,t){var i;return i=n.call(this,e,t)||this,Fa("PlaylistPlugin",vs?"Not on Chromecast":"create"),i.options_=t||{},i.sources_=[],vs||(i.playingChangedBind=i.playingChanged.bind(ma(i)),i.player.on(va.PLAYING,i.playingChangedBind),i.assetChangedBind=i.assetChanged.bind(ma(i)),i.player.on(va.ASSET_CHANGED,i.assetChangedBind),i.programChangedBind=i.programChanged.bind(ma(i)),i.player.on(va.PROGRAM_CHANGED,i.programChangedBind),i.onEndedBind=i.onEnded.bind(ma(i)),i.player.on(va.ENDED,i.onEndedBind),i.onChromecastQueChangeBind=i.onChromecastQueChange.bind(ma(i)),i.player.on(va.CC_QUE_CHANGE,i.onChromecastQueChangeBind)),i}ca(e,n);var t=e.prototype;return t.onChromecastQueChange=function(e,t){Fa("PlaylistPlugin:onChromecastQueChange",t),t&&t.sources?(this.sources_=t.sources,this.player.options_.playlist=!0,this.triggerChange_()):t&&t.contentId?this.selectSource_({assetId:t.contentId}):(this.clear(),this.player.options_.playlist=!1)},t.onEnded=function(){(!this.autoSequence||0<this.sources_.length&&this.index===this.sources_.length-1)&&(Fa("playlist: ended",this.autoSequence),this.trigger(va.ENDED))},t.playingChanged=function(){var e=this.player.currentAsset();e=e||{assetId:this.player.currentSrc()},this.selectSource_(e)},t.assetChanged=function(e,t){t&&t.asset&&this.selectSource_(t.asset)},t.programChanged=function(e,t){t&&t.program&&this.selectSource_(t.program)},t.clear=function(){this.sources_&&0<this.sources_.length&&(this.sources_=[],this.triggerChange_())},t.replay=function(){this.src(this.src())},t.dispose=function(){Fa("PlaylistPlugin","dispose"),this.player.off(va.PLAYING,this.playingChangedBind),this.player.off(va.ASSET_CHANGED,this.assetChangedBind),this.player.off(va.PROGRAM_CHANGED,this.programChangedBind),this.player.off(va.ENDED,this.onEndedBind),this.player.off(va.CC_QUE_CHANGE,this.onChromecastQueChangeBind),this.sources_=[],this.component_=null,n.prototype.dispose.call(this)},t.selectSource_=function(e){var t=this.index;this.setSelectedIndex_(-1);for(var i=0;i<this.sources_.length;i++){var n=xa(this.sources_[i].src);if(n=n||{assetId:this.sources_[i].src},e&&n&&(n.assetId===e.assetId||n.assetId===e.channelId)){this.setSelectedIndex_(i);break}}t!==this.index&&this.triggerChange_()},t.triggerChange_=function(){this.trigger(va.PLAYLIST_CHANGE),this.player.trigger(va.PLAYLIST_CHANGE)},t.src=function(e){var t=this;if(void 0===e)return this.sources_;if(this.player.isCreated){var i=Pa(e);if(i.length)if(i.forEach(function(e){e.type||(e.type="video/emp")}),this.sources_=i,"EmpCast"===this.player.techName_){for(var n=0;n<this.sources_.length;n++)if(this.sources_[n].selected||""===this.sources_[n].selected)return this.sources_[n].selected=!0,this.triggerChange_(),void this.player.src(this.sources_);this.sources_[0].selected=!0,this.triggerChange_(),this.player.src(this.sources_)}else{for(var r=0;r<this.sources_.length;r++)if(this.sources_[r].selected||""===this.sources_[r].selected)return this.sources_[r].selected=!0,this.index=r,void this.triggerChange_();this.sources_[0].selected=!0,this.index=0,this.triggerChange_()}else this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)}else this.one(va.PLAYER_CREATED,function(){t.src(e)})},t.next=function(){var e=this.index+1;e<this.sources_.length?this.index=e:Fa.warn("playlist: playing last source")},t.previous=function(){var e=this.index-1;-1<e?this.index=e:Fa.warn("playlist: playing first source")},t.setSelectedIndex_=function(e){for(var t=0;t<this.sources_.length;t++)this.sources_[t].selected=!1;-1<e&&(this.sources_[e>=this.sources_.length?this.sources_.length-1:e].selected=!0)},t.getSelectedIndex_=function(){for(var e=0;e<this.sources_.length;e++)if(this.sources_[e].selected)return e;return-1},t.currentSource=function(e){if(void 0===e){for(var t=0;t<this.sources_.length;t++)if(this.sources_[t].selected)return this.sources_[t]}else for(var i=0;i<this.sources_.length;i++){var n=xa(this.sources_[i].src),r=xa(e.src);if(n=n||{assetId:this.sources_[i].src},(r=r||{assetId:this.player.currentSrc()})&&n&&n.assetId===r.assetId)return this.index=i,!0}return!1},ua(e,[{key:"autoSequence",get:function(){return!(this.player&&!1===this.player.options_.autosequence)},set:function(e){this.player.options_.autosequence=e}},{key:"length",get:function(){return this.sources_.length}},{key:"index",get:function(){return this.getSelectedIndex_()},set:function(e){var t=this.index;-1<e&&this.sources_.length>e?(this.setSelectedIndex_(e),"EmpCast"!==this.player.techName_?this.player.src(this.sources.slice(e)):this.player.tech_.jumpToItem(e)):Fa.warn("playlist: index out of bounds",e),t!==this.index&&this.triggerChange_()}},{key:"sources",get:function(){for(var e=[],t=0;t<this.sources_.length;t++)e.push(Ta({},this.sources_[t]));return e}}]),e}(ga.getPlugin("plugin"));nl.VERSION="2.2.124-498",ga.getPlugin("playList")?ga.log.warn('A plugin named "PlaylistPlugin" already exists.'):ga.registerPlugin("playList",nl);var rl=ga.getComponent("Player"),al=ga.getComponent("Tech"),sl=ga.getComponent("CaptionSettingsMenuItem");T.vttjs&&T.vttjs.restore();var ol=function(o){function l(e,t,i){var n;void 0===t&&(t={}),void 0===i&&(i=function(){}),t.absoluteStartTime&&(t.startTime=0),"auto"===(t=Ta({children:["mediaLoader","PosterImage","textTrackDisplay","loadingSpinner","empMediaInfoBar","controlBar","errorDisplay","textTrackSettings","BigPlayButton"]},t)).techOrder||Array.isArray(t.techOrder)&&1===t.techOrder.length&&"auto"===t.techOrder[0]?t.techOrder=l.AutoTechArray("EmpShaka"):"auto-dashif"===t.techOrder||Array.isArray(t.techOrder)&&1===t.techOrder.length&&"auto-dashif"===t.techOrder[0]?t.techOrder=l.AutoTechArray("EmpDashif"):Array.isArray(t.techOrder)&&(t.techOrder=l.GetValidAutoTechOrder(t.techOrder));var r=l.getTagSettings(e),a=!Os&&!Ls;if((t=ga.mergeOptions({"entitlement-engine":"EricssonExposure",sources:r.sources?r.sources:void 0,techOrder:r.techOrder?r.techOrder:l.AutoTechArray("EmpShaka"),maxBitrate:r.maxBitrate?r.maxBitrate:0,timeShiftDisabled:!!r.timeShiftDisabled&&r.timeShiftDisabled,useLastViewedOffset:!!r.useLastViewedOffset&&r.useLastViewedOffset,startTime:r.startTime?r.startTime:0,absoluteStartTime:r.absoluteStartTime?r.absoluteStartTime:void 0,persistTextTrackSettings:r.persistTextTrackSettings?r.persistTextTrackSettings:a,textTrackSettings:r.textTrackSettings?r.textTrackSettings:a,playFrom:r.playFrom?r.playFrom:"defaultBehaviour"},t)).sources)for(var s=0;s<t.sources.length;s++){t.sources[s]=Ca(t.sources[s],{licenseserver:"licenseServer",certificateserver:"certificateServer",playtoken:"playToken",keysystems:"keySystems"}),Ia(t.sources[s].keySystems)&&(t.sources[s].keySystems=JSON.parse(t.sources[s].keySystems))}return(n=o.call(this,e,t,i)||this).monkeyPatchingTextMenu_(),T.empPlayer&&Fa.islogToBrowserConsole&&T.empPlayer.setInstance(ma(n)),n.previousAbsoluteStartTime_=void 0,n.castPlugin&&n.castPlugin(),n.eme&&n.eme(),t.enableThumbnails&&n.vttThumbnails&&n.vttThumbnails(),n.on(va.ENDED,function(){Fa("ENDED"),n.ended_=!0,n.sourceChanging_=!1,n.stopProgramService(),n.entitlementExpirationService&&n.entitlementExpirationService().stop(),"EmpCast"!==n.techName_&&!1!==n.options_.autosequence&&n.loadNextSource(),n.yospace&&n.yospace().stop()}),n.on(va.DISPOSE,function(){n.loadNextSrc_=null,n.loadingSrc_&&(clearInterval(n.loadingSrc_),n.loadingSrc_=null),n.sourceChanging_=!1,n.clearResetAndReloadTimer_(),n.stopProgramService(),n.entitlementExpirationService&&n.entitlementExpirationService().stop()}),n.on(va.ERROR,function(){n.loadNextSrc_=null,n.loadingSrc_&&(clearInterval(n.loadingSrc_),n.loadingSrc_=null),n.sourceChanging_=!1,n.clearResetAndReloadTimer_(),n.stopProgramService(),n.entitlementExpirationService&&n.entitlementExpirationService().stop(),n.yospace&&n.yospace().stop()}),n.on(va.CAN_PLAY,function(){n.disableTimeShift(n.options_.timeShiftDisabled)}),n.on(va.LOADED_DATA,function(){n.addClass("vjs-has-started"),n.ended_=!1,n.paused()&&n.autoplay()&&(n.handleTechLoadStart_(),!0===n.autoplay()&&n.paused()&&n.manualAutoplay_("any"))}),n.on(va.REPLAY,function(){if(n.playList&&0<n.playList().length)n.playList().replay();else if(n.cache_&&n.cache_.source&&n.cache_.source.yospaceUrl)n.src({src:n.cache_.source.yospaceUrl,type:"application/yospace"});else if(n.cache_&&n.cache_.source&&n.cache_.source.streamInfo){var e=n.currentAsset();n.src({type:"video/emp",src:JSON.stringify(e)})}else n.cache_&&n.cache_.source&&n.src(n.cache_.source)}),n.on(va.FIRST_PLAY,function(){Fa("FIRST_PLAY"),n.options_.startTime&&"Html5"===n.techName_&&n.currentTime(n.options_.startTime),n.options_.startTime=0}),n.initialSeekToAbsoluteStartTimeBind=n.initialSeekToAbsoluteStartTime_.bind(ma(n)),n.isCreated=!0,n.trigger(va.PLAYER_CREATED),n.ended_=!1,n.sourceChanging_=!1,n}ca(l,o);var e=l.prototype;return e.monkeyPatchingTextMenu_=function(){if(this.controlBar&&this.controlBar.subsCapsButton){var n=this.controlBar.subsCapsButton.createItems,r=this;this.controlBar.subsCapsButton.createItems=function(){for(var e=n.apply(this,arguments),t=[],i=0;i<e.length;i++)e[i].track&&""!==e[i].track.label&&t.push(e[i]);return t&&1<t.length&&"CaptionSettingsMenuItem"!==t[0].name()&&"EmpHLS"===r.techName_&&r.options_.textTrackSettings?(t.unshift(new sl(this.player_,{kind:this.label_})),this.hideThreshold_+=1):t&&1<t.length&&"CaptionSettingsMenuItem"===t[0].name()&&"EmpDashif"===r.techName_&&(t.shift(),--this.hideThreshold_),t}}if(Cs){var e=ga.getComponent("TextTrackMenuItem");if(e){var t=e.prototype.handleClick,i=this;e.prototype.handleClick=function(){t.apply(this,arguments),i.trigger(va.TRACK_CHANGE),i.trigger(va.TEXT_TRACK_CHANGE)}}}},e.options=function(e){return e&&("auto"===e.techOrder||Array.isArray(e.techOrder)&&1===e.techOrder.length&&"auto"===e.techOrder[0]?e.techOrder=l.AutoTechArray("EmpShaka"):"auto-dashif"===e.techOrder||Array.isArray(e.techOrder)&&1===e.techOrder.length&&"auto-dashif"===e.techOrder[0]?e.techOrder=l.AutoTechArray("EmpDashif"):Array.isArray(e.techOrder)&&(e.techOrder=l.GetValidAutoTechOrder(e.techOrder)),void 0!==e.startTime&&(e.startTime=parseFloat(e.startTime)||0),void 0!==e.absoluteStartTime&&(e.startTime=0),this.vttThumbnails&&void 0!==e.enableThumbnails&&(this.vttThumbnails().enabled=e.enableThumbnails||!1),this.options_=ga.mergeOptions(this.options_,e)),this.options_},e.getTechOptions_=function(){var e={};return Ta(e,this.options_[this.techName_.toLowerCase()]),Ta(e,{autoplay:this.options_.autoplay,muted:this.options_.muted,language:this.options_.language,maxBitrate:this.options_.maxBitrate,timeShiftDisabled:this.options_.timeShiftDisabled,useLastViewedOffset:this.options_.useLastViewedOffset,startTime:this.options_.startTime,absoluteStartTime:this.options_.absoluteStartTime,audioLanguage:this.options_.audioLanguage,subtitleLanguage:this.options_.subtitleLanguage,liveDelay:this.options_.liveDelay}),e},e.loadTech_=function(e,t){var n=this;o.prototype.loadTech_.call(this,e,t),this.on(this.tech_,va.RECOVERABLE_ASSET_ERROR,this.handleRecoverableError),this.on(this.tech_,va.ERROR,function(e,t){n.player_.error(t)}),this.on(this.tech_,va.TRACK_CHANGE,function(){Fa("TRACK_CHANGE"),n.player_.trigger(va.TRACK_CHANGE)}),this.on(this.tech_,va.PROGRAM_CHANGED,function(e,t){Fa("PROGRAM_CHANGED");var i=t&&t.program;i&&ts.currentAsset(n,i.assetId,i.programId,i.channelId),i?n.removeClass("vjs-live"):n.addClass("vjs-live"),n.trigger(va.PROGRAM_CHANGED,{program:i}),n.trigger(va.DURATION_CHANGE)}),this.on(this.tech_,va.ASSET_CHANGED,function(e,t){Fa("ASSET_CHANGED");var i=t&&t.asset;i&&ts.currentAsset(n,i.assetId),n.trigger(va.ASSET_CHANGED,{asset:i}),n.trigger(va.DURATION_CHANGE)}),this.on(this.tech_,va.DURATION_CHANGE,function(){n.player_.trigger(va.DURATION_CHANGE)})},e.loadNextSource=function(){if(!this.sourceChanging_)return this.sourceChanging_=!0,this.tech_&&void 0!==this.tech_.loadNextSource?(this.techCall_("loadNextSource"),!0):this.cache_.sources&&1<this.cache_.sources.length?(Fa("loadNextSource"),this.cache_.sources.shift(),this.src(this.cache_.sources),!0):this.sourceChanging_=!1;Fa("loadNextSource ignore sourceChanging")},e.setTextTrackStyle=function(e){"EmpCast"===this.techName_?this.techCall_("sendTextTrackStyle",e):(this.options_.textTrackStyle=e,this.trigger(va.TEXT_TRACK_CHANGE))},e.lineUpAsset=function(e,t,i,n,r){var a={assetId:e,programId:i,channelId:t};n&&this.options({playFrom:"startTime",absoluteStartTime:n,noPlaylist:r}),this.lineupSource({type:"video/emp",src:JSON.stringify(a)})},e.lineupSource=function(e){this.tech_&&void 0!==this.tech_.lineupSource?this.techCall_("lineupSource",e):this.cache_.sources.push(e)},e.unloadTech_=function(){this.techName_=null,o.prototype.unloadTech_.call(this),this.textTracksJson_=[]},e.stop=function(e){this.analytics&&this.analytics().stop(),this.yospace&&this.yospace().stop(),ts.stop(this,e)},e.getAvalibleTechs_=function(n){return this.options_.techOrder.map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).map(function(e){return[e,al.getTech(e)]}).filter(function(e){var t=e[0],i=e[1];if(i&&"Html5"!==t&&"EmpCast"!==t&&-1===n.indexOf(t))return i.isSupported()})},e.selectSource=function(e){var t=this,i=this.options_.techOrder;if(this.options_.excludeTechs&&0<this.options_.excludeTechs.length){var n=this.options_.techOrder.filter(function(e){if(-1===t.options_.excludeTechs.indexOf(e))return!0});this.options_.techOrder=n}var r=o.prototype.selectSource.call(this,e);return this.options_.techOrder=i,r},e.handleRecoverableError=function(e,t){var i=[];this.options_.excludeTechs&&(i=this.options_.excludeTechs.slice(0)),i.push(t.techName);var n=this.getAvalibleTechs_(i);!(!t.source||t.source.licenseServer||t.source.keySystems&&!wa(t.source.keySystems)||t.source.protection||vs)&&0<n.length&&(Fa.error("handleRecoverableError",t.techName,t.message),this.analytics&&this.analytics().onError({code:t.error.code,message:t.message,stack:t.error.stack}),this.options_.excludeTechs||(this.options_.excludeTechs=[]),this.options_.excludeTechs.push(t.techName),this.options_.techOrder.length>this.options_.excludeTechs.length)?this.resetAndRestart_(t):(t.error.code&&t.error.message?this.error(t.error):(t.message=t.message||this.localize("Tech error, can't recover"),this.error(new Ma(t.message,t.error.code))),this.resetWithoutReload_())},e.resetAndRestart_=function(e){if(this.error(null),this.resetWithoutReload_(),this.hasStarted()&&(this.options_.autoplay=vs||"any"),this.options_.absoluteStartTime=this.previousAbsoluteStartTime_,e.source.channelId){var t={assetId:e.source.assetId,channelId:e.source.channelId,programId:e.source.programId};o.prototype.src.call(this,{type:"video/emp",src:JSON.stringify(t)})}else if(e.source.assetId){var i={assetId:e.source.assetId};o.prototype.src.call(this,{type:"video/emp",src:JSON.stringify(i)})}},e.resetWithoutReload_=function(){this.tech_&&(this.techCall_("reset"),this.unloadTech_())},e.restartFormPlayhead=function(){this.resetAndRestartFormPlayhead(!1)},e.resetAndRestartFormPlayhead=function(e){void 0===e&&(e=!0),this.hasStarted()&&(this.options_.autoplay=vs||"any");var t=ts.currentAsset(this);t&&(this.cache_.source&&(this.cache_.source=void 0),ts.currentAsset(this,t.assetId,t.programId,t.channelId));var i=this.playheadTime();i=i||this.prePlayheadTime_,Fa("resetAndRestartFormPlayhead",i,e),e&&this.reset(),this.startResetAndReloadTimer_(),this.restart(null,i)},e.bitrates=function(){return ts.bitrates(this)},e.bitrate=function(e){return ts.bitrate(this,e)},e.getBitrate=function(){return ts.getBitrate(this)},e.selectAudioTrack=function(e,t){for(var i=this.audioTracks(),n=i.length;n--;){var r=i[n];if(r.language===e&&!r.enabled)return void(t&&r.kind!==t||(r.enabled=!0))}},e.getSelectedAudioTrack=function(){return ts.getSelectedAudioTrack(this)},e.getAudioTracksLanguages=function(){for(var e=[],t=this.audioTracks(),i=0;i<t.length;i++)e.push(t[i].language);return e},e.selectTextTrack=function(e,t){e=e&&"None"!==e?e:null;for(var i=this.textTracks(),n=i.length;n--;){var r=i[n];r.language===e?t&&r.kind!==t||(r.mode="showing"):"disabled"!==r.mode&&(r.mode="disabled")}"EmpHLS"===this.techName_&&Cs&&(this.trigger(va.TRACK_CHANGE),this.trigger(va.TEXT_TRACK_CHANGE))},e.getSelectedTextTrack=function(){return ts.getSelectedTextTrack(this)},e.textTrackVisible=function(e){for(var t=this.textTracks(),i=t.length;i--;){var n=t[i];if(e){if("hidden"===n.mode)return void(n.mode="showing")}else"showing"===n.mode?n.mode="hidden":"disabled"!==n.mode&&(n.mode="disabled")}},e.isTextTrackVisible=function(){for(var e=this.textTracks(),t=e.length;t--;){if("showing"===e[t].mode)return!0}return!1},e.getTextTracksLanguages=function(){for(var e=[],t=this.textTracks(),i=0;i<t.length;i++)e.push(t[i].language);return e},e.canSeekTo=function(e){return ts.canSeekTo(this,e)},e.getRestrictions=function(){var e={},t=ts.getEntitlement(this);return t&&(e={minBitrate:t.minBitrate,maxBitrate:t.maxBitrate,maxResWidth:t.maxResWidth,maxResHeight:t.maxResHeight,rwEnabled:t.rwEnabled,ffEnabled:t.ffEnabled}),e},e.isPlaying=function(){return this.hasStarted()},e.isLive=function(){return ts.isLive(this)},e.techVersion=function(){return ts.techVersion(this)},e.baseCurrentTime=function(){return ts.baseCurrentTime(this)},e.baseDuration=function(e){if(void 0===e)return ts.baseDuration(this);o.prototype.duration.call(this,e)},e.src=function(e){var t=this;if(void 0===e)return this.cache_.src||"";if(this.isCreated){if(!vs&&Array.isArray(this.options_.sources)&&0<this.options_.sources.length&&this.playList){var i=this.options_.sources;return this.options_.sources=[],void this.playList().src(i)}Array.isArray(e)?this.options_.playlist=!this.options_.noPlaylist||void 0:(!vs&&this.playList&&this.playList().clear(),this.options_.playlist=void 0),this.options_.noPlaylist=void 0,vs&&this.options_.hasMediaQueue&&(this.options_.playlist=!0);var n=Pa(e);if(n.length){if(n.forEach(function(e){e.type||(e.type="video/emp")}),"video/emp"===n[0].type){if(this.loadingSrc_)return Fa("load src blocked",e),void(this.loadNextSrc_=e);this.loadingSrc_=setTimeout(function(){t.loadingSrc_=null,t.loadNextSrc_&&t.src(t.loadNextSrc_)},3e3)}return this.loadNextSrc_=null,Fa("load src OK"),this.yospace&&this.yospace().stop(),this.options_.excludeTechs=[],this.tech_||this.reset(),this.cache_.currentTime=0,this.cache_.duration=NaN,this.error(null),"video/emp"!==n[0].type&&this.stopProgramService(),this.isPlaying()&&(this.trigger(va.ABORT),this.sourceChanging_=!0),ts.casting(this,n)?void 0:(n[0].options&&this.options(n[0].options),"video/emp"!==n[0].type&&(n[0].options=this.getTechOptions_()),this.off(va.LOADED_DATA,this.initialSeekToAbsoluteStartTimeBind),this.one(va.LOADED_DATA,this.initialSeekToAbsoluteStartTimeBind),"application/yospace"===n[0].type&&this.yospace?void this.yospace().start("VoD",n[0].src).then(function(e){Fa("yospace mediaLocator returned",e),t.options_.excludeTechs.push("EmpShaka"),t.options_.excludeTechs.push("EmpDashif"),n[0]={src:e,type:"application/x-mpegURL",yospaceUrl:n[0].src},o.prototype.src.call(t,n)}).catch(function(e){t.error(e)}):o.prototype.src.call(this,n))}this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)}else this.one(va.PLAYER_CREATED,function(){t.src(e)})},e.reset=function(){var i=this;this.clearResetAndReloadTimer_(),this.hasStarted(!1),this.options_.source=void 0,Object.keys(al.techs_).forEach(function(e){var t=i.options_[e.toLowerCase()];t&&"EmpCast"!==e&&t.source&&(t.source=void 0)}),o.prototype.reset.call(this)},e.clearResetAndReloadTimer_=function(){this.resetAndReloadTimer_&&(Fa("clearResetAndReloadTimer"),clearInterval(this.resetAndReloadTimer_),this.resetAndReloadTimer_=null)},e.startResetAndReloadTimer_=function(){var e=this;if(!(vs&&this.hasStarted()||(this.clearResetAndReloadTimer_(),Fa("startResetAndReloadTimer"),!1===this.options_.resetAndReloadLive))){var t=120;t=this.options_.resetAndReloadLive?1<this.options_.resetAndReloadLive?this.options_.resetAndReloadLive:1:vs?120:this.isLive()?360:1440,this.resetAndReloadTimer_=this.setTimeout(function(){e.clearResetAndReloadTimer_(),e.resetAndRestartFormPlayhead()},1e3*t*60)}},e.initialSeekToAbsoluteStartTime_=function(){var e=ts.getEntitlement(this);e&&e.streamInfo.event&&e.streamInfo.live&&!this.isLive()&&(e.live=!1,e.streamInfo.live=!1,e.streamInfo.static=!0,e.isDynamicCachupAsLive=!1,e.isStaticCachupAsLive=!0),e&&e.streamInfo.event&&e.streamInfo.static&&this.baseDuration()!==1/0&&0<this.baseDuration()&&1e3*this.baseDuration()+e.streamInfo.startTime<e.streamInfo.endTime&&(e.streamInfo.endTime=1e3*this.baseDuration()+e.streamInfo.startTime,e.streamInfo.end=new Date(e.streamInfo.endTime),e.lastViewedOffset=0,e.lastViewedTime=0,e.liveTime=0),this.options_.absoluteStartTime&&this.timeShiftEnabled()&&(this.setAbsoluteTime(new Date(this.options_.absoluteStartTime)),this.previousAbsoluteStartTime_=this.options_.absoluteStartTime,this.options_.absoluteStartTime=void 0)},e.setMaxBitrate=function(e){this.options_.maxBitrate=e,this.tech_&&void 0!==this.tech_.setMaxBitrate&&this.techCall_("setMaxBitrate",e)},e.getMaxBitrate=function(){return this.tech_&&void 0!==this.tech_.getMaxBitrate?this.techGet_("getMaxBitrate"):0},e.disableTimeShift=function(e){if(!this.tech_||void 0===this.tech_.disableTimeShift)return!1;if(void 0===e)return!ts.timeShiftEnabled(this);if(!1===e&&!this.canEnableTimeshift())return!ts.timeShiftEnabled(this);this.techCall_("disableTimeShift",e);var t=ts.timeShiftEnabled(this);return this.options_.timeShiftDisabled=void 0===t?e:!t,this.trigger(va.TIMESHIFT_CHANGE,{timeShiftDisabled:this.options_.timeShiftDisabled}),this.options_.timeShiftDisabled},e.canEnableTimeshift=function(){var e=ts.getEntitlement(this);return!e||!1!==e.timeshiftEnabled},e.timeShiftEnabled=function(e){if(void 0===e)return ts.timeShiftEnabled(this);this.disableTimeShift(!e)},e.noEPG=function(){if(this.getProgramDetails())return!1;var e=ts.getEntitlement(this);return!e||e&&(e.isDynamicCachupAsLive||e.isStaticCachupAsLive)},e.canRestart=function(){return!ts.getEntitlement(this)||!this.noEPG()&&ts.canRestart(this)},e.restart=function(e,t){ts.restart(this,e,t)},e.error=function(e){return void 0===e?this.error_||null:null!==e?this.error_&&e&&4===e.code?this.error_:(e&&Ia(e)?e=new Ma(e):Sa(e)&&!e.code&&(e.code=Na.UNKNOWN),Sa(e)&&this.cache_.sources&&1<this.cache_.sources.length?(Fa.error(e),this.loadNextSource(),e):this.videojsError_(e)):void o.prototype.error.call(this,e)},e.videojsError_=function(e){if(void 0===e)return this.error_||null;if(null===e)return this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new Zo(e),this.addClass("vjs-error");var t="";Zo.errorTypes.hasOwnProperty(this.error_.code)&&(t=Zo.errorTypes[this.error_.code]),Fa.error("(CODE:"+this.error_.code+" "+t+")",this.error_.message,this.error_),this.trigger({type:va.ERROR,bubbles:!0},this.error_)},e.getError=function(){return this.error_},e.setAbsoluteTime=function(e){ts.setAbsoluteTime(this,e)},e.getAbsoluteTime=function(){return ts.getAbsoluteTime(this)},e.playheadTime=function(e){if(void 0===e)return ts.getPlayheadTime(this);ts.setPlayheadTime(this,e)},e.setAnalyticsCustomAttribute=function(e,t){this.options_.analytics||(this.options_.analytics={}),this.options_.analytics.customAttributes||(this.options_.analytics.customAttributes=[]),this.options_.analytics.customAttributes.push({key:e,value:t})},e.loadAsset=function(e,t,i){if(void 0===i&&(i=function(){}),Fa.warn("loadAsset() has been deprecated with new US a/v pipe use startPlayback() or src() instead"),this.options({playFrom:void 0}),!e&&t)return Fa.error("loadAsset: with only programId is not supported"),void i();ts.loadAsset(this,t?void 0:e,t,t?e:void 0,i)},e.startPlaybackV2=function(e,t){this.startPlayback(e,"","",t)},e.startPlayback=function(e,t,i,n){if(n=n||{},e||t||i)if(e||t||!i){n.playFrom||(n.playFrom="defaultBehaviour");var r={playFrom:n.playFrom,autoplay:vs||"any"};void 0!==n.autoplay&&(r.autoplay=n.autoplay),n.startTime&&"startTime"===n.playFrom?(r.absoluteStartTime=n.startTime,this.options_.useLastViewedOffset=!1):r.absoluteStartTime=void 0,void 0!==n.startOffset?r.startTime=n.startOffset/1e3:r.startTime=0,r.useLastViewedOffset="bookmark"===n.playFrom||!0===this.options_.useLastViewedOffset,this.options(r),ts.loadAsset(this,e,i,t)}else Fa.error("startPlayback: with only programId is not supported");else Fa.error("startPlayback: assetId or channelId or programId is undefined")},e.playEntitlement=function(e){e&&Sa(e)?(e.type="video/emp",o.prototype.src.call(this,e)):Fa.error("Call playEntitlement without entitlement")},e.timeBehindLive=function(){return ts.timeBehindLive(this)},e.liveDelay=function(){return ts.liveDelay(this)},e.startTimeLive=function(){return ts.startTimeLive(this)},e.driftingTime=function(){return ts.driftingTime(this)},e.getCurrentTechName=function(){return this.techName_},e.getExposure=function(){return this.programService?this.programService().exposure:null},e.syncServerTime=function(e){if(this.programService){var t=this.programService().exposure;if(t)return void t.syncServerTime(e)}var i="No programService or No exposure";Fa.error(i),e&&e(0,i)},e.stopProgramService=function(){this.programService&&this.programService().reset()},e.startProgramService=function(){this.programService&&this.programService().start()},e.supportsEpgProgramChange=function(){return void 0!==this.programService},e.getServerTime=function(){return ts.getServerTime(this)},e.getProgram=function(e){if(this.programService){var t=this.getProgramDetails();e(t,t?null:"No EPG for program")}},e.getProgramDetails=function(){return ts.supportsEpgProgramChange(this)?ts.program(this):this.programService?this.programService().currentProgram:null},e.getAssetDetails=function(){return this.tech_&&this.tech_.VOD&&this.techGet_("VOD")?this.techGet_("VOD"):this.programService?this.programService().currentVOD:null},e.getSeekTimerange=function(){return ts.getSeekTimerange(this)},e.getBufferedTimerange=function(){return ts.getBufferedTimerange(this)},e.currentTime=function(e){var t=ts.getEntitlement(this);if(t&&(t.isDynamicCachupAsLive||t.isStaticCachupAsLive)&&"EmpCast"!==this.techName_){if(void 0!==e){var i=this.getProgramDetails();if(i){e<1&&-1<e&&(e=1);var n=new Date(i.startTime);if(t.isStaticCachupAsLive||"HLS"===this.streamType){var r=t.streamInfo;if((e+=(n.getTime()-r.start.getTime())/1e3)<=0)return e=0,void ts.playPreviousProgram(this,!0)}else if(1e3*(e+=n.getTime()/1e3)<=t.streamInfo.start.getTime())return e=t.streamInfo.start.getTime()/1e3+1,void ts.playPreviousProgram(this,!0)}return e<0&&(e=0),void this.techCall_("setCurrentTime",e)}var a=this.techGet_("currentTime")||0,s=this.getProgramDetails();if(s&&1<a){var o=new Date(s.startTime);if(t.isStaticCachupAsLive||"HLS"===this.streamType){var l=t.streamInfo;a-=(o.getTime()-l.start.getTime())/1e3}else a-=o.getTime()/1e3}else s||this.duration(1/0);return this.scrubbing()||(this.cache_.currentTime=a),this.cache_.currentTime}return void 0!==e?(t&&(t.isDynamicCachupAsLive||t.isStaticCachupAsLive)&&"EmpCast"===this.techName_||(e=e<0?0:e),void this.techCall_("setCurrentTime",e)):(this.scrubbing()||(this.cache_.currentTime=this.techGet_("currentTime")||0),this.cache_.currentTime)},e.duration=function(e){var t=ts.getEntitlement(this);if(t&&(t.isDynamicCachupAsLive||t.isStaticCachupAsLive)&&"EmpCast"!==this.techName_){if(void 0!==e){var i=this.getProgramDetails();if(i&&e!==1/0){var n=new Date(i.startTime);if(t.isStaticCachupAsLive||"HLS"===this.streamType){var r=t.streamInfo;e-=(n.getTime()-r.start.getTime())/1e3}else e-=n.getTime()/1e3}return this.noEPG()&&(e=1/0,this.addClass("vjs-live")),void o.prototype.duration.call(this,e)}var a=this.techGet_("duration"),s=this.getProgramDetails();return s&&a!==1/0&&(this.isProgramEvent&&s.duration/1e3>a||(a=s.duration/1e3)),this.noEPG()&&(a=1/0,this.addClass("vjs-live")),this.cache_.duration=a}return o.prototype.duration.call(this,e),this.techGet_("duration")},e.seekable=function(){var e=o.prototype.seekable.call(this);return"EmpCast"!==this.techName_?this.getRange_(e):e},e.buffered=function(){var e=o.prototype.buffered.call(this);return"EmpCast"!==this.techName_?this.getRange_(e):e},e.getRange_=function(e){var t=ts.getEntitlement(this);if(this.seeking()||!e)return Co(0,0);if(0<e.length&&t&&(t.isDynamicCachupAsLive||t.isStaticCachupAsLive)){var i=this.getProgramDetails();if(i){var n=new Date(i.startTime),r=t.streamInfo,a=e.start(e.length-1),s=e.end(e.length-1);if(s)if(t.isStaticCachupAsLive||"HLS"===this.streamType)e=Co(0<(a-=(n.getTime()-r.start.getTime())/1e3)?a:0,(s-=(n.getTime()-r.start.getTime())/1e3)>this.duration()?this.duration():s);else if(t.isDynamicCachupAsLive){a-=n.getTime()/1e3,s-=n.getTime()/1e3;var o=this.getGrowingLiveDuration();e=Co(0<a?a:0,o<s?o:s)}}}return e},e.getGrowingLiveDuration=function(){var e=ts.getEntitlement(this),t=this.duration(),i=this.getProgramDetails();if(i&&t!==1/0&&e&&e.isDynamicCachupAsLive)if(this.getServerTime()<new Date(i.endTime).getTime()){if((t=this.techGet_("duration"))!==1/0){var n=e.streamInfo;t="HLS"===this.streamType?(n.start.getTime()+1e3*t-i.start.getTime())/1e3:(1e3*t-i.start.getTime())/1e3}}else t=i.duration/1e3;return t},e.remainingTime=function(){var e=ts.getEntitlement(this),t=0;if(e&&(e.isDynamicCachupAsLive||e.isStaticCachupAsLive)&&"EmpCast"!==this.techName_){var i=this.duration();if(i===1/0||0===i)return 1/0;t=i-this.currentTime()}else t=ts.remainingTime(this);return t<0&&(t=0),Math.round(t)},e.gotoLive=function(){ts.gotoLive(this)},e.gotoBeginning=function(){this.scrubbing(!0);var e=!this.paused();this.pause(),this.currentTime(0),this.scrubbing(!1),e&&Fs(this.play())},e.playPreviousProgram=function(i){var n=this;if(this.sourceChanging_||this.isProgramEvent)Fa("playPreviousProgram ignore, sourceChanging");else{if(this.isProgramEvent)return Fa("playPreviousProgram ignore, isProgramEvent"),void this.gotoBeginning();if(this.tech_.playPreviousProgram)this.techCall_("playPreviousProgram",i);else{var e=ts.getEntitlement(this);this.programService&&(e.isStaticCachupAsLive||e.isDynamicCachupAsLive)&&e.rwEnabled?this.programService().getPreviousProgram(function(e,t){t?Fa.warn("playPreviousProgram",t):i?n.playheadTime(e.end.getTime()-3e4):n.playheadTime(e.start.getTime()+1e3)}):ts.playPreviousProgram(this)}}},e.playNextProgram=function(){var i=this;if(this.sourceChanging_||this.isProgramEvent)Fa("playNextProgram ignore");else if(this.tech_.playNextProgram)this.techCall_("playNextProgram");else{var e=ts.getEntitlement(this),n=this.getProgramDetails();n&&(e.isStaticCachupAsLive||e.isDynamicCachupAsLive)&&e.ffEnabled?this.programService().getNextProgram(function(e,t){t&&Fa.warn("playNextProgram",t),i.playheadTime(n.end.getTime()+1e3)}):ts.playNextProgram(this)}},e.isProgramLive=function(){var e=this.getProgramDetails();return e?e.end.getTime()>this.getServerTime():this.isLive()},e.isProgramCatchup=function(){var e=ts.getEntitlement(this);return e?e.isStaticCachupAsLive||!this.isProgramLive()&&e.isDynamicCachupAsLive:!this.isLive()},e.currentAsset=function(){return ts.currentAsset(this)},e.ended=function(){return this.ended_},e.handleTechWaiting_=function(){var t=this;!this.hasStarted()||this.ended()||this.paused()||this.hasClass("vjs-waiting")||this.playheadMoving_(function(e){e||(t.addClass("vjs-waiting"),t.trigger(va.WAITING),t.removeWaitingClass_())})},e.removeWaitingClass_=function(){var e=this;this.one("timeupdate",function(){1<e.playheadTime()-e.prePlayheadTime_||e.playheadTime()-e.prePlayheadTime_<-1?(e.prePlayheadTime_=0,e.removeClass("vjs-waiting"),e.paused()?e.trigger(va.PAUSE):e.trigger(va.PLAYING)):e.removeWaitingClass_()})},e.playheadMoving_=function(e){this.playheadMovingTimer_&&(clearInterval(this.playheadMovingTimer_),this.playheadMovingTimer_=null),this.prePlayheadTime_=this.playheadTime(),this.playheadMovingTimer_=this.setTimeout(function(){e(200<this.playheadTime()-this.prePlayheadTime_||this.playheadTime()-this.prePlayheadTime_<-200)},2e3)},e.handleTechCanPlay_=function(){this.prePlayheadTime_||this.removeClass("vjs-waiting"),this.trigger(va.CAN_PLAY)},e.handleTechCanPlayThrough_=function(){this.prePlayheadTime_||this.removeClass("vjs-waiting"),this.trigger(va.CAN_PLAY_THROUGH)},e.handleTechPlaying_=function(){this.prePlayheadTime_||this.removeClass("vjs-waiting"),this.sourceChanging_=!1,this.trigger(va.PLAYING)},e.sourceChanging=function(){return this.sourceChanging_},e.isCasting=function(){if("EmpCast"===this.techName_){var e=this.castPlugin().get("ChromecastSender");if(e){var t=e.castSession();return t&&"connected"===t.status}}return!1},e.isAudioOnly=function(){var e=this.bitrates();return!(0<e.length&&0<e[0])},e.updateSourceCaches_=function(e){void 0===e&&(e="");var t=e,i="";"string"!=typeof t&&(t=e.src,i=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!i&&(i=tl(this,t)),this.cache_.source=function i(){for(var n={},e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.forEach(function(e){e&&_a(e,function(e,t){Ea(e)?(Ea(n[t])||(n[t]={}),n[t]=i(n[t],e)):n[t]=e})}),n}({},e,{src:t,type:i}),this.cache_.src=t},ua(l,[{key:"isProgramEvent",get:function(){return ts.getIsProgramEvent(this)}},{key:"version",get:function(){return"2.2.124-498"}},{key:"entitlement",get:function(){var e=ts.getEntitlement(this);return e&&((e=Ta({},e)).options=void 0),e}},{key:"streamType",get:function(){if(this.tech_)return this.tech_.streamType}}]),l}(rl);ol.AutoTechArray=function(e){var t=al.techs_.hasOwnProperty("EmpShaka"),i=al.techs_.hasOwnProperty("EmpDashif");t&&i||(e=t?"EmpShaka":"EmpDashif");var n=[e,"EmpHLS-MSE","EmpHLS","EmpSmooth","Html5"];return ol.SupportFairplay()&&(n=["EmpHLS",e,"Html5"]),ol.GetValidAutoTechOrder(n)},ol.GetValidAutoTechOrder=function(e){for(var t=[],i=0;i<e.length;i++)al.techs_.hasOwnProperty(e[i])&&t.push(e[i]);return t},ol.SupportFairplay=function(){var e=ga.getTech("EmpHLS");return!!(void 0!==e&&e.isSupported()&&T.WebKitMediaKeys&&e.getKeySystem&&T.WebKitMediaKeys.isTypeSupported(e.getKeySystem(),"video/mp4"))},ga.getComponent("Component").registerComponent("Player",ol);var ll=function(){function e(e,t,i){this.INITIAL_REFERENCE_TIME=1,this.player_=e,this.analytics_=t,this.analytics_.afterSendData_=this.onDataSent.bind(this),this.sessionId_=null,this.customAttributes=i.analytics&&i.analytics.customAttributes,this.exposure=i.exposure,this.currentTimeTimer=null,this.onPlayBind=this.onPlay.bind(this),this.onResumedBind=this.onResume.bind(this),this.onPlayingBind=this.onPlaying.bind(this),this.onPauseBind=this.onPause.bind(this),this.onEndedBind=this.onEnded.bind(this),this.onErrorBind=this.onError.bind(this),this.onDrmSessionUpdateBind=this.onDrmSessionUpdate.bind(this),this.onEntitlementLoadStartBind=this.onEntitlementLoadStart.bind(this),this.onBitrateChangeBind=this.onBitrateChange.bind(this),this.onDisposeBind=this.onDispose.bind(this),this.onLoadStartBind=this.onLoadStart.bind(this),this.onSeekedBind=this.onSeeked.bind(this),this.onWaitingBind=this.onWaiting.bind(this),this.onChromeCastingStartBind=this.onChromeCastingStart.bind(this),this.onChromeCastingStopBind=this.onChromeCastingStop.bind(this),this.onProgramChangeBind=this.onProgramChange.bind(this),this.onWaitingEndedBind=this.onWaitingEnded.bind(this),this.onErrorBeforeAssetBind=this.onErrorBeforeAsset.bind(this),this.onEntitlementChangeBind=this.onEntitlementChange.bind(this),this.onWindowUnloadBind=this.onWindowUnload.bind(this),this.onPlayingAfterStartBind=this.onPlayingAfterStart.bind(this),this.allEvents_=Object.keys(va).map(function(e){return va[e]}),this.init(),this.createdSessions={},this.mem={}}var t=e.prototype;return t.SessionId=function(e){if(!(e||this.entitlement()&&this.entitlementLoaded_))return this.errorSessionId;var t=e||this.entitlement().playSessionId;return this.mem[t]||(this.mem[t]={pause:{},resume:{}}),t},t.hasSessionId=function(){return!(!this.entitlement()||!this.entitlementLoaded_)},t.sendCurrentTime=function(){var e=this.SessionId();e&&this.player_&&this.analytics_.getSessionState&&"PLAYING"===this.analytics_.getSessionState(e)&&this.analytics_.setCurrentTime(e,this.OffsetTime())},t.registerCurrentTimeTimer=function(){var t=this;this.clearTimers(),this.currentTimeTimer=setInterval(function(){t.sendCurrentTime();var e=t.SessionId();e&&t.analytics_&&t.analytics_.ok&&!1===t.analytics_.ok(e)&&(t.exposure?t.exposure.verifySession(function(){t.player_.resetAndRestartFormPlayhead()},function(){t.player_.el_&&(t.player_.trigger(va.ERROR,"401 INVALID_SESSION_TOKEN: The session token is no longer valid."),ts.stop(t.player_)),t.clearTimers()}):Fa.error("registerCurrentTimeTimer Exposure is undefined"))},1e3)},t.clearTimers=function(){this.currentTimeTimer&&clearInterval(this.currentTimeTimer),this.currentTimeTimer=null},t.init=function(){this.player_&&this.analytics_?(this._errorSessionId=null,this.disabled_=!1,this.entitlementLoaded_=!1,Fa("Initialization EmpAnalytics"),this.analytics_.init(),T.addEventListener("beforeunload",this.onWindowUnloadBind),this.player_.on(va.ENTITLEMENT_LOAD_START,this.onEntitlementLoadStartBind),this.player_.on(va.PAUSE,this.onPauseBind),this.player_.on(va.SEEKED,this.onSeekedBind),this.player_.on(va.ENDED,this.onEndedBind),this.player_.on(va.ERROR,this.onErrorBind),this.player_.on(va.DISPOSE,this.onDisposeBind),this.player_.on(va.STOPPED,this.onDisposeBind),this.player_.on(va.BITRATE_CHANGED,this.onBitrateChangeBind),this.player_.on(va.WAITING,this.onWaitingBind),this.player_.on(va.CHROMECAST_CASTING,this.onChromeCastingStartBind),this.player_.on(va.CHROMECAST_STOPPED,this.onChromeCastingStopBind),this.player_.on(va.PROGRAM_CHANGED,this.onProgramChangeBind),this.player_.on(va.DRM_SESSION_UPDATE,this.onDrmSessionUpdateBind)):Fa.warn("Warning: init failed . Possible causes: either player or analytics were not set.")},t.onWindowUnload=function(){var e=this;this.onGeneric("WindowClose",this.analytics_.dispose,function(){!0===e.hasSessionId()&&e.analytics_.dispose(e.SessionId(),e.getCachedCurrentTime()),e.analytics_.dispatchNow(!1),e.clearTimers()},!0)},t.onChromeCastingStart=function(){var t=this;this.onGeneric("StartCasting",this.analytics_.startCasting,function(){if(!1!==t.hasSessionId()){if(t.SessionId()){var e=t.getCachedCurrentTime();Fa("StartCasting",e),t.analytics_.startCasting(t.SessionId(),e)}t.clearTimers()}},!1),this.disabled_=!0},t.onChromeCastingStop=function(e){var t=this;this.disabled_=!1,e&&this.onGeneric("StopCasting",this.analytics_.stopCasting,function(){!1!==t.hasSessionId()&&t.analytics_.stopCasting(t.SessionId(),t.OffsetTime())},!1)},t.onProgramChange=function(e,t){var i=this,n=t?t.program:null;Fa("analytics","onProgramChange",n),n&&this.analytics_.programChanged&&this.player_.hasStarted()&&this.onGeneric("ProgramChange",this.analytics_.programChanged,function(){i.analytics_.programChanged(i.SessionId(),i.OffsetTime(),{programId:n.programId})},!0)},t.onEntitlementChange=function(e,t,n){var r=this;this.entitlementLoaded_=!0,this.player_.off(va.ERROR,this.onErrorBeforeAssetBind);var a=this.entitlement(t&&t.entitlement);this.onGeneric("HandShake",this.analytics_.handshake,function(){var e={};if(a&&a.assetId&&(e.assetId=a.assetId),a&&a.programId&&(e.programId=a.programId),!a){var t=ts.currentAsset(r.player_);t&&(e.assetId=t.assetId,e.channelId=t.channelId,e.programId=t.programId)}var i=a?a.playSessionId:n;r.analytics_.handshake(r.SessionId(i),e),r.onLoadStart(i)},!1)},t.onEntitlementLoadStart=function(){var e=this;this.entitlementLoaded_=!1,this.onGeneric("ExitOngoingSession",this.analytics_.exitOngoingSession,function(){return e.analytics_.exitOngoingSession(e.getCachedCurrentTime())}),this.player_.one(va.ERROR,this.onErrorBeforeAssetBind),this.player_.one(va.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind)},t.onDataSent=function(e,t){Fa("onDataSent",e,t),e&&t&&e.getTime()>t.getTime()+6e5&&this.player_.resetAndRestartFormPlayhead()},t.onLoadStart=function(e){var i=this,n=e||this.SessionId();n?this.sessionCreated(n)||(this.createdSessions[n]=!0,this.onGeneric("Created",this.analytics_.created,function(){var e=i.player_.options(),t={version:i.playerVersion};e&&e.autoplay&&(t.autoplay=!0),i.entitlement()&&i.entitlement().requestId&&(t.requestId=i.entitlement().requestId),i.analytics_.created(n,t)},!1),this.player_.off(va.PLAYING,this.onResumedBind),this.player_.off(va.PLAYING,this.onPlayingAfterStartBind),this.player_.one(va.PLAYING,this.onPlayingAfterStartBind)):Fa("onLoadStart called but not session available.")},t.onPlayingAfterStart=function(){this.onPlayBind(),this.onPlayingBind(),this.player_.on(va.PLAYING,this.onResumedBind)},t.onBitrateChange=function(){var t=this;this.onGeneric("BitrateChange",this.analytics_.bitrateChanged,function(){var e={bitrate:Math.max(0,Math.round(t.getBitrate()/1e3))};t.analytics_.bitrateChanged(t.SessionId(),t.OffsetTime(),e)},!0)},t.onWaiting=function(){var t=this;this.onGeneric("StartWaiting",this.analytics_.waiting,function(){t.player_.hasStarted()&&t.analytics_.waiting(t.SessionId(),t.OffsetTime()),t.allEvents_.map(function(e){e!==va.PLAY&&e!==va.PLAYING&&e!==va.ENDED&&e!==va.ERROR&&e!==va.DISPOSE&&e!==va.SEEKED&&e!==va.CHROMECAST_CASTING&&e!==va.CHROMECAST_STOPPED||t.player_.one(e,t.onWaitingEndedBind)})},!0)},t.OffsetTime=function(){return this.entitlement()&&(this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive)?ts.getPlayheadTime(this.player_)/1e3:ts.baseCurrentTime(this.player_)},t.startTimeLive=function(){return ts.startTimeLive(this.player_)},t.isLive=function(){return ts.isLive(this.player_)},t.getBitrate=function(){return ts.getBitrate(this.player_)},t.duration=function(){return this.entitlement()&&(this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive)&&this.player_.getProgramDetails&&this.player_.getProgramDetails()?Math.round(this.player_.getProgramDetails().duration/1e3):Math.round(ts.duration(this.player_))},t.entitlement=function(e){return void 0===e?ts.getEntitlement(this.player_)||this.entitlement_:this.entitlement_=e},t.onWaitingEnded=function(){var t=this;this.allEvents_.map(function(e){t.player_.off(e,t.onWaitingEndedBind)}),this.onGeneric("WaitingEnded",this.analytics_.waitingEnded,function(){t.analytics_.waitingEnded(t.SessionId(),t.OffsetTime())},!0)},t.onDispose=function(){var e=this;this.onGeneric("Dispose",this.analytics_.dispose,function(){!1!==e.hasSessionId()&&(e.analytics_.dispose(e.SessionId(),e.getCachedCurrentTime()),e.clearTimers())},!0,!0)},t.getCachedCurrentTime=function(){if(this.player_){var e=this.player_.getCache().currentTime,t=this.OffsetTime();return t||e}},t.onEnded=function(){var e=this;this.onGeneric("End of Stream",this.analytics_.endOfStream,function(){e.analytics_.endOfStream(e.SessionId()),e.clearTimers()},!0,!0)},t.onPlay=function(){var i=this;this.onGeneric("Play",this.analytics_.play,function(){var e="Unknown";switch(i.player_.techName_){case"EmpShaka":e="Shaka";break;case"EmpDashif":e="DashIf";break;case"EmpHLS":e="NativeHLS";break;case"EmpHLS-MSE":e="HLS-MSE"}var t={techName:e,version:i.playerVersion,techVersion:i.techVersion};i.analytics_.play(i.SessionId(),i.OffsetTime(),t),i.registerCurrentTimeTimer()},!1)},t.onPlaying=function(){var t=this;this.onGeneric("Playing",this.analytics_.playing,function(){var e={};e.bitrate=Math.max(0,Math.round(t.getBitrate()/1024)),!0===t.isLive()?e.referenceTime=t.startTimeLive():e.duration=t.duration(),t.entitlement()&&t.entitlement().mediaLocator&&(e.mediaLocator=t.entitlement().mediaLocator),e.mediaLocator&&0<=e.mediaLocator.indexOf(".isml")&&(e.referenceTime=t.INITIAL_REFERENCE_TIME),t.analytics_.clearCustomAttributes(),(t.customAttributes||[]).map(function(e){t.analytics_.setCustomAttribute(e.key,e.value)}),t.analytics_.playing(t.SessionId(),t.OffsetTime(),e)},!1)},t.onSeeked=function(){var e=this;this.onGeneric("Seeked",this.analytics_.seek,function(){e.analytics_.seek(e.SessionId(),e.OffsetTime())},!0)},t.onPause=function(){var i=this;this.onGeneric("Pause",this.analytics_.paused,function(){if(!1!==i.player_.hasStarted()){var e=i.SessionId(),t=parseInt(new Date/25,10);i.mem[e].pause[t]||(i.mem[e].pause[t]=!0,i.analytics_.paused(e,i.OffsetTime()))}},!0)},t.onResume=function(){var i=this;this.onGeneric("Resume",this.analytics_.resume,function(){var e=i.SessionId(),t=parseInt(new Date/25,10);i.mem[e].resume[t]||(i.mem[e].resume[t]=!0,i.analytics_.resume(e,i.OffsetTime()))},!0)},t.onErrorBeforeAsset=function(){this.entitlementLoaded_=!1,this.onEntitlementChange(null,null,this.errorSessionId),this.onError(null,this.errorSessionId),this.clearTimers()},t.onError=function(a,s){var o=this;void 0===a&&(a=null),void 0===s&&(s=null),(s||this.entitlementLoaded_)&&this.onGeneric("Error",this.analytics_.error,function(){var e=o.player_.error(),t={};e&&e.code&&(t.errorCode=e.code),e&&e.message&&(t.errorMessage=e.message),e&&e.status&&(t.errorDetails=e.status+""),e&&e.stack&&(t.errorDetails=t.errorDetails?t.errorDetails+"\n"+e.stack.toString():e.stack.toString());var i=o.player_.options();if(o.player_.tech_){var n="EmpShaka"===o.player_.techName_&&i&&i.empshaka?i.empshaka.streamType:"";t.errorInfo=o.player_.techName_+(n?"-"+n:"")}else t.errorInfo="Unknown tech, techOrder: "+i.techOrder.toString();!e&&a&&(t.errorCode=a.code,t.errorMessage=a.message?a.message:"Browser Error",a.status&&(t.errorDetails=a.status+""),a.stack&&(t.errorDetails=t.errorDetails?t.errorDetails+"\n"+a.stack.toString():a.stack.toString()));var r=o.SessionId();(r||s)&&o.analytics_.error(r||s,o.OffsetTime(),t),o.clearTimers()},!1)},t.onDrmSessionUpdate=function(e,t){var i=this;Fa("onDrmSessionUpdate",e,t),this.onGeneric("DrmSessionUpdate",this.analytics_.drmSessionUpdate,function(){i.analytics_.drmSessionUpdate(i.SessionId(),{message:t.messageType,code:t.code,info:t.info})},!0)},t.onGeneric=function(e,t,i,n,r){void 0===r&&(r=!1),!this.disabled_||r?n&&!this.sessionCreated(this.SessionId())?Fa(e+" was discarded."):t&&i&&i():Fa(e+" not delivered: analytics disabled.")},t.sessionCreated=function(e){return e&&this.createdSessions[e]},t.dispose=function(){this.clearTimers(),this.analytics_&&(this.analytics_.exitOngoingSession(this.getCachedCurrentTime()),this.analytics_.dispatchNow(!1)),T.removeEventListener("beforeunload",this.onWindowUnloadBind),this.player_.off(va.PLAY,this.onPlayBind),this.player_.off(va.PLAYING,this.onPlayingBind),this.player_.off(va.PLAYING,this.onResumedBind),this.player_.off(va.PAUSE,this.onPauseBind),this.player_.off(va.SEEKED,this.onSeekedBind),this.player_.off(va.ENTITLEMENT_LOAD_START,this.onEntitlementLoadStartBind),this.player_.off(va.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.player_.off(va.BITRATE_CHANGED,this.onBitrateChangeBind),this.player_.off(va.ENDED,this.onEndedBind),this.player_.off(va.DISPOSE,this.onDisposeBind),this.player_.off(va.STOPPED,this.onDisposeBind),this.player_.off(va.ERROR,this.onErrorBind),this.player_.off(va.ERROR,this.onErrorBeforeAssetBind),this.player_.off(va.WAITING,this.onWaitingBind),this.player_.off(va.CHROMECAST_CASTING,this.onChromeCastingStartBind),this.player_.off(va.CHROMECAST_STOPPED,this.onChromeCastingStopBind),this.player_.off(va.PROGRAM_CHANGED,this.onProgramChangeBind),this.player_.off(va.PLAYING,this.onPlayingAfterStartBind),this.player_.off(va.DRM_SESSION_UPDATE,this.onDrmSessionUpdateBind)},ua(e,[{key:"techVersion",get:function(){return ts.techVersion(this.player_)}},{key:"playerVersion",get:function(){return this.player_.version?this.player_.version:T.videojs?T.videojs.VERSION:"2.x.x"}},{key:"errorSessionId",get:function(){return this._errorSessionId||(this._errorSessionId="error-"+Math.random().toString().split(".")[1]),this._errorSessionId}}]),e}(),ul=e(t(function(e){var t,n=(t=T)&&"object"==typeof t&&"default"in t?t.default:t,c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==_?_:"undefined"!=typeof self?self:{};function r(e,t){return o.set(e,t),t}function a(e){var t=o.get(e),i=void 0===t?e.size:2147483648<t?0:t+1;if(!e.has(i))return r(e,i);if(e.size<1073741824){for(;e.has(i);)i=Math.floor(2147483648*Math.random());return r(e,i)}if(e.size>l)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;e.has(i);)i=Math.floor(Math.random()*l);return r(e,i)}var i,s=(function(l,u){(function(){var M={function:!0,object:!0}[typeof window]&&window||this,i=u,e=l&&!l.nodeType&&l,t=i&&e&&"object"==typeof c&&c;!t||t.global!==t&&t.window!==t&&t.self!==t||(M=t);var a=Math.pow(2,53)-1,B=/\bOpera/,n=Object.prototype,r=n.hasOwnProperty,U=n.toString;function s(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function F(e){return e=K(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:s(e)}function j(e,t){for(var i in e)r.call(e,i)&&t(e[i],i,e)}function H(e){return null==e?s(e):U.call(e).slice(8,-1)}function G(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function V(i,n){var r=null;return function(e,t){var i=-1,n=e?e.length:0;if("number"==typeof n&&-1<n&&n<=a)for(;++i<n;)t(e[i],i,e);else j(e,t)}(i,function(e,t){r=n(r,e,t,i)}),r}function K(e){return String(e).replace(/^ +| +$/g,"")}var o=function e(o){var t=M,i=o&&"object"==typeof o&&"String"!=H(o);i&&(t=o,o=null);var n=t.navigator||{},r=n.userAgent||"";o=o||r;var a,s,l,u,c,h=i?!!n.likeChrome:/\bChrome\b/.test(o)&&!/internal|\n/i.test(U.toString()),d="Object",f=i?d:"ScriptBridgingProxyObject",p=i?d:"Environment",m=i&&t.java?"JavaPackage":H(t.java),g=i?d:"RuntimeObject",v=/\bJava/.test(m)&&t.java,y=v&&H(t.environment)==p,b=v?"a":"α",_=v?"b":"β",T=t.document||{},S=t.operamini||t.opera,E=B.test(E=i&&S?S["[[Class]]"]:H(S))?E:S=null,w=o,C=[],k=null,A=o==r,I=A&&S&&"function"==typeof S.version&&S.version(),x=V([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(e,t){return e||RegExp("\\b"+(t.pattern||G(t))+"\\b","i").exec(o)&&(t.label||t)}),P=V(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],function(e,t){return e||RegExp("\\b"+(t.pattern||G(t))+"\\b","i").exec(o)&&(t.label||t)}),L=D([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),R=V({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}},function(e,t,i){return e||(t[L]||t[/^[a-z]+(?: +[a-z]+\b)*/i.exec(L)]||RegExp("\\b"+G(i)+"(?:\\b|\\w*\\d)","i").exec(o))&&i}),O=V(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],function(e,t){var i,n,r,a,s=t.pattern||G(t);return!e&&(e=RegExp("\\b"+s+"(?:/[\\d.]+|[ \\w.]*)","i").exec(o))&&(i=e,n=s,r=t.label||t,a={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"},n&&r&&/^Win/i.test(i)&&!/^Windows Phone /i.test(i)&&(a=a[/[\d.]+$/.exec(i)])&&(i="Windows "+a),i=String(i),n&&r&&(i=i.replace(RegExp(n,"i"),r)),e=i=F(i.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])),e});function D(e){return V(e,function(e,t){var i=t.pattern||G(t);return!e&&(e=RegExp("\\b"+i+" *\\d+[.\\w_]*","i").exec(o)||RegExp("\\b"+i+" *\\w+-[\\w]*","i").exec(o)||RegExp("\\b"+i+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(o))&&((e=String(t.label&&!RegExp(i,"i").test(t.label)?t.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),t=t.label||t,e=F(e[0].replace(RegExp(i,"i"),t).replace(RegExp("; *(?:"+t+"[_-])?","i")," ").replace(RegExp("("+t+")[-_.]?(\\w)","i"),"$1 $2"))),e})}if(x=x&&[x],R&&!L&&(L=D([R])),(a=/\bGoogle TV\b/.exec(L))&&(L=a[0]),/\bSimulator\b/i.test(o)&&(L=(L?L+" ":"")+"Simulator"),"Opera Mini"==P&&/\bOPiOS\b/.test(o)&&C.push("running in Turbo/Uncompressed mode"),"IE"==P&&/\blike iPhone OS\b/.test(o)?(R=(a=e(o.replace(/like iPhone OS/,""))).manufacturer,L=a.product):/^iP/.test(L)?(P=P||"Safari",O="iOS"+((a=/ OS ([\d_]+)/i.exec(o))?" "+a[1].replace(/_/g,"."):"")):"Konqueror"!=P||/buntu/i.test(O)?R&&"Google"!=R&&(/Chrome/.test(P)&&!/\bMobile Safari\b/i.test(o)||/\bVita\b/.test(L))||/\bAndroid\b/.test(O)&&/^Chrome/.test(P)&&/\bVersion\//i.test(o)?(P="Android Browser",O=/\bAndroid\b/.test(O)?O:"Android"):"Silk"==P?(/\bMobi/i.test(o)||(O="Android",C.unshift("desktop mode")),/Accelerated *= *true/i.test(o)&&C.unshift("accelerated")):"PaleMoon"==P&&(a=/\bFirefox\/([\d.]+)\b/.exec(o))?C.push("identifying as Firefox "+a[1]):"Firefox"==P&&(a=/\b(Mobile|Tablet|TV)\b/i.exec(o))?(O=O||"Firefox OS",L=L||a[1]):!P||(a=!/\bMinefield\b/i.test(o)&&/\b(?:Firefox|Safari)\b/.exec(P))?(P&&!L&&/[\/,]|^[^(]+?\)/.test(o.slice(o.indexOf(a+"/")+8))&&(P=null),(a=L||R||O)&&(L||R||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(O))&&(P=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(O)?O:a)+" Browser")):"Electron"==P&&(a=(/\bChrome\/([\d.]+)\b/.exec(o)||0)[1])&&C.push("Chromium "+a):O="Kubuntu",I=I||V(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",G(P),"(?:Firefox|Minefield|NetFront)"],function(e,t){return e||(RegExp(t+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(o)||0)[1]||null}),(a=("iCab"==x&&3<parseFloat(I)?"WebKit":/\bOpera\b/.test(P)&&(/\bOPR\b/.test(o)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(o)&&!/^(?:Trident|EdgeHTML)$/.test(x)&&"WebKit"||!x&&/\bMSIE\b/i.test(o)&&("Mac OS"==O?"Tasman":"Trident")||"WebKit"==x&&/\bPlayStation\b(?! Vita\b)/i.test(P)&&"NetFront")&&(x=[a]),"IE"==P&&(a=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(o)||0)[1])?(P+=" Mobile",O="Windows Phone "+(/\+$/.test(a)?a:a+".x"),C.unshift("desktop mode")):/\bWPDesktop\b/i.test(o)?(P="IE Mobile",O="Windows Phone 8.x",C.unshift("desktop mode"),I=I||(/\brv:([\d.]+)/.exec(o)||0)[1]):"IE"!=P&&"Trident"==x&&(a=/\brv:([\d.]+)/.exec(o))&&(P&&C.push("identifying as "+P+(I?" "+I:"")),P="IE",I=a[1]),A){if(u="global",c=null!=(l=t)?typeof l[u]:"number",/^(?:boolean|number|string|undefined)$/.test(c)||"object"==c&&!l[u])H(a=t.runtime)==f?(P="Adobe AIR",O=a.flash.system.Capabilities.os):H(a=t.phantom)==g?(P="PhantomJS",I=(a=a.version||null)&&a.major+"."+a.minor+"."+a.patch):"number"==typeof T.documentMode&&(a=/\bTrident\/(\d+)/i.exec(o))?(I=[I,T.documentMode],(a=+a[1]+4)!=I[1]&&(C.push("IE "+I[1]+" mode"),x&&(x[1]=""),I[1]=a),I="IE"==P?String(I[1].toFixed(1)):I[0]):"number"==typeof T.documentMode&&/^(?:Chrome|Firefox)\b/.test(P)&&(C.push("masking as "+P+" "+I),P="IE",I="11.0",x=["Trident"],O="Windows");else if(v&&(w=(a=v.lang.System).getProperty("os.arch"),O=O||a.getProperty("os.name")+" "+a.getProperty("os.version")),y){try{I=t.require("ringo/engine").version.join("."),P="RingoJS"}catch(e){(a=t.system)&&a.global.system==t.system&&(P="Narwhal",O=O||a[0].os||null)}P=P||"Rhino"}else"object"==typeof t.process&&!t.true&&(a=t.process)&&("object"==typeof a.versions&&("string"==typeof a.versions.electron?(C.push("Node "+a.versions.node),P="Electron",I=a.versions.electron):"string"==typeof a.versions.nw&&(C.push("Chromium "+I,"Node "+a.versions.node),P="NW.js",I=a.versions.nw)),P||(P="Node.js",w=a.arch,O=a.platform,I=(I=/[\d.]+/.exec(a.version))?I[0]:null));O=O&&F(O)}if(I&&(a=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(I)||/(?:alpha|beta)(?: ?\d)?/i.exec(o+";"+(A&&n.appMinorVersion))||/\bMinefield\b/i.test(o)&&"a")&&(k=/b/i.test(a)?"beta":"alpha",I=I.replace(RegExp(a+"\\+?$"),"")+("beta"==k?_:b)+(/\d+\+?/.exec(a)||"")),"Fennec"==P||"Firefox"==P&&/\b(?:Android|Firefox OS)\b/.test(O))P="Firefox Mobile";else if("Maxthon"==P&&I)I=I.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(L))"Xbox 360"==L&&(O=null),"Xbox 360"==L&&/\bIEMobile\b/.test(o)&&C.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(P)&&(!P||L||/Browser|Mobi/.test(P))||"Windows CE"!=O&&!/Mobi/i.test(o))if("IE"==P&&A)try{null===t.external&&C.unshift("platform preview")}catch(e){C.unshift("embedded")}else(/\bBlackBerry\b/.test(L)||/\bBB10\b/.test(o))&&(a=(RegExp(L.replace(/ +/g," *")+"/([.\\d]+)","i").exec(o)||0)[1]||I)?(O=((a=[a,/BB10/.test(o)])[1]?(L=null,R="BlackBerry"):"Device Software")+" "+a[0],I=null):this!=j&&"Wii"!=L&&(A&&S||/Opera/.test(P)&&/\b(?:MSIE|Firefox)\b/i.test(o)||"Firefox"==P&&/\bOS X (?:\d+\.){2,}/.test(O)||"IE"==P&&(O&&!/^Win/.test(O)&&5.5<I||/\bWindows XP\b/.test(O)&&8<I||8==I&&!/\bTrident\b/.test(o)))&&!B.test(a=e.call(j,o.replace(B,"")+";"))&&a.name&&(a="ing as "+a.name+((a=a.version)?" "+a:""),B.test(P)?(/\bIE\b/.test(a)&&"Mac OS"==O&&(O=null),a="identify"+a):(a="mask"+a,P=E?F(E.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(a)&&(O=null),A||(I=null)),x=["Presto"],C.push(a));else P+=" Mobile";(a=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(o)||0)[1])&&(a=[parseFloat(a.replace(/\.(\d)$/,".0$1")),a],"Safari"==P&&"+"==a[1].slice(-1)?(P="WebKit Nightly",k="alpha",I=a[1].slice(0,-1)):I!=a[1]&&I!=(a[2]=(/\bSafari\/([\d.]+\+?)/i.exec(o)||0)[1])||(I=null),a[1]=(/\bChrome\/([\d.]+)/i.exec(o)||0)[1],537.36==a[0]&&537.36==a[2]&&28<=parseFloat(a[1])&&"WebKit"==x&&(x=["Blink"]),a=A&&(h||a[1])?(x&&(x[1]="like Chrome"),a[1]||((a=a[0])<530?1:a<532?2:a<532.05?3:a<533?4:a<534.03?5:a<534.07?6:a<534.1?7:a<534.13?8:a<534.16?9:a<534.24?10:a<534.3?11:a<535.01?12:a<535.02?"13+":a<535.07?15:a<535.11?16:a<535.19?17:a<536.05?18:a<536.1?19:a<537.01?20:a<537.11?"21+":a<537.13?23:a<537.18?24:a<537.24?25:a<537.36?26:"Blink"!=x?"27":"28")):(x&&(x[1]="like Safari"),(a=a[0])<400?1:a<500?2:a<526?3:a<533?4:a<534?"4+":a<535?5:a<537?6:a<538?7:a<601?8:"8"),x&&(x[1]+=" "+(a+="number"==typeof a?".x":/[.+]/.test(a)?"":"+")),"Safari"==P&&(!I||45<parseInt(I))&&(I=a)),"Opera"==P&&(a=/\bzbov|zvav$/.exec(O))?(P+=" ",C.unshift("desktop mode"),"zvav"==a?(P+="Mini",I=null):P+="Mobile",O=O.replace(RegExp(" *"+a+"$"),"")):"Safari"==P&&/\bChrome\b/.exec(x&&x[1])&&(C.unshift("desktop mode"),P="Chrome Mobile",I=null,O=/\bOS X\b/.test(O)?(R="Apple","iOS 4.3+"):null),I&&0==I.indexOf(a=/[\d.]+$/.exec(O))&&-1<o.indexOf("/"+a+"-")&&(O=K(O.replace(a,""))),x&&!/\b(?:Avant|Nook)\b/.test(P)&&(/Browser|Lunascape|Maxthon/.test(P)||"Safari"!=P&&/^iOS/.test(O)&&/\bSafari\b/.test(x[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(P)&&x[1])&&(a=x[x.length-1])&&C.push(a),C.length&&(C=["("+C.join("; ")+")"]),R&&L&&L.indexOf(R)<0&&C.push("on "+R),L&&C.push((/^on /.test(C[C.length-1])?"":"on ")+L),O&&(a=/ ([\d.+]+)$/.exec(O),s=a&&"/"==O.charAt(O.length-a[0].length-1),O={architecture:32,family:a&&!s?O.replace(a[0],""):O,version:a?a[1]:null,toString:function(){var e=this.version;return this.family+(e&&!s?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(a=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(w))&&!/\bi686\b/i.test(w)?(O&&(O.architecture=64,O.family=O.family.replace(RegExp(" *"+a),"")),P&&(/\bWOW64\b/i.test(o)||A&&/\w(?:86|32)$/.test(n.cpuClass||n.platform)&&!/\bWin64; x64\b/i.test(o))&&C.unshift("32-bit")):O&&/^OS X/.test(O.family)&&"Chrome"==P&&39<=parseFloat(I)&&(O.architecture=64),o=o||null;var N={};return N.description=o,N.layout=x&&x[0],N.manufacturer=R,N.name=P,N.prerelease=k,N.product=L,N.ua=o,N.version=P&&I,N.os=O||{architecture:null,family:null,version:null,toString:function(){return"null"}},N.parse=e,N.toString=function(){return this.description||""},N.version&&C.unshift(I),N.name&&C.unshift(P),O&&P&&(O!=String(O).split(" ")[0]||O!=P.split(" ")[0]&&!L)&&C.push(L?"("+O+")":"on "+O),C.length&&(N.description=C.join(" ")),N}();i&&e?j(o,function(e,t){i[t]=e}):M.platform=o}).call(c)}(i={exports:{}},i.exports),i.exports),o=new WeakMap,l=Number.MAX_SAFE_INTEGER||9007199254740991,u=new Blob(['!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);const n=new Map,o=new Map,i=(e,t)=>{let r,n;if("performance"in self){const o=performance.now();r=o,n=e-Math.max(0,o-t)}else r=Date.now(),n=e;return{expected:r+n,remainingDelay:n}},s=(e,t,r,n)=>{const o="performance"in self?performance.now():Date.now();o>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:n}}):e.set(t,setTimeout(s,r-o,e,t,r,n))};addEventListener("message",({data:e})=>{try{if("clear"===e.method){const t=e.id,r=e.params,i=r.timerId,s=r.timerType;if("interval"===s)(e=>{const t=n.get(e);if(void 0===t)throw new Error(\'There is no interval scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),n.delete(e)})(i),postMessage({error:null,id:t});else{if("timeout"!==s)throw new Error(\'The given type "\'.concat(s,\'" is not supported\'));(e=>{const t=o.get(e);if(void 0===t)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),o.delete(e)})(i),postMessage({error:null,id:t})}}else{if("set"!==e.method)throw new Error(\'The given method "\'.concat(e.method,\'" is not supported\'));{const t=e.params,r=t.delay,a=t.now,c=t.timerId,l=t.timerType;if("interval"===l)((e,t,r)=>{const o=i(e,r),a=o.expected,c=o.remainingDelay;n.set(t,setTimeout(s,c,n,t,a,"interval"))})(r,c,a);else{if("timeout"!==l)throw new Error(\'The given type "\'.concat(l,\'" is not supported\'));((e,t,r)=>{const n=i(e,r),a=n.expected,c=n.remainingDelay;o.set(t,setTimeout(s,c,o,t,a,"timeout"))})(r,c,a)}}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);'],{type:"application/javascript; charset=utf-8"}),h=URL.createObjectURL(u),d=function(e){var h=new Map,d=new Map,f=new Map,n=new Worker(e);n.addEventListener("message",function(e){var t,i,n=e.data;if(void 0!==(i=n).method&&"call"===i.method){var r=n.params,a=r.timerId;if("interval"===(c=r.timerType))if("number"==typeof(s=h.get(a))){if(void 0===(l=f.get(s))||l.timerId!==a||l.timerType!==c)throw new Error("The timer is in an undefined state.")}else{if(void 0===s)throw new Error("The timer is in an undefined state.");s()}else if("timeout"===c){var s;if("number"==typeof(s=d.get(a))){if(void 0===(l=f.get(s))||l.timerId!==a||l.timerType!==c)throw new Error("The timer is in an undefined state.")}else{if(void 0===s)throw new Error("The timer is in an undefined state.");s(),d.delete(a)}}}else{if(null!==(t=n).error||"number"!=typeof t.id){var o=n.error.message;throw new Error(o)}var l,u=n.id;if(void 0===(l=f.get(u)))throw new Error("The timer is in an undefined state.");a=l.timerId;var c=l.timerType;f.delete(u),"interval"===c?h.delete(a):d.delete(a)}});return{clearInterval:function(e){var t=a(f);f.set(t,{timerId:e,timerType:"interval"}),h.set(e,t),n.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"interval"}})},clearTimeout:function(e){var t=a(f);f.set(t,{timerId:e,timerType:"timeout"}),d.set(e,t),n.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"timeout"}})},setInterval:function(e,t){var i=a(h);return h.set(i,function(){e(),"function"==typeof h.get(i)&&n.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:i,timerType:"interval"}})}),n.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:i,timerType:"interval"}}),i},setTimeout:function(e,t){var i=a(d);return d.set(i,e),n.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:i,timerType:"timeout"}}),i}}}(h),f=d.clearInterval,p=d.clearTimeout,m=d.setInterval,g=d.setTimeout;URL.revokeObjectURL(h);function v(e,t,i,n,r,a,s){void 0===a&&(a={}),void 0===s&&(s={}),this.CYCLE_TIME=1e3,this.EVENT_PURGE_TIME_DEFAULT=3*this.CYCLE_TIME,this.TIME_WITHOUT_BEAT_DEFAULT=60*this.CYCLE_TIME,this.SERVER_URL_DEFAULT="",this.CUSTOMER_DEFAULT="",this.BUSINESS_UNIT_DEFAULT="",this.INCLUDE_DEVICE_METRICS_DEFAULT=!0,this.SESSION_TOKEN_DEFAULT="",this.SESSION_ID_DEFAULT="",this.DEBUG_DEFAULT=!1,this.MAX_RETRIES=20,this.DEVICE_CLOCK_CHECK_THRESHOLD=3e5,this.eventsSkeleton=this.initEventSkeleton(),this.customer_=t,this.businessUnit_=i,this.sessionToken_=n,this.serverURL_=e,this.includeDeviceMetrics_=!1,this.userId_=r,this.deviceInfoData_=a,this.props_=s||{},this.pendingRequest_=!1}var y={debug:{configurable:!0},deviceAppInfo:{configurable:!0}};v.prototype.init=function(){var e=this;this.cycleTimer&&("undefined"!=typeof Worker&&!0!==this.props_.disableWebWorkers?f:clearInterval)(this.cycleTimer),"undefined"!=typeof Worker&&!0!==this.props_.disableWebWorkers?this.cycleTimer=m(function(){return e.cycle()},this.CYCLE_TIME):this.cycleTimer=setInterval(function(){return e.cycle()},this.CYCLE_TIME),this.communicationCurrentTime=0,this.lastCommunicationTime=0,this.eventPool={}},v.prototype.clear=function(){this.eventPool={}},y.debug.get=function(){return this.debug_},y.debug.set=function(e){this.debug_=e},v.prototype.ok=function(e){var t=this.eventPool[e];return!!t&&(!1===t.forbidden&&t.retries<this.MAX_RETRIES)},v.prototype.created=function(e,t){void 0===t&&(t={});this.addEventToPool(e,{type:"Created"},t)},v.prototype.play=function(e,t,i){void 0===i&&(i={});var n={type:"PlayerReady",currentTime:t};this.deviceAppInfo&&(i.deviceAppInfo=this.deviceAppInfo),this.addEventToPool(e,n,i)},v.prototype.playing=function(e,t,i){void 0===i&&(i={});var n={type:"Started",currentTime:t};if(this.customAttributes){var r=Object.keys(this.customAttributes);r.length&&0<r.length&&(i.attributes=this.customAttributes)}this.addEventToPool(e,n,i),this.changeSessionState(e,"PLAYING")},v.prototype.paused=function(e,t,i){void 0===i&&(i={});var n={type:"Paused",currentTime:t};this.addEventToPool(e,n,i,!0)},v.prototype.seek=function(e,t,i){void 0===i&&(i={});var n={type:"ScrubbedTo",currentTime:t};this.addEventToPool(e,n,i,!0)},v.prototype.programChanged=function(e,t,i){void 0===i&&(i={});var n={type:"ProgramChanged",currentTime:t};this.addEventToPool(e,n,i,!0)},v.prototype.startCasting=function(e,t,i){void 0===i&&(i={});var n={type:"StartCasting",currentTime:t};this.addEventToPool(e,n,i,!0),this.changeSessionState(e,"FINISHED")},v.prototype.stopCasting=function(e,t,i){void 0===i&&(i={});var n={type:"StopCasting",currentTime:t};this.addEventToPool(e,n,i,!0),this.changeSessionState(e,"FINISHED")},v.prototype.setCurrentTime=function(e,t){this.eventPool[e]&&(this.eventPool[e].currentTime=t)},v.prototype.handshake=function(e,t){void 0===t&&(t={});this.addEventToPool(e,{type:"HandshakeStarted"},t)},v.prototype.resume=function(e,t,i){void 0===i&&(i={});var n={type:"Resumed",currentTime:t};this.addEventToPool(e,n,i,!0)},v.prototype.bitrateChanged=function(e,t,i){void 0===i&&(i={});var n={type:"BitrateChanged",currentTime:t};this.addEventToPool(e,n,i,!0)},v.prototype.drmSessionUpdate=function(e,t){void 0===t&&(t={});this.addEventToPool(e,{type:"DRM"},t,!0)},v.prototype.endOfStream=function(e,t){void 0===t&&(t={});this.addEventToPool(e,{type:"Completed"},t,!0),this.changeSessionState(e,"FINISHED")},v.prototype.error=function(e,t,i){void 0===i&&(i={});var n={type:"Error",currentTime:t};this.addEventToPool(e,n,i),this.changeSessionState(e,"FINISHED")},v.prototype.dispose=function(e,t,i){void 0===i&&(i={});var n=this.eventPool[e];if(n&&"FINISHED"!==n.currentState){var r={type:"Aborted"};t&&(r.currentTime=t),this.addEventToPool(e,r,i,!0),this.changeSessionState(e,"FINISHED")}},v.prototype.waiting=function(e,t,i){void 0===i&&(i={});var n={type:"BufferingStarted",currentTime:t};this.addEventToPool(e,n,i)},v.prototype.waitingEnded=function(e,t,i){void 0===i&&(i={});var n={type:"BufferingEnded",currentTime:t};this.addEventToPool(e,n,i)},v.prototype.getSessionState=function(e){return this.eventPool[e]&&this.eventPool[e].currentState||"IDLE"},v.prototype.dispatchNow=function(e){void 0===e&&(e=!0),this.cycle(e,!0)},v.prototype.exitOngoingSession=function(t){var i=this;Object.keys(this.eventPool).map(function(e){i.eventPool[e]&&i.dispose(e,t)})},v.prototype.setCustomAttribute=function(e,t){this.customAttributes||this.resetAnalyticsCustomAttributes(),this.customAttributes[e]=t},v.prototype.clearCustomAttributes=function(){this.customAttributes={}},v.prototype.removeSession=function(e,t){if(void 0===t&&(t=!1),!0===t)delete this.eventPool[e];else{var i=this.eventPool[e];i&&(i.currentState="REMOVED")}},v.prototype.hasDataToSend=function(){for(var e=Object.keys(this.eventPool),t=0;t<e.length;++t)if(0<this.eventPool[e[t]].events.length)return!0;return!1},v.prototype.sendData=function(t,i){var s=this;if(void 0===t&&(t=!0),void 0===i&&(i=!1),!this.pendingRequest_){var o,n=!1;this.pendingRequest_=!0,o=("undefined"!=typeof Worker&&!0!==this.props_.disableWebWorkers?g:setTimeout)(function(){s.pendingRequest_=!1,o=void 0},2*this.EVENT_PURGE_TIME_DEFAULT),Object.keys(this.eventPool).map(function(r){var a=s.eventPool[r];if(a){if(!r)return a.events=[],void s.removeSession(r,!0);if("PLAYING"===a.currentState&&0===a.events.length&&i&&a.events.push({EventType:"Playback.Heartbeat",Timestamp:(new Date).getTime(),OffsetTime:Math.floor(1e3*a.currentTime)}),"IDLE"!==a.currentState&&"REMOVED"!==a.currentState){if(0===a.events.length)return void("FINISHED"===a.currentState&&s.removeSession(r));var e={DispatchTime:(new Date).getTime(),Customer:s.customer_,BusinessUnit:s.businessUnit_,Payload:a.events,SessionId:r,ClockOffset:a.clockOffset};if(s.debugLog("Sending analytics - sessionId: "+r+" and params: ",e),a.retries>s.MAX_RETRIES||!0===a.forbidden)return void(a.events=[]);Math.abs(s.communicationCurrentDate-s.lastCommunicationDate)>s.DEVICE_CLOCK_CHECK_THRESHOLD&&s.initRequest(r).then(function(){}),n=!0,s.sendRequest(t,e,function(e,t){if(o)try{o="undefined"!=typeof Worker&&!0!==s.props_.disableWebWorkers?void p(o):void clearTimeout(o)}catch(e){}s.pendingRequest_=!1;var i=e&&e.httpCode?e.httpCode:200;if(void 0!==t||200!==i)401===i&&(a.forbidden=!0),s.debugLog("Error sending request to backend",t),t||a.retries++;else{a.events=[],a.retries=0;var n=new Date;s.afterSendData_&&s.afterSendData_(n,a.lastRequestDate),a.lastRequestDate=n,"FINISHED"===a.currentState&&s.removeSession(r)}})}}}),n||(this.pendingRequest_=!1)}},v.prototype.cycle=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1),this.communicationCurrentDate=new Date,this.communicationCurrentTime+=this.CYCLE_TIME,this.hasDataToSend()?(t||this.lastCommunicationTime+this.EVENT_PURGE_TIME_DEFAULT<this.communicationCurrentTime)&&(this.sendData(e),this.lastCommunicationTime=this.communicationCurrentTime,this.lastCommunicationDate=this.communicationCurrentDate):(t||this.lastCommunicationTime+this.TIME_WITHOUT_BEAT_DEFAULT<this.communicationCurrentTime)&&(this.sendData(e,!0),this.lastCommunicationTime=this.communicationCurrentTime,this.lastCommunicationDate=this.communicationCurrentDate)},v.prototype.sendRequest=function(e,t,i){var n=new XMLHttpRequest;n.open("POST",this.serverURL_+"/eventsink/send",!0),n.setRequestHeader("Content-type","application/json"),n.setRequestHeader("Authorization","Bearer "+this.sessionToken_),n.onload=function(){var e=JSON.parse(this.responseText);i(e)},n.onerror=function(e){i(null,e)},n.send(JSON.stringify(t))},v.prototype.initRequest=function(a){var s=this;return new Promise(function(i,t){var n=(new Date).getTime(),r=new XMLHttpRequest;r.open("POST",s.serverURL_+"/eventsink/init",!0),r.setRequestHeader("Content-type","application/json"),r.setRequestHeader("Authorization","Bearer "+s.sessionToken_),r.onload=function(){var e=(new Date).getTime(),t=JSON.parse(r.responseText);s.determineClockOffset(a,t,n,e),t&&t.settings&&t.settings.includeDeviceMetrics&&(s.includeDeviceMetrics_=!!t.settings.includeDeviceMetrics),i()},r.onerror=function(e){s.debugLog("Unable to init. Aborting."),t(e)};var e={Customer:s.customer_,BusinessUnit:s.businessUnit_,SessionId:a};r.send(JSON.stringify(e))})},v.prototype.debugLog=function(e,t){t=t||"",this.debug_&&console.log("Analytics: "+e,t)},v.prototype.addDeviceInfoEvent=function(e){var t=this.eventPool[e];if(this.includeDeviceMetrics_&&t&&t.events&&t.events.length){var i={Timestamp:(new Date).getTime(),EventType:"Device.Info",DeviceModel:this.deviceInfoData_.deviceModel||"Desktop",UserAgent:this.deviceInfoData_.userAgent||(n.navigator?n.navigator.userAgent:""),Height:this.deviceInfoData_.screenHeight||(n.screen?n.screen.height:0),Width:this.deviceInfoData_.screenWidth||(n.screen?n.screen.width:0),Model:this.deviceInfoData_.model||(n.navigator?n.navigator.appName:""),Name:this.deviceInfoData_.deviceName||(n.navigator?n.navigator.product:""),OS:this.deviceInfoData_.deviceOS||s.os.family,OSVersion:this.deviceInfoData_.deviceOSVersion||s.os.version,Type:this.deviceInfoData_.type||"WEB"};(this.deviceInfoData_.deviceManufacturer||s.manufacturer)&&(i.Manufacturer=this.deviceInfoData_.deviceManufacturer||s.manufacturer),this.deviceInfoData_.deviceId&&(i.DeviceId=this.deviceInfoData_.deviceId),t.events.push(i)}},v.prototype.determineClockOffset=function(e,t,i,n){var r=this.eventPool[e];r&&(r.clockOffset=Math.floor((n-t.repliedTime+i-t.receivedTime)/2))},v.prototype.createPool=function(i){var n=this;return new Promise(function(e,t){n.eventPool[i]={currentState:"IDLE",currentTime:0,clockOffset:0,events:[],retries:0,forbidden:!1},n.initRequest(i).then(function(){n.addDeviceInfoEvent(i),e()}).catch(function(e){t(e)})})},v.prototype.addEventToPool=function(e,t,i,n){var r,a=this;void 0===n&&(n=!1),n&&this.eventPool[e]&&("FINISHED"===this.eventPool[e].currentState||"REMOVED"===this.eventPool[e].currentState)||(this.eventPool[e]||(r=this.createPool(e)),r?r.then(function(){a.internalAddEventToPool(e,t,i)}):this.internalAddEventToPool(e,t,i))},v.prototype.internalAddEventToPool=function(e,t,i){var n=this.eventsSkeleton[t.type];if(n){var r={Timestamp:(new Date).getTime(),EventType:"Playback."+n.event};n.includeOffset&&(r.OffsetTime=Math.floor(1e3*t.currentTime)),n.attributes&&"function"==typeof n.attributes&&(r=this.objectAssign(r,n.attributes(i))),this.eventPool[e].events.push(r),this.debugLog("added "+n.event+" to queue")}else this.debugLog("Unknown playback event: ",t)},v.prototype.changeSessionState=function(e,t){var i,n=this;this.eventPool[e]||(i=this.createPool(e)),i?i.then(function(){n.eventPool[e].currentState=t}):this.eventPool[e].currentState=t},y.deviceAppInfo.get=function(){return this.deviceInfoData_?this.deviceInfoData_.deviceAppInfo:null},v.prototype.initEventSkeleton=function(){var e={Completed:{event:"Completed",autoListener:!1}};return e.PlayerReady={event:"PlayerReady",autoListener:!1,attributes:function(e){var t={Technology:e.techName,PlayerVersion:e.version};return e.techVersion&&(t.TechVersion=e.techVersion),t.AnalyticsVersion=v.VERSION,e.deviceAppInfo&&(t.DeviceAppInfo=e.deviceAppInfo),e.playMode&&(t.PlayMode=e.playMode),t}},e.Resumed={event:"Resumed",autoListener:!1,includeOffset:!0},e.BufferingStarted={event:"BufferingStarted",includeOffset:!0},e.BufferingEnded={event:"BufferingEnded",includeOffset:!0},e.ScrubbedTo={event:"ScrubbedTo",includeOffset:!0},e.Created={event:"Created",attributes:function(e){var t={};return void 0!==e.autoplay&&(t.AutoPlay=e.autoplay),e.techName&&(t.Technology=e.techName),e.player&&(t.Player=e.player),e.version&&(t.Version=e.version),e.requestId&&(t.RequestId=e.requestId),e.techVersion&&(t.TechVersion=e.techVersion),e.deviceAppInfo&&(t.DeviceAppInfo=e.deviceAppInfo),e.playMode&&(t.PlayMode=e.playMode),t}},e.StartCasting={event:"StartCasting",includeOffset:!0},e.StopCasting={event:"StopCasting",includeOffset:!0},e.Paused={event:"Paused",includeOffset:!0},e.BitrateChanged={event:"BitrateChanged",includeOffset:!0,attributes:function(e){return{Bitrate:e.bitrate}}},e.DRM={event:"DRM",includeOffset:!1,attributes:function(e){var t={};return e.message&&(t.Message=e.message),e.code&&(t.Code=e.code),e.info&&(t.Info=e.info),t}},e.Error={event:"Error",includeOffset:!0,attributes:function(e){var t={};return e.errorCode&&(t.Code=e.errorCode),e.errorMessage?t.Message=e.errorMessage:t.Message="Unknown Error",e.errorInfo&&(t.Info=e.errorInfo),e.errorDetails&&(t.Details=e.errorDetails),t}},e.HandshakeStarted={event:"HandshakeStarted",autoListener:!1,attributes:function(e){if(!e.assetId)return{};var t={AssetId:e.assetId};return e.programId&&(t.ProgramId=e.programId),t}},e.ProgramChanged={event:"ProgramChanged",includeOffset:!0,autoListener:!1,attributes:function(e){return e.programId?{ProgramId:e.programId}:{}}},e.Aborted={event:"Aborted",autoListener:!1,includeOffset:!0},e.Started={event:"Started",autoListener:!1,includeOffset:!0,attributes:function(e){var t={};return e.bitrate&&(t.Bitrate=e.bitrate),e.duration&&(t.VideoLength=1e3*e.duration),e.mediaLocator&&(t.MediaLocator=e.mediaLocator),e.attributes&&(t.Attributes=e.attributes),e.referenceTime&&(t.ReferenceTime=e.referenceTime),e.playMode&&(t.PlayMode=e.playMode),t}},e},v.prototype.objectAssign=function(e,t){for(var i,n,r=arguments,a=1;a<arguments.length;++a)for(i in n=r[a])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},Object.defineProperties(v.prototype,y),v.VERSION="2.1.119-25";var b=v.default||v;e.exports=b})),cl=T.empAnalytics?T.empAnalytics:ul,hl=function(r){function e(e,t){var i;i=r.call(this,e,t)||this,Fa("AnalyticsPlugin","create"),i.analyticsConnector_=null,i.options_=t,i.onLoadStartBind=i.onLoadStart_.bind(ma(i)),i.player.on(va.LOAD_START,i.onLoadStartBind);var n=function(){var e,t=T.navigator.userAgent,i=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([0-9.]+)/i)||[];if(/trident/i.test(i[1]))return{name:"Explorer",version:(e=/\brv[ :]+([0-9.]+)/g.exec(t)||[])[1]||""};if("Chrome"!==i[1]||null===(e=t.match(/\b(OPR|Edge|Edg)\/([0-9.]+)/)))return i=i[2]?[i[1],i[2]]:[T.navigator.appName,T.navigator.appVersion,"-?"],null!==(e=t.match(/version\/([0-9.]+)/i))&&i.splice(1,1,e[1]),{name:i[0],version:i[1]};var n=e.slice(1).toString().split(",");return"Edg"===n[0]&&(n[0]="ChromiumEdge"),{name:n[0].replace("OPR","Opera"),version:n[1]}}();return i.options_=i.options_?i.options_:{},i.options_.analytics=i.options_.analytics?i.options_.analytics:{},i.options_.analytics.deviceInfo=i.options_.analytics.deviceInfo?i.options_.analytics.deviceInfo:{},i.options_.analytics.deviceInfo=ga.mergeOptions({deviceName:n.name,model:n.version},i.options_.analytics.deviceInfo),i}ca(e,r);var t=e.prototype;return t.stop=function(){this.analyticsConnector_&&this.analyticsConnector_.dispose&&(this.analyticsConnector_.dispose(),this.analyticsConnector_=null)},t.stopCasting=function(){this.analyticsConnector_&&this.analyticsConnector_.dispose&&(this.analyticsConnector_.onChromeCastingStop(!0),this.analyticsConnector_=null)},t.dispose=function(){Fa("AnalyticsPlugin","dispose"),this.player.off(va.LOAD_START,this.onLoadStartBind),this.stop(),r.prototype.dispose.call(this)},t.options=function(e){if(!e)return this.options_;this.options_=ga.mergeOptions(this.options_,e)},t.newAnalytics=function(e){Fa("new EMPAnalytics");var t=new cl(e.exposureApiURL,e.customer,e.businessUnit,e.sessionToken,e.userId,this.options_.analytics&&this.options_.analytics.deviceInfo);this.stop(),Fa("new EMPAnalyticsConnector"),this.analyticsConnector_=new ll(this.player,t,this.options_)},t.onEntitlementLoadStart=function(){this.analyticsConnector_&&this.analyticsConnector_.onEntitlementLoadStart()},t.onError=function(e){this.analyticsConnector_&&this.analyticsConnector_.onError(e)},t.onWindowUnload=function(){this.analyticsConnector_&&this.analyticsConnector_.onWindowUnload()},t.onLoadStart_=function(){ts.getEntitlement(this.player)||this.stop()},t.version=function(){return cl?cl.VERSION:r.prototype.version.call(this)},ua(e,[{key:"connector",get:function(){return this.analyticsConnector_}}]),e}(ga.getPlugin("plugin"));hl.VERSION="2.2.124-498",ga.getPlugin("analytics")?ga.log.warn('A plugin named "analytics" already exists.'):ga.registerPlugin("analytics",hl);var dl=function(a){function e(e){var t,i;void 0===e&&(e={});var n=!0,r=Na.ENTITLEMENT2;return"string"==typeof e?i=e:e instanceof Object&&(i=e.message,!1===e.fatal&&(n=e.fatal),e.code&&(r=e.code)),(t=a.call(this,i)||this).fatal=n,t.code=r,t}return ca(e,a),ua(e,[{key:"fatal",get:function(){return!!this.fatal_},set:function(e){this.fatal_=e}}]),e}(e(t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,Error),n);function n(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,t,i){for(var n=!0;n;){var r=e,a=t,s=i;n=!1,null===r&&(r=Function.prototype);var o=Object.getOwnPropertyDescriptor(r,a);if(void 0!==o){if("value"in o)return o.value;var l=o.get;if(void 0===l)return;return l.call(s)}var u=Object.getPrototypeOf(r);if(null===u)return;e=u,t=a,i=s,n=!0,o=u=void 0}}(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,e),Object.defineProperty(this,"message",{enumerable:!1,value:e,writable:!0}),Object.defineProperty(this,"name",{enumerable:!1,value:this.constructor.name,writable:!0}),Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):Object.defineProperty(this,"stack",{enumerable:!1,value:new Error(e).stack,writable:!0})}t.default=i,e.exports=t.default}))),fl=function(){function n(e){void 0===e&&(e={}),this.options_=e}var e=n.prototype;return e.getEntitlement=function(){throw new dl("EntitlementEngine: getEntitlement should be implemented in subclass.")},e.getV2Entitlement=function(){throw new dl("EntitlementEngine: getV2Entitlement should be implemented in subclass.")},e.getV2Asset_=function(e,t,i,n){throw void 0===n&&(n=function(){}),new dl("EntitlementEngine: getV2Asset_ should be implemented in subclass.")},e.getServerTime=function(){throw new dl("EntitlementEngine: getServerTime should be implemented in subclass.")},e.syncServerTime=function(i){this.getServerTime(function(e,t){t&&(Fa.error("getServerTime",t),e=new Date),n.ServerTimeDiff_=e-new Date,Fa("serverDiff",n.ServerTimeDiff_),i&&i(n.ServerTimeDiff_,t)})},e.getCachedServerTime=function(){return void 0!==n.ServerTimeDiff_?Date.now()+n.ServerTimeDiff_:Date.now()},e.getPreferences=function(){throw new dl("EntitlementEngine: getPreferences should be implemented in subclass.")},e.savePreferences=function(){throw new dl("EntitlementEngine: savePreferences should be implemented in subclass.")},e.getProgramInfo=function(){throw new dl("EntitlementEngine: getProgramInfo should be implemented in subclass.")},e.getNextProgram=function(){throw new dl("EntitlementEngine: getProgramInfo should be implemented in subclass.")},e.getPreviousProgram=function(){throw new dl("EntitlementEngine: getProgramInfo should be implemented in subclass.")},e.getEPG=function(){throw new dl("EntitlementEngine: getEPG should be implemented in subclass.")},e.getAssetInfo=function(){throw new dl("EntitlementEngine: getAssetInfo should be implemented in subclass.")},e.getChannelInfo=function(){throw new dl("EntitlementEngine: getChannelInfo should be implemented in subclass.")},e.verifySession=function(){throw new dl("EntitlementEngine: verifySession should be implemented in subclass.")},e.verifyEntitlement=function(){throw new dl("EntitlementEngine: verifyEntitlement should be implemented in subclass.")},e.login=function(){throw new dl("EntitlementEngine: login should be implemented in subclass.")},e.logout=function(){throw new dl("EntitlementEngine: logout should be implemented in subclass.")},e.fetchPreferences=function(){throw new dl("EntitlementEngine: fetchPreferences should be implemented in subclass.")},e.savePreferences=function(){throw new dl("EntitlementEngine: savePreferences should be implemented in subclass.")},n.isEntitlementEngine=function(e){return e.prototype instanceof n||e instanceof n||e===n},n.registerEntitlementEngine=function(e,t){if(n.engines_||(n.engines_={}),!n.isEntitlementEngine(t))throw new dl("EntitlementEngine "+e+" must be a EntitlementEngine");return n.engines_[e]=t},n.getEntitlementEngine=function(e){return e=e||"EricssonExposure",n.engines_&&n.engines_[e]?n.engines_[e]:null},n}();fl.ServerTimeDiff_=void 0;var pl=function(){function e(){this.channelId=0,this.assetId=void 0,this.programId=void 0,this.productId="",this.mimeType="",this.playRequest=null,this.requestId="",this.edrmConfig=null,this.live=!1,this.playSessionId="",this.analyticsConfig=null,this.lastViewedOffset=null,this.lastViewedTime=null,this.liveTime=null,this.entitlementType="",this.licenseExpiration=null,this.licenseExpirationReason="",this.minBitrate=0,this.maxBitrate=0,this.maxResWidth=0,this.maxResHeight=0,this.rwEnabled=!0,this.ffEnabled=!0,this.airplayBlocked=!1,this.mdnRequestRouterUrl="",this.timeshiftEnabled=!0,this.formats=null,this.mediaLocator="",this.src="",this.adMediaLocator="",this.streamInfo=null,this.playToken="",this.playTokenExpiration="",this.protection=void 0,this.certificateServer=void 0,this.keySystems=void 0}var t=e.prototype;return t.commonInitiate=function(e){this.edrmConfig=e.edrmConfig||null,this.playSessionId=e.playSessionId||"",this.analyticsConfig=e.analyticsConfig||null,this.entitlementType=e.entitlementType||"",this.mdnRequestRouterUrl=e.mdnRequestRouterUrl||"",this.playToken=e.playToken||"",this.playTokenExpiration=e.playTokenExpiration||""},t.initiateV1=function(e,t){this.commonInitiate(e),this.minBitrate=e.minBitrate||0,this.maxBitrate=e.maxBitrate||0,this.maxResWidth=e.maxResWidth||0,this.maxResHeight=e.maxResHeight||0,this.rwEnabled=void 0===e.rwEnabled||e.rwEnabled,this.ffEnabled=void 0===e.ffEnabled||e.ffEnabled,this.airplayBlocked=void 0!==e.airplayBlocked&&e.airplayBlocked,this.timeshiftEnabled=e.timeshiftEnabled||!0,this.lastViewedOffset=e.lastViewedOffset||null,this.lastViewedTime=e.lastViewedTime||null,this.liveTime=e.liveTime||null,this.live=e.live||!1;var i=Date.parse(e.licenseExpiration||null);!1===isNaN(i)&&(this.licenseExpiration=new Date(i)),this.licenseExpirationReason=e.licenseExpirationReason||"",this.mediaLocator=e.mediaLocator||"",this.mediaLocator&&("localhost"===T.location.hostname||Ls?this.src=this.mediaLocator:this.src=this.mediaLocator.replace(/^(http:)/,"").replace(/^(https:)/,"")),this.adMediaLocator=e.adMediaLocator||"",e.streamInfo?this.streamInfo=e.streamInfo:this.setupStreamInfo(t),e.fairplayConfig&&(this.protection={},this.protection.certificateUrl=e.fairplayConfig.certificateUrl||"",this.protection.licenseUrl=e.fairplayConfig.licenseAcquisitionUrl||"",e.fairplayConfig.secondaryMediaLocator?this.protection.version="mrr":this.protection.version="irdeto",this.keySystems={"com.apple.fps.1_0":{certificateUri:e.fairplayConfig.certificateUrl||"",licenseUri:e.fairplayConfig.licenseAcquisitionUrl||""}}),e.widevineConfig&&(this.certificateServer=e.widevineConfig.certificateUrl||""),e.cencConfig&&(this.keySystems=e.cencConfig)},t.initiateV2=function(e){if(this.commonInitiate(e),this.formats=e.formats||null,e.contractRestrictions){var t=e.contractRestrictions;this.minBitrate=t.minBitrate||0,this.maxBitrate=t.maxBitrate||0,this.maxResWidth=t.maxResWidth||0,this.maxResHeight=t.maxResHeight||0,this.rwEnabled=void 0===t.rwEnabled||t.rwEnabled,this.ffEnabled=void 0===t.ffEnabled||t.ffEnabled,this.airplayBlocked=void 0===t.airplayEnabled||!t.airplayEnabled,this.timeshiftEnabled=t.timeshiftEnabled||!0}if(e.bookmarks){var i=e.bookmarks;this.lastViewedOffset=i.lastViewedOffset||null,this.lastViewedTime=i.lastViewedTime||null,this.liveTime=i.liveTime||null}if(this.durationInMs=e.durationInMs||0,e.streamInfo){var n=e.streamInfo;this.streamInfo={referenceTime:0},this.updateStreamInfoV2(n)}},t.updateStreamInfoV2=function(e){this.live=e.live||!1,this.streamInfo.live=e.live||!1,this.channelId=e.channelId||void 0,this.programId=e.programId||void 0,this.streamInfo.channelId=e.channelId||void 0,this.streamInfo.programId=e.programId||void 0,this.streamInfo.static=e.static||!1,this.isDynamicCachupAsLive=!e.static&&void 0!==e.start,this.isStaticCachupAsLive=e.static&&void 0!==e.end,e.start&&(this.streamInfo.start=new Date(1e3*e.start),this.streamInfo.startTime=this.streamInfo.start.getTime()),e.end&&(this.streamInfo.end=new Date(1e3*e.end),this.streamInfo.endTime=this.streamInfo.end.getTime()),this.streamInfo.event=e.event&&void 0!==e.programId},t.setupMediaLocator=function(e){this.mediaLocator=e.mediaLocator||"",this.mediaLocator&&("localhost"===T.location.hostname||Ls?this.src=this.mediaLocator:this.src=this.mediaLocator.replace(/^(http:)/,"").replace(/^(https:)/,"")),this.adMediaLocator=e.adMediaLocator||"";var t=Date.parse(e.licenseExpiration||null);!1===isNaN(t)&&(this.licenseExpiration=new Date(t)),this.licenseExpirationReason=e.licenseExpirationReason||""},t.selectFormat=function(e){var t,i=this;switch(this.mediaLocator="",this.src="",this.playRequest=e,this.mimeType=e.type,e.format){case"DASH":if(0<(t=this.formats.filter(function(e){return"DASH"===e.format})).length){var n=t[0];this.setupMediaLocator(n),n.drm&&(this.keySystems=n.drm,n.drm["com.widevine.alpha"]&&(this.certificateServer=n.drm["com.widevine.alpha"].certificateUrl),this.keySystems={},Object.keys(n.drm).forEach(function(e){i.keySystems[e]=n.drm[e].licenseServerUrl}))}break;case"SMOOTHSTREAMING":if(0<(t=this.formats.filter(function(e){return"SMOOTHSTREAMING"===e.format})).length){var r=t[0];this.setupMediaLocator(r),r.drm&&(this.keySystems=r.drm,r.drm["com.widevine.alpha"]&&(this.certificateServer=r.drm["com.widevine.alpha"].certificateUrl),this.keySystems={},Object.keys(r.drm).forEach(function(e){i.keySystems[e]=r.drm[e].licenseServerUrl}))}break;case"HLS":if(0<(t=this.formats.filter(function(e){return"HLS"===e.format})).length){var a=t[0];this.setupMediaLocator(a),a.drm&&a.drm["com.apple.fps"]&&(this.protection={},this.protection.certificateUrl=a.drm["com.apple.fps"].certificateUrl||"",this.protection.licenseUrl=a.drm["com.apple.fps"].licenseServerUrl||"",this.protection.version="irdeto",this.keySystems={"com.apple.fps.1_0":{certificateUri:a.drm["com.apple.fps"].certificateUrl||"",licenseUri:a.drm["com.apple.fps"].licenseServerUrl||""}})}}},t.setupStreamInfo=function(e){if(this.streamInfo={referenceTime:0},this.isDynamicCachupAsLive=!1,this.isStaticCachupAsLive=!1,this.mediaLocator){var t=La("t",this.mediaLocator);if(!t){var i=La("dvr_window_length",this.mediaLocator);if(i){var n=e?new Date(e):new Date;t=new Date(n.getTime()-1e3*i).toISOString().replace(/Z/g,"")}else if(this.live){var r=e?new Date(e):new Date;t=new Date(r.getTime()-72e5).toISOString().replace(/Z/g,"")}}if(t)try{t&&47===t.length?(this.streamInfo.start=new Date(t.slice(0,23)+"Z"),this.streamInfo.startTime=this.streamInfo.start.getTime(),this.streamInfo.end=new Date(t.slice(24)+"Z"),this.streamInfo.endTime=this.streamInfo.end.getTime()):t&&23===t.length&&(this.streamInfo.start=new Date(t+"Z"),this.streamInfo.startTime=this.streamInfo.start.getTime()),this.isDynamicCachupAsLive=void 0!==this.streamInfo.start&&void 0===this.streamInfo.end,this.isStaticCachupAsLive=void 0!==this.streamInfo.start&&void 0!==this.streamInfo.end}catch(e){Fa.warn("timeParams",e)}}},ua(e,null,[{key:"Type",get:function(){return{DASH:"DASH",HLS:"HLS"}}}]),e}(),ml=function(){function e(){}return e.getBaseUrl=function(n,r){var a=new XMLHttpRequest;a.open("GET",n.mdnRequestRouterUrl),a.onreadystatechange=function(e){if(4===a.readyState)if(200===a.status){Fa("getBaseUrl OK");var t=a.responseXML;try{var i=t.firstChild.getElementsByTagName("baseURL")[0].textContent;i?n.baseUrl=i:Fa.error("getBaseUrl Error can not find baseURL"),r(n)}catch(e){Fa.error("getBaseUrl Error",e),r(n)}}else Fa.error("getBaseUrl Error",a.statusText),r(n)},a.send(null)},e}(),gl=function(i){function e(e){var t;return void 0===e&&(e={}),e=Ta({exposureApiURL:"https://exposure.emps.ebsd.ericsson.net",exposureApiVersion:"v1"},e),(t=i.call(this,e)||this).statusMessageZero="An HTTP request failed with an error (Statuscode:0), but not from the server.",t.errorMap={400:{INVALID_JSON:{message:"Invalid json.",fatal:!1}},401:{NO_SESSION_TOKEN:{message:"The session token is missing.",fatal:!0},INVALID_SESSION_TOKEN:{message:"The session token is not valid.",fatal:!0}},403:{FORBIDDEN:{message:"The business unit has been configured to require server to server authentication, but it is not valid.",fatal:!0},NOT_ENTITLED:{message:"The user is not entitled.",fatal:!0},DEVICE_BLOCKED:{message:"The device is not allowed to play the asset.",fatal:!0},GEO_BLOCKED:{message:"Not allowed from this region.",fatal:!0},LICENSE_EXPIRED:{message:"Asset has been expired.",fatal:!0},NOT_AVAILABLE_IN_FORMAT:{message:"The media is not available in the requested format.",fatal:!1},NOT_ENABLED:{message:"The media is not enabled.",fatal:!0},CONCURRENT_STREAMS_LIMIT_REACHED:{message:"You have reached the maximum number of concurrent streams you are allowed to watch.",fatal:!0},NO_MEDIA_ON_CHANNEL:{message:"The media is not available on the channel.",fatal:!1},NO_MEDIA_FOR_PROGRAM:{message:"No media available for this program.",fatal:!1}},404:{UNKNOWN_BUSINESS_UNIT:{message:"The business unit cannot be found.",fatal:!0},UNKNOWN_ASSET:{message:"The asset cannot be found.",fatal:!1}},0:{NETWORK_ERROR:{message:"Network error.",fatal:!1}}},void 0===fl.ServerTimeDiff_&&t.getServerTime(function(e,t){t&&(Fa.error("getServerTime",t),e=new Date),fl.ServerTimeDiff_=e-new Date,Fa("serverDiff",fl.ServerTimeDiff_)}),t}ca(e,i);var t=e.prototype;return t.login=function(e,t,n,i){var r=this;if(!n)throw new dl("callback is mandantory for login");var a=!1;i&&(a=!0);var s=""===e,o=new Date(this.getCachedServerTime());if(o.setTime(o.getTime()+864e5),this.options_.apiKey){var l={"EMP-Auth":this.options_.apiKey},u=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+this.customer+"/businessunit/"+this.businessUnit+"/auth/session",c={accountId:e,userId:e,deviceId:"WEB_"+Ds(),device:{height:T.screen.height,width:T.screen.width,model:T.navigator.appName,name:T.navigator.product,os:T.navigator.platform,osVersion:T.navigator.appVersion,manufacturer:T.navigator.vendor,type:"WEB"},expiration:o.toISOString(),anonymous:!1};V.post(u,{json:c,headers:l},function(e,t,i){r.checkForError(e,t,function(e,t){n({success:!1,expiration:0,message:t.message})})||(r.sessionToken=i.sessionToken,n({success:!0,expiration:864e5,session:i}))})}else{var h=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+this.customer+"/businessunit/"+this.businessUnit;h+=!0==s?"/auth/anonymous":!0===a?"/auth/twofactorlogin":"/auth/login";var d={deviceId:"WEB_"+Ds(),device:{height:T.screen.height,width:T.screen.width,model:T.navigator.appName,name:T.navigator.product,os:T.navigator.platform,osVersion:T.navigator.appVersion,manufacturer:T.navigator.vendor,type:"WEB"},rememberMe:!1,username:e,password:t,totp:!0===a?i:void 0};V.post(h,{json:d},function(e,t,i){r.checkForError(e,t,function(e,t){n({success:!1,expiration:0,message:t.message})})||(r.sessionToken=i.sessionToken,n({success:!0,expiration:i.expirationDateTime?new Date(i.expirationDateTime)-new Date(r.getCachedServerTime()):864e5,session:i}))})}},t.logout=function(n,e){var r=this;void 0===n&&(n=function(){});var t=this.customer,i=this.businessUnit;if(!t)throw new dl("Customer was not provided.");if(!i)throw new dl("Business unit was not provided.");var a=this.requestHeaders;e&&(a={Authorization:"Bearer "+e});var s=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+t+"/businessunit/"+i+"/auth/session";V.del(s,{headers:a},function(e,t,i){r.checkForError(e,t,n)||(r.sessionToken=null,n(!0))})},t.getV2Entitlement=function(e,t,i,n){if(void 0===e)throw new dl("No request specified.");if(void 0===t)throw new dl("Media not found.");if(!t.drm||!t.format)throw new dl("Invalid playrequest specified.");!e.assetId&&e.programId?this.getProgram_(e.channelId,e.programId,t,i):this.getV2Asset_(e,t,n,i)},t.getEntitlement=function(e,t,i){if(void 0===e)throw new dl("No request specified.");if(void 0===t)throw new dl("Media not found.");if(!t.drm||!t.format)throw new dl("Invalid playrequest specified.");null!==e.programId||e.channelId?this.getProgram_(e.channelId,e.programId,t,i):this.getAsset_(e.assetId,t,i)},t.getErrorForResponse=function(t){if(!t)return null;var e=t.statusCode,i="";if(!(200<=e&&e<=299))if(t.body&&t.body.message)i=t.body.message;else if(t.body)try{i=JSON.parse(t.body).message}catch(e){i=t.body}var n=this.errorMap[e];if(n){var r=e+" "+i,a=n[i];return a&&(r+=": "+a.message),new dl(a?{message:r,fatal:!!a.fatal}:r)}return 200<=e&&e<=299?null:new dl(e+" "+i)},t.checkForError=function(e,t,i){var n=e;return e||(n=this.getErrorForResponse(t))&&(n.statusCode=t.statusCode),n?(0===n.statusCode&&(n.message=this.statusMessageZero),i&&i(t.body,n),n):null},t.getV2Asset_=function(o,l,e,u){var c=this;if(void 0===u&&(u=function(){}),!this.customer)throw new dl("getV2Asset_: Customer was not provided.");if(!this.businessUnit)throw new dl("getV2Asset_: Business unit was not provided.");var h=o.assetId?o.assetId:o.channelId;if(!h)throw new dl("getV2Asset_: No assetId or channelId specified.");if(e&&e.formats)if(e.selectFormat(l),e.mediaLocator)u(e,null);else{var t=new dl(l.format+" not avalible");t.fatal=!1,u(e,t)}else{var i=this.options_.exposureApiURL+"/v2/customer/"+this.customer+"/businessunit/"+this.businessUnit+"/entitlement/"+h+"/play";V.get(i,{headers:this.requestHeaders},function(e,t,i){if(e)return 0===e.statusCode&&(e.message=c.statusMessageZero),void u(null,e);if(e=c.checkForError(e,t))400===e.statusCode||404===e.statusCode&&i&&-1===i.indexOf("message")||404===e.statusCode&&"404 Not found"===e.message?(Fa.warn("Fallback to Entitlement play v1",e.message),c.getEntitlement(o,l,u)):u(null,e);else{var n=JSON.parse(i),r=new pl;r.initiateV2(n),r.selectFormat(l),r.assetId=h,(r.channelId||r.programId)&&c.setStreamReferenceTime_(r);var a=t.headers["x-request-id"];if(r.requestId=a||"",r.mediaLocator)u(r,null);else{var s=new dl(l.format+" not avalible");s.fatal=!1,u(r,s)}}})}},t.getAsset_=function(a,s,o){var l=this;void 0===o&&(o=function(){});var e=this.customer,t=this.businessUnit;if(!e)throw new dl("getAsset_: Customer was not provided.");if(!t)throw new dl("getAsset_: Business unit was not provided.");if(!a)throw new dl("getAsset_: assetId was not provided.");var i=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+e+"/businessunit/"+t+"/entitlement/"+a+"/play";V.post(i,{json:s,headers:this.requestHeaders},function(e,t,i){if(!l.checkForError(e,t,o)){var n=new pl;n.initiateV1(i,t.headers.date),n.assetId=a,n.playRequest=s,n.mimeType=s.type;var r=t.headers["x-request-id"];n.requestId=r||"",n.mdnRequestRouterUrl?ml.getBaseUrl(n,o):o(n)}})},t.setStreamReferenceTime_=function(e){(e.isDynamicCachupAsLive||e.isStaticCachupAsLive)&&("application/dash+xml"===e.mimeType||"application/vnd.ms-sstr+xml"===e.mimeType?e.isStaticCachupAsLive?e.streamInfo.referenceTime=e.streamInfo.startTime:e.streamInfo.referenceTime=0:"application/x-mpegurl"===e.mimeType&&(e.streamInfo.referenceTime=e.streamInfo.startTime))},t.getAssetMetadata_=function(e,r){var a=this;if(!this.customer)throw new dl("getAssetMetadata_: Customer was not provided.");if(!this.businessUnit)throw new dl("getAssetMetadata_: Business unit was not provided.");if(!e)throw new dl("getAssetMetadata_: assetId was not provided.");var t=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+this.customer+"/businessunit/"+this.businessUnit+"/content/asset/"+e;V.get(t,null,function(e,t,i){if(!a.checkForError(e,t,r)){var n=JSON.parse(i);r(n)}})},t.getProgram_=function(a,s,o,l){var u=this;void 0===l&&(l=function(){});var e=this.customer,t=this.businessUnit;if(!e)throw new dl("getProgram_: Customer was not provided.");if(!t)throw new dl("getProgram_: Business unit was not provided.");if(!a&&!s)throw new dl("getProgram_: channelId or programId was not provided.");var i="";s&&(i="/program/"+s);var n="";a&&(n="/channel/"+a);var r=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+e+"/businessunit/"+t+"/entitlement"+n+i+"/play";V.post(r,{json:o,headers:this.requestHeaders},function(e,t,i){if(!u.checkForError(e,t,l)){var n=new pl;n.initiateV1(i,t.headers.date),a&&(n.assetId=a,n.channelId=a),s&&(n.programId=s),n.playRequest=o,n.mimeType=o.type,u.setStreamReferenceTime_(n);var r=t.headers["x-request-id"];n.requestId=r||"",n.mdnRequestRouterUrl?ml.getBaseUrl(n,l):l(n)}})},t.getServerTime=function(a){var s=this,e=this.customer,t=this.businessUnit;if(!e||!t)return Fa.warn("getServerTime no customer or businessUnit"),void a(new Date);if(!1===T.navigator.onLine)return Fa("getServerTime offline"),void a(new Date);var i=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+e+"/businessunit/"+t+"/time";V.get(i,null,function(e,t,i){if(e)return 0===e.statusCode&&(e.message=s.statusMessageZero),void a(null,e);if(e=s.checkForError(e,t))a(null,e);else{var n=JSON.parse(i),r=new Date(n.iso8601);a(r)}})},t.getPreferences=function(r){var a=this,e=this.customer,t=this.businessUnit,i=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+e+"/businessunit/"+t+"/preferences";V.get(i,{headers:this.requestHeaders},function(e,t,i){if(!a.checkForError(e,t,r)){var n=JSON.parse(i);r(n)}})},t.savePreferences=function(e,n){var r=this,t=this.customer,i=this.businessUnit;if(e){var a={preferences:e},s=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+t+"/businessunit/"+i+"/preferences";V.post(s,{json:a,headers:this.requestHeaders},function(e,t,i){r.checkForError(e,t,n)||n(!0)})}else Fa.error("Preferences was not provided.")},t.getEPG=function(e,t,i,r){var a=this,n=this.customer,s=this.businessUnit,o=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+n+"/businessunit/"+s+"/epg/"+e;o+="?from="+t+"&to="+i,V.get(o,null,function(e,t,i){if(!a.checkForError(e,t,r)){var n=JSON.parse(i);r(n)}})},t.getProgramInfo=function(e,t,a,i){var s=this,n=this.customer,r=this.businessUnit,o=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+n+"/businessunit/"+r+"/epg/"+e;i?o=o+"/program/"+i:o+="?from="+t.getTime()+"&to="+t.getTime(),V.get(o,null,function(e,t,i){if(e)return 0===e.statusCode&&(e.message=s.statusMessageZero),void a(null,e);if(!s.checkForError(e,t,a)){var n,r=JSON.parse(i);if(r.programs&&0<r.programs.length)n=r.programs[0];else{if(!r.programId)return void a(null,"No programs found.");n=r}n.start=new Date(n.startTime),n.end=new Date(n.endTime),n.duration=new Date(n.endTime)-new Date(n.startTime),a(n)}})},t.getNextProgram=function(e,a){var s=this,t=this.customer,i=this.businessUnit,n=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+t+"/businessunit/"+i+"/epg/program/"+e+"/next";V.get(n,null,function(e,t,i){if(e)return 0===e.statusCode&&(e.message=s.statusMessageZero),void a(null,e);if(!s.checkForError(e,t,a)){var n,r=JSON.parse(i);r.programId?((n=r).start=new Date(n.startTime),n.end=new Date(n.endTime),n.duration=new Date(n.endTime)-new Date(n.startTime),a(n)):a(null,"No programs found.")}})},t.getPreviousProgram=function(e,a){var s=this,t=this.customer,i=this.businessUnit,n=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+t+"/businessunit/"+i+"/epg/program/"+e+"/previous";V.get(n,null,function(e,t,i){if(e)return 0===e.statusCode&&(e.message=s.statusMessageZero),void a(null,e);if(!s.checkForError(e,t,a)){var n,r=JSON.parse(i);r.programId?((n=r).start=new Date(n.startTime),n.end=new Date(n.endTime),n.duration=new Date(n.endTime)-new Date(n.startTime),a(n)):a(null,"No programs found.")}})},t.getChannelInfo=function(e,t){void 0===t&&(t=function(){}),this.getAssetInfo(e,t)},t.getAssetInfo=function(e,r){var a=this,t=this.customer,i=this.businessUnit,n=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+t+"/businessunit/"+i+"/content/asset/"+e;V.get(n,null,function(e,t,i){if(e)return 0===e.statusCode&&(e.message=a.statusMessageZero),void r(null,e);if(!a.checkForError(e,t,r)){var n=JSON.parse(i);r(n)}})},t.verifyEntitlement=function(e,t,i){var n=this;void 0===i&&(i=function(){});var r=this.customer,a=this.businessUnit;if(!r)throw new dl("verifyEntitlement: Customer was not provided.");if(!a)throw new dl("verifyEntitlement: Business unit was not provided.");if(!e)throw new dl("verifyEntitlement: assetId was not provided.");if(!t)throw new dl("verifyEntitlement: playRequest was not provided.");var s=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+r+"/businessunit/"+a+"/entitlement/"+e+"?drm="+t.drm+"&format="+t.format,o=this.options_.exposureApiURL+"/v2/customer/"+r+"/businessunit/"+a+"/entitlement/"+e+"/entitle";this.internalVerifyEntitlement(o,function(e,t){t?400===t.statusCode||404===t.statusCode&&e&&-1===e.indexOf("status")||404===t.statusCode&&"404 Not found"===t.message?(Fa.warn("Fallback to Entitlement entitle v1",t.message),n.internalVerifyEntitlement(s,i)):i&&i(e,t):i(e,t)})},t.internalVerifyEntitlement=function(e,n){var r=this;V.get(e,{headers:this.requestHeaders},function(e,t,i){r.checkForError(e,t,n)||n(JSON.parse(i))})},t.verifySession=function(n,r){var a=this,e=this.customer,t=this.businessUnit,i=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+e+"/businessunit/"+t+"/auth/session";V.get(i,{headers:this.requestHeaders},function(e,t,i){a.checkForError(e,t)?r&&r():n&&n()})},ua(e,[{key:"requestHeaders",get:function(){var e={Authorization:"Bearer "+this.sessionToken};return this.options_.apiKey&&(e=Ta({"EMP-Auth":this.options_.apiKey},e)),e}},{key:"customer",get:function(){return this.customer_||this.options_.customer||null},set:function(e){this.customer_=e}},{key:"businessUnit",get:function(){return this.businessUnit_||this.options_.businessUnit||null},set:function(e){this.businessUnit_=e}},{key:"sessionToken",get:function(){return this.options_.sessionToken||null},set:function(e){this.options_.sessionToken=e}}]),e}(fl);fl.registerEntitlementEngine("EricssonExposure",gl);var vl=function(){function e(e){this.assetId=e.assetId||null,this.programId=e.programId||null,this.channelId=e.channelId||null}return ua(e,[{key:"assetId",get:function(){return this.assetId_},set:function(e){this.assetId_=e}},{key:"programId",get:function(){return this.programId_},set:function(e){this.programId_=e}},{key:"channelId",get:function(){return this.channelId_},set:function(e){this.channelId_=e}}]),e}(),yl=function(n){function e(e,t){var i;return i=n.call(this,e,t)||this,Fa("ProgramService","create"),i.MIN_PROGRAM_CHECK_TIMEOUT=1e3,i.checkForProgramChangeBind=i.checkForProgramChange_.bind(ma(i)),i.onEntitlementChangeBind=i.onEntitlementChange.bind(ma(i)),i.clearProgramChangeTimeoutBind=i.clearProgramChangeTimeout_.bind(ma(i)),i.options_=t||{},i.programChangeTimeout_=null,i.programChangeCheckTimestamp_=0,i.player.on(va.ENTITLEMENT_CHANGE,i.onEntitlementChangeBind),i}ca(e,n);var t=e.prototype;return t.entitlement=function(e){return void 0===e?this.entitlement_:this.entitlement_=e},t.options=function(e){if(!e)return this.options_;this.options_=e},t.onEntitlementChange=function(e,t){var i=t&&t.entitlement;i&&(i instanceof pl||(this.stop(),i=Ta(new pl({}),i)),this.entitlement(i)),ts.supportsEpgProgramChange(this.player)||(this.player.off(va.PLAYING,this.checkForProgramChangeBind),this.player.one(va.PLAYING,this.checkForProgramChangeBind))},t.start=function(){Fa("ProgramService","start"),this.entitlement()&&this.checkForProgramChange_({type:"startplayback"})},t.stop=function(){Fa("ProgramService stop"),this.clearProgramChangeTimeout_(),this.player&&(this.player.off(va.SEEKED,this.checkForProgramChangeBind),this.player.off(va.PLAYING,this.checkForProgramChangeBind),this.player.off(va.PAUSE,this.clearProgramChangeTimeoutBind),this.player.off(va.PLAY,this.checkForProgramChangeBind)),this.currentProgram_=null,this.currentVOD_=null},t.reset=function(){this.stop(),this.currentProgram_=null,this.shiftProgram_=null,this.currentVOD_=null,this.entitlement_=null},t.clearProgramChangeTimeout_=function(e){this.programChangeTimeout_&&(e&&Fa("clearProgramChangeTimeout",e.type),clearTimeout(this.programChangeTimeout_),this.programChangeTimeout_=null)},t.running=function(){return!!this.programChangeTimeout_&&(Fa("ProgramService:running",this.programChangeCheckTimestamp_?new Date(this.programChangeCheckTimestamp_):0),!0)},t.dispose=function(){Fa("ProgramService","dispose"),this.player.off(va.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.stop(),n.prototype.dispose.call(this)},t.checkForProgramChange_=function(e){if(e){if(Fa("checkForProgramChange",e.type),this.entitlement()&&(this.entitlement().live||this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive||e.type!==va.SEEKED)&&this.player&&this.player.options_)if(this.player.options_.absoluteStartTime&&e.type===va.SEEKED)Fa("checkForProgramChange","ignore livepoint");else{if(this.clearProgramChangeTimeout_(),ts.supportsEpgProgramChange(this.player))if(ts.program(this.player))return void Fa("updateCurrentProgram from player");var t=this.entitlement().channelId,i=this.entitlement().live,n=this.entitlement().programId;if(i||n){if("startplayback"===e.type||!this.eventProgramHasEnded_(t,n)){var r;if(i&&!n){var a=new Date(this.exposure.getCachedServerTime()),s="startplayback"===e.type?15:ts.timeBehindLive(this.player);if(a.setSeconds(a.getSeconds()-s),r=a,Fa("checkForProgramChange","Live",s),this.currentProgram&&this.currentProgram.channelId===this.entitlement().channelId&&r.getTime()<this.currentProgram.end.getTime()&&r.getTime()>=this.currentProgram.start.getTime())return Fa("checkForProgramChange","Same"),r=null,void this.updateCurrentProgram_(this.currentProgram,!1)}else if("startplayback"!==e.type&&(this.entitlement().isDynamicCachupAsLive||this.entitlement().isStaticCachupAsLive)){var o=ts.getPlayheadTime(this.player);if(r=new Date(o),this.currentProgram)return void(!this.isProgramEvent&&this.entitlement().isStaticCachupAsLive&&r.getTime()+2e3>=this.entitlement().streamInfo.end.getTime()?this.player.lineUpAsset&&r.getTime()+2e3<this.currentProgram.end.getTime()?(Fa("checkForProgramChange","Load next stream",r),this.player.lineUpAsset(this.currentProgram.assetId,null,null,r.getTime(),!0)):(Fa("checkForProgramChange","playNextProgram",r),this.player.playNextProgram()):r.getTime()+2e3>=this.currentProgram.end.getTime()?(Fa("checkForProgramChange","Next",r),r.setSeconds(r.getSeconds()+2),this.shiftToNextProgram_(n,t,r)):r.getTime()<this.currentProgram.end.getTime()&&r.getTime()+2e3>this.currentProgram.start.getTime()?(Fa("checkForProgramChange","Same",r),r=null,this.updateCurrentProgram_(this.currentProgram,!1)):this.isProgramEvent?(r=null,this.updateCurrentProgram_(this.currentProgram,!1)):(Fa("checkForProgramChange","Prev",r),this.shiftToPreviousProgram_(n,t,r)))}r&&this.shiftProgram_&&t===this.shiftProgram_.channelId&&this.shiftProgram_.start.getTime()<=r.getTime()&&this.shiftProgram_.end.getTime()>=r.getTime()?this.updateCurrentProgram_(this.shiftProgram_,!1):"pollingforepg"!==e.type||this.epgPolling?this.shiftCurrentProgram_(n,t,r,"startplayback"===e.type):"pollingforepg"===e.type&&this.pollingForEPG_()}}else this.updateVOD_(this.entitlement().assetId)}}else Fa.error("checkForProgramChange","event was not provided.")},t.stopEventProgram=function(){this.player.options_.playlist&&1<this.player.currentSources().length&&!1!==this.player.options_.autosequence?this.player.loadNextSource():this.player.stop()},t.eventProgramHasEnded_=function(e,t){var i=this;return!!(this.currentProgram&&this.isProgramEvent&&ts.getPlayheadTime(this.player)+2e3>=this.currentProgram.end.getTime())&&(Fa("event program ended"),this.entitlement().isStaticCachupAsLive?(Fa("Static live program, stop playback"),this.stopEventProgram()):this.exposure.getProgramInfo(e,null,function(e,t){t&&Fa("getProgramInfo","No EPG found.",t),!t&&e.end.getTime()>i.currentProgram.end.getTime()?(Fa("Current program has been extended"),i.updateCurrentProgram_(e,!1,!0)):i.player.options_.playlist?i.stopEventProgram():i.getNextProgram(function(e,t){t&&("404 NO_NEXT_PROGRAM"!==t.message&&Fa.warn("shiftToNextProgram",t),Fa("No upcomming program, stop playback"),i.stopEventProgram()),e&&e.start.getTime()-2e3<=ts.getPlayheadTime(i.player)&&e.end.getTime()>=ts.getPlayheadTime(i.player)?i.updateCurrentProgram_(e,!1):(Fa("Gap before upcomming program, stop playback"),i.stopEventProgram())})},t),!0)},t.shiftCurrentProgram_=function(e,t,i,n){var r=this;void 0===n&&(n=!1),this.shiftProgram_&&e===this.shiftProgram_.programId?this.updateCurrentProgram_(this.shiftProgram_,!1):this.exposure.getProgramInfo(t,i,function(e,t){if(r.currentVOD_=null,t)return Fa("getProgramInfo","No EPG found.",t),void r.pollingForEPG_();r.updateCurrentProgram_(e,n)},i?null:e)},t.shiftToPreviousProgram_=function(i,n,r){var a=this;this.shiftProgram_&&n===this.shiftProgram_.channelId&&this.shiftProgram_.start.getTime()<=r.getTime()&&this.shiftProgram_.end.getTime()>=r.getTime()?this.updateCurrentProgram_(this.shiftProgram_,!1):this.getPreviousProgram(function(e,t){t?(Fa.warn("shiftToPreviousProgram",t),a.shiftCurrentProgram_(i,n,r)):e.start.getTime()<=r.getTime()&&e.end.getTime()>=r.getTime()?a.updateCurrentProgram_(e,!1):a.shiftCurrentProgram_(i,n,r)})},t.shiftToNextProgram_=function(i,n,r){var a=this;this.shiftProgram_&&n===this.shiftProgram_.channelId&&this.shiftProgram_.start.getTime()<=r.getTime()&&this.shiftProgram_.end.getTime()>=r.getTime()?this.updateCurrentProgram_(this.shiftProgram_,!1):this.getNextProgram(function(e,t){t?("404 NO_NEXT_PROGRAM"!==t.message?Fa.warn("shiftToNextProgram",t):Fa("shiftToNextProgram",t.message),a.shiftCurrentProgram_(i,n,r)):e.start.getTime()<=r.getTime()&&e.end.getTime()>=r.getTime()?a.updateCurrentProgram_(e,!1):a.shiftCurrentProgram_(i,n,r)})},t.updateChannelInfo_=function(i,n){var r=this;return i&&i.channelId?this.currentChannelAsset_&&this.currentChannelAsset_.assetId===i.channelId?(i.channelInfo=this.extractAssetMetadata(this.currentChannelAsset_),void n()):void this.exposure.getChannelInfo(i.channelId,function(e,t){if(t)return Fa.warn("updateChannelInfo","No ChannelInfo found.",t),void n();Fa("updateChannelInfo",i.channelId),r.currentChannelAsset_=e,i.channelInfo=r.extractAssetMetadata(r.currentChannelAsset_),n()}):(Fa.error("updateChannelInfo","program or channelId empty"),void n())},t.updateVOD_=function(e){var i=this;this.currentProgram_=null,this.shiftProgram_=null,ts.currentAsset(this.player,e),this.currentVOD_&&this.currentVOD_.assetId===e||this.exposure.getAssetInfo(e,function(e,t){if(i.player)return t?(Fa.warn("No AssetInfo found.",t),i.currentVOD_=null,void i.player.trigger(va.ASSET_CHANGED,{asset:null})):void(i.currentVOD_&&i.currentVOD_.assetId===e.assetId||(i.currentVOD_=e,ts.setTechVOD(i.player,e),Fa("ASSET_CHANGED"),i.player.trigger(va.ASSET_CHANGED,{asset:e})))})},t.updateCurrentProgram_=function(e,t,i){var n=this;if(void 0===t&&(t=!1),void 0===i&&(i=!1),Fa("updateCurrentProgram",e,t),this.clearProgramChangeTimeout_(),this.shiftProgram_=null,this.currentVOD_=null,this.player){if(ts.currentAsset(this.player,e.assetId,e.programId,e.channelId),this.entitlement_&&(this.entitlement_.channelId=e.channelId,this.entitlement_.assetId=e.assetId,this.entitlement_.programId=e.programId),ts.setTechProgram(this.player,e),this.player.removeClass("vjs-live"),this.currentProgram&&this.currentProgram.programId===e.programId)i&&(this.player.trigger(va.PROGRAM_CHANGED,{program:e}),this.player.trigger(va.DURATION_CHANGE));else{if(!t){var r=(this.player.getServerTime()-e.start.getTime())/1e3;Fa("verifyEntitlement timeBehindLive",r),r<5?(Fa("Wait for verifyEntitlement ",5-r),setTimeout(function(){n.verifyEntitlement(e)},1e3*(5-r))):this.verifyEntitlement(e)}this.isProgramEvent?(this.player.trigger(va.PROGRAM_CHANGED,{program:e}),this.player.trigger(va.DURATION_CHANGE)):this.updateChannelInfo_(e,function(){n.player.trigger(va.PROGRAM_CHANGED,{program:e}),n.player.trigger(va.DURATION_CHANGE)})}if(this.currentProgram_=e,t)Fa("updateCurrentProgram","startplayback");else{if(this.entitlement().isDynamicCachupAsLive||this.entitlement().live||this.entitlement().isStaticCachupAsLive){var a;if(this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive){var s=ts.getPlayheadTime(this.player);if(!s)return void Fa("updateCurrentProgram","no playHeadTime",s);a=new Date(s)}else{var o=ts.timeBehindLive(this.player);(a=new Date(this.exposure.getCachedServerTime())).setSeconds(a.getSeconds()-o)}var l=new Date(e.start.getTime()+e.duration),u=this.entitlement().streamInfo.end;u&&l.getTime()>u.getTime()&&(l=u);var c=l.getTime()-a.getTime();(!c||c<this.MIN_PROGRAM_CHECK_TIMEOUT)&&(Fa("updateCurrentProgram","timediff is below minimum",c),c=this.MIN_PROGRAM_CHECK_TIMEOUT),this.programChangeCheckTimestamp_=Date.now()+c,Fa("updateCurrentProgram","programChangeTimeout",new Date(this.programChangeCheckTimestamp_)),this.programChangeTimeout_=setTimeout(function(){n.checkForProgramChange_({type:"programend"}),n.programChangeTimeout_=null},2147483647<c?2147483647:c)}this.player.off(va.SEEKED,this.checkForProgramChangeBind),this.player.one(va.SEEKED,this.checkForProgramChangeBind),this.player.off(va.PLAY,this.checkForProgramChangeBind),this.player.one(va.PLAY,this.checkForProgramChangeBind),this.player.off(va.PAUSE,this.clearProgramChangeTimeoutBind),this.player.one(va.PAUSE,this.clearProgramChangeTimeoutBind)}}},t.pollingForEPG_=function(){var e=this;this.currentProgram_=null,this.entitlement_.programId=null,this.entitlement_.assetId=null,this.player.trigger(va.PROGRAM_CHANGED,{program:null}),this.player.trigger(va.DURATION_CHANGE),this.player.addClass("vjs-live");var t=12e4+60*Math.random()*1e3;this.programChangeCheckTimestamp_=Date.now()+t,this.programChangeTimeout_=setTimeout(function(){e.checkForProgramChange_({type:"pollingforepg"}),e.programChangeTimeout_=null},t)},t.getNextProgram=function(i){var n=this;this.currentProgram||!i?this.exposure.getCachedServerTime()<this.currentProgram.end.getTime()?i(this.currentProgram):this.exposure.getNextProgram(this.currentProgram.programId,function(e,t){t?i(null,t):(n.shiftProgram_=e,i(e))},null):i(null,{message:"getNextProgram No Current Program"})},t.getPreviousProgram=function(i){var n=this;this.currentProgram||!i?this.exposure.getPreviousProgram(this.currentProgram.programId,function(e,t){t?i(null,t):(n.shiftProgram_=e,i(e))},null):i(null,{message:"getPreviousProgram No Current Program"})},t.getProgram=function(e,i){var n=this;this.currentProgram||!i?this.currentProgram.start.getTime()<=e.getTime()&&this.currentProgram.end.getTime()>=e.getTime()?i(this.currentProgram):this.shiftProgram_&&this.currentProgram.channelId===this.shiftProgram_.channelId&&this.shiftProgram_.start.getTime()<=e.getTime()&&this.shiftProgram_.end.getTime()>=e.getTime()?i(this.shiftProgram_):this.exposure.getProgramInfo(this.currentProgram.channelId,e,function(e,t){t?i(null,t):(n.shiftProgram_=e,i(e))},null):i(null,{message:"getProgram No Current Program"})},t.verifyEntitlement=function(e){var i=this;this.exposure.verifyEntitlement(e.assetId,this.entitlement().playRequest,function(e,t){return t?(i.player.error("verifyEntitlement "+t.message),void ts.stop(i.player)):e&&"SUCCESS"===e.status?(e.streamInfo&&i.entitlement_&&(i.entitlement_.streamInfo.event=e.streamInfo.event&&void 0!==e.streamInfo.programId,i.entitlement_.streamInfo.programId=e.streamInfo.programId||void 0,i.entitlement_.programId=i.entitlement_.streamInfo.programId,i.player.trigger(va.ENTITLEMENT_CHANGE,{entitlement:i.entitlement_})),void Fa("verifyEntitlement",e.status)):(i.player.error(e?e.status:"verifyEntitlement no status"),void ts.stop(i.player))})},t.getAssetMetadata=function(e,i){var n=this,t=this.currentProgram?this.currentProgram.asset:this.currentVOD;t&&t.assetId===e?i(this.extractAssetMetadata(t)):this.exposure.getAssetMetadata_(e,function(e,t){if(t)return Fa.warn("getAssetMetadata","No data found.",t),void i(null,t);i(n.extractAssetMetadata(e))})},t.extractAssetMetadata=function(e){var t=null,i=null,n=null,r=this.getLocalizedAssetMetadata(e);return r&&(r.title&&(t=r.title),r.shortDescription?i=r.shortDescription:r.description&&(i=r.description),r.images&&0<r.images.length&&r.images[0].url&&(n=r.images)),{title:t||"",subtitle:i||"",images:n||[]}},t.getLocalizedAssetMetadata=function(e){var t=null;if(e&&e.localized&&0<e.localized.length){t=e.localized[0];var i=this.player.language();if(i)for(var n=0;n<e.localized.length;n++)if(e.localized[n].locale===i)return Fa("Use Localized AssetMetadata for",i),e.localized[n];Fa("Use default Localized AssetMetadata",e.localized[0].locale)}else Fa("No AssetMetadata");return t},ua(e,[{key:"exposure",get:function(){if(!this.options_.exposure){var e=this.player.options_["entitlement-engine"];e=e||(this.player.options_["exposure-service"]?this.player.options_["exposure-service"]:"EricssonExposure");var t=this.player.options_[e.toLowerCase()];if(!t)return null;var i=fl.getEntitlementEngine(e);this.options_.exposure=new i(t)}return this.options_.exposure}},{key:"epgPolling",get:function(){if(this.isProgramEvent)return!1;var e=this.player.options();return!e||!0!==e.epgPollingDisabled}},{key:"currentProgram",get:function(){return ts.supportsEpgProgramChange(this.player)?ts.program(this.player):this.currentProgram_}},{key:"currentChannelAsset",get:function(){return this.currentChannelAsset_}},{key:"currentVOD",get:function(){return this.currentVOD_}},{key:"isProgramEvent",get:function(){return!!(this.entitlement_&&this.entitlement_.streamInfo&&this.entitlement_.streamInfo.event||this.player.options_.playlist)}}]),e}(ga.getPlugin("plugin"));yl.VERSION="2.2.124-498",ga.getPlugin("programService")?ga.log.warn('A plugin named "programService" already exists.'):ga.registerPlugin("programService",yl);var bl=function(n){function e(e,t){var i;return i=n.call(this,e,t)||this,Fa("EntitlementExpirationService","create"),i.options_=t,i.onEntitlementChangeBind=i.onEntitlementChange.bind(ma(i)),i}ca(e,n);var t=e.prototype;return t.dispose=function(){Fa("EntitlementExpirationService","dispose"),this.stop(),n.prototype.dispose.call(this)},t.stop=function(){Fa("EntitlementExpirationService","stop"),this.player.off(va.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.expirationTimeout_&&(clearTimeout(this.expirationTimeout_),this.expirationTimeout_=null)},t.start=function(){Fa("EntitlementExpirationService","start"),this.expirationTimeout_&&(clearTimeout(this.expirationTimeout_),this.expirationTimeout_=null),this.player.off(va.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.player.on(va.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind)},t.entitlement=function(e){return void 0===e?this.entitlement_:this.entitlement_=e},t.onEntitlementChange=function(e,t){this.entitlement(t&&t.entitlement),this.expirationTimeout_&&(clearTimeout(this.expirationTimeout_),this.expirationTimeout_=null),this.checkForExpiration()},t.options=function(e){if(!e)return this.options_;this.options_=e},t.checkForExpiration=function(){var e=this,t=this.entitlement();if(Fa("EntitlementExpirationService","checkForExpiration",t.licenseExpiration),this.hasLicenseExpiration(t)){var i=t.licenseExpiration.getTime()-this.exposure.getCachedServerTime();if(i<=0)return this.player.error(this.errorForReason(t.licenseExpirationReason)),void ts.stop(this.player);i<2147483647?this.expirationTimeout_=setTimeout(function(){e.expirationTimeout_=null,Fa("EntitlementExpirationService","license expired"),e.refreshEntitlement()},i):setTimeout(function(){return e.checkForExpiration()},1073741823)}},t.refreshEntitlement=function(){ts.restart(this.player,!0)},t.errorForReason=function(e){switch(e){case"GEO_BLOCKED":return this.player.localize("Not allowed from this region.");case"NOT_ENTITLED":return this.player.localize("The user is not entitled.");case"GAP_IN_EPG":return this.player.localize("Asset temporarily not available");case"EPG_PLAY_MAX_HOURS":default:return this.player.localize("Asset exceeded maximum playback time")}},t.hasLicenseExpiration=function(e){return!!e.licenseExpiration},ua(e,[{key:"exposure",get:function(){return this.options_&&this.options_.exposure}}]),e}(ga.getPlugin("plugin"));bl.VERSION="2.2.124-498",ga.getPlugin("entitlementExpirationService")?ga.log.warn('A plugin named "entitlementExpirationService" already exists.'):ga.registerPlugin("entitlementExpirationService",bl);function _l(C){function k(e,t,i,n){C.options_.absoluteStartTime&&C.options_.absoluteStartTime>t.getCachedServerTime()?C.options_.absoluteStartTime=t.getCachedServerTime()-1e4:C.options_.startTime&&C.options_.startTime>t.getCachedServerTime()/1e3&&(C.options_.startTime=(t.getCachedServerTime()-1e4)/1e3);if(C.programService&&(!e.programService||!e.programService.disable)){if(C.programService().options({exposure:t}),i.isDynamicCachupAsLive&&e.playFrom)if("beginning"===e.playFrom||!i.live&&!C.options_.absoluteStartTime&&!C.options_.startTime){var r=i.streamInfo.start.getTime()+100;"application/dash+xml"===i.mimeType||"application/vnd.ms-sstr+xml"===i.mimeType?(Fa("SET startTime",r),C.options({startTime:r/1e3}),i.options.startTime=r/1e3):(Fa("SET startTime",.1),C.options({startTime:.1}),i.options.startTime=.1)}else if(C.options_.absoluteStartTime){C.options_.absoluteStartTime<i.streamInfo.start.getTime()&&(C.options_.absoluteStartTime=i.streamInfo.start.getTime());var a=C.options_.absoluteStartTime;"HLS"===C.streamType&&(a=C.options_.absoluteStartTime-i.streamInfo.start.getTime()),Fa("absoluteStartTime SET startTime",a=a||.1),C.options({startTime:a/1e3}),i.options.startTime=a/1e3,C.options_.absoluteStartTime=void 0,i.options.absoluteStartTime=void 0}else C.options_.startTime&&(i.options.startTime=C.options_.startTime,C.options_.absoluteStartTime=void 0,i.options.absoluteStartTime=void 0);else if(i.isStaticCachupAsLive&&C.options_.absoluteStartTime){C.options_.absoluteStartTime<i.streamInfo.start.getTime()&&(C.options_.absoluteStartTime=i.streamInfo.start.getTime());var s=C.options_.absoluteStartTime-i.streamInfo.start.getTime();Fa("absoluteStartTime SET startTime",s),C.options({startTime:s/1e3}),i.options.startTime=s/1e3,C.options_.absoluteStartTime=void 0,i.options.absoluteStartTime=void 0}else i.isStaticCachupAsLive&&C.options_.startTime&&(i.options.startTime=C.options_.startTime,C.options_.absoluteStartTime=void 0,i.options.absoluteStartTime=void 0);C.programService().start()}n()}function A(e,t,i){if(e){!0===i.useLastViewedOffset&&((e.isStaticCachupAsLive||e.isDynamicCachupAsLive||e.live)&&(e.lastViewedTime||e.liveTime)?e.liveTime&&(Fa("liveTime",new Date(e.liveTime),e.liveTime),C.options({absoluteStartTime:e.liveTime})):e.lastViewedOffset&&(!e.durationInMs||e.lastViewedOffset<e.durationInMs-3e4)&&(Fa("lastViewedOffset",e.lastViewedOffset/1e3),C.options({startTime:e.lastViewedOffset/1e3}))),!1===e.timeshiftEnabled&&C.options({timeShiftDisabled:!0}),C.trigger(va.ENTITLEMENT_CHANGE,{entitlement:e}),(e=Ta(new pl({}),e)).type=e.mimeType;var n={autoplay:C.options_.autoplay,muted:C.options_.muted,language:C.options_.language,maxBitrate:C.options_.maxBitrate,timeShiftDisabled:C.options_.timeShiftDisabled,useLastViewedOffset:C.options_.useLastViewedOffset,startTime:C.options_.startTime,absoluteStartTime:C.options_.absoluteStartTime,audioLanguage:C.options_.audioLanguage,subtitleLanguage:C.options_.subtitleLanguage,liveDelay:C.options_.liveDelay};return t?Ta(t,n):t=n,e.options=t,e.options.source=e,C.entitlementExpirationService().start(),e}Fa.error("setupEntitlement_ no entitlement")}return{setSource:function(e,s){var t,o=C.options(),l=null,u=null,c=null;if(C.programService&&C.programService().stop(),(t=C.currentSource())&&t.playSessionId&&t.playToken&&t.mediaLocator)l=C.currentSource();else{var i=xa(e.src);c=new vl(i),C.trigger(va.ENTITLEMENT_LOAD_START,c)}var n=o["entitlement-engine"];n=n||(o["exposure-service"]?o["exposure-service"]:"EricssonExposure");var r=o[n.toLowerCase()];if(!r){var a=new Ma("Missing entitlementOptions in player options",Na.ENTITLEMENT);return C.error(a),void s(a)}var h=_l.getExposure(r,n);if(r.sessionToken){var d,f,p,m;o.analytics&&o.analytics.disable||(f=r,p=h,(m=(d=o).analyticsDeviceInfo)&&(Fa.warn("options.analyticsDeviceInfo is deprecated. Use options.analytics.deviceInfo."),d.analytics||(d.analytics={}),d.analytics.deviceInfo=m),C.analytics&&(C.analytics().options({exposure:p,analytics:d.analytics}),C.analytics().newAnalytics({exposureApiURL:f.exposureApiURL,customer:f.customer,businessUnit:f.businessUnit,sessionToken:f.sessionToken}),C.analytics().onEntitlementLoadStart())),C.entitlementExpirationService().options({exposure:h});var g,v,y,b,_,T,S,E=o.techOrder.map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).map(function(e){return[e,Tl.getTech(e)]}).filter(function(e){e[0];var t=e[1];if(t&&t.entitlementPlayRequest)return t.isSupported()});if(0===E.length){var w=new Ma("Unable to load asset: None of the playback technologies are supported",Na.ENTITLEMENT);return C.error(w),void s(w)}v=E.length,y=function(i){var n=i.iteration();if(o.excludeTechs&&-1!==o.excludeTechs.indexOf(E[n][0]))i.next();else{var e=E[n][1],r=o[E[n][0].toLowerCase()];C.tech_&&C.techName_!==E[n][0]&&(C.techCall_("reset"),C.unloadTech_());try{if(l)return l=A(l,r,o),k(o,h,l,function(){s(null,l)}),void i.break();var a=r&&r.streamType&&e.entitlementPlayRequests?e.entitlementPlayRequests[r.streamType]:e.entitlementPlayRequest;h.getV2Entitlement(c,a,function(e,t){if(t){if(C.options_.excludeTechs||(C.options_.excludeTechs=[]),C.options_.excludeTechs.push(E[n][0]),g=new Ma(t.message+"  "+JSON.stringify(a)+JSON.stringify(c),t.code,t.stack),t.fatal)return C.error(g),ts.stop(C),void s(g);u=e,i.next()}else l=A(e,r,o),ts.currentAsset(C,e.assetId,e.programId,e.channelId),l.adMediaLocator&&C.yospace?(Fa("play adMediaLocator with yospace",l.adMediaLocator),C.yospace().start("VoD",l.adMediaLocator).then(function(e){Fa("yospace mediaLocator returned",e),l.mediaLocator=e,l.src=e,k(o,h,l,function(){s(null,l)}),i.break()}).catch(function(e){g=new Ma(e,Na.ENTITLEMENT),C.error(g),ts.stop(C),l=null})):(k(o,h,l,function(){s(null,l)}),i.break())},u)}catch(e){return Fa.warn("error try next tech",new Ma(e,Na.ENTITLEMENT)),void i.next()}}},_=0,T=!(b=function(){return null===l&&(g=g||new Ma("Unable to load asset: None of the playback technologies are supported",Na.ENTITLEMENT),C.error(g),ts.stop(C),void s(g))}),(S={next:function(){T||(_<v?(_++,y(S)):(T=!0,b()))},iteration:function(){return _-1},break:function(){T=!0,b()}}).next()}else h.login("","",function(e){if(e.success)r.sessionToken=e.session.sessionToken,C.trigger(va.REPLAY);else{Fa.error("Anonymous login fail",e.message);var t=new Ma("Anonymous login fail",Na.ENTITLEMENT);C.error(t)}},"")}}}var Tl=ga.getComponent("Tech");_l.isExposure=function(e){return fl.isEntitlementEngine(e)},_l.EntitlementClass=pl,_l.getExposure=function(e,t){if(e)return new(fl.getEntitlementEngine(t))(e);throw new Ma("Missing exposureOptions",Na.ENTITLEMENT)},_l.registerExposure=function(e,t){return fl.registerEntitlementEngine(e,t)},_l.getLog=function(){return Fa},_l.getEntitlementEngine=fl.getEntitlementEngine,_l.registerEntitlementEngine=fl.registerEntitlementEngine,_l.isEntitlementEngine=fl.isEntitlementEngine,_l.VERSION="2.2.124-498",ga.EntitlementMiddleware?ga.log.warn("EntitlementMiddleware already exists."):(ga.use("video/emp",_l),ga.EntitlementMiddleware=_l);var Sl=T.empEntitlement?T.empEntitlement:_l,El=ga;El.canPlayUnencrypted=function(){var e=ga.getTech("EmpShaka");if(void 0!==e&&e.isSupported())return Promise.resolve(!0);var t=ga.getTech("EmpDashif");if(void 0!==t&&t.isSupported())return Promise.resolve(!0);var i=ga.getTech("EmpHLS");if(void 0!==i&&i.isSupported())return Promise.resolve(!0);var n=ga.getTech("EmpHLS-MSE");if(void 0!==n&&n.isSupported())return Promise.resolve(!0);var r=ga.getTech("EmpSmooth");return void 0!==r&&r.isSupported()?Promise.resolve(!0):Promise.resolve(!1)},El.canPlayEncrypted=function(){var e=[];if("function"==typeof T.navigator.requestMediaKeySystemAccess){var i=[{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.5"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.4d401f"',robustness:!0==(-1!==T.navigator.userAgent.indexOf("Android"))?"SW_SECURE_DECODE":"SW_SECURE_CRYPTO"}],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]}],t=ga.getTech("EmpShaka"),n=ga.getTech("EmpDashif"),r=ga.getTech("EmpSmooth");(void 0!==t&&t.isSupported()||void 0!==n&&n.isSupported()||void 0!==r&&r.isSupported())&&(e.push(new Promise(function(e,t){T.navigator.requestMediaKeySystemAccess("com.microsoft.playready",i).then(function(){e(!0)},function(){e(!1)})})),e.push(new Promise(function(e,t){T.navigator.requestMediaKeySystemAccess("com.widevine.alpha",i).then(function(){e(!0)},function(){e(!1)})})))}else{var a=ga.getTech("EmpShaka"),s=ga.getTech("EmpDashif"),o=ga.getTech("EmpSmooth");(void 0!==a&&a.isSupported()||void 0!==s&&s.isSupported()||void 0!==o&&o.isSupported())&&11===Is&&T.MSMediaKeys&&T.MSMediaKeys.isTypeSupported("com.microsoft.playready","video/mp4")&&e.push(!0)}var l=ga.getTech("EmpHLS");return void 0!==l&&l.isSupported()&&T.WebKitMediaKeys&&l.getKeySystem&&T.WebKitMediaKeys.isTypeSupported(l.getKeySystem(),"video/mp4")&&e.push(!0),0===e.length&&e.push(!1),Promise.all(e).then(function(e){return-1!==e.indexOf(!0)},function(e){return!1})},El.getExposure=Sl.getExposure,El.getEntitlementEngine=Sl.getEntitlementEngine,El.registerEntitlementEngine=Sl.registerEntitlementEngine,El.isEntitlementEngine=Sl.isEntitlementEngine,El.EntitlementClass=Sl.EntitlementClass,El.log=Fa,El.plugin=ga.plugin,El.videojs=ga,El.EntitlementMiddleware=Sl,El.extend=ga.extend,El.Events=va,El.VERSION="2.2.124-498","function"==typeof define&&define.amd?define("empPlayer",[],function(){return El}):"object"==typeof exports&&"object"==typeof module&&(module.exports=El);var wl=t(function(Lc,n){!function(){var e="undefined"!=typeof window?window:_,t={};for(var i in function(d,e){var t,s="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,i){e!=Array.prototype&&e!=Object.prototype&&(e[t]=i.value)},u=(void 0===d||d!==this)&&void 0!==e&&null!=e?e:this;function l(){l=function(){},u.Symbol||(u.Symbol=n)}var i,n=(i=0,function(e){return"jscomp_symbol_"+(e||"")+i++});function c(){l();var e=u.Symbol.iterator;e=e||(u.Symbol.iterator=u.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&s(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return r(this)}}),c=function(){}}function r(e){var t=0;return a(function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}})}function a(e){return c(),(e={next:e})[u.Symbol.iterator]=function(){return this},e}function q(e){c();var t=e[Symbol.iterator];return t?t.call(e):r(e)}function o(e,t){if(t){for(var i=u,n=e.split("."),r=0;r<n.length-1;r++){var a=n[r];a in i||(i[a]={}),i=i[a]}(a=t(r=i[n=n[n.length-1]]))!=r&&null!=a&&s(i,n,{configurable:!0,writable:!0,value:a})}}function h(t){function r(e){return t.next(e)}function a(e){return t.throw(e)}return new Promise(function(i,n){!function e(t){t.done?i(t.value):Promise.resolve(t.value).then(r,a).then(e,n)}(t.next())})}function z(e){return h(e())}o("Promise",function(e){function o(e){this.b=0,this.g=void 0,this.a=[];var t=this.c();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function t(){this.a=null}function l(t){return t instanceof o?t:new o(function(e){e(t)})}if(e)return e;t.prototype.b=function(e){null==this.a&&(this.a=[],this.f()),this.a.push(e)},t.prototype.f=function(){var e=this;this.c(function(){e.h()})};var i=u.setTimeout;t.prototype.c=function(e){i(e,0)},t.prototype.h=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var i=e[t];e[t]=null;try{i()}catch(e){this.g(e)}}}this.a=null},t.prototype.g=function(e){this.c(function(){throw e})},o.prototype.c=function(){function e(t){return function(e){n||(n=!0,t.call(i,e))}}var i=this,n=!1;return{resolve:e(this.s),reject:e(this.f)}},o.prototype.s=function(e){if(e===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof o)this.u(e);else{e:switch(typeof e){case"object":var t=null!=e;break e;case"function":t=!0;break e;default:t=!1}t?this.m(e):this.h(e)}},o.prototype.m=function(e){var t=void 0;try{t=e.then}catch(e){return void this.f(e)}"function"==typeof t?this.C(t,e):this.h(e)},o.prototype.f=function(e){this.i(2,e)},o.prototype.h=function(e){this.i(1,e)},o.prototype.i=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.g=t,this.l()},o.prototype.l=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)r.b(this.a[e]);this.a=null}};var r=new t;return o.prototype.u=function(e){var t=this.c();e.ac(t.resolve,t.reject)},o.prototype.C=function(e,t){var i=this.c();try{e.call(t,i.resolve,i.reject)}catch(e){i.reject(e)}},o.prototype.then=function(e,t){function i(t,e){return"function"==typeof t?function(e){try{n(t(e))}catch(e){r(e)}}:e}var n,r,a=new o(function(e,t){n=e,r=t});return this.ac(i(e,n),i(t,r)),a},o.prototype.catch=function(e){return this.then(void 0,e)},o.prototype.ac=function(e,t){function i(){switch(n.b){case 1:e(n.g);break;case 2:t(n.g);break;default:throw Error("Unexpected state: "+n.b)}}var n=this;null==this.a?r.b(i):this.a.push(i)},o.resolve=l,o.reject=function(i){return new o(function(e,t){t(i)})},o.race=function(r){return new o(function(e,t){for(var i=q(r),n=i.next();!n.done;n=i.next())l(n.value).ac(e,t)})},o.all=function(e){var a=q(e),s=a.next();return s.done?l([]):new o(function(i,e){function t(t){return function(e){n[t]=e,0==--r&&i(n)}}for(var n=[],r=0;n.push(void 0),r++,l(s.value).ac(t(n.length-1),e),!(s=a.next()).done;);})},o}),o("Promise.prototype.finally",function(e){return e||function(t){return this.then(function(e){return Promise.resolve(t()).then(function(){return e})},function(e){return Promise.resolve(t()).then(function(){throw e})})}});var f,p="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)f=Object.setPrototypeOf;else{var m;e:{var g={};try{g.__proto__={pe:!0},m=g.pe;break e}catch(e){}m=!1}f=m?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var v=f;function y(){this.g=!1,this.c=null,this.o=void 0,this.j=1,this.b=this.f=0,this.i=this.a=null}function b(e){if(e.g)throw new TypeError("Generator is already running");e.g=!0}function _(e,t){e.a={Cd:t,Jd:!0},e.j=e.f||e.b}function Y(e,t,i){return e.j=i,{value:t}}function F(e){e.j=0}function E(e,t,i){e.f=t,null!=i&&(e.b=i)}function L(e,t){e.f=0,e.b=t||0}function S(e,t){e.j=t,e.f=0}function w(e){e.f=0;var t=e.a.Cd;return e.a=null,t}function R(e){e.i=[e.a],e.f=0,e.b=0}function O(e,t){var i=e.i.splice(0)[0];(i=e.a=e.a||i)?i.Jd?e.j=e.f||e.b:null!=i.A&&e.b<i.A?(e.j=i.A,e.a=null):e.j=e.b:e.j=t}function T(e){this.a=new y,this.b=e}function C(t,e,i,n){try{var r=e.call(t.a.c,i);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return t.a.g=!1,r;var a=r.value}catch(e){return t.a.c=null,_(t.a,e),k(t)}return t.a.c=null,n.call(t.a,a),k(t)}function k(t){for(;t.a.j;)try{var e=t.b(t.a);if(e)return t.a.g=!1,{value:e.value,done:!1}}catch(e){t.a.o=void 0,_(t.a,e)}if(t.a.g=!1,t.a.a){if(e=t.a.a,t.a.a=null,e.Jd)throw e.Cd;return{value:e.return,done:!0}}return{value:void 0,done:!0}}function A(t){this.next=function(e){return b(t.a),e=t.a.c?C(t,t.a.c.next,e,t.a.h):(t.a.h(e),k(t))},this.throw=function(e){return b(t.a),e=t.a.c?C(t,t.a.c.throw,e,t.a.h):(_(t.a,e),k(t))},this.return=function(e){return function(e,t){b(e.a);var i=e.a.c;return i?C(e,"return"in i?i.return:function(e){return{value:e,done:!0}},t,e.a.return):(e.a.return(t),k(e))}(t,e)},c(),this[Symbol.iterator]=function(){return this}}function X(e,t){return A.prototype=e.prototype,new A(new T(t))}function I(e){if(!(e instanceof Array)){e=q(e);for(var t,i=[];!(t=e.next()).done;)i.push(t.value);e=i}return e}function x(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function P(e,t,i){e instanceof String&&(e=String(e));for(var n=e.length,r=0;r<n;r++){var a=e[r];if(t.call(i,a,r,e))return{Gd:r,ke:a}}return{Gd:-1,ke:void 0}}function D(e,t,i){if(null==e)throw new TypeError("The 'this' value for String.prototype."+i+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+i+" must not be a regular expression");return e+""}y.prototype.h=function(e){this.o=e},y.prototype.return=function(e){this.a={return:e},this.j=this.b},y.prototype.A=function(e){this.j=e},o("WeakMap",function(n){function e(e){if(this.a=(a+=Math.random()+1).toString(),e){l(),c(),e=q(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function i(e){x(e,r)||s(e,r,{value:{}})}function t(e){var t=Object[e];t&&(Object[e]=function(e){return i(e),t(e)})}if(function(){if(n&&Object.seal)try{var e=Object.seal({}),t=Object.seal({}),i=new n([[e,2],[t,3]]);return 2!=i.get(e)||3!=i.get(t)?void 0:(i.delete(e),i.set(t,4),!i.has(e)&&4==i.get(t))}catch(e){return}}())return n;var r="$jscomp_hidden_"+Math.random();t("freeze"),t("preventExtensions"),t("seal");var a=0;return e.prototype.set=function(e,t){if(i(e),!x(e,r))throw Error("WeakMap key fail: "+e);return e[r][this.a]=t,this},e.prototype.get=function(e){return x(e,r)?e[r][this.a]:void 0},e.prototype.has=function(e){return x(e,r)&&x(e[r],this.a)},e.prototype.delete=function(e){return!(!x(e,r)||!x(e[r],this.a))&&delete e[r][this.a]},e}),o("Map",function(r){function i(){var e={};return e.Fa=e.next=e.head=e}function e(e,t){var i=e.a;return a(function(){if(i){for(;i.head!=e.a;)i=i.Fa;if(i.next!=i.head)return i=i.next,{done:!1,value:t(i)};i=null}return{done:!0,value:void 0}})}function n(e,t){var i=t&&typeof t;"object"==i||"function"==i?s.has(t)?i=s.get(t):(i=""+ ++o,s.set(t,i)):i="p_"+t;var n=e.b[i];if(n&&x(e.b,i))for(var r=0;r<n.length;r++){var a=n[r];if(t!=t&&a.key!=a.key||t===a.key)return{id:i,list:n,index:r,X:a}}return{id:i,list:n,index:-1,X:void 0}}function t(e){if(this.b={},this.a=i(),this.size=0,e){e=q(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}if(function(){if(r&&"function"==typeof r&&r.prototype.entries&&"function"==typeof Object.seal)try{var e=Object.seal({x:4}),t=new r(q([[e,"s"]]));if("s"!=t.get(e)||1!=t.size||t.get({x:4})||t.set({x:4},"t")!=t||2!=t.size)return;var i=t.entries(),n=i.next();return n.done||n.value[0]!=e||"s"!=n.value[1]?void 0:!((n=i.next()).done||4!=n.value[0].x||"t"!=n.value[1]||!i.next().done)}catch(e){return}}())return r;l(),c();var s=new WeakMap;t.prototype.set=function(e,t){var i=n(this,e);return i.list||(i.list=this.b[i.id]=[]),i.X?i.X.value=t:(i.X={next:this.a,Fa:this.a.Fa,head:this.a,key:e,value:t},i.list.push(i.X),this.a.Fa.next=i.X,this.a.Fa=i.X,this.size++),this},t.prototype.delete=function(e){return!(!(e=n(this,e)).X||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.b[e.id],e.X.Fa.next=e.X.next,e.X.next.Fa=e.X.Fa,e.X.head=null,this.size--,!0)},t.prototype.clear=function(){this.b={},this.a=this.a.Fa=i(),this.size=0},t.prototype.has=function(e){return!!n(this,e).X},t.prototype.get=function(e){return(e=n(this,e).X)&&e.value},t.prototype.entries=function(){return e(this,function(e){return[e.key,e.value]})},t.prototype.keys=function(){return e(this,function(e){return e.key})},t.prototype.values=function(){return e(this,function(e){return e.value})},t.prototype.forEach=function(e,t){for(var i,n=this.entries();!(i=n.next()).done;)i=i.value,e.call(t,i[1],i[0],this)},t.prototype[Symbol.iterator]=t.prototype.entries;var o=0;return t}),o("Set",function(r){function e(e){if(this.a=new Map,e){e=q(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.a.size}return function(){if(r&&"function"==typeof r&&r.prototype.entries&&"function"==typeof Object.seal)try{var e=Object.seal({x:4}),t=new r(q([e]));if(!t.has(e)||1!=t.size||t.add(e)!=t||1!=t.size||t.add({x:4})!=t||2!=t.size)return;var i=t.entries(),n=i.next();return n.done||n.value[0]!=e||n.value[1]!=e?void 0:!(n=i.next()).done&&n.value[0]!=e&&4==n.value[0].x&&n.value[1]==n.value[0]&&i.next().done}catch(e){return}}()?r:(l(),c(),e.prototype.add=function(e){return this.a.set(e,e),this.size=this.a.size,this},e.prototype.delete=function(e){return e=this.a.delete(e),this.size=this.a.size,e},e.prototype.clear=function(){this.a.clear(),this.size=0},e.prototype.has=function(e){return this.a.has(e)},e.prototype.entries=function(){return this.a.entries()},e.prototype.keys=e.prototype.values=function(){return this.a.values()},e.prototype[Symbol.iterator]=e.prototype.values,e.prototype.forEach=function(t,i){var n=this;this.a.forEach(function(e){return t.call(i,e,e,n)})},e)}),o("Array.prototype.findIndex",function(e){return e||function(e,t){return P(this,e,t).Gd}}),o("Array.prototype.keys",function(e){return e||function(){return function(t,i){c(),t instanceof String&&(t+="");var n=0,r={next:function(){if(n<t.length){var e=n++;return{value:i(e,t[e]),done:!1}}return r.next=function(){return{done:!0,value:void 0}},r.next()}};return r[Symbol.iterator]=function(){return r},r}(this,function(e){return e})}}),o("Object.is",function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}}),o("Array.prototype.includes",function(e){return e||function(e,t){var i=this;i instanceof String&&(i=String(i));var n=i.length,r=t||0;for(r<0&&(r=Math.max(r+n,0));r<n;r++){var a=i[r];if(a===e||Object.is(a,e))return!0}return!1}}),o("String.prototype.includes",function(e){return e||function(e,t){return-1!==D(this,e,"includes").indexOf(e,t||0)}}),o("Array.from",function(e){return e||function(e,t,i){c(),t=null!=t?t:function(e){return e};var n=[],r=e[Symbol.iterator];if("function"==typeof r)for(e=r.call(e);!(r=e.next()).done;)n.push(t.call(i,r.value));else{r=e.length;for(var a=0;a<r;a++)n.push(t.call(i,e[a]))}return n}}),o("String.prototype.startsWith",function(e){return e||function(e,t){for(var i=D(this,e,"startsWith"),n=i.length,r=e.length,a=Math.max(0,Math.min(0|t,i.length)),s=0;s<r&&a<n;)if(i[a++]!=e[s++])return!1;return r<=s}}),o("Array.prototype.find",function(e){return e||function(e,t){return P(this,e,t).ke}});var N="function"==typeof Object.assign?Object.assign:function(e,t){for(var i=1;i<arguments.length;i++){var n=arguments[i];if(n)for(var r in n)x(n,r)&&(e[r]=n[r])}return e};o("Object.assign",function(e){return e||N});var M=this;function B(e,t){var i,n=e.split("."),r=M;n[0]in r||!r.execScript||r.execScript("var "+n[0]);for(;n.length&&(i=n.shift());)n.length||void 0===t?r=r[i]?r[i]:r[i]={}:r[i]=t}function U(e,n){function t(){}t.prototype=n.prototype,e.fg=n.prototype,e.prototype=new t,(e.prototype.constructor=e).tg=function(e,t,i){return n.prototype[t].apply(e,Array.prototype.slice.call(arguments,2))}}function j(e){this.c=Math.exp(Math.log(.5)/e),this.b=this.a=0}function H(e,t,i){var n=Math.pow(e.c,t);i=i*(1-n)+n*e.a,isNaN(i)||(e.a=i,e.b+=t)}function G(e){return e.a/(1-Math.pow(e.c,e.b))}function V(){this.b=new j(2),this.c=new j(5),this.a=0}function K(){}function W(){}function $(){}M.a=!0,V.prototype.getBandwidthEstimate=function(e){return this.a<128e3?e:Math.min(G(this.b),G(this.c))},d.console&&d.console.log.bind&&(W=console.warn.bind(console),K=console.error.bind(console));var J=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function Q(e){var t;e instanceof Q?(Z(this,e.ta),this.bb=e.bb,this.sa=e.sa,ee(this,e.zb),this.ja=e.ja,te(this,e.a.clone()),this.Sa=e.Sa):e&&(t=String(e).match(J))?(Z(this,t[1]||"",!0),this.bb=ie(t[2]||""),this.sa=ie(t[3]||"",!0),ee(this,t[4]),this.ja=ie(t[5]||"",!0),te(this,t[6]||"",!0),this.Sa=ie(t[7]||"")):this.a=new ce(null)}function Z(e,t,i){e.ta=i?ie(t,!0):t,e.ta&&(e.ta=e.ta.replace(/:$/,""))}function ee(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.zb=t}else e.zb=null}function te(e,t,i){t instanceof ce?e.a=t:(i||(t=ne(t,le)),e.a=new ce(t))}function ie(e,t){return e?(t?decodeURI:decodeURIComponent)(e):""}function ne(e,t,i){return"string"==typeof e?(e=encodeURI(e).replace(t,re),i&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function re(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}(t=Q.prototype).ta="",t.bb="",t.sa="",t.zb=null,t.ja="",t.Sa="",t.toString=function(){var e=[],t=this.ta;if(t&&e.push(ne(t,ae,!0),":"),t=this.sa){e.push("//");var i=this.bb;i&&e.push(ne(i,ae,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.zb)&&e.push(":",String(t))}return(t=this.ja)&&(this.sa&&"/"!=t.charAt(0)&&e.push("/"),e.push(ne(t,"/"==t.charAt(0)?oe:se,!0))),(t=this.a.toString())&&e.push("?",t),(t=this.Sa)&&e.push("#",ne(t,ue)),e.join("")},t.resolve=function(e){var t=this.clone();"data"===t.ta&&(t=new Q);var i=!!e.ta;i?Z(t,e.ta):i=!!e.bb,i?t.bb=e.bb:i=!!e.sa,i?t.sa=e.sa:i=null!=e.zb;var n=e.ja;if(i)ee(t,e.zb);else if(i=!!e.ja){if("/"!=n.charAt(0))if(this.sa&&!this.ja)n="/"+n;else{var r=t.ja.lastIndexOf("/");-1!=r&&(n=t.ja.substr(0,r+1)+n)}if(".."==n||"."==n)n="";else if(-1!=n.indexOf("./")||-1!=n.indexOf("/.")){r=0==n.lastIndexOf("/",0),n=n.split("/");for(var a=[],s=0;s<n.length;){var o=n[s++];"."==o?r&&s==n.length&&a.push(""):".."==o?((1<a.length||1==a.length&&""!=a[0])&&a.pop(),r&&s==n.length&&a.push("")):(a.push(o),r=!0)}n=a.join("/")}}return i?t.ja=n:i=""!==e.a.toString(),i?te(t,e.a.clone()):i=!!e.Sa,i&&(t.Sa=e.Sa),t},t.clone=function(){return new Q(this)};var ae=/[#\/\?@]/g,se=/[#\?:]/g,oe=/[#\?]/g,le=/[#\?@]/g,ue=/#/g;function ce(e){this.a=e||null}function he(e){this.b=e,this.a=null}function de(e){this.b=e,this.a=null}function fe(e,t){var i=me();this.i=null==e.maxAttempts?i.maxAttempts:e.maxAttempts,this.f=null==e.baseDelay?i.baseDelay:e.baseDelay,this.h=null==e.fuzzFactor?i.fuzzFactor:e.fuzzFactor,this.g=null==e.backoffFactor?i.backoffFactor:e.backoffFactor,this.a=0,this.b=this.f,(this.c=void 0!==t&&t)&&(this.a=1)}function pe(n){return z(function e(){var t,i;return X(e,function(e){switch(e.j){case 1:if(n.a>=n.i){if(!n.c)return e.return(Promise.reject());n.a=1,n.b=n.f}return(t=n.a,n.a++,0==t)?e.return():(i=n.b*(1+(2*Math.random()-1)*n.h),Y(e,new Promise(function(e){new de(e).P(i/1e3)}),2));case 2:n.b*=n.g,F(e)}})})}function me(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0}}function ge(e,t,i,n){for(var r=[],a=3;a<arguments.length;++a)r[a-3]=arguments[a];this.severity=e,this.category=t,this.code=i,this.data=r,this.handled=!1}function ve(){var i,n,e=new Promise(function(e,t){i=e,n=t});return e.resolve=i,e.reject=n,e}function ye(e,t){this.promise=e,this.Md=t,this.a=!1}function be(e){return new ye(Promise.reject(e),function(){return Promise.resolve()})}function _e(){var e=Promise.reject(new ge(2,7,7001));return e.catch(function(){}),new ye(e,function(){return Promise.resolve()})}function Te(e){return new ye(Promise.resolve(e),function(){return Promise.resolve()})}function Se(e){return new ye(e,function(){return e.catch(function(){})})}function Ee(e){return new ye(Promise.all(e.map(function(e){return e.promise})),function(){return Promise.all(e.map(function(e){return e.abort()}))})}function we(e,t,i){try{var n=e(t);return n&&n.promise&&n.abort?(i.resolve(n.promise),function(){return n.abort()}):(i.resolve(n),function(){return Promise.resolve(n).then(function(){}).catch(function(){})})}catch(e){return i.reject(e),function(){return Promise.resolve()}}}function Ce(e,t){for(var i in t=void 0===t?{}:t)this[i]=t[i];this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=d.performance&&d.performance.now?d.performance.now():Date.now(),this.type=e,this.isTrusted=!1,this.target=this.currentTarget=null,this.a=!1}function ke(){this.a={}}function Ae(){this.Fc=new ke,this.Yb=this}function Ie(e){var a=new Set;return function e(t){switch(typeof t){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return t;default:if(!t||t.buffer&&t.buffer.constructor==ArrayBuffer)return t;if(a.has(t))return null;var i=t.constructor==Array;if(t.constructor!=Object&&!i)return null;a.add(t);var n,r=i?[]:{};for(n in t)r[n]=e(t[n]);return i&&(r.length=t.length),r}}(e)}function xe(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t}function Pe(e,t){var i=e.indexOf(t);-1<i&&e.splice(i,1)}function Le(e,t,i){if(i=i||xe,e.length!=t.length)return!1;t=t.slice();for(var n={},r=(e=q(e)).next();!r.done;n={item:n.item},r=e.next()){if(n.item=r.value,-1==(r=t.findIndex(function(t){return function(e){return i(t.item,e)}}(n))))return!1;t[r]=t[t.length-1],t.pop()}return 0==t.length}function Re(){this.a=[]}function Oe(e,t){e.a.push(t.finally(function(){Pe(e.a,t)}))}function De(e){Ae.call(this),this.f=!1,this.g=new Re,this.a=new Set,this.b=new Set,this.c=e||null}(t=ce.prototype).ha=null,t.cc=null,t.add=function(e,t){if(!this.ha&&(this.ha={},this.cc=0,this.a))for(var i=this.a.split("&"),n=0;n<i.length;n++){var r=i[n].indexOf("="),a=null;if(0<=r){var s=i[n].substring(0,r);a=i[n].substring(r+1)}else s=i[n];s=decodeURIComponent(s.replace(/\+/g," ")),a=a||"",this.add(s,decodeURIComponent(a.replace(/\+/g," ")))}return this.a=null,(i=this.ha.hasOwnProperty(e)&&this.ha[e])||(this.ha[e]=i=[]),i.push(t),this.cc++,this},t.toString=function(){if(this.a)return this.a;if(!this.ha)return"";var e,t=[];for(e in this.ha)for(var i=encodeURIComponent(e),n=this.ha[e],r=0;r<n.length;r++){var a=i;""!==n[r]&&(a+="="+encodeURIComponent(n[r])),t.push(a)}return this.a=t.join("&")},t.clone=function(){var e=new ce;if(e.a=this.a,this.ha){var t,i={};for(t in this.ha)i[t]=this.ha[t].concat();e.ha=i,e.cc=this.cc}return e},he.prototype.P=function(e){var t=this;this.stop();var i=!0,n=null;return this.a=function(){d.clearTimeout(n),i=!1},n=d.setTimeout(function(){i&&t.b()},1e3*e),this},he.prototype.stop=function(){this.a&&(this.a(),this.a=null)},B("shaka.util.Timer",de),de.prototype.tickNow=de.prototype.uc=function(){return this.stop(),this.b(),this},de.prototype.tickAfter=de.prototype.P=function(e){var t=this;return this.stop(),this.a=new he(function(){t.b()}).P(e),this},de.prototype.tickEvery=de.prototype.Na=function(e){var t=this;return this.stop(),this.a=new he(function(){t.a.P(e),t.b()}).P(e),this},de.prototype.stop=de.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)},B("shaka.util.Error",ge),ge.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},ge.Severity={RECOVERABLE:1,CRITICAL:2},ge.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9},ge.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,CAST_RECEIVER_APP_ID_MISSING:8007,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013},ve.prototype.resolve=function(){},ve.prototype.reject=function(){},B("shaka.util.AbortableOperation",ye),ye.failed=be,ye.aborted=_e,ye.completed=Te,ye.notAbortable=Se,ye.prototype.abort=ye.prototype.abort=function(){return this.a=!0,this.Md()},ye.all=Ee,ye.prototype.finally=ye.prototype.finally=function(e){return this.promise.then(function(){return e(!0)},function(){return e(!1)}),this},ye.prototype.chain=ye.prototype.U=function(t,i){function n(){return a.reject(new ge(2,7,7001)),r.abort()}var r=this,a=new ve;return this.promise.then(function(e){r.a?a.reject(new ge(2,7,7001)):t?n=we(t,e,a):a.resolve(e)},function(e){i?n=we(i,e,a):a.reject(e)}),new ye(a,function(){return n()})},Ce.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Ce.prototype.stopImmediatePropagation=function(){this.a=!0},Ce.prototype.stopPropagation=function(){},(t=ke.prototype).push=function(e,t){this.a.hasOwnProperty(e)?this.a[e].push(t):this.a[e]=[t]},t.get=function(e){return(e=this.a[e])?e.slice():null},t.getAll=function(){var e,t=[];for(e in this.a)t.push.apply(t,this.a[e]);return t},t.remove=function(e,t){var i=this.a[e];if(i)for(var n=0;n<i.length;++n)i[n]==t&&(i.splice(n,1),--n)},t.forEach=function(e){for(var t in this.a)e(t,this.a[t])},Ae.prototype.addEventListener=function(e,t){this.Fc.push(e,t)},Ae.prototype.removeEventListener=function(e,t){this.Fc.remove(e,t)},Ae.prototype.dispatchEvent=function(e){for(var t=this.Fc.get(e.type)||[],i=0;i<t.length;++i){e.target=this.Yb,e.currentTarget=this.Yb;var n=t[i];try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch(e){}if(e.a)break}return e.defaultPrevented},Re.prototype.destroy=function(){var t=[];return this.a.forEach(function(e){e.promise.catch(function(){}),t.push(e.abort())}),this.a=[],Promise.all(t)},U(De,Ae),B("shaka.net.NetworkingEngine",De),De.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4},De.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var Ne={};function Me(e,t,i){i=i||3;var n=Ne[e];(!n||i>=n.priority)&&(Ne[e]={priority:i,Df:t})}function Be(e,t){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null}}function Ue(){this.a=0}function Fe(e,t,i){ye.call(this,e,t),this.b=i}De.registerScheme=Me,De.unregisterScheme=function(e){delete Ne[e]},De.prototype.registerRequestFilter=De.prototype.Ff=function(e){this.a.add(e)},De.prototype.unregisterRequestFilter=De.prototype.hg=function(e){this.a.delete(e)},De.prototype.clearAllRequestFilters=De.prototype.ye=function(){this.a.clear()},De.prototype.registerResponseFilter=De.prototype.Gf=function(e){this.b.add(e)},De.prototype.unregisterResponseFilter=De.prototype.ig=function(e){this.b.delete(e)},De.prototype.clearAllResponseFilters=De.prototype.ze=function(){this.b.clear()},De.defaultRetryParameters=function(){return me()},De.makeRequest=Be,De.prototype.destroy=De.prototype.destroy=function(){return this.f=!0,this.a.clear(),this.b.clear(),this.g.destroy()},De.prototype.request=De.prototype.request=function(n,e){var r=this,t=new Ue;if(this.f){var i=Promise.reject(new ge(2,7,7001));return i.catch(function(){}),new Fe(i,function(){return Promise.resolve()},t)}e.method=e.method||"GET",e.headers=e.headers||{},e.retryParameters=e.retryParameters?Ie(e.retryParameters):me(),e.uris=Ie(e.uris);var a=(i=function(e,t,i){for(var n=Te(void 0),r={},a=(e=q(e.a)).next();!a.done;r={ld:r.ld},a=e.next())r.ld=a.value,n=n.U(function(e){return function(){return e.ld(t,i)}}(r));return n.U(void 0,function(e){if(e&&7001==e.code)throw e;throw new ge(2,1,1006,e)})}(this,n,e)).U(function(){return function t(n,r,i,a,s,o,l){var e=new Q(i.uris[s]),u=e.ta,c=!1;u||(u=location.protocol,u=u.slice(0,-1),Z(e,u),i.uris[s]=e.toString());u=u.toLowerCase();var h=(u=Ne[u])?u.Df:null;if(!h)return be(new ge(2,1,1e3,e));var d;return Se(pe(a)).U(function(){return n.f?_e():(d=Date.now(),h(i.uris[s],i,r,function(e,t,i){n.c&&1==r&&(n.c(e,t),c=!0,l.a=i)}))}).U(function(e){return null==e.timeMs&&(e.timeMs=Date.now()-d),{response:e,cf:c}},function(e){if(e&&7001==e.code)throw e;if(n.f)return _e();if(e&&1==e.severity)return n.dispatchEvent(new Ce("retry",{error:e instanceof ge?e:null})),s=(s+1)%i.uris.length,t(n,r,i,a,s,e,l);throw e||o})}(r,n,e,new fe(e.retryParameters,!1),0,null,t)}),s=a.U(function(e){return function(e,t,i){for(var n=Te(void 0),r=(e=q(e.b)).next();!r.done;r=e.next())n=n.U(r.value.bind(null,t,i.response));return n.U(function(){return i},function(e){if(e&&7001==e.code)throw e;var t=2;throw e instanceof ge&&(t=e.severity),new ge(t,1,1007,e)})}(r,n,e)}),o=Date.now(),l=0;i.promise.then(function(){l=Date.now()-o},function(){});var u=0;return a.promise.then(function(){u=Date.now()},function(){}),i=new Fe((i=s.U(function(e){var t=Date.now()-u,i=e.response;return i.timeMs+=l,i.timeMs+=t,e.cf||!r.c||i.fromCache||1!=n||r.c(i.timeMs,i.data.byteLength),i},function(e){throw e&&(e.severity=2),e})).promise,i.Md,t),Oe(this.g,i),i},De.NumBytesRemainingClass=Ue;var je=Fe;if(je.prototype=p(ye.prototype),je.prototype.constructor=je,v)v(je,ye);else for(var He in ye)if("prototype"!=He)if(Object.defineProperties){var Ge=Object.getOwnPropertyDescriptor(ye,He);Ge&&Object.defineProperty(je,He,Ge)}else je[He]=ye[He];function Ve(){}function Ke(){this.a=new ke}function We(e,t,i,n){this.target=e,this.type=t,this.listener=i,this.a=function(e,t){if(null==t)return!1;if("boolean"==typeof t)return t;var i=new Set(["passive","capture"]);return Object.keys(t).filter(function(e){return!i.has(e)}),function(e){var t=qe;if(null==t){t=!1;try{var i={},n={get:function(){return!(t=!0)}};Object.defineProperty(i,"passive",n),Object.defineProperty(i,"capture",n),n=function(){},e.addEventListener("test",n,i),e.removeEventListener("test",n,i)}catch(e){t=!1}qe=t}return t}(e)?t:t.capture||!1}(e,n),this.target.addEventListener(t,i,this.a)}je.fg=ye.prototype,(De.PendingRequest=Fe).all=Ee,Fe.notAbortable=Se,Fe.completed=Te,Fe.aborted=_e,Fe.failed=be,B("shaka.util.IReleasable",Ve),Ve.prototype.release=function(){},B("shaka.util.EventManager",Ke),Ke.prototype.release=Ke.prototype.release=function(){this.$a(),this.a=null},Ke.prototype.listen=Ke.prototype.w=function(e,t,i,n){this.a&&(e=new We(e,t,i,n),this.a.push(t,e))},Ke.prototype.listenOnce=Ke.prototype.da=function(i,n,r,e){var a=this;this.w(i,n,function e(t){a.ea(i,n,e),r(t)},e)},Ke.prototype.unlisten=Ke.prototype.ea=function(e,t,i){if(this.a)for(var n=this.a.get(t)||[],r=(n=q(n)).next();!r.done;r=n.next())(r=r.value).target!=e||i!=r.listener&&i||(r.ea(),this.a.remove(t,r))},Ke.prototype.removeAll=Ke.prototype.$a=function(){if(this.a){for(var e=this.a.getAll(),t=(e=q(e)).next();!t.done;t=e.next())t.value.ea();this.a.a={}}},We.prototype.unlisten=We.prototype.ea=function(){this.target.removeEventListener(this.type,this.listener,this.a),this.listener=this.target=null,this.a=!1};var qe=void 0;function ze(e){if(e=new Uint8Array(e),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");return new Q(e=lt(e.subarray(4),!0)).sa}function Ye(e,t,i){function n(e){new DataView(a.buffer).setUint32(s,e.byteLength,!0),s+=4,r(e)}function r(e){a.set(e,s),s+=e.byteLength}if(!i||!i.byteLength)throw new ge(2,6,6015);t="string"==typeof t?new Uint8Array(ht(t,!0)):new Uint8Array(t);var a=new Uint8Array(8+e.byteLength+t.byteLength+i.byteLength),s=0;return r(new Uint8Array(e)),n(t),n(new Uint8Array(i)),a}function Xe(e,t){for(var i=q(e),n=i.next();!n.done;n=i.next())if(!t(n.value))return!1;return!0}function $e(t){var i=new Map;return Object.keys(t).forEach(function(e){i.set(e,t[e])}),i}function Je(e){var i={};return e.forEach(function(e,t){i[t]=e}),i}function Qe(e,t){var i=e;return t&&(i+='; codecs="'+t+'"'),i}function Ze(e){var t=(e=e.split("."))[0];return e.pop(),[t,e.join(".")]}B("shaka.util.FairPlayUtils.defaultGetContentId",ze),B("shaka.util.FairPlayUtils.initDataTransform",Ye);var et=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function tt(){return!(!d.MediaSource||!MediaSource.isTypeSupported)}function it(e){return""!=rt().canPlayType(e)}function nt(e){return(navigator.userAgent||"").includes(e)}function rt(){return st||(at=at||new de(function(){st=null}),(st=document.querySelector("video")||document.querySelector("audio"))||(st=document.createElement("video")),at.P(1),st)}var at=null,st=null;function ot(e){if(!e)return"";239==(e=new Uint8Array(e))[0]&&187==e[1]&&191==e[2]&&(e=e.subarray(3)),e=dt(e),e=escape(e);try{return decodeURIComponent(e)}catch(e){throw new ge(2,2,2004)}}function lt(e,t,i){if(!e)return"";if(!i&&0!=e.byteLength%2)throw new ge(2,2,2004);if(e instanceof ArrayBuffer)var n=e;else(i=new Uint8Array(e.byteLength)).set(new Uint8Array(e)),n=i.buffer;e=Math.floor(e.byteLength/2),i=new Uint16Array(e),n=new DataView(n);for(var r=0;r<e;r++)i[r]=n.getUint16(2*r,t);return dt(i)}function ut(e){var t=new Uint8Array(e);if(239==t[0]&&187==t[1]&&191==t[2])return ot(t);if(254==t[0]&&255==t[1])return lt(t.subarray(2),!1);if(255==t[0]&&254==t[1])return lt(t.subarray(2),!0);var i=function(e,t){return e.byteLength<=t||32<=e[t]&&e[t]<=126}.bind(null,t);if(0==t[0]&&0==t[2])return lt(e,!1);if(0==t[1]&&0==t[3])return lt(e,!0);if(i(0)&&i(1)&&i(2)&&i(3))return ot(e);throw new ge(2,2,2003)}function ct(e){e=encodeURIComponent(e),e=unescape(e);for(var t=new Uint8Array(e.length),i=0;i<e.length;++i)t[i]=e.charCodeAt(i);return t.buffer}function ht(e,t){for(var i=new Uint8Array(2*e.length),n=new DataView(i.buffer),r=0;r<e.length;++r)n.setUint16(2*r,e.charCodeAt(r),t);return i.buffer}function dt(e){if(!ft)for(var t=function(e){try{return I(new Uint8Array(e)),!0}catch(e){return!1}},i={size:65536};0<i.size;(i={size:i.size}).size/=2)if(t(i.size)){ft=function(n){return function(e){for(var t="",i=0;i<e.length;i+=n.size)t+=String.fromCharCode.apply(String,I(e.subarray(i,i+n.size)));return t}}(i);break}return ft(e)}B("shaka.util.StringUtils.fromUTF8",ot),B("shaka.util.StringUtils.fromUTF16",lt),B("shaka.util.StringUtils.fromBytesAutoDetect",ut),B("shaka.util.StringUtils.toUTF8",ct),B("shaka.util.StringUtils.toUTF16",ht);var ft=null,pt={vc:function(e,t){var i=dt(e);return t=null==t||t,i=d.btoa(i).replace(/\+/g,"-").replace(/\//g,"_"),t?i:i.replace(/=*$/,"")}};function mt(t){var n=this;this.C=t,this.u=new Set,this.h=this.l=null,this.S=!1,this.K=0,this.a=null,this.i=new Ke,this.b=new Map,this.s=[],this.m=new ve,this.f=null,this.g=function(e){n.m.reject(e),t.onError(e)},this.pa=new Map,this.W=new Map,this.R=new de(function(){return t=(e=n).pa,(i=e.W).clear(),t.forEach(function(e,t){return i.set(t,e)}),(t=Array.from(i.values())).length&&t.every(function(e){return"expired"==e})&&e.g(new ge(2,6,6014)),void e.C.mc(Je(i));var e,t,i}),this.c=!1,this.na=new ve,this.D=!1,this.F=[],this.oa=!1,this.$=new de(function(){var r;(r=n).b.forEach(function(e,t){var i=e.cd,n=t.expiration;isNaN(n)&&(n=1/0),n!=i&&(r.C.onExpirationUpdated(t.sessionId,n),e.cd=n)})}).Na(1),this.m.catch(function(){})}function gt(e,t,i){return e.s=i,e.D=0<i.length,vt(e,t)}function vt(e,t){var i=function(e){if(0==(e=$e(e.f.clearKeys)).size)return null;var r=[],a=[];e.forEach(function(e,t){var i=pt.Mc(t),n=pt.Mc(e);i={kty:"oct",kid:pt.vc(i,!1),k:pt.vc(n,!1)},r.push(i),a.push(i.kid)}),e=JSON.stringify({keys:r});var t=JSON.stringify({kids:a});return t=[{initData:new Uint8Array(ct(t)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+d.btoa(e),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:t,keyIds:[]}}(e);if(i)for(var n=q(t),r=n.next();!r.done;r=n.next())r.value.drmInfos=[i];for((i=t.some(function(e){return 0<e.drmInfos.length}))||function(e,t){var i=[];t.forEach(function(e,t){i.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})});for(var n=q(e),r=n.next();!r.done;r=n.next())r.value.drmInfos=i}(t,r=$e(e.f.servers)),r=(n=q(t)).next();!r.done;r=n.next())for(var a=(r=q(r.value.drmInfos)).next();!a.done;a=r.next())Dt(a.value,$e(e.f.servers),$e(e.f.advanced||{}));for(r=(n=q(t)).next();!r.done;r=n.next())for(a=(r=r.value).drmInfos.length;a--;)"com.chromecast.playready"===r.drmInfos[a].keySystem&&r.drmInfos.splice(a,1);return(r=function(e,t){for(var i=new Set,n=q(t),r=n.next();!r.done;r=n.next()){var a=q(r.value.drmInfos);for(r=a.next();!r.done;r=a.next())i.add(r.value)}for(n=q(i),r=n.next();!r.done;r=n.next())Dt(r.value,$e(e.f.servers),$e(e.f.advanced||{}));a=e.D?"required":"optional";var s=e.D?["persistent-license"]:["temporary"];for(n=new Map,i=q(i),r=i.next();!r.done;r=i.next())r=r.value,n.set(r.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:a,sessionTypes:s,label:r.keySystem,drmInfos:[]});for(i=q(t),r=i.next();!r.done;r=i.next()){r=r.value,a=r.audio,s=r.video;var o=a?Qe(a.mimeType,a.codecs):"",l=s?Qe(s.mimeType,s.codecs):"",u=q(r.drmInfos);for(r=u.next();!r.done;r=u.next()){r=r.value;var c=n.get(r.keySystem);c.drmInfos.push(r),r.distinctiveIdentifierRequired&&(c.distinctiveIdentifier="required"),r.persistentStateRequired&&(c.persistentState="required"),a&&c.audioCapabilities.push({robustness:r.audioRobustness||"",contentType:o}),s&&c.videoCapabilities.push({robustness:r.videoRobustness||"",contentType:l})}}return n}(e,t)).size?(r=wt(e,r),i?r:r.catch(function(){})):(e.S=!0,Promise.resolve())}function yt(i){return z(function e(){var t;return X(e,function(e){switch(e.j){case 1:if(i.l&&i.a&&i.a.serverCertificate&&i.a.serverCertificate.length)return E(e,3),Y(e,i.l.setServerCertificate(i.a.serverCertificate),5);e.A(0);break;case 5:S(e,0);break;case 3:return t=w(e),e.return(Promise.reject(new ge(2,6,6004,t.message)))}})})}function bt(t){var e=t.a?t.a.initData:[];return e.forEach(function(e){return kt(t,e.initDataType,e.initData)}),t.s.forEach(function(e){return Ct(t,e)}),e.length||t.s.length||t.m.resolve(),t.m}function _t(e,t,i){for(var n=e.b.values(),r=(n=q(n)).next();!r.done;r=n.next())if(pt.za(i,r.value.initData))return;kt(e,t,i)}function Tt(e){return e?e.keySystem:""}function St(e,t){return nt("Edge/")||e.u.has(t)}function Et(e){return e=function(e,t){for(var i=[],n=q(e),r=n.next();!r.done;r=n.next())i.push(t(r.value));return i}(e=e.b.keys(),function(e){return e.sessionId}),Array.from(e)}function wt(e,d){if(1==d.size&&d.has(""))return Promise.reject(new ge(2,6,6e3));for(var t=q(d.values()),i=t.next();!i.done;i=t.next())0==(i=i.value).audioCapabilities.length&&delete i.audioCapabilities,0==i.videoCapabilities.length&&delete i.videoCapabilities;var r=t=new ve;return[!0,!1].forEach(function(i){var n=this;d.forEach(function(e,t){e.drmInfos.some(function(e){return!!e.licenseServerUri})==i&&(r=r.catch(function(){if(!this.c)return navigator.requestMediaKeySystemAccess(t,[e])}.bind(n)))})}.bind(e)),r=(r=r.catch(function(){return Promise.reject(new ge(2,6,6001))})).then(function(e){if(this.c)return Promise.reject();this.u.clear();var t=e.getConfiguration(),i=t.videoCapabilities||[],n=q(t.audioCapabilities||[]);for(t=n.next();!t.done;t=n.next())this.u.add(t.value.contentType);for(t=(i=q(i)).next();!t.done;t=i.next())this.u.add(t.value.contentType);i=e.keySystem,t=d.get(e.keySystem),n=[];var r,a,s,o,l,u=[],c=[],h=[];return r=t.drmInfos,a=n,s=u,o=c,l=h,r.forEach(function(t){if(a.includes(t.licenseServerUri)||a.push(t.licenseServerUri),t.serverCertificate&&(s.some(function(e){return pt.za(e,t.serverCertificate)})||s.push(t.serverCertificate)),t.initData&&t.initData.forEach(function(t){o.some(function(e){return!(!e.keyId||e.keyId!=t.keyId)||e.initDataType==t.initDataType&&pt.za(e.initData,t.initData)})||o.push(t)}),t.keyIds)for(var e=0;e<t.keyIds.length;++e)l.includes(t.keyIds[e])||l.push(t.keyIds[e])}),this.a={keySystem:i,licenseServerUri:n[0],distinctiveIdentifierRequired:"required"==t.distinctiveIdentifier,persistentStateRequired:"required"==t.persistentState,audioRobustness:(t.audioCapabilities?t.audioCapabilities[0].robustness:"")||"",videoRobustness:(t.videoCapabilities?t.videoCapabilities[0].robustness:"")||"",serverCertificate:u[0],initData:c,keyIds:h},this.a.licenseServerUri?e.createMediaKeys():Promise.reject(new ge(2,6,6012,this.a.keySystem))}.bind(e)).then(function(e){if(this.c)return Promise.reject();this.l=e,this.S=!0}.bind(e)).catch(function(e){if(!this.c)return this.a=null,this.u.clear(),e instanceof ge?Promise.reject(e):Promise.reject(new ge(2,6,6002,e.message))}.bind(e)),t.reject(),r}function Ct(t,e){try{var i=t.l.createSession("persistent-license")}catch(e){var n=new ge(2,6,6005,e.message);return t.g(n),Promise.reject(n)}t.i.w(i,"message",t.Ud.bind(t)),t.i.w(i,"keystatuseschange",t.Sd.bind(t));var r={initData:null,loaded:!1,cd:1/0,ya:null};return t.b.set(i,r),i.load(e).then(function(e){return this.c?Promise.reject():e?(r.loaded=!0,Ot(this)&&this.m.resolve(),i):(this.b.delete(i),void this.g(new ge(2,6,6013)))}.bind(t),function(e){this.c||(this.b.delete(i),this.g(new ge(2,6,6005,e.message)))}.bind(t))}function kt(i,t,e){try{var n=i.D?i.l.createSession("persistent-license"):i.l.createSession()}catch(e){return void i.g(new ge(2,6,6005,e.message))}i.i.w(n,"message",i.Ud.bind(i)),i.i.w(n,"keystatuseschange",i.Sd.bind(i)),i.b.set(n,{initData:e,loaded:!1,cd:1/0,ya:null});try{e=i.f.initDataTransform(e,i.a)}catch(e){return(t=e)instanceof ge||(t=new ge(2,6,6016,e)),void i.g(t)}n.generateRequest(t,e.buffer).catch(function(e){if(!i.c){if(i.b.delete(n),e.errorCode&&e.errorCode.systemCode){var t=e.errorCode.systemCode;t<0&&(t+=Math.pow(2,32)),t="0x"+t.toString(16)}i.g(new ge(2,6,6006,e.message,e,t))}})}function At(e,t){if(Tt(t).startsWith("com.apple.fps")){var i=t.serverCertificate;e=Ye(e,ze(e),i)}return e}function It(e,t){var i,n,r=t.target,a=e.b.get(r),s=e.a.licenseServerUri,o=e.f.advanced[e.a.keySystem];"individualization-request"==t.messageType&&o&&o.individualizationServer&&(s=o.individualizationServer),(s=Be([s],e.f.retryParameters)).body=t.message,s.method="POST",s.licenseRequestType=t.messageType,s.sessionId=r.sessionId,"com.microsoft.playready"!=e.a.keySystem&&"com.chromecast.playready"!=e.a.keySystem||function(e){var t=lt(e.body,!0,!0);if(t.includes("PlayReadyKeyMessage")){for(var i=(t=(new DOMParser).parseFromString(t,"application/xml")).getElementsByTagName("HttpHeader"),n=0;n<i.length;++n)e.headers[i[n].querySelector("name").textContent]=i[n].querySelector("value").textContent;e.body=pt.Ba(t.querySelector("Challenge").textContent).buffer}else e.headers["Content-Type"]="text/xml; charset=utf-8"}(s),e.a.keySystem.startsWith("com.apple.fps")&&e.f.fairPlayTransform&&(i=s,n=new Uint8Array(i.body),n="spc="+pt.vc(n),i.headers["Content-Type"]="application/x-www-form-urlencoded",i.body=ct(n));var l=Date.now();e.C.tb.request(2,s).promise.then(function(e){return this.c?Promise.reject():(this.a.keySystem.startsWith("com.apple.fps")&&this.f.fairPlayTransform&&function(e){try{var t=ot(e.data)}catch(e){return}"<ckc>"===(t=t.trim()).substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6));try{t=JSON.parse(t).ckc}catch(e){}e.data=pt.Ba(t).buffer}(e),this.K+=(Date.now()-l)/1e3,r.update(e.data).then(function(){var e=this;this.C.onEvent(new Ce("drmsessionupdate")),a&&(a.ya&&a.ya.resolve(),new de(function(){a.loaded=!0,Ot(e)&&e.m.resolve()}).P(Nt))}.bind(this)))}.bind(e),function(e){this.c||(e=new ge(2,6,6007,e),this.g(e),a&&a.ya&&a.ya.reject(e))}.bind(e)).catch(function(e){this.c||(e=new ge(2,6,6008,e.message),this.g(e),a&&a.ya&&a.ya.reject(e))}.bind(e))}function xt(){var e=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],a=[{videoCapabilities:e,persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:e}],s=new Map;return e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map(function(e){return r=e,z(function e(){var t,i,n;return X(e,function(e){switch(e.j){case 1:return E(e,2),Y(e,navigator.requestMediaKeySystemAccess(r,a),4);case 4:return t=e.o,n=!!(i=t.getConfiguration().sessionTypes)&&i.includes("persistent-license"),nt("Tizen 3")&&(n=!1),s.set(r,{persistentState:n}),Y(e,t.createMediaKeys(),5);case 5:S(e,0);break;case 2:w(e),s.set(r,null),F(e)}})});var r}),Promise.all(e).then(function(){return Je(s)})}function Pt(e,t){var i=t.audio,n=t.video;if(i&&i.encrypted&&!St(e,Qe(i.mimeType,i.codecs))||n&&n.encrypted&&!St(e,Qe(n.mimeType,n.codecs)))return!1;var r=Tt(e.a);return 0==t.drmInfos.length||t.drmInfos.some(function(e){return e.keySystem==r})}function Lt(e,t){if(!e.length)return t;if(!t.length)return e;for(var i=[],n=0;n<e.length;n++)for(var r=0;r<t.length;r++)if(e[n].keySystem==t[r].keySystem){var a=e[n];r=t[r];var s=[];s=(s=s.concat(a.initData||[])).concat(r.initData||[]);var o=[];o=(o=o.concat(a.keyIds)).concat(r.keyIds),i.push({keySystem:a.keySystem,licenseServerUri:a.licenseServerUri||r.licenseServerUri,distinctiveIdentifierRequired:a.distinctiveIdentifierRequired||r.distinctiveIdentifierRequired,persistentStateRequired:a.persistentStateRequired||r.persistentStateRequired,videoRobustness:a.videoRobustness||r.videoRobustness,audioRobustness:a.audioRobustness||r.audioRobustness,serverCertificate:a.serverCertificate||r.serverCertificate,initData:s,keyIds:o});break}return i}function Rt(i){return z(function e(){var t;return X(e,function(e){switch(e.j){case 1:return t=Array.from(i.b.keys()),i.b.clear(),Y(e,Promise.all(t.map(function(t){return z(function e(){return X(e,function(e){switch(e.j){case 1:return E(e,2),Y(e,Promise.all([t.close(),t.closed]),4);case 4:S(e,0);break;case 2:w(e),F(e)}})})})),0)}})})}function Ot(e){return Xe(e=e.b.values(),function(e){return e.loaded})}function Dt(e,t,i){!e.keySystem||"org.w3.clearkey"==e.keySystem&&e.licenseServerUri||(t.size&&(t=t.get(e.keySystem)||"",e.licenseServerUri=t),e.keyIds||(e.keyIds=[]),(i=i.get(e.keySystem))&&(e.distinctiveIdentifierRequired||(e.distinctiveIdentifierRequired=i.distinctiveIdentifierRequired),e.persistentStateRequired||(e.persistentStateRequired=i.persistentStateRequired),e.videoRobustness||(e.videoRobustness=i.videoRobustness),e.audioRobustness||(e.audioRobustness=i.audioRobustness),e.serverCertificate||(e.serverCertificate=i.serverCertificate)),d.cast&&d.cast.__platform__&&"com.microsoft.playready"==e.keySystem&&(e.keySystem="com.chromecast.playready"))}B("shaka.util.Uint8ArrayUtils.toBase64",pt.vc),pt.Ba=function(e){e=d.atob(e.replace(/-/g,"+").replace(/_/g,"/"));for(var t=new Uint8Array(e.length),i=0;i<e.length;++i)t[i]=e.charCodeAt(i);return t},B("shaka.util.Uint8ArrayUtils.fromBase64",pt.Ba),pt.Mc=function(e){for(var t=new Uint8Array(e.length/2),i=0;i<e.length;i+=2)t[i/2]=d.parseInt(e.substr(i,2),16);return t},B("shaka.util.Uint8ArrayUtils.fromHex",pt.Mc),pt.wc=function(e){for(var t="",i=0;i<e.length;++i){var n=e[i].toString(16);1==n.length&&(n="0"+n),t+=n}return t},B("shaka.util.Uint8ArrayUtils.toHex",pt.wc),pt.za=function(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var i=0;i<e.length;++i)if(e[i]!=t[i])return!1;return!0},B("shaka.util.Uint8ArrayUtils.equal",pt.za),pt.concat=function(e){for(var t=[],i=0;i<arguments.length;++i)t[i]=arguments[i];for(var n=i=0;n<t.length;++n)i+=t[n].length;i=new Uint8Array(i);for(var r=n=0;r<t.length;++r)i.set(t[r],n),n+=t[r].length;return i},B("shaka.util.Uint8ArrayUtils.concat",pt.concat),(t=mt.prototype).destroy=function(){var i=this;return z(function e(){return X(e,function(e){switch(e.j){case 1:return i.c?Y(e,i.na,0):(i.c=!0,Y(e,(t=i,z(function e(){return X(e,function(e){switch(e.j){case 1:return t.i.release(),t.i=null,t.m.reject(),t.$.stop(),t.$=null,t.R.stop(),t.R=null,Y(e,Rt(t),2);case 2:if(t.h)return E(e,4),Y(e,t.h.setMediaKeys(null),6);e.A(3);break;case 6:S(e,5);break;case 4:w(e);case 5:t.h=null;case 3:t.a=null,t.u.clear(),t.l=null,t.s=[],t.f=null,t.g=null,t.C=null,F(e)}})})),4));case 4:i.na.resolve(),e.A(0)}var t})})},t.configure=function(e){this.f=e},t.Gb=function(e){var t=this;if(!this.l)return this.i.da(e,"encrypted",function(){t.g(new ge(2,6,6010))}),Promise.resolve();this.h=e,this.i.da(this.h,"play",function(){for(var e=0;e<t.F.length;e++)It(t,t.F[e]);t.oa=!0,t.F=[]}),"webkitCurrentPlaybackTargetIsWireless"in this.h&&this.i.w(this.h,"webkitcurrentplaybacktargetiswirelesschanged",function(){return Rt(t)}),e=(e=this.h.setMediaKeys(this.l)).catch(function(e){return Promise.reject(new ge(2,6,6003,e.message))});var i=yt(this);return Promise.all([e,i]).then(function(){if(t.c)return Promise.reject();bt(t),t.a.initData.length||t.s.length||t.i.w(t.h,"encrypted",function(e){return _t(t,e.initDataType,new Uint8Array(e.initData))})}).catch(function(e){if(!t.c)return Promise.reject(e)})},t.Jb=function(){for(var e=1/0,t=this.b.keys(),i=(t=q(t)).next();!i.done;i=t.next())i=i.value,isNaN(i.expiration)||(e=Math.min(e,i.expiration));return e},t.Ud=function(e){this.h&&this.f.delayLicenseRequestUntilPlayed&&this.h.paused&&!this.oa?this.F.push(e):It(this,e)},t.Sd=function(e){e=e.target;var s=this.b.get(e),o=!1;e.keyStatuses.forEach(function(e,t){if("string"==typeof t){var i=t;t=e,e=i}if("com.microsoft.playready"==this.a.keySystem&&16==t.byteLength&&!nt("Tizen")){var n=(i=new DataView(t)).getUint32(0,!0),r=i.getUint16(4,!0),a=i.getUint16(6,!0);i.setUint32(0,n,!1),i.setUint16(4,r,!1),i.setUint16(6,a,!1)}"com.microsoft.playready"==this.a.keySystem&&"status-pending"==e&&(e="usable"),"status-pending"!=e&&(s.loaded=!0),"expired"==e&&(o=!0),i=pt.wc(new Uint8Array(t)),this.pa.set(i,e)}.bind(this));var t=e.expiration-Date.now();(t<0||o&&t<1e3)&&s&&!s.ya&&(this.b.delete(e),e.close().catch(function(){})),Ot(this)&&(this.m.resolve(),this.R.P(Mt))};var Nt=5,Mt=.5;function Bt(){this.a=new muxjs.mp4.CaptionParser,this.g=[],this.f={}}function Ut(){}function Ft(e){return e&&!(1==e.length&&e.end(0)-e.start(0)<1e-6)&&e.length?e.end(e.length-1):null}function jt(e,t,i){return i=void 0===i?0:i,!(!e||!e.length||1==e.length&&e.end(0)-e.start(0)<1e-6||t>e.end(e.length-1))&&t+i>=e.start(0)}function Ht(e,t){if(!e||!e.length||1==e.length&&e.end(0)-e.start(0)<1e-6)return 0;for(var i=0,n=e.length-1;0<=n&&e.end(n)>t;--n)i+=e.end(n)-Math.max(e.start(n),t);return i}function Gt(e){if(!e)return[];for(var t=[],i=0;i<e.length;i++)t.push({start:e.start(i),end:e.end(i)});return t}Bt.prototype.init=function(e){var t=muxjs.mp4.probe;e=new Uint8Array(e),this.g=t.videoTrackIds(e),this.f=t.timescale(e),this.a.init()},Bt.prototype.b=function(e,t){var i=new Uint8Array(e);(i=this.a.parse(i,this.g,this.f))&&i.captions&&t(i.captions),this.a.clearParsedCaptions()},Bt.prototype.c=function(){this.a.resetCaptionStream()},Ut.prototype.init=function(){},Ut.prototype.b=function(){},Ut.prototype.c=function(){};var Vt={Ae:function(e,t){return e.reduce(function(e,t,i){return t.catch(e.bind(null,i))}.bind(null,t),Promise.reject())},Cc:function(e,t){return e.concat(t)},kc:function(){},Ia:function(e){return null!=e}};function Kt(e,t){if(0==t.length)return e;var i=t.map(function(e){return new Q(e)});return e.map(function(e){return new Q(e)}).map(function(e){return i.map(e.resolve.bind(e))}).reduce(Vt.Cc,[]).map(function(e){return e.toString()})}function Wt(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:t||[],keyIds:[]}}var qt={Pa:"video",Db:"audio",ra:"text",rg:"image",pg:"application"},zt=1/15;function Yt(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.b=null,this.g=[],this.c=[],this.f=!1,this.a.on("data",this.i.bind(this)),this.a.on("done",this.h.bind(this))}function Xt(e,t){return!(!d.muxjs||"mp2t"!=e.toLowerCase().split(";")[0].split("/")[1])&&(t?MediaSource.isTypeSupported($t(t,e)):MediaSource.isTypeSupported($t("audio",e))||MediaSource.isTypeSupported($t("video",e)))}function $t(e,t){var i=t.replace(/mp2t/i,"mp4");"audio"==e&&(i=i.replace("video","audio"));var n=/avc1\.(66|77|100)\.(\d+)/.exec(i);if(n){var r="avc1.",a=n[1],s=Number(n[2]);r=("66"==a?r+"4200":"77"==a?r+"4d00":r+"6400")+(s>>4).toString(16),r+=(15&s).toString(16),i=i.replace(n[0],r)}return i}function Jt(e,t,i){this.startTime=e,this.direction=ni,this.endTime=t,this.payload=i,this.region=new hi,this.position=null,this.positionAlign=Qt,this.size=100,this.textAlign=Zt,this.writingMode=ri,this.lineInterpretation=ai,this.line=null,this.lineHeight="",this.lineAlign=si,this.displayAlign=ti,this.fontSize=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=li,this.fontStyle=ui,this.fontFamily="",this.textDecoration=[],this.wrapLine=!0,this.id="",this.nestedCues=[],this.spacer=!1}Yt.prototype.destroy=function(){return this.a.dispose(),this.a=null,Promise.resolve()},Yt.prototype.i=function(e){this.c=e.captions;var t=new Uint8Array(e.data.byteLength+e.initSegment.byteLength);t.set(e.initSegment,0),t.set(e.data,e.initSegment.byteLength),this.g.push(t)},Yt.prototype.h=function(){var e={data:pt.concat.apply(null,this.g),captions:this.c};this.b.resolve(e),this.f=!1},B("shaka.text.Cue",Jt);var Qt="auto";Jt.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Qt};var Zt="center",ei={LEFT:"left",RIGHT:"right",CENTER:Zt,START:"start",END:"end"};Jt.textAlign=ei;var ti="after",ii={BEFORE:"before",CENTER:"center",AFTER:ti};Jt.displayAlign=ii;var ni="ltr";Jt.direction={HORIZONTAL_LEFT_TO_RIGHT:ni,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var ri="horizontal-tb";Jt.writingMode={HORIZONTAL_TOP_TO_BOTTOM:ri,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var ai=0;Jt.lineInterpretation={LINE_NUMBER:ai,PERCENTAGE:1};var si="start",oi={CENTER:"center",START:si,END:"end"};Jt.lineAlign=oi;var li=400;Jt.fontWeight={NORMAL:li,BOLD:700};var ui="normal",ci={NORMAL:ui,ITALIC:"italic",OBLIQUE:"oblique"};function hi(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=di,this.scroll=fi}Jt.fontStyle=ci,Jt.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},B("shaka.text.CueRegion",hi);var di=1;hi.units={PX:0,PERCENTAGE:di,LINES:2};var fi="";function pi(e){this.g=null,this.c=e,this.f=this.m=0,this.h=1/0,this.b=this.a=null,this.l="",this.i=new Map}hi.scrollMode={NONE:fi,UP:"up"};var mi={};function gi(e){return!!(mi[e]||d.muxjs&&"application/cea-608"==e)}function vi(e,t){"application/cea-608"!=t&&(e.g=new mi[t])}function yi(e,t,i,n,r){for(var a=i+" "+n,s=new Map,o=(t=q(t)).next();!o.done;o=t.next()){var l=o.value;o=l.stream,s.has(o)||s.set(o,new Map),s.get(o).has(a)||s.get(o).set(a,[]),l.startTime+=r,l.endTime+=r,l.startTime>=e.f&&l.startTime<e.h&&(l=new Jt(l.startTime,l.endTime,l.text),s.get(o).get(a).push(l),o==e.l&&e.c.append([l]))}for(a=(r=q(s.keys())).next();!a.done;a=r.next())for(a=a.value,e.i.has(a)||e.i.set(a,new Map),o=(t=q(s.get(a).keys())).next();!o.done;o=t.next())o=o.value,l=s.get(a).get(o),e.i.get(a).set(o,l);e.a=null==e.a?Math.max(i,e.f):Math.min(e.a,Math.max(i,e.f)),e.b=Math.max(e.b,Math.min(n,e.h))}function bi(e,t,i){this.f=e,this.g=i,this.b={},this.a=null,this.c={},this.i=new Ke,this.u=!1,this.l={},this.m=t,e=this.s=new ve,t=new MediaSource,this.i.da(t,"sourceopen",e.resolve),this.f.src=_i(t),this.h=t}B("shaka.text.TextEngine.registerParser",function(e,t){mi[e]=t}),B("shaka.text.TextEngine.unregisterParser",function(e){delete mi[e]}),pi.prototype.destroy=function(){return this.c=this.g=null,this.i.clear(),Promise.resolve()},pi.prototype.Rc=function(e){try{return this.g.parseMedia(new Uint8Array(e),{periodStart:0,segmentStart:null,segmentEnd:0})[0].startTime}catch(e){throw new ge(2,2,2009,e)}},pi.prototype.remove=function(e,t){return Promise.resolve().then(function(){!this.c||!this.c.remove(e,t)||null==this.a||t<=this.a||e>=this.b||(e<=this.a&&t>=this.b?this.a=this.b=null:e<=this.a&&t<this.b?this.a=t:e>this.a&&t>=this.b&&(this.b=e))}.bind(this))},pi.prototype.appendCues=pi.prototype.se=function(e){this.c.append(e)},pi.prototype.setSelectedClosedCaptionId=pi.prototype.tc=function(e,t){this.l=e;var i=this.i.get(e);if(i)for(var n=q(i.keys()),r=n.next();!r.done;r=n.next())(r=i.get(r.value).filter(function(e){return e.endTime<=t}))&&this.c.append(r)};var _i=d.URL.createObjectURL;function Ti(e){var n,r,t=Qe(e.mimeType,e.codecs),i=(r=[(n=e).mimeType],et.forEach(function(e,t){var i=n[t];i&&r.push(e+'="'+i+'"')}),r.join(";"));return gi(t)||MediaSource.isTypeSupported(i)||Xt(t,e.type)}function Si(e,t){e.a||(e.a=new pi(e.g)),vi(e.a,t)}function Ei(e){return!e.h||"ended"==e.h.readyState}function wi(e,t){if("text"==t)var i=e.a.a;else i=!(i=ki(e,t))||1==i.length&&i.end(0)-i.start(0)<1e-6?null:1==i.length&&i.start(0)<0?0:i.length?i.start(0):null;return i}function Ci(e,t){return"text"==t?e.a.b:Ft(ki(e,t))}function ki(e,t){try{return e.b[t].buffered}catch(e){return null}}function Ai(t,i,e,n,r,a){return"text"==i?(s=t.a,o=e,l=n,u=r,Promise.resolve().then(function(){if(this.g&&this.c)if(null==l||null==u)this.g.parseInit(new Uint8Array(o));else{var e={periodStart:this.m,segmentStart:l,segmentEnd:u};e=this.g.parseMedia(new Uint8Array(o),e).filter(function(e){return e.startTime>=this.f&&e.startTime<this.h}.bind(this)),this.c.append(e),null==this.a&&(this.a=Math.max(l,this.f)),this.b=Math.min(u,this.h)}}.bind(s))):t.l[i]?function(e,t){e.f=!0,e.b=new ve,e.g=[],e.c=[];var i=new Uint8Array(t);return e.a.push(i),e.a.flush(),e.f&&e.b.reject(new ge(2,3,3018)),e.b}(t.l[i],e).then(function(e){return this.a||Si(this,"text/vtt"),e.captions&&e.captions.length&&yi(this.a,e.captions,n,r,this.b.video.timestampOffset),xi(this,i,this.ge.bind(this,i,e.data.buffer))}.bind(t)):(a&&d.muxjs&&(t.a||Si(t,"text/vtt"),null==n&&null==r?t.m.init(e):t.m.b(e,function(e){e.length&&yi(t.a,e,n,r,t.b.video.timestampOffset)})),xi(t,i,t.ge.bind(t,i,e)));var s,o,l,u}function Ii(e,t){return"text"==t?e.a?(e.m.c(),e.a.remove(0,1/0)):Promise.resolve():xi(e,t,e.he.bind(e,t,0,e.h.duration))}function xi(t,i,n){if(t.u)return Promise.reject();if(n={start:n,p:new ve},t.c[i].push(n),1==t.c[i].length)try{n.start()}catch(e){"QuotaExceededError"==e.name?n.p.reject(new ge(2,3,3017,i)):n.p.reject(new ge(2,3,3015,e)),Li(t,i)}return n.p}function Pi(e,i){if(e.u)return Promise.reject();var t,n=[];for(t in e.b){var r=new ve,a={start:function(e){e.resolve()}.bind(null,r),p:r};e.c[t].push(a),n.push(r),1==e.c[t].length&&a.start()}return Promise.all(n).then(function(){try{i()}catch(e){var t=Promise.reject(new ge(2,3,3015,e))}for(var e in this.b)Li(this,e);return t}.bind(e),function(e){throw e}.bind(e))}function Li(t,i){t.c[i].shift();var n=t.c[i][0];if(n)try{n.start()}catch(e){n.p.reject(new ge(2,3,3015,e)),Li(t,i)}}function Ri(e,t){return e=Di(e),t=Di(t),e.split("-")[0]==t.split("-")[0]}function Oi(e,t){e=Di(e),t=Di(t);var i=e.split("-"),n=t.split("-");return i[0]==n[0]&&1==i.length&&2==n.length}function Di(e){var t=e.split("-");return e=t[0]||"",t=t[1]||"",e=e.toLowerCase(),e=Bi.get(e)||e,(t=t.toUpperCase())?e+"-"+t:e}function Ni(e){return e.language?Di(e.language):e.audio&&e.audio.language?Di(e.audio.language):e.video&&e.video.language?Di(e.video.language):"und"}function Mi(e,t){for(var i=Di(e),n=new Set,r=q(t),a=r.next();!a.done;a=r.next())n.add(Di(a.value));for(a=(r=q(n)).next();!a.done;a=r.next())if((a=a.value)==i)return a;for(a=(r=q(n)).next();!a.done;a=r.next())if(Oi(a=a.value,i))return a;for(a=(r=q(n)).next();!a.done;a=r.next()){var s=a=a.value,o=i;if(s=Di(s),o=Di(o),s=s.split("-"),o=o.split("-"),2==s.length&&2==o.length&&s[0]==o[0])return a}for(a=(n=q(n)).next();!a.done;a=n.next())if(Oi(i,r=a.value))return r;return null}(t=bi.prototype).destroy=function(){var e=this;this.u=!0;var t,i=[];for(t in this.c){var n=this.c[t],r=n[0];for(this.c[t]=n.slice(0,1),r&&i.push(r.p.catch(Vt.kc)),r=1;r<n.length;++r)n[r].p.reject()}for(var a in this.a&&i.push(this.a.destroy()),this.g&&i.push(this.g.destroy()),this.l)i.push(this.l[a].destroy());return Promise.all(i).then(function(){e.i&&(e.i.release(),e.i=null),e.f&&(e.f.removeAttribute("src"),e.f.load(),e.f=null),e.h=null,e.a=null,e.g=null,e.b={},e.l={},e.m=null,e.c={}})},t.init=function(t,r){var a=this;return z(function e(){var n;return X(e,function(e){switch(e.j){case 1:return n=qt,Y(e,a.s,2);case 2:t.forEach(function(e,t){var i=Qe(e.mimeType,e.codecs);t==n.ra?Si(a,i):(!r&&MediaSource.isTypeSupported(i)||!Xt(i,t)||(a.l[t]=new Yt,i=$t(t,i)),i=a.h.addSourceBuffer(i),a.i.w(i,"error",a.Yf.bind(a,t)),a.i.w(i,"updateend",a.wb.bind(a,t)),a.b[t]=i,a.c[t]=[])}),F(e)}})})},t.Oc=function(e){if(e.total=Gt(this.f.buffered),e.audio=Gt(ki(this,"audio")),e.video=Gt(ki(this,"video")),e.text=[],this.a){var t=this.a.a,i=this.a.b;null!=t&&null!=i&&e.text.push({start:t,end:i})}},t.tc=function(e){var t=Ci(this,"video")||0;this.a.tc(e,t)},t.remove=function(e,t,i){return"text"==e?this.a.remove(t,i):xi(this,e,this.he.bind(this,e,t,i))},t.flush=function(e){return"text"==e?Promise.resolve():xi(this,e,this.Fe.bind(this,e))},t.endOfStream=function(e){return Pi(this,function(){Ei(this)||(e?this.h.endOfStream(e):this.h.endOfStream())}.bind(this))},t.xa=function(e){return Pi(this,function(){this.h.duration=e}.bind(this))},t.Y=function(){return this.h.duration},t.ge=function(e,t){this.b[e].appendBuffer(t)},t.he=function(e,t,i){i<=t?this.wb(e):this.b[e].remove(t,i)},t.qe=function(e){var t=this.b[e].appendWindowStart,i=this.b[e].appendWindowEnd;this.b[e].abort(),this.b[e].appendWindowStart=t,this.b[e].appendWindowEnd=i,this.wb(e)},t.Fe=function(e){this.f.currentTime-=.001,this.wb(e)},t.Xf=function(e,t){t<0&&(t+=.001),this.b[e].timestampOffset=t,this.wb(e)},t.Uf=function(e,t,i){this.b[e].appendWindowStart=0,this.b[e].appendWindowEnd=i,this.b[e].appendWindowStart=t,this.wb(e)},t.Yf=function(e){this.c[e][0].p.reject(new ge(2,3,3014,this.f.error?this.f.error.code:0))},t.wb=function(e){var t=this.c[e][0];t&&(t.p.resolve(),Li(this,e))};var Bi=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function Ui(e,t,i){function n(e,t,i){return t<=e&&e<=i}var r=e.video;return!(r&&r.width&&r.height&&(!n(r.width,t.minWidth,Math.min(t.maxWidth,i.width))||!n(r.height,t.minHeight,Math.min(t.maxHeight,i.height))||!n(r.width*r.height,t.minPixels,t.maxPixels))||e&&e.frameRate&&!n(e.frameRate,t.minFrameRate,t.maxFrameRate)||!n(e.bandwidth,t.minBandwidth,t.maxBandwidth))}function Fi(e,i,n){var r=!1;return e.forEach(function(e){var t=e.allowedByApplication;e.allowedByApplication=Ui(e,i,n),t!=e.allowedByApplication&&(r=!0)}),r}function ji(i,n,r,e){e.variants=e.variants.filter(function(e){if(i&&i.S&&!Pt(i,e))return!1;var t=e.audio;return e=e.video,!(t&&!Ti(t)||e&&!Ti(e)||t&&n&&!Hi(t,n)||e&&r&&!Hi(e,r))}),e.textStreams=e.textStreams.filter(function(e){return gi(Qe(e.mimeType,e.codecs))})}function Hi(e,t){return e.mimeType==t.mimeType&&e.codecs.split(".")[0]==t.codecs.split(".")[0]}function Gi(e){var t=e.audio,i=e.video,n=t?t.codecs:null,r=i?i.codecs:null,a=[];r&&a.push(r),n&&a.push(n);var s=[];i&&s.push(i.mimeType),t&&s.push(t.mimeType),s=s[0]||null;var o=[];t&&o.push(t.kind),i&&o.push(i.kind),o=o[0]||null;var l=new Set;return t&&t.roles.forEach(function(e){return l.add(e)}),i&&i.roles.forEach(function(e){return l.add(e)}),e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:o,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:s,codecs:a.join(", "),audioCodec:n,videoCodec:r,primary:e.primary,roles:Array.from(l),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null},i&&(e.videoId=i.id,e.originalVideoId=i.originalId,e.width=i.width||null,e.height=i.height||null,e.frameRate=i.frameRate||null,e.pixelAspectRatio=i.pixelAspectRatio||null,e.videoBandwidth=i.bandwidth||null),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.label=t.label,e.audioRoles=t.roles),e}function Vi(e){return{id:e.id,active:!1,type:"text",bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:e.mimeType,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId}}function Ki(e){return e.__shaka_id||(e.__shaka_id=Wi++),e.__shaka_id}var Wi=0;function qi(e){return{id:Ki(e),active:!1,type:"",bandwidth:0,language:Di(e.language),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}}function zi(e){return e.allowedByApplication&&e.allowedByKeySystem}function Yi(e,t){for(var i=e.filter(function(e){return e.audio&&e.audio.channelsCount}),n=new Map,r=(i=q(i)).next();!r.done;r=i.next()){var a=(r=r.value).audio.channelsCount;n.has(a)||n.set(a,[]),n.get(a).push(r)}return 0==(i=Array.from(n.keys())).length?e:(r=i.filter(function(e){return e<=t})).length?n.get(Math.max.apply(null,r)):n.get(Math.min.apply(null,i))}function Xi(e,t,i){var n=e,r=e.filter(function(e){return e.primary});r.length&&(n=r);var a=n.length?n[0].language:"";if(n=n.filter(function(e){return e.language==a}),t){var s=Mi(Di(t),e.map(function(e){return e.language}));s&&(n=e.filter(function(e){return Di(e.language)==s}))}if(i){if((e=$i(n,i)).length)return e}else if((e=n.filter(function(e){return 0==e.roles.length})).length)return e;return(e=n.map(function(e){return e.roles}).reduce(Vt.Cc,[])).length?$i(n,e[0]):n}function $i(e,t){return e.filter(function(e){return e.roles.includes(t)})}function Ji(e,t,i){for(var n=0;n<i.length;n++)if(i[n].audio==e&&i[n].video==t)return i[n];return null}function Qi(){this.h=null,this.f=!1,this.b=new V,this.c=[],this.i=!1,this.a=this.g=null}function Zi(t,e){return t&&(e=e.filter(function(e){return Ui(e,t,{width:1/0,height:1/0})})),e.sort(function(e,t){return e.bandwidth-t.bandwidth})}function en(e,t){this.a=e,this.b=t}function tn(e,t){var i=new en(2,6),n=an.a,r=i.b-n.b;(0<(i.a-n.a||r)?an.c:an.b)(an.a,i,e,t)}function nn(e,t,i,n){W([i,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",n].join(" "))}function rn(e,t,i,n){K([i,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",n].join(""))}B("shaka.abr.SimpleAbrManager",Qi),Qi.prototype.stop=Qi.prototype.stop=function(){this.h=null,this.f=!1,this.c=[],this.g=null},Qi.prototype.init=Qi.prototype.init=function(e){this.h=e},Qi.prototype.chooseVariant=Qi.prototype.chooseVariant=function(){var e=Zi(this.a.restrictions,this.c),t=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.c.length&&!e.length&&(e=[(e=Zi(null,this.c))[0]]);for(var i=e[0]||null,n=0;n<e.length;++n){var r=e[n],a=(e[n+1]||{bandwidth:1/0}).bandwidth/this.a.bandwidthUpgradeTarget;t>=r.bandwidth/this.a.bandwidthDowngradeTarget&&t<=a&&(i=r)}return this.g=Date.now(),i},Qi.prototype.enable=Qi.prototype.enable=function(){this.f=!0},Qi.prototype.disable=Qi.prototype.disable=function(){this.f=!1},Qi.prototype.segmentDownloaded=Qi.prototype.segmentDownloaded=function(e,t){var i=this.b;if(!(t<16e3)){var n=8e3*t/e,r=e/1e3;i.a+=t,H(i.b,r,n),H(i.c,r,n)}if(null!=this.g&&this.f)e:{if(this.i){if(Date.now()-this.g<1e3*this.a.switchInterval)break e}else{if(!(128e3<=this.b.a))break e;this.i=!0}i=this.chooseVariant(),this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate),this.h(i)}},Qi.prototype.getBandwidthEstimate=Qi.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)},Qi.prototype.setVariants=Qi.prototype.setVariants=function(e){this.c=e},Qi.prototype.configure=Qi.prototype.configure=function(e){this.a=e},en.prototype.toString=function(){return"v"+this.a+"."+this.b};var an=null,sn="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),on="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),ln=["loop","playbackRate"],un=["pause","play"],cn="abrstatuschanged adaptation buffering drmsessionupdate emsg error expirationupdated largegap loading manifestparsed onstatechange onstateidle streaming textchanged texttrackvisibility timelineregionadded timelineregionenter timelineregionexit trackschanged unloading variantchanged".split(" "),hn={getAssetUri:2,getAudioLanguages:2,getAudioLanguagesAndRoles:2,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getPlaybackRate:2,getTextLanguages:2,getTextLanguagesAndRoles:2,getTextTracks:2,getStats:5,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,usingEmbeddedTextTrack:2,getLoadMode:10},dn={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},fn=[["getConfiguration","configure"]],pn=[["isTextTrackVisible","setTextTrackVisibility"]],mn="addTextTrack cancelTrickPlay configure resetConfiguration retryStreaming selectAudioLanguage selectEmbeddedTextTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay".split(" "),gn=["attach","detach","load","unload"];function vn(e){return JSON.stringify(e,function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof Ce){var i,n={};for(i in t){var r=t[i];r&&"object"==typeof r?"detail"==i&&(n[i]=r):i in Event||(n[i]=r)}return n}if(t instanceof TimeRanges)for(n={__type__:"TimeRanges",length:t.length,start:[],end:[]},i=0;i<t.length;++i)n.start.push(t.start(i)),n.end.push(t.end(i));else n=t instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:t<0?"-Infinity":"Infinity":t;return n}})}function yn(e){return JSON.parse(e,function(e,t){return"NaN"==t?NaN:"-Infinity"==t?-1/0:"Infinity"==t?1/0:t&&"object"==typeof t&&"TimeRanges"==t.__type__?{length:(i=t).length,start:function(e){return i.start[e]},end:function(e){return i.end[e]}}:t&&"object"==typeof t&&"Uint8Array"==t.__type__?new Uint8Array(t.entries):t;var i})}function bn(e,t,i,n,r,a){this.S=e,this.f=new de(t),this.R=i,this.l=!1,this.F=n,this.K=r,this.C=a,this.b=this.h=!1,this.D="",this.i=null,this.m=this.Qd.bind(this),this.s=this.pf.bind(this),this.a={video:{},player:{}},this.u=0,this.c={},this.g=null}var _n=!1,Tn=null;function Sn(e){var t=Tn;t.removeUpdateListener(e.m),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.s)}function En(e){for(var t in e.c){var i=e.c[t];delete e.c[t],i.reject(new ge(1,7,7e3))}}function wn(e){e=vn(e),Tn.sendMessage("urn:x-cast:com.google.shaka.v2",e,function(){},$)}function Cn(e,t,i){var n=this;Ae.call(this),this.c=e,this.b=t,this.i=this.g=this.f=this.l=this.h=null,(this.m=i)&&(this.a=new bn(i,function(){return An(n)},function(){return In(n)},function(e,t){return Pn(n,e,t)},function(){return xn(n)},function(){return kn(n)})),function(e){for(var t in e.a&&e.a.init(),e.i=new Ke,sn.forEach(function(e){this.i.w(this.c,e,this.ng.bind(this))}.bind(e)),cn.forEach(function(e){this.i.w(this.b,e,this.Cf.bind(this))}.bind(e)),e.h={},e.c)Object.defineProperty(e.h,t,{configurable:!1,enumerable:!0,get:e.mg.bind(e,t),set:e.og.bind(e,t)});for(var i in e.l={},e.b)Object.defineProperty(e.l,i,{configurable:!1,enumerable:!0,get:e.Xd.bind(e,i)});e.f=new Ae,e.f.Yb=e.h,e.g=new Ae,e.g.Yb=e.l}(this)}function kn(e){var i={video:{},player:{},playerAfterLoad:{},manifest:e.b.ec(),startTime:null};return e.c.pause(),ln.forEach(function(e){i.video[e]=this.c[e]}.bind(e)),e.c.ended||(i.startTime=e.c.currentTime),fn.forEach(function(e){var t=e[1];e=this.b[e[0]](),i.player[t]=e}.bind(e)),pn.forEach(function(e){var t=e[1];e=this.b[e[0]](),i.playerAfterLoad[t]=e}.bind(e)),i}function An(e){e.dispatchEvent(new Ce("caststatuschanged"))}function In(e){e.f.dispatchEvent(new Ce(e.h.paused?"pause":"play"))}function xn(t){fn.forEach(function(e){var t=e[1];e=this.a.get("player",e[0])(),this.b[t](e)}.bind(t));var e=t.a.get("player","getAssetUri")(),i=t.a.get("video","ended"),n=Promise.resolve(),r=t.c.autoplay,a=null;i||(a=t.a.get("video","currentTime")),e&&(t.c.autoplay=!1,n=t.b.load(e,a));var s={};ln.forEach(function(e){s[e]=this.a.get("video",e)}.bind(t)),n.then(function(){t.c&&(ln.forEach(function(e){this.c[e]=s[e]}.bind(t)),pn.forEach(function(e){var t=e[1];e=this.a.get("player",e[0])(),this.b[t](e)}.bind(t)),t.c.autoplay=r,e&&t.c.play())},function(e){t.b.dispatchEvent(new Ce("error",{detail:e}))})}function Pn(e,t,i){e.a.ga()&&("video"==t?e.f.dispatchEvent(i):"player"==t&&e.g.dispatchEvent(i))}function Ln(e,t,i,n){var r,a,s=this;Ae.call(this),this.a=e,this.b=t,this.c=new Ke,this.D={video:e,player:t},this.s=i||function(){},this.F=n||function(e){return e},this.u=!1,this.h=!0,this.g=0,this.m=!1,this.l=!0,this.i=this.f=null,this.C=new de(function(){On(s)}),r=this,(a=cast.receiver.CastReceiverManager.getInstance()).onSenderConnected=r.Td.bind(r),a.onSenderDisconnected=r.Td.bind(r),a.onSystemVolumeChanged=r.Ee.bind(r),r.i=a.getCastMessageBus("urn:x-cast:com.google.cast.media"),r.i.onMessage=r.jf.bind(r),r.f=a.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),r.f.onMessage=r.vf.bind(r),a.start(),sn.forEach(function(e){this.c.w(this.a,e,this.Zd.bind(this,"video"))}.bind(r)),cn.forEach(function(e){this.c.w(this.b,e,this.Zd.bind(this,"player"))}.bind(r)),cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?r.b.qd(3840,2160):r.b.qd(1920,1080),r.c.w(r.a,"loadeddata",function(){this.m=!0}.bind(r)),r.c.w(r.b,"loading",function(){this.h=!1,Rn(this)}.bind(r)),r.c.w(r.a,"playing",function(){this.h=!1,Rn(this)}.bind(r)),r.c.w(r.a,"pause",function(){Rn(this)}.bind(r)),r.c.w(r.b,"unloading",function(){this.h=!0,Rn(this)}.bind(r)),r.c.w(r.a,"ended",function(){var e=this;new de(function(){e.a&&e.a.ended&&(e.h=!0,Rn(e))}).P(5)}.bind(r))}function Rn(e){Promise.resolve().then(function(){this.b&&(this.dispatchEvent(new Ce("caststatuschanged")),Dn(this)||Bn(this,0))}.bind(e))}function On(e){e.C.P(.5);var t={video:{},player:{}};if(on.forEach(function(e){t.video[e]=this.a[e]}.bind(e)),e.b.V())for(var i in dn)0==e.g%dn[i]&&(t.player[i]=e.b[i]());for(var n in hn)0==e.g%hn[n]&&(t.player[n]=e.b[n]());(i=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=i.level,t.video.muted=i.muted),e.m&&(e.g+=1),Mn(e,{type:"update",update:t},e.f),Dn(e)}function Dn(e){return e.l&&(e.a.duration||e.b.V())&&(Nn(e),e.l=!1,1)}function Nn(e){var t={contentId:e.b.ec(),streamType:e.b.V()?"LIVE":"BUFFERED",duration:e.a.duration,contentType:""};Bn(e,0,t)}function Mn(e,t,i,n){e.u&&(e=vn(t),n?i.getCastChannel(n).send(e):i.broadcast(e))}function Bn(e,t,i){var n=e.a.playbackRate,r=Un;n={mediaSessionId:0,playbackRate:n,playerState:r=e.h?r.IDLE:e.b.Tc()?r.le:e.a.paused?r.ne:r.oe,currentTime:e.a.currentTime,supportedMediaCommands:15,volume:{level:e.a.volume,muted:e.a.muted}},i&&(n.media=i),Mn(e,{requestId:t,type:"MEDIA_STATUS",status:[n]},e.i)}(t=bn.prototype).destroy=function(){return En(this),Tn&&Sn(this),this.f&&(this.f.stop(),this.f=null),this.K=this.F=null,this.b=this.h=!1,this.s=this.m=this.g=this.c=this.a=this.i=null,Promise.resolve()},t.ga=function(){return this.b},t.hd=function(){return this.D},t.init=function(){if(d.chrome&&chrome.cast&&chrome.cast.isAvailable){delete d.__onGCastApiAvailable,this.h=!0,this.f.uc();var e=new chrome.cast.SessionRequest(this.S);e=new chrome.cast.ApiConfig(e,this.Rd.bind(this),this.tf.bind(this),"origin_scoped"),chrome.cast.initialize(e,function(){},function(){}),_n&&this.f.P(.02),(e=Tn)&&e.status!=chrome.cast.SessionStatus.STOPPED?this.Rd(e):Tn=null}else d.__onGCastApiAvailable=function(e){e&&this.init()}.bind(this)},t.pd=function(e){this.i=e,this.b&&wn({type:"appData",appData:this.i})},t.cast=function(e){return this.h?_n?this.b?Promise.reject(new ge(1,8,8002)):(this.g=new ve,chrome.cast.requestSession(this.ed.bind(this,e),this.Pd.bind(this)),this.g):Promise.reject(new ge(1,8,8001)):Promise.reject(new ge(1,8,8e3))},t.Ib=function(){this.b&&(En(this),Tn&&(Sn(this),Tn.stop(function(){},function(){}),Tn=null))},t.get=function(e,t){if("video"==e){if(un.includes(t))return this.ae.bind(this,e,t)}else if("player"==e){if(dn[t]&&!this.get("player","isLive")())return function(){};if(mn.includes(t))return this.ae.bind(this,e,t);if(gn.includes(t))return this.If.bind(this,e,t);if(hn[t])return this.Yd.bind(this,e,t)}return this.Yd(e,t)},t.set=function(e,t,i){wn({type:"set",targetName:e,property:t,value:this.a[e][t]=i})},t.ed=function(e,t){(Tn=t).addUpdateListener(this.m),t.addMessageListener("urn:x-cast:com.google.shaka.v2",this.s),this.Qd(),wn({type:"init",initState:e,appData:this.i}),this.g.resolve()},t.Pd=function(e){var t=8003;switch(e.code){case"cancel":t=8004;break;case"timeout":t=8005;break;case"receiver_unavailable":t=8006}this.g.reject(new ge(2,8,t,e))},t.Yd=function(e,t){return this.a[e][t]},t.ae=function(e,t,i){for(var n=[],r=2;r<arguments.length;++r)n[r-2]=arguments[r];wn({type:"call",targetName:e,methodName:t,args:n})},t.If=function(e,t,i){for(var n=[],r=2;r<arguments.length;++r)n[r-2]=arguments[r];r=new ve;var a=this.u.toString();return this.u++,this.c[a]=r,wn({type:"asyncCall",targetName:e,methodName:t,args:n,id:a}),r},t.Rd=function(e){var t=this.C();this.g=new ve,this.l=!0,this.ed(t,e)},t.tf=function(e){_n="available"==e,this.f.uc()},t.Qd=function(){var e=!!Tn&&"connected"==Tn.status;if(this.b&&!e){for(var t in this.K(),this.a)this.a[t]={};En(this)}this.D=(this.b=e)?Tn.receiver.friendlyName:"",this.f.uc()},t.pf=function(e,t){var i=yn(t);switch(i.type){case"event":var n=i.event;this.F(i.targetName,new Ce(n.type,n));break;case"update":for(var r in n=i.update)for(var a in i=this.a[r]||{},n[r])i[a]=n[r][a];this.l&&(this.R(),this.l=!1);break;case"asyncComplete":if(r=i.id,i=i.error,a=this.c[r],delete this.c[r],a)if(i){for(n in r=new ge(i.severity,i.category,i.code),i)r[n]=i[n];a.reject(r)}else a.resolve()}},U(Cn,Ae),B("shaka.cast.CastProxy",Cn),Cn.prototype.destroy=Cn.prototype.destroy=function(e){return e&&this.a&&this.a.Ib(),this.i&&(this.i.release(),this.i=null),e=[],this.b&&(e.push(this.b.destroy()),this.b=null),this.a&&(e.push(this.a.destroy()),this.a=null),this.l=this.h=this.c=null,Promise.all(e)},Cn.prototype.getVideo=Cn.prototype.bf=function(){return this.h},Cn.prototype.getPlayer=Cn.prototype.Ve=function(){return this.l},Cn.prototype.canCast=Cn.prototype.ue=function(){return!!this.a&&(this.a.h&&_n)},Cn.prototype.isCasting=Cn.prototype.ga=function(){return!!this.a&&this.a.ga()},Cn.prototype.receiverName=Cn.prototype.hd=function(){return this.a?this.a.hd():""},Cn.prototype.cast=Cn.prototype.cast=function(){if(!this.a)throw new ge(1,8,8007);var e=kn(this);return this.a.cast(e).then(function(){if(this.b)return this.b.xd()}.bind(this))},Cn.prototype.setAppData=Cn.prototype.pd=function(e){this.a&&this.a.pd(e)},Cn.prototype.suggestDisconnect=Cn.prototype.eg=function(){if(this.a){var e=this.a;if(e.b){var t=e.C();chrome.cast.requestSession(e.ed.bind(e,t),e.Pd.bind(e))}}},Cn.prototype.changeReceiverId=Cn.prototype.xe=function(t){var i=this;return z(function e(){return X(e,function(e){switch(e.j){case 1:if(t==i.m)return e.return();if(i.m=t,i.a)return i.a.Ib(),Y(e,i.a.destroy(),3);e.A(2);break;case 3:i.a=null;case 2:i.a=new bn(t,function(){return An(i)},function(){return In(i)},function(e,t){return Pn(i,e,t)},function(){return xn(i)},function(){return kn(i)}),i.a.init(),F(e)}})})},Cn.prototype.forceDisconnect=Cn.prototype.Ib=function(){this.a&&this.a.Ib()},(t=Cn.prototype).mg=function(e){if("addEventListener"==e)return this.f.addEventListener.bind(this.f);if("removeEventListener"==e)return this.f.removeEventListener.bind(this.f);if(this.a&&this.a.ga()&&0==Object.keys(this.a.a.video).length){var t=this.c[e];if("function"!=typeof t)return t}return this.a&&this.a.ga()?this.a.get("video",e):("function"==typeof(e=this.c[e])&&(e=e.bind(this.c)),e)},t.og=function(e,t){this.a&&this.a.ga()?this.a.set("video",e,t):this.c[e]=t},t.ng=function(e){this.a&&this.a.ga()||this.f.dispatchEvent(new Ce(e.type,e))},t.Xd=function(e){if("addEventListener"==e)return this.g.addEventListener.bind(this.g);if("removeEventListener"==e)return this.g.removeEventListener.bind(this.g);if("getMediaElement"==e)return function(){return this.h}.bind(this);if("getSharedConfiguration"==e)return this.a?this.a.get("player","getConfiguration"):this.b.getConfiguration();if("getNetworkingEngine"==e)return this.b.Kb.bind(this.b);if(this.a&&this.a.ga()){if("getManifest"==e||"drmInfo"==e)return function(){return W(e+"() does not work while casting!"),null};if("getManifestUri"==e)return tn("getManifestUri",'Please use "getAssetUri" instead.'),this.Xd("getAssetUri");if("attach"==e||"detach"==e)return function(){return W(e+"() does not work while casting!"),Promise.resolve()}}return this.a&&this.a.ga()&&0==Object.keys(this.a.a.video).length&&hn[e]||!this.a||!this.a.ga()?this.b[e].bind(this.b):this.a.get("player",e)},t.Cf=function(e){this.a&&this.a.ga()||this.g.dispatchEvent(e)},U(Ln,Ae),B("shaka.cast.CastReceiver",Ln),Ln.prototype.isConnected=Ln.prototype.isConnected=function(){return this.u},Ln.prototype.isIdle=Ln.prototype.ff=function(){return this.h},Ln.prototype.destroy=Ln.prototype.destroy=function(){var i=this;return z(function e(){var t;return X(e,function(e){switch(e.j){case 1:return i.c&&(i.c.release(),i.c=null),t=[],i.b&&(t.push(i.b.destroy()),i.b=null),i.C&&(i.C.stop(),i.C=null),i.a=null,i.D=null,i.s=null,i.u=!1,i.h=!0,i.f=null,i.i=null,Y(e,Promise.all(t),2);case 2:cast.receiver.CastReceiverManager.getInstance().stop(),F(e)}})})},(t=Ln.prototype).Td=function(){this.g=0,this.l=!0,this.u=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,Rn(this)},t.Zd=function(e,t){this.b&&(On(this),Mn(this,{type:"event",targetName:e,event:t},this.f))},t.Ee=function(){var e=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();e&&Mn(this,{type:"update",update:{video:{volume:e.level,muted:e.muted}}},this.f),Mn(this,{type:"event",targetName:"video",event:{type:"volumechange"}},this.f)},t.vf=function(e){var t=yn(e.data);switch(t.type){case"init":this.g=0,this.m=!1,this.l=!0,function(i,n,e){for(var t in n.player)i.b[t](n.player[t]);i.s(e),e=Promise.resolve();var r=i.a.autoplay;n.manifest&&(i.a.autoplay=!1,e=i.b.load(n.manifest,n.startTime)),e.then(function(){if(i.b){for(var e in n.video)i.a[e]=n.video[e];for(var t in n.playerAfterLoad)i.b[t](n.playerAfterLoad[t]);i.a.autoplay=r,n.manifest&&(i.a.play(),Bn(i,0))}},function(e){i.b.dispatchEvent(new Ce("error",{detail:e}))})}(this,t.initState,t.appData),On(this);break;case"appData":this.s(t.appData);break;case"set":var i=t.targetName,n=t.property;if(t=t.value,"video"==i){var r=cast.receiver.CastReceiverManager.getInstance();if("volume"==n){r.setSystemVolumeLevel(t);break}if("muted"==n){r.setSystemVolumeMuted(t);break}}this.D[i][n]=t;break;case"call":(i=this.D[t.targetName])[t.methodName].apply(i,t.args);break;case"asyncCall":i=t.targetName,n=t.methodName,"player"==i&&"load"==n&&(this.g=0,this.m=!1),r=t.id,e=e.senderId;var a=this.D[i];t=a[n].apply(a,t.args),"player"==i&&"load"==n&&(t=t.then(function(){this.l=!0}.bind(this))),t.then(this.de.bind(this,e,r,null),this.de.bind(this,e,r))}},t.jf=function(e){var i=yn(e.data);switch(i.type){case"PLAY":this.a.play(),Bn(this,0);break;case"PAUSE":this.a.pause(),Bn(this,0);break;case"SEEK":e=i.currentTime;var t=i.resumeState;null!=e&&(this.a.currentTime=Number(e)),t&&"PLAYBACK_START"==t?(this.a.play(),Bn(this,0)):t&&"PLAYBACK_PAUSE"==t&&(this.a.pause(),Bn(this,0));break;case"STOP":this.b.xd().then(function(){this.b&&Bn(this,0)}.bind(this));break;case"GET_STATUS":Bn(this,Number(i.requestId));break;case"VOLUME":e=(t=i.volume).level,t=t.muted;var n=this.a.volume,r=this.a.muted;null!=e&&(this.a.volume=Number(e)),null!=t&&(this.a.muted=t),n==this.a.volume&&r==this.a.muted||Bn(this,0);break;case"LOAD":this.g=0,this.l=this.m=!1,e=i.media,t=i.currentTime,n=this.F(e.contentId),r=i.autoplay||!0,this.s(e.customData),r&&(this.a.autoplay=!0),this.b.load(n,t).then(function(){this.b&&Nn(this)}.bind(this)).catch(function(e){var t="LOAD_FAILED";7==e.category&&7e3==e.code&&(t="LOAD_CANCELLED"),Mn(this,{requestId:Number(i.requestId),type:t},this.i)}.bind(this));break;default:Mn(this,{requestId:Number(i.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.i)}},t.de=function(e,t,i){this.b&&Mn(this,{type:"asyncComplete",id:t,error:i},this.f,e)};var Un={IDLE:"IDLE",oe:"PLAYING",le:"BUFFERING",ne:"PAUSED"};function Fn(e,t){this.J=e,this.b=t==jn,this.a=0}B("shaka.util.DataViewReader",Fn);var jn=1;function Hn(){throw new ge(2,3,3e3)}function Gn(){this.c=[],this.b=[],this.a=!1}function Vn(e){for(var t=null!=e.flags?12:8;e.reader.ua()&&!e.parser.a;)e.parser.oc(e.start+t,e.reader,e.partialOkay)}function Kn(e){for(var t=null!=e.flags?12:8,i=e.reader.G();0<i&&!e.parser.a;--i)e.parser.oc(e.start+t,e.reader,e.partialOkay)}function Wn(t){return function(e){t(e.reader.Za(e.reader.J.byteLength-e.reader.ca()))}}function qn(e){for(var t=0,i=0;i<e.length;i++)t=t<<8|e.charCodeAt(i);return t}function zn(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function Yn(e){var r=this;this.b=[],this.a=[],this.data=[],(new Gn).H("moov",Vn).fa("pssh",function(e){if(!(1<e.version)){var t=e.reader.J;if(t=new Uint8Array(t.buffer,t.byteOffset-12,e.size),r.data.push(t),r.b.push(pt.wc(e.reader.Za(16))),0<e.version){t=e.reader.G();for(var i=0;i<t;++i){var n=pt.wc(e.reader.Za(16));r.a.push(n)}}}}).parse(e)}Fn.Endianness={qg:0,sg:jn},Fn.prototype.hasMoreData=Fn.prototype.ua=function(){return this.a<this.J.byteLength},Fn.prototype.getPosition=Fn.prototype.ca=function(){return this.a},Fn.prototype.getLength=Fn.prototype.Le=function(){return this.J.byteLength},Fn.prototype.readUint8=Fn.prototype.la=function(){try{var e=this.J.getUint8(this.a);return this.a+=1,e}catch(e){Hn()}},Fn.prototype.readUint16=Fn.prototype.Rb=function(){try{var e=this.J.getUint16(this.a,this.b);return this.a+=2,e}catch(e){Hn()}},Fn.prototype.readUint32=Fn.prototype.G=function(){try{var e=this.J.getUint32(this.a,this.b);return this.a+=4,e}catch(e){Hn()}},Fn.prototype.readInt32=Fn.prototype.$d=function(){try{var e=this.J.getInt32(this.a,this.b);return this.a+=4,e}catch(e){Hn()}},Fn.prototype.readUint64=Fn.prototype.Ab=function(){try{if(this.b)var e=this.J.getUint32(this.a,!0),t=this.J.getUint32(this.a+4,!0);else t=this.J.getUint32(this.a,!1),e=this.J.getUint32(this.a+4,!1)}catch(e){Hn()}if(2097151<t)throw new ge(2,3,3001);return this.a+=8,t*Math.pow(2,32)+e},Fn.prototype.readBytes=Fn.prototype.Za=function(e){this.a+e>this.J.byteLength&&Hn();var t=new Uint8Array(this.J.buffer,this.J.byteOffset+this.a,e);return this.a+=e,t},Fn.prototype.skip=Fn.prototype.M=function(e){this.a+e>this.J.byteLength&&Hn(),this.a+=e},Fn.prototype.rewind=Fn.prototype.be=function(e){this.a<e&&Hn(),this.a-=e},Fn.prototype.seek=Fn.prototype.seek=function(e){(e<0||e>this.J.byteLength)&&Hn(),this.a=e},Fn.prototype.readTerminatedString=Fn.prototype.gd=function(){for(var e=this.a;this.ua()&&0!=this.J.getUint8(this.a);)this.a+=1;return e=new Uint8Array(this.J.buffer,this.J.byteOffset+e,this.a-e),this.a+=1,ot(e)},B("shaka.util.Mp4Parser",Gn),Gn.prototype.box=Gn.prototype.H=function(e,t){var i=qn(e);return this.c[i]=0,this.b[i]=t,this},Gn.prototype.fullBox=Gn.prototype.fa=function(e,t){var i=qn(e);return this.c[i]=1,this.b[i]=t,this},Gn.prototype.stop=Gn.prototype.stop=function(){this.a=!0},Gn.prototype.parse=Gn.prototype.parse=function(e,t){var i=new Uint8Array(e);for(i=new Fn(new DataView(i.buffer,i.byteOffset,i.byteLength),0),this.a=!1;i.ua()&&!this.a;)this.oc(0,i,t)},Gn.prototype.parseNext=Gn.prototype.oc=function(e,t,i){var n=t.ca(),r=t.G(),a=t.G();switch(r){case 0:r=t.J.byteLength-n;break;case 1:r=t.Ab()}var s=this.b[a];if(s){var o=null,l=null;1==this.c[a]&&(o=(l=t.G())>>>24,l&=16777215),a=n+r,i&&a>t.J.byteLength&&(a=t.J.byteLength),t=0<(a-=t.ca())?t.Za(a):new Uint8Array(0),s({parser:this,partialOkay:i||!1,version:o,flags:l,reader:t=new Fn(new DataView(t.buffer,t.byteOffset,t.byteLength),0),size:r,start:n+e})}else t.M(Math.min(n+r-t.ca(),t.J.byteLength-t.ca()))},Gn.children=Vn,Gn.sampleDescription=Kn,Gn.allData=Wn,Gn.typeToString=zn,(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");var Xn,$n={dc:function(e,t){var i=$n.O(e,t);return 1!=i.length?null:i[0]},Kc:function(e,t,i){return 1!=(e=$n.Dd(e,t,i)).length?null:e[0]},O:function(e,t){return Array.prototype.filter.call(e.childNodes,function(e){return e instanceof Element&&e.tagName==t})},Dd:function(e,t,i){return Array.prototype.filter.call(e.childNodes,function(e){return e instanceof Element&&e.localName==i&&e.namespaceURI==t})},getAttributeNS:function(e,t,i){return e.hasAttributeNS(t,i)?e.getAttributeNS(t,i):null},fc:function(e){return Array.prototype.every.call(e.childNodes,function(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE})?e.textContent.trim():null},I:function(e,t,i,n){n=void 0===n?null:n;var r=null;return null!=(e=e.getAttribute(t))&&(r=i(e)),null==r?n:r},zf:function(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:Math.floor(e/1e3)):null},Ea:function(e){return(e=e&&/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(e))?(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null):null},qc:function(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null},parseInt:function(e){return 0==(e=Number(e))%1?e:null},pc:function(e){return 0==(e=Number(e))%1&&0<e?e:null},xb:function(e){return 0==(e=Number(e))%1&&0<=e?e:null},parseFloat:function(e){return e=Number(e),isNaN(e)?null:e},Ce:function(e){var t;return e=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e),isNaN(e)?null:e},Wd:function(e,t){var i=new DOMParser;try{var n=i.parseFromString(e,"text/xml")}catch(e){}if(n&&n.documentElement.tagName==t)var r=n.documentElement;return r&&0<r.getElementsByTagName("parsererror").length?null:r},Vd:function(e,t){try{var i=ot(e);return $n.Wd(i,t)}catch(e){}}},Jn=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");function Qn(e,t,i){var n=function(e){for(var t=[],i=(e=q(e)).next();!i.done;i=e.next())(i=Zn(i.value))&&t.push(i);return t}(e),r=null;e=[];var a=[],s=new Set(n.map(function(e){return e.keyId}));if(s.delete(null),1<s.size)throw new ge(2,4,4010);if(i||(a=n.filter(function(e){return"urn:mpeg:dash:mp4protection:2011"!=e.ce||(r=e.init||r,!1)})).length&&(0==(e=function(e,t,i){for(var n=[],r=(i=q(i)).next();!r.done;r=i.next()){r=r.value;var a=Jn.get(r.ce);if(a){var s;if(s=$n.Kc(r.node,"urn:microsoft:playready","pro")){s=pt.Ba(s.textContent);var o=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),l=s.length,u=o.length+16+l,c=new ArrayBuffer(u),h=new Uint8Array(c);c=new DataView(c);var d=0;c.setUint32(d,u),d+=4,c.setUint32(d,1886614376),d+=4,c.setUint32(d,0),d+=4,h.set(o,d),d+=o.length,c.setUint32(d,l),d+=4,h.set(s,d),s=[{initData:h,initDataType:"cenc",keyId:r.keyId}]}else s=null;n.push(Wt(a,r.init||e||s))}else for(r=q(r=t(r.node)||[]),a=r.next();!a.done;a=r.next())n.push(a.value)}return n}(r,t,a)).length&&(e=[Wt("",r)])),n.length&&(i||!a.length))for(e=[],i=(t=q(Jn.values())).next();!i.done;i=t.next())"org.w3.clearkey"!=(i=i.value)&&e.push(Wt(i,r));if(s=Array.from(s)[0]||null)for(i=(t=q(e)).next();!i.done;i=t.next())for(n=(i=q(i.value.initData)).next();!n.done;n=i.next())n.value.keyId=s;return{Bd:s,ug:r,drmInfos:e,Ed:!0}}function Zn(e){var t=e.getAttribute("schemeIdUri"),i=$n.getAttributeNS(e,"urn:mpeg:cenc:2013","default_KID"),n=$n.Dd(e,"urn:mpeg:cenc:2013","pssh").map($n.fc);if(!t)return null;if(t=t.toLowerCase(),i&&(i=i.replace(/-/g,"").toLowerCase()).includes(" "))throw new ge(2,4,4009);var r=[];try{r=n.map(function(e){return{initDataType:"cenc",initData:pt.Ba(e),keyId:null}})}catch(e){throw new ge(2,4,4007)}return{node:e,ce:t,keyId:i,init:0<r.length?r:null}}function er(e,t,i,n,r){var a={RepresentationID:t,Number:i,Bandwidth:n,Time:r};return e.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(e,t,i,n){if("$$"==e)return"$";var r=a[t];if(null==r)return e;switch("RepresentationID"==t&&i&&(i=void 0),"Time"==t&&(r=Math.round(r)),n){case void 0:case"d":case"i":case"u":e=r.toString();break;case"o":e=r.toString(8);break;case"x":e=r.toString(16);break;case"X":e=r.toString(16).toUpperCase();break;default:e=r.toString()}return i=d.parseInt(i,10)||1,Array(Math.max(0,i-e.length)+1).join("0")+e})}function tr(e,t){var i=ir(e,t,"timescale"),n=1;i&&(n=$n.pc(i)||1),i=ir(e,t,"duration"),(i=$n.pc(i||""))&&(i/=n);var r=ir(e,t,"startNumber"),a=Number(ir(e,t,"presentationTimeOffset"))||0,s=$n.xb(r||"");null!=r&&null!=s||(s=1);var o=nr(e,t,"SegmentTimeline");if(r=null,o){r=n;var l=e.T.duration||1/0;o=$n.O(o,"S");for(var u=[],c=0,h=0;h<o.length;++h){var d=o[h],f=$n.I(d,"t",$n.xb),p=$n.I(d,"d",$n.xb);if(d=$n.I(d,"r",$n.parseInt),null!=f&&(f-=a),!p)break;if(f=null!=f?f:c,(d=d||0)<0)if(h+1<o.length){if(null==(d=$n.I(o[h+1],"t",$n.xb)))break;if(d<=f)break;d=Math.ceil((d-f)/p)-1}else{if(1/0==l)break;if(l<=f/r)break;d=Math.ceil((l*r-f)/p)-1}0<u.length&&f!=c&&(u[u.length-1].end=f/r);for(var m=0;m<=d;++m)c=f+p,u.push({start:f/r,end:c/r,jg:f}),f=c}r=u}return{timescale:n,Z:i,ab:s,ma:a/n||0,yd:a,N:r}}function ir(e,t,i){return[t(e.B),t(e.aa),t(e.ka)].filter(Vt.Ia).map(function(e){return e.getAttribute(i)}).reduce(function(e,t){return e||t})}function nr(e,t,i){return[t(e.B),t(e.aa),t(e.ka)].filter(Vt.Ia).map(function(e){return $n.dc(e,i)}).reduce(function(e,t){return e||t})}function rr(e,t,i,n,r,a){if(a=void 0===a?0:a,$n.getAttributeNS(e,"http://www.w3.org/1999/xlink","href")){var s=function(r,a,s,e,o,l){for(var u=$n.getAttributeNS(r,"http://www.w3.org/1999/xlink","href"),t=$n.getAttributeNS(r,"http://www.w3.org/1999/xlink","actuate")||"onRequest",i=0;i<r.attributes.length;i++){var n=r.attributes[i];"http://www.w3.org/1999/xlink"==n.namespaceURI&&(r.removeAttributeNS(n.namespaceURI,n.localName),--i)}if(5<=l)return be(new ge(2,4,4028));if("onLoad"!=t)return be(new ge(2,4,4027));var c=Kt([e],[u]);return o.request(0,Be(c,a)).U(function(e){if(!(e=$n.Vd(e.data,r.tagName)))return be(new ge(2,4,4001,u));for(;r.childNodes.length;)r.removeChild(r.childNodes[0]);for(;e.childNodes.length;){var t=e.childNodes[0];e.removeChild(t),r.appendChild(t)}for(t=0;t<e.attributes.length;t++){var i=e.attributes[t].nodeName,n=e.getAttribute(i);r.setAttribute(i,n)}return rr(r,a,s,c[0],o,l+1)})}(e,t,i,n,r,a);return i&&(s=s.U(void 0,function(){return rr(e,t,i,n,r,a)})),s}s=[];for(var o=0;o<e.childNodes.length;o++){var l=e.childNodes[o];l instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==$n.getAttributeNS(l,"http://www.w3.org/1999/xlink","href")?(e.removeChild(l),--o):"SegmentTimeline"!=l.tagName&&s.push(rr(l,t,i,n,r,a)))}return Ee(s).U(function(){return e})}function ar(e,t,i){this.c=e,this.b=t,this.a=i}function sr(e,t,i,n,r,a){this.position=e,this.startTime=t,this.endTime=i,this.c=n,this.b=r,this.a=a}function or(e,t,i,n){var r,a=(new Gn).fa("sidx",function(e){r=function(e,t,i,n){var r=[];n.reader.M(4);var a=n.reader.G();if(0==a)throw new ge(2,3,3005);if(0==n.version)var s=n.reader.G(),o=n.reader.G();else s=n.reader.Ab(),o=n.reader.Ab();n.reader.M(2);var l=n.reader.Rb();for(e=e+n.size+o,o=0;o<l;o++){var u=n.reader.G(),c=(2147483648&u)>>>31;u&=2147483647;var h=n.reader.G();if(n.reader.M(4),1==c)throw new ge(2,3,3006);r.push(new sr(r.length,s/a-t,(s+h)/a-t,function(){return i},e,e+u-1)),s+=h,e+=u}return n.parser.stop(),r}(t,n,i,e)});if(e&&a.parse(e),r)return r;throw new ge(2,3,3004)}function lr(e){this.a=e}function ur(e,t){for(;e.a.length&&e.a[e.a.length-1].startTime>=t;)e.a.pop();for(;e.a.length&&e.a[0].endTime<=0;)e.a.shift();if(0!=e.a.length){var i=e.a[e.a.length-1];e.a[e.a.length-1]=new sr(i.position,i.startTime,t,i.c,i.b,i.a)}}function cr(e){this.b=e,this.a=new Fn(e,0),Xn=Xn||[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])]}function hr(e){var t=dr(e);if(7<t.length)throw new ge(2,3,3002);for(var i=0,n=0;n<t.length;n++)i=256*i+t[n];t=i,i=dr(e);e:{n=pt.za;for(var r=0;r<Xn.length;r++)if(n(i,Xn[r])){n=!0;break e}n=!1}if(n)i=e.b.byteLength-e.a.ca();else{if(8==i.length&&224&i[1])throw new ge(2,3,3001);for(n=i[0]&(1<<8-i.length)-1,r=1;r<i.length;r++)n=256*n+i[r];i=n}return i=e.a.ca()+i<=e.b.byteLength?i:e.b.byteLength-e.a.ca(),n=new DataView(e.b.buffer,e.b.byteOffset+e.a.ca(),i),e.a.M(i),new fr(t,n)}function dr(e){var t,i=e.a.la();for(t=1;t<=8&&!(i&1<<8-t);t++);if(8<t)throw new ge(2,3,3002);var n=new Uint8Array(t);for(n[0]=i,i=1;i<t;i++)n[i]=e.a.la();return n}function fr(e,t){this.id=e,this.a=t}function pr(e){if(8<e.a.byteLength)throw new ge(2,3,3002);if(8==e.a.byteLength&&224&e.a.getUint8(0))throw new ge(2,3,3001);for(var t=0,i=0;i<e.a.byteLength;i++){t=256*t+e.a.getUint8(i)}return t}function mr(){}function gr(e){var t=new cr(e.a);if(179!=(e=hr(t)).id)throw new ge(2,3,3013);if(e=pr(e),183!=(t=hr(t)).id)throw new ge(2,3,3012);t=new cr(t.a);for(var i=0;t.ua();){var n=hr(t);if(241==n.id){i=pr(n);break}}return{kg:e,Hf:i}}function vr(e,t){var i=nr(e,t,"Initialization");if(!i)return null;var n=e.B.qa,r=i.getAttribute("sourceURL");r&&(n=Kt(e.B.qa,[r])),r=0;var a=null;return(i=$n.I(i,"range",$n.qc))&&(r=i.start,a=i.end),new ar(function(){return n},r,a)}function yr(e,t,i,n,r,a,s,o){var l=e.presentationTimeline,u=!e.mb||!e.T.Vc,c=e.T.start,h=e.T.duration,d=t,f=null;return{createSegmentIndex:function(){var e=[d(n,r,a),"webm"==s?d(i.c(),i.b,i.a):null];return d=null,Promise.all(e).then(function(e){var t=e[0];e=e[1]||null,t="mp4"==s?or(t,r,n,o):(new mr).parse(t,e,n,o),l.ub(t,c),f=new lr(t),u&&ur(f,h)})},findSegmentPosition:function(e){return f.find(e)},getSegmentReference:function(e){return f.get(e)}}}function br(e){return e.Sb}function _r(e,t){var i,n=vr(e,Tr),r=[(i=e).B.La,i.aa.La,i.ka.La].filter(Vt.Ia).map(function(e){return $n.O(e,"SegmentURL")}).reduce(function(e,t){return 0<e.length?e:t}).map(function(e){return e.getAttribute("indexRange")&&!i.Id&&(i.Id=!0),{gf:e.getAttribute("media"),start:(e=$n.I(e,"mediaRange",$n.qc,{start:0,end:null})).start,end:e.end}}),a=tr(e,Tr),s=a.ab;0==s&&(s=1);var o=0;if(a.Z?o=a.Z*(s-1):a.N&&0<a.N.length&&(o=a.N[0].start),!(r={Z:a.Z,startTime:o,ab:s,ma:a.ma,N:a.N,sb:r}).Z&&!r.N&&1<r.sb.length)throw new ge(2,4,4002);if(!r.Z&&!e.T.duration&&!r.N&&1==r.sb.length)throw new ge(2,4,4002);if(r.N&&0==r.N.length)throw new ge(2,4,4002);return s=a=null,e.ka.id&&e.B.id&&(a=t[s=e.ka.id+","+e.B.id]),o=function(e,t,i,n){var r=n.sb.length;n.N&&n.N.length!=n.sb.length&&(r=Math.min(n.N.length,n.sb.length));for(var a=[],s=n.startTime,o=0;o<r;o++){var l,u=n.sb[o],c=Kt(i,[u.gf]);l=null!=n.Z?s+n.Z:n.N?n.N[o].end:s+e,a.push(new sr(o+t,s,l,function(e){return e}.bind(null,c),u.start,u.end)),s=l}return a}(e.T.duration,r.ab,e.B.qa,r),a?(a.Yc(o),s=e.presentationTimeline.Mb(),a.Hc(s-e.T.start)):(e.presentationTimeline.ub(o,e.T.start),a=new lr(o),s&&e.mb&&(t[s]=a)),e.mb&&e.T.Vc||ur(a,e.T.duration),{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:a.find.bind(a),getSegmentReference:a.get.bind(a),initSegmentReference:n,ma:r.ma}}function Tr(e){return e.La}function Sr(e,t,i,n){var r,a,s,o,l,u,c,h,d,f,p=function(e){var t=ir(e,Er,"initialization");if(!t)return null;var i=e.B.id,n=e.bandwidth||null,r=e.B.qa;return new ar(function(){var e=er(t,i,null,n,null);return Kt(r,[e])},0,null)}(e),m=tr(e,Er),g=ir(e,Er,"media"),v=ir(e,Er,"index");if(g=(m={Z:m.Z,timescale:m.timescale,ab:m.ab,ma:m.ma,yd:m.yd,N:m.N,Xc:g,Ob:v}).Ob?1:0,g+=m.N?1:0,0==(g+=m.Z?1:0))throw new ge(2,4,4002);if(1!=g&&(m.Ob&&(m.N=null),m.Z=null),!m.Ob&&!m.Xc)throw new ge(2,4,4002);if(m.Ob){if("mp4"!=(i=e.B.mimeType.split("/")[1])&&"webm"!=i)throw new ge(2,4,4006);if("webm"==i&&!p)throw new ge(2,4,4005);n=er(m.Ob,e.B.id,null,e.bandwidth||null,null),e=yr(e,t,p,n=Kt(e.B.qa,[n]),0,null,i,m.ma)}else e=m.Z?(n||(e.presentationTimeline.$c(m.Z),e.presentationTimeline.ad(e.T.start)),a=m,s=(r=e).T.duration,o=a.Z,l=a.ab,u=a.timescale,c=a.Xc,h=r.bandwidth||null,d=r.B.id,f=r.B.qa,{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return e<0||s&&s<=e?null:Math.floor(e/o)},getSegmentReference:function(t){var i=t*o,e=i+o;return s&&(e=Math.min(e,s)),e<0||s&&s<=i?null:new sr(t,i,e,function(){var e=er(c,d,t+l,h,i*u);return Kt(f,[e])},0,null)}}):(g=t=null,e.ka.id&&e.B.id&&(t=i[g=e.ka.id+","+e.B.id]),v=function(e,t){for(var i=[],n=0;n<t.N.length;n++){var r=n+t.ab;i.push(new sr(r,t.N[n].start,t.N[n].end,function(e,t,i,n,r,a){return Kt(n,[e=er(e,t,r,i,a)]).map(function(e){return e.toString()})}.bind(null,t.Xc,e.B.id,e.bandwidth||null,e.B.qa,r,t.N[n].jg+t.yd),0,null))}return i}(e,m),n=!e.mb||!e.T.Vc,t?(n&&ur(new lr(v),e.T.duration),t.Yc(v),i=e.presentationTimeline.Mb(),t.Hc(i-e.T.start)):(e.presentationTimeline.ub(v,e.T.start),t=new lr(v),g&&e.mb&&(i[g]=t)),n&&ur(t,e.T.duration),{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:t.find.bind(t),getSegmentReference:t.get.bind(t)});return{createSegmentIndex:e.createSegmentIndex,findSegmentPosition:e.findSegmentPosition,getSegmentReference:e.getSegmentReference,initSegmentReference:p,ma:m.ma}}function Er(e){return e.Ub}(new Map).set("com.widevine.alpha",function(e){return(e=$n.Kc(e.node,"urn:microsoft","laurl"))&&e.getAttribute("licenseUrl")||""}).set("com.microsoft.playready",function(e){return(e=$n.Kc(e.node,"urn:microsoft:playready","pro"))&&(e=function(e){var t=0,i=new DataView(e).getUint32(t,!0);if(i!==e.byteLength)return[];t+=6,i=[];for(var n=new DataView(e);t<e.byteLength-1;){var r=n.getUint16(t,!0);t+=2;var a=n.getUint16(t,!0);t+=2;var s=new Uint8Array(e,t,a);i.push({type:r,value:s}),t+=a}return i}((e=pt.Ba(e.textContent)).buffer).filter(function(e){return 1===e.type})[0])?(e=lt(e.value,!0),(e=$n.Wd(e,"WRMHEADER"))?(t=(t=e).querySelector("DATA > LA_URL"))?t.textContent:"":""):"";var t}),B("shaka.media.InitSegmentReference",ar),ar.prototype.createUris=ar.prototype.Ec=function(){return this.c()},ar.prototype.getStartByte=ar.prototype.Qc=function(){return this.b},ar.prototype.getEndByte=ar.prototype.Pc=function(){return this.a},B("shaka.media.SegmentReference",sr),sr.prototype.getPosition=sr.prototype.ca=function(){return this.position},sr.prototype.getStartTime=sr.prototype.Rc=function(){return this.startTime},sr.prototype.getEndTime=sr.prototype.Je=function(){return this.endTime},sr.prototype.createUris=sr.prototype.Ec=function(){return this.c()},sr.prototype.getStartByte=sr.prototype.Qc=function(){return this.b},sr.prototype.getEndByte=sr.prototype.Pc=function(){return this.a},B("shaka.media.SegmentIndex",lr),lr.prototype.destroy=lr.prototype.destroy=function(){return this.a=null,Promise.resolve()},lr.prototype.find=lr.prototype.find=function(e){for(var t=this.a.length-1;0<=t;--t){var i=this.a[t];if(e>=i.startTime&&e<i.endTime)return i.position}return this.a.length&&e<this.a[0].startTime?this.a[0].position:null},lr.prototype.get=lr.prototype.get=function(e){return 0==this.a.length||(e-=this.a[0].position)<0||e>=this.a.length?null:this.a[e]},lr.prototype.offset=lr.prototype.offset=function(e){for(var t=0;t<this.a.length;++t)this.a[t].startTime+=e,this.a[t].endTime+=e},lr.prototype.merge=lr.prototype.Yc=function(e){for(var t=[],i=0,n=0;i<this.a.length&&n<e.length;){var r=this.a[i],a=e[n];r.startTime<a.startTime?(t.push(r),i++):(r.startTime>a.startTime?0==i&&t.push(a):(.1<Math.abs(r.endTime-a.endTime)?t.push(new sr(r.position,a.startTime,a.endTime,a.c,a.b,a.a)):t.push(r),i++),n++)}for(;i<this.a.length;)t.push(this.a[i++]);if(t.length)for(i=t[t.length-1].position+1;n<e.length;)r=new sr(i++,(r=e[n++]).startTime,r.endTime,r.c,r.b,r.a),t.push(r);else t=e;this.a=t},lr.prototype.evict=lr.prototype.Hc=function(e){for(var t=0;t<this.a.length;++t)if(this.a[t].endTime>e)return void this.a.splice(0,t);this.a=[]},cr.prototype.ua=function(){return this.a.ua()},mr.prototype.parse=function(e,t,i,n){var r;if(440786851!=hr(t=new cr(new DataView(t))).id)throw new ge(2,3,3008);var a=hr(t);if(408125543!=a.id)throw new ge(2,3,3009);for(t=a.a.byteOffset,a=new cr(a.a),r=null;a.ua();){var s=hr(a);if(357149030==s.id){r=s;break}}if(!r)throw new ge(2,3,3010);for(a=new cr(r.a),r=1e6,s=null;a.ua();){var o=hr(a);if(2807729==o.id)r=pr(o);else if(17545==o.id)if(4==(s=o).a.byteLength)s=s.a.getFloat32(0);else{if(8!=s.a.byteLength)throw new ge(2,3,3003);s=s.a.getFloat64(0)}}if(null==s)throw new ge(2,3,3011);if(r=s*(a=r/1e9),475249515!=(e=hr(new cr(new DataView(e)))).id)throw new ge(2,3,3007);return function(e,t,i,n,r,a){function s(){return r}var o=[];e=new cr(e.a);for(var l=null,u=null;e.ua();){var c=hr(e);if(187==c.id){var h=gr(c);h&&(c=i*h.kg,h=t+h.Hf,null!=l&&o.push(new sr(o.length,l-a,c-a,s,u,h-1)),l=c,u=h)}}return null!=l&&o.push(new sr(o.length,l-a,n-a,s,u,null)),o}(e,t,a,r,i,n)};var wr={yb:{},Qb:{},kd:function(e,t){wr.Qb[e]=t}};function Cr(e,t,i){this.f=e,this.rc=t,this.h=this.g=1/0,this.b=1,this.c=this.a=null,this.l=0,this.m=!0,this.i=0,this.s=void 0===i||i}function kr(e,t,i,n){return e=Be(e,n),0==t&&null==i||(e.headers.Range=i?"bytes="+t+"-"+i:"bytes="+t+"-"),e}function Ar(){var e=this;this.b=this.a=null,this.f=[],this.c=null,this.l=[],this.h=1,this.m={},this.s=0,this.u=new j(5),this.i=new de(function(){var n;n=e,z(function e(){var t,i;return X(e,function(e){switch(e.j){case 1:return t=0,E(e,2),Y(e,Ir(n),4);case 4:t=e.o,S(e,3);break;case 2:i=w(e),n.b&&(i.severity=1,n.b.onError(i));case 3:if(!n.b)return e.return();Rr(n,t),F(e)}})})}),this.g=new Re}function Ir(t){var i=Date.now(),e=t.b.networkingEngine.request(0,Be(t.f,t.a.retryParameters));return Oe(t.g,e),e.promise.then(function(e){if(t.b)return e.uri&&!t.f.includes(e.uri)&&t.f.unshift(e.uri),function(t,e,i){if(!(e=$n.Vd(e,"MPD")))throw new ge(2,4,4001,i);return e=rr(e,t.a.retryParameters,t.a.dash.xlinkFailGracefully,i,t.b.networkingEngine),Oe(t.g,e),e.promise.then(function(e){return M=t,B=e,U=i,z(function e(){var d,f,p,m,g,v,y,b,_,T,S,E,w,C,k,A,I,x,P,L,R,O,D,N;return X(e,function(e){switch(e.j){case 1:m=Vt,v=[U],0<(y=(g=$n).O(B,"Location").map(g.fc).filter(m.Ia)).length&&(b=Kt(v,y),v=M.f=b),_=g.O(B,"BaseURL").map(g.fc),T=Kt(v,_),S=M.a.dash.ignoreMinBufferTime,E=0,S||(E=g.I(B,"minBufferTime",g.Ea)),M.s=g.I(B,"minimumUpdatePeriod",g.Ea,-1),w=g.I(B,"availabilityStartTime",g.zf),C=g.I(B,"timeShiftBufferDepth",g.Ea),k=g.I(B,"maxSegmentDuration",g.Ea),A=B.getAttribute("type")||"static",I=M.a.dash.ignoreSuggestedPresentationDelay,x=null,I||(x=g.I(B,"suggestedPresentationDelay",g.Ea)),P=M.c?M.c.presentationTimeline:(L=Math.max(M.a.dash.defaultPresentationDelay,1.5*E),new Cr(w,null!=x?x:L,M.a.dash.autoCorrectDrift));for(var t={mb:"static"!=A,presentationTimeline:P,ka:null,T:null,aa:null,B:null,bandwidth:0,Id:!1},i=T,n=$n.I(B,"mediaPresentationDuration",$n.Ea),r=[],a=0,s=$n.O(B,"Period"),o=0;o<s.length;o++){var l=s[o];a=$n.I(l,"start",$n.Ea,a);var u=$n.I(l,"duration",$n.Ea),c=null;if(o!=s.length-1){var h=$n.I(s[o+1],"start",$n.Ea);null!=h&&(c=h-a)}else null!=n&&(c=n-a);if(null==c&&(c=u),l=xr(M,t,i,{start:a,duration:c,node:l,Vc:null==c||o==s.length-1}),r.push(l),u=t.ka.id,M.l.includes(u)||(M.l.push(u),M.c&&(M.b.filterNewPeriod(l),M.c.periods.push(l))),null==c){a=null;break}a+=c}if(null==M.c&&M.b.filterAllPeriods(r),p=null!=n?(d=r,f=n,!1):(d=r,f=a,!0),R=f,O=d,P.Vb("static"==A),"static"!=A&&p||P.xa(R||1/0),P.V()&&!isNaN(M.a.availabilityWindowOverride)&&(C=M.a.availabilityWindowOverride),null==C&&(C=1/0),P.sd(C),P.$c(k||1),M.c){e.A(0);break}if(M.c={presentationTimeline:P,periods:O,offlineSessionIds:[],minBufferTime:E||0},P.je())return D=g.O(B,"UTCTiming"),Y(e,function(e,i,t){t=t.map(function(e){return{scheme:e.getAttribute("schemeIdUri"),value:e.getAttribute("value")}});var n=e.a.dash.clockSyncUri;return!t.length&&n&&t.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:n}),Vt.Ae(t,function(e){var t=e.scheme;switch(e=e.value,t){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return Dr(this,i,e,"HEAD");case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return Dr(this,i,e,"GET");case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return t=Date.parse(e),isNaN(t)?0:t-Date.now();case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":return W("NTP UTCTiming scheme is not supported"),Promise.reject();default:return W("Unrecognized scheme in UTCTiming element",t),Promise.reject()}}.bind(e)).catch(function(){return W("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),0})}(M,T,D),4);e.A(0);break;case 4:if(N=e.o,!M.b)return e.return();P.ee(N),F(e)}})});var M,B,U})}(t,e.data,e.uri)}).then(function(){var e=(Date.now()-i)/1e3;return H(t.u,1,e),e})}function xr(e,t,i,n){if(t.ka=Or(n.node,null,i),t.T=n,t.ka.id||(t.ka.id="__shaka_period_"+n.start),$n.O(n.node,"EventStream").forEach(e.Af.bind(e,n.start,n.duration)),i=$n.O(n.node,"AdaptationSet").map(e.yf.bind(e,t)).filter(Vt.Ia),t.mb){t=[];for(var r=q(i),a=r.next();!a.done;a=r.next())for(var s=(a=q(a.value.Kf)).next();!s.done;s=a.next())t.push(s.value);if(t.length!=new Set(t).size)throw new ge(2,4,4018)}var o=i.filter(function(e){return!e.wd});if(i.filter(function(e){return e.wd}).forEach(function(e){var t=e.streams[0],i=e.wd;o.forEach(function(e){e.id==i&&e.streams.forEach(function(e){e.trickModeVideo=t})})}),t=Pr(o,"video"),r=Pr(o,"audio"),!t.length&&!r.length)throw new ge(2,4,4004);for(i=e.a.disableAudio,r.length&&!i||(r=[null]),i=e.a.disableVideo,t.length&&!i||(t=[null]),i=[],a=0;a<r.length;a++)for(s=0;s<t.length;s++)Lr(e,r[a],t[s],i);if(t=[],!e.a.disableText)for(e=Pr(o,"text"),r=0;r<e.length;r++)t.push.apply(t,e[r].streams);return{startTime:n.start,textStreams:t,variants:i}}function Pr(e,t){return e.filter(function(e){return e.contentType==t})}function Lr(e,t,i,n){if(t||i)if(t&&i){var r=t.drmInfos,a=i.drmInfos;if(!r.length||!a.length||0<Lt(r,a).length){a=Lt(t.drmInfos,i.drmInfos);for(var s=0;s<t.streams.length;s++)for(var o=0;o<i.streams.length;o++)r=(i.streams[o].bandwidth||0)+(t.streams[s].bandwidth||0),r={id:e.h++,language:t.language,primary:t.Wc||i.Wc,audio:t.streams[s],video:i.streams[o],bandwidth:r,drmInfos:a,allowedByApplication:!0,allowedByKeySystem:!0},n.push(r)}}else for(a=t||i,s=0;s<a.streams.length;s++)r=a.streams[s].bandwidth||0,r={id:e.h++,language:a.language||"und",primary:a.Wc,audio:t?a.streams[s]:null,video:i?a.streams[s]:null,bandwidth:r,drmInfos:a.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},n.push(r)}function Rr(e,t){e.s<0||e.i.P(Math.max(3,e.s-t,G(e.u)))}function Or(e,t,i){t=t||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,bd:null,audioSamplingRate:null},i=i||t.qa;var n=$n.xb,r=$n.Ce,a=$n.O(e,"BaseURL").map($n.fc),s=e.getAttribute("contentType")||t.contentType,o=e.getAttribute("mimeType")||t.mimeType,l=e.getAttribute("codecs")||t.codecs;r=$n.I(e,"frameRate",r)||t.frameRate;for(var u=e.getAttribute("par")||t.pixelAspectRatio,c=$n.O(e,"InbandEventStream"),h=t.emsgSchemeIdUris.slice(),d=(c=q(c)).next();!d.done;d=c.next())d=d.value.getAttribute("schemeIdUri"),h.includes(d)||h.push(d);return c=function(e){for(var t=0;t<e.length;++t){var i=e[t],n=i.getAttribute("schemeIdUri");if(n&&(i=i.getAttribute("value")))switch(n){case"urn:mpeg:dash:outputChannelPositionList:2012":return i.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(!(n=parseInt(i,10)))continue;return n;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(n=parseInt(i,16)){for(e=0;n;)1&n&&++e,n>>=1;return e}}}return null}(c=$n.O(e,"AudioChannelConfiguration"))||t.bd,d=$n.I(e,"audioSamplingRate",n)||t.audioSamplingRate,s=s||Nr(o,l),{qa:Kt(i,a),Sb:$n.dc(e,"SegmentBase")||t.Sb,La:$n.dc(e,"SegmentList")||t.La,Ub:$n.dc(e,"SegmentTemplate")||t.Ub,width:$n.I(e,"width",n)||t.width,height:$n.I(e,"height",n)||t.height,contentType:s,mimeType:o,codecs:l,frameRate:r,pixelAspectRatio:u,emsgSchemeIdUris:h,id:e.getAttribute("id"),bd:c,audioSamplingRate:d}}function Dr(e,t,i,n){return(t=Be(t=Kt(t,[i]),e.a.retryParameters)).method=n,t=e.b.networkingEngine.request(4,t),Oe(e.g,t),t.promise.then(function(e){if("HEAD"==n){if(!e.headers||!e.headers.date)return 0;e=e.headers.date}else e=ot(e.data);return e=Date.parse(e),isNaN(e)?0:e-Date.now()})}function Nr(e,t){return gi(Qe(e,t))?"text":e.split("/")[0]}function Mr(e,t,i,n){this.b=e,this.type=t,this.a=i,this.segments=n||null}function Br(e,t,i,n){this.id=e,this.name=t,this.a=i,this.value=void 0===n?null:n}function Ur(e,t){this.name=e,this.value=t}function Fr(e,t,i){return(e=e.getAttribute(t))?e.value:i||null}function jr(e,t){this.b=t,this.a=e}B("shaka.media.ManifestParser.registerParserByExtension",wr.kd),wr.Bb=function(e,t){wr.yb[e]=t},B("shaka.media.ManifestParser.registerParserByMime",wr.Bb),wr.Ef=function(){var e={};if(tt()){for(var t in wr.yb)e[t]=!0;for(var i in wr.Qb)e[i]=!0}t={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};for(var n=(i=q(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!n.done;n=i.next())e[n=n.value]=tt()?!!wr.yb[n]:it(n);for(var r in t)e[r]=tt()?!!wr.Qb[r]:it(t[r]);return e},wr.create=function(n,r,a,s){return z(function e(){var t,i;return X(e,function(e){switch(e.j){case 1:return E(e,2),Y(e,wr.Ke(n,r,a,s),4);case 4:return t=e.o,e.return(new t);case 2:throw(i=w(e)).severity=2,i}})})},wr.Ke=function(s,o,l,u){return z(function e(){var t,i,n,r,a;return X(e,function(e){switch(e.j){case 1:if(t=wr,u&&(i=t.yb[u.toLowerCase()]))return e.return(i);if((n=t.getExtension(s))&&(r=t.Qb[n]))return e.return(r);if(u){e.A(2);break}return Y(e,t.Se(s,o,l),3);case 3:if((u=e.o)&&(a=wr.yb[u]))return e.return(a);case 2:throw new ge(2,4,4e3,s)}})})},wr.Se=function(r,a,s){return z(function e(){var t,i,n;return X(e,function(e){switch(e.j){case 1:return(t=Be([r],s)).method="HEAD",Y(e,a.request(0,t).promise,2);case 2:return i=e.o,n=i.headers["content-type"],e.return(n?n.toLowerCase().split(";").shift():"")}})})},wr.getExtension=function(e){return 1==(e=new Q(e).ja.split("/").pop().split(".")).length?"":e.pop().toLowerCase()},wr.isSupported=function(e,t){return!!tt()&&(t in wr.yb||wr.getExtension(e)in wr.Qb)},B("shaka.media.PresentationTimeline",Cr),Cr.prototype.getDuration=Cr.prototype.Y=function(){return this.g},Cr.prototype.getMaxSegmentDuration=Cr.prototype.Qe=function(){return this.b},Cr.prototype.setDuration=Cr.prototype.xa=function(e){this.g=e},Cr.prototype.getPresentationStartTime=Cr.prototype.Xe=function(){return this.f},Cr.prototype.setClockOffset=Cr.prototype.ee=function(e){this.l=e},Cr.prototype.setStatic=Cr.prototype.Vb=function(e){this.m=e},Cr.prototype.setSegmentAvailabilityDuration=Cr.prototype.sd=function(e){this.h=e},Cr.prototype.setDelay=Cr.prototype.Vf=function(e){this.rc=e},Cr.prototype.getDelay=Cr.prototype.Ie=function(){return this.rc},Cr.prototype.notifySegments=Cr.prototype.ub=function(e,t){if(0!=e.length){var i=e[e.length-1].endTime+t;this.ad(e[0].startTime+t),this.b=e.reduce(function(e,t){return Math.max(e,t.endTime-t.startTime)},this.b),this.c=Math.max(this.c,i),null!=this.f&&this.s&&(this.f=(Date.now()+this.l)/1e3-this.c-this.b)}},Cr.prototype.notifyMinSegmentStartTime=Cr.prototype.ad=function(e){this.a=null==this.a?e:2.1<e-this.a?Math.min(this.a,e):Math.max(this.a,e),this.a=Math.ceil(this.a*Math.pow(10,4))/Math.pow(10,4)},Cr.prototype.notifyMaxSegmentDuration=Cr.prototype.$c=function(e){this.b=Math.max(this.b,e)},Cr.prototype.offset=Cr.prototype.offset=function(e){null!=this.a&&(this.a+=e),null!=this.c&&(this.c+=e)},Cr.prototype.isLive=Cr.prototype.V=function(){return 1/0==this.g&&!this.m},Cr.prototype.isInProgress=Cr.prototype.Xa=function(){return 1/0!=this.g&&!this.m},Cr.prototype.getSegmentAvailabilityStart=Cr.prototype.Mb=function(){if(1/0==this.h)return this.i;var e=this.pb()-this.h;return Math.max(this.i,e)},Cr.prototype.setUserSeekStart=Cr.prototype.fe=function(e){this.i=e},Cr.prototype.getSegmentAvailabilityEnd=Cr.prototype.pb=function(){return this.V()||this.Xa()?Math.min(Math.max(0,(Date.now()+this.l)/1e3-this.b-this.f),this.g):this.g},Cr.prototype.getSafeSeekRangeStart=Cr.prototype.Lb=function(e){var t=Math.max(this.a,this.i);if(1/0==this.h)return t;var i=this.pb()-this.h;return e=Math.min(i+e,this.Ca()),Math.max(t,e)},Cr.prototype.getSeekRangeStart=Cr.prototype.ob=function(){return this.Lb(0)},Cr.prototype.getSeekRangeEnd=Cr.prototype.Ca=function(){var e=this.V()||this.Xa()?this.rc:0;return Math.max(0,this.pb()-e)},Cr.prototype.usingPresentationStartTime=Cr.prototype.je=function(){return null!=this.f&&null==this.c},B("shaka.dash.DashParser",Ar),(t=Ar.prototype).configure=function(e){this.a=e},t.start=function(i,n){var r=this;return z(function e(){var t;return X(e,function(e){switch(e.j){case 1:return r.f=[i],r.b=n,Y(e,Ir(r),2);case 2:if(t=e.o,r.b&&Rr(r,t),!r.b)throw new ge(2,7,7001);return e.return(r.c)}})})},t.stop=function(){return this.a=this.b=null,this.f=[],this.c=null,this.l=[],this.m={},null!=this.i&&(this.i.stop(),this.i=null),this.g.destroy()},t.update=function(){Ir(this).catch(function(e){this.b&&this.b.onError(e)}.bind(this))},t.onExpirationUpdated=function(){},t.yf=function(t,e){if(t.aa=Or(e,t.ka,null),"image"==t.aa.contentType)return null;var i=!1,n=$n.O(e,"Role"),r=n.map(function(e){return e.getAttribute("value")}).filter(Vt.Ia),a=void 0,s="text"==t.aa.contentType;s&&(a="subtitle");for(var o=0;o<n.length;o++){var l=n[o].getAttribute("schemeIdUri");if(null==l||"urn:mpeg:dash:role:2011"==l)switch(l=n[o].getAttribute("value"),l){case"main":i=!0;break;case"caption":case"subtitle":a=l}}var u=null,c=!1;$n.O(e,"EssentialProperty").forEach(function(e){"http://dashif.org/guidelines/trickmode"==e.getAttribute("schemeIdUri")?u=e.getAttribute("value"):c=!0}),o=$n.O(e,"Accessibility");var h=new Map;for(n={},l=(o=q(o)).next();!l.done;n={Hb:n.Hb},l=o.next()){var d=l.value;l=d.getAttribute("schemeIdUri"),d=d.getAttribute("value"),"urn:scte:dash:cc:cea-608:2015"==l||"urn:scte:dash:cc:cea-708:2015"==l?(n.Hb=1,null!=d?d.split(";").forEach(function(i){return function(e){if(e.includes("=")){var t=(e=e.split("="))[0].startsWith("CC")?e[0]:"CC"+e[0];e=e[1].split(",")[0].split(":").pop()}else t="CC"+i.Hb,i.Hb+=2;h.set(t,Di(e))}}(n)):h.set("CC1","und")):"urn:mpeg:dash:role:2011"==l&&null!=d&&(r.push(d),"captions"==d&&(a="caption"))}if(c)return null;var f=Qn(n=$n.O(e,"ContentProtection"),this.a.dash.customScheme,this.a.dash.ignoreDrmInfo);if(n=Di(e.getAttribute("lang")||"und"),o=e.getAttribute("label"),(l=$n.O(e,"Label"))&&l.length&&((l=l[0]).textContent&&(o=l.textContent)),0!=(r=(l=$n.O(e,"Representation")).map(this.Bf.bind(this,t,f,a,n,o,i,r,h)).filter(function(e){return!!e})).length)return t.aa.contentType&&"application"!=t.aa.contentType||(t.aa.contentType=Nr(r[0].mimeType,r[0].codecs),r.forEach(function(e){e.type=t.aa.contentType})),r.forEach(function(t){f.drmInfos.forEach(function(e){t.keyId&&e.keyIds.push(t.keyId)})}),s=l.map(function(e){return e.getAttribute("id")}).filter(Vt.Ia),{id:t.aa.id||"__fake__"+this.h++,contentType:t.aa.contentType,language:n,Wc:i,streams:r,drmInfos:f.drmInfos,wd:u,Kf:s};if(this.a.dash.ignoreEmptyAdaptationSet||s)return null;throw new ge(2,4,4003)},t.Bf=function(e,t,i,n,r,a,s,o,l){if(e.B=Or(l,e.aa,null),u=e.B,c=u.Sb?1:0,c+=u.La?1:0,!(0==(c+=u.Ub?1:0)?"text"==u.contentType||"application"==u.contentType:(1!=c&&(u.Sb&&(u.La=null),u.Ub=null),1)))return null;var u,c;e.bandwidth=$n.I(l,"bandwidth",$n.pc)||0;var h=e.B.contentType;h="text"==h||"application"==h;try{var d=this.Lf.bind(this);if(e.B.Sb)var f=function(e,t){var i=Number(ir(e,br,"presentationTimeOffset"))||0,n=ir(e,br,"timescale"),r=1;n&&(r=$n.pc(n)||1),i=i/r||0,n=vr(e,br);var a=e.B.contentType;if(r=e.B.mimeType.split("/")[1],"text"!=a&&"mp4"!=r&&"webm"!=r)throw new ge(2,4,4006);if("webm"==r&&!n)throw new ge(2,4,4005);a=nr(e,br,"RepresentationIndex");var s=ir(e,br,"indexRange"),o=e.B.qa;if(s=$n.qc(s||""),a){var l=a.getAttribute("sourceURL");l&&(o=Kt(e.B.qa,[l])),s=$n.I(a,"range",$n.qc,s)}if(!s)throw new ge(2,4,4002);return{createSegmentIndex:(r=yr(e,t,n,o,s.start,s.end,r,i)).createSegmentIndex,findSegmentPosition:r.findSegmentPosition,getSegmentReference:r.getSegmentReference,initSegmentReference:n,ma:i}}(e,d);else if(e.B.La)f=_r(e,this.m);else if(e.B.Ub)f=Sr(e,d,this.m,!!this.c);else{var p=e.B.qa,m=e.T.duration||0;f={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0<=e&&e<m?1:null},getSegmentReference:function(e){return 1!=e?null:new sr(1,0,m,function(){return p},0,null)},initSegmentReference:null,ma:0}}}catch(e){if(h&&4002==e.code)return null;throw e}return l=function(e,t,i,n){var r=Qn(e,t,n);if(i.Ed)e=1==i.drmInfos.length&&!i.drmInfos[0].keySystem,t=0==r.drmInfos.length,(0==i.drmInfos.length||e&&!t)&&(i.drmInfos=r.drmInfos),i.Ed=!1;else if(0<r.drmInfos.length&&(i.drmInfos=i.drmInfos.filter(function(t){return r.drmInfos.some(function(e){return e.keySystem==t.keySystem})}),0==i.drmInfos.length))throw new ge(2,4,4008);return r.Bd||i.Bd}(l=$n.O(l,"ContentProtection"),this.a.dash.customScheme,t,this.a.dash.ignoreDrmInfo),{id:this.h++,originalId:e.B.id,createSegmentIndex:f.createSegmentIndex,findSegmentPosition:f.findSegmentPosition,getSegmentReference:f.getSegmentReference,initSegmentReference:f.initSegmentReference,presentationTimeOffset:f.ma,mimeType:e.B.mimeType,codecs:e.B.codecs,frameRate:e.B.frameRate,pixelAspectRatio:e.B.pixelAspectRatio,bandwidth:e.bandwidth,width:e.B.width,height:e.B.height,kind:i,encrypted:0<t.drmInfos.length,keyId:l,language:n,label:r,type:e.aa.contentType,primary:a,trickModeVideo:null,emsgSchemeIdUris:e.B.emsgSchemeIdUris,roles:s,channelsCount:e.B.bd,audioSamplingRate:e.B.audioSamplingRate,closedCaptions:o}},t.Af=function(n,r,e){var a=$n.xb,s=e.getAttribute("schemeIdUri")||"",o=e.getAttribute("value")||"",l=$n.I(e,"timescale",a)||1;$n.O(e,"Event").forEach(function(e){var t=$n.I(e,"presentationTime",a)||0,i=$n.I(e,"duration",a)||0;i=(t=t/l+n)+i/l,null!=r&&(t=Math.min(t,n+r),i=Math.min(i,n+r)),e={schemeIdUri:s,value:o,startTime:t,endTime:i,id:e.getAttribute("id")||"",eventElement:e},this.b.onTimelineRegionAdded(e)}.bind(this))},t.Lf=function(e,t,i){return e=kr(e,t,i,this.a.retryParameters),e=this.b.networkingEngine.request(1,e),Oe(this.g,e),e.promise.then(function(e){return e.data})},wr.kd("mpd",Ar),wr.Bb("application/dash+xml",Ar),wr.Bb("video/vnd.mpeg.dash.mpd",Ar),Br.prototype.toString=function(){var e="#"+this.name,t=this.a?this.a.map(function(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)}):[];return this.value&&t.unshift(this.value),0<t.length&&(e+=":"+t.join(",")),e},Br.prototype.getAttribute=function(t){var e=this.a.filter(function(e){return e.name==t});return e.length?e[0]:null};var Hr={nb:function(e,t){return e.filter(function(e){return e.name==t})},Ta:function(e,t){var i=Hr.nb(e,t);return i.length?i[0]:null},Lc:function(e,i,n){return e.filter(function(e){var t=e.getAttribute("TYPE");return e=e.getAttribute("GROUP-ID"),t.value==i&&e.value==n})},Dc:function(e,t){return Kt([e],[t])[0]},Uc:function(e){return/^#(?!EXT)/m.test(e)}};function Gr(e){this.b=e,this.a=0}function Vr(e){Kr(e,/[ \t]+/gm)}function Kr(e,t){t.lastIndex=e.a;var i=t.exec(e.b);return i=null==i?null:{position:i.index,length:i[0].length,Nf:i},e.a==e.b.length||null==i||i.position!=e.a?null:(e.a+=i.length,i.Nf)}function Wr(e){return e.a!=e.b.length&&(e=Kr(e,/[^ \t\n]*/gm))?e[0]:null}function qr(){this.a=0}function zr(e,t,i){var n=(t=(t=ot(t)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(n[0]))throw new ge(2,4,4015);t=0;for(var r=1;r<n.length;r++)if(!Hr.Uc(n[r])){var a=Xr(e,n[r]);if(--e.a,$r.includes(a.name)){t=1;break}"EXT-X-STREAM-INF"==a.name&&(r+=1)}for(r=[],a=1;a<n.length;)if(Hr.Uc(n[a]))a+=1;else{var s=Xr(e,n[a]);if(Jr.includes(s.name)){if(1!=t)throw new ge(2,4,4017);return new Mr(i,t,r,e=Yr(e,i,n=n.splice(a,n.length-a),r))}r.push(s),a+=1,"EXT-X-STREAM-INF"==s.name&&(s.a.push(new Ur("URI",n[a])),a+=1)}return new Mr(i,t,r)}function Yr(t,i,e,n){var r=[],a=[];return e.forEach(function(e){if(/^(#EXT)/.test(e))e=Xr(t,e),$r.includes(e.name)?n.push(e):a.push(e);else{if(Hr.Uc(e))return[];e=Hr.Dc(i,e.trim()),r.push(new jr(e,a)),a=[]}}),r}function Xr(e,t){var i=e.a++,n=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!n)throw new ge(2,4,4016,t);var r,a=n[1],s=n[2];if(n=[],s){var o;(o=Kr(s=new Gr(s),/^([^,=]+)(?:,|$)/g))&&(r=o[1]);for(var l=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;o=Kr(s,l);)n.push(new Ur(o[1],o[2]||o[3]))}return new Br(i,a,n,r)}var $r="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-MAP EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST".split(" "),Jr="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE".split(" ");function Qr(e){try{var t=Qr.parse(e);return Te({uri:e,fd:e,data:t.data,headers:{"content-type":t.contentType}})}catch(e){return be(e)}}function Zr(){var e=this;this.a=this.g=null,this.$=1,this.D=new Map,this.S=new Set,this.b=new Map,this.c=null,this.u="",this.s=new qr,this.R=0,this.h=new de(function(){var n;n=e,z(function e(){var t,i;return X(e,function(e){switch(e.j){case 1:return n.g?(E(e,2),Y(e,n.update(),4)):e.return();case 4:t=n.R,n.h.P(t),S(e,0);break;case 2:(i=w(e)).severity=1,n.g.onError(i),n.h.P(.1),F(e)}})})}),this.f=va,this.m=null,this.C=0,this.F=1/0,this.i=new Re,this.K=[],this.l=new Map,this.W=!1}function ea(h,d){return z(function e(){var t,i,n,r,a,s,o,l,u,c;return X(e,function(e){switch(e.j){case 1:return t=Hr,i=ya,n=d.re,Y(e,ma(h,Be([n],h.a.retryParameters),0),2);case 2:if(r=e.o,1!=(a=zr(h.s,r.data,r.uri)).type)throw new ge(2,4,4017);return o=(s=t.Ta(a.a,"EXT-X-MEDIA-SEQUENCE"))?Number(s.value):0,l=d.stream,Y(e,oa(h,d.xc,a,o,l.mimeType,l.codecs),3);case 3:u=e.o,d.Tb.a=u,c=u[u.length-1],t.Ta(a.a,"EXT-X-ENDLIST")&&(pa(h,i.Qa),h.c.xa(c.endTime)),F(e)}})})}function ta(e){e.forEach(function(e){var t=e.stream.codecs.split(",");t=t.filter(function(e){return"mp4a.40.34"!=e}),e.stream.codecs=t.join(",")})}function ia(h,d,f){return z(function e(){var i,n,r,a,s,o,l,u,c;return X(e,function(e){switch(e.j){case 1:if(i=ca(d,"URI"),h.b.has(i))return e.return(h.b.get(i));if(n=ca(d,"TYPE").toLowerCase(),r=qt,"subtitles"==n&&(n=r.ra),a=Di(Fr(d,"LANGUAGE","und")),s=Fr(d,"NAME"),o=d.getAttribute("DEFAULT"),l=d.getAttribute("AUTOSELECT"),u=Fr(d,"CHANNELS"),"audio"==n)if(u){var t=u.split("/")[0];t=parseInt(t,10)}else t=null;else t=null;return Y(e,na(h,i,f,n,a,!!o||!!l,s,t,null),2);case 2:return null==(c=e.o)?e.return(null):h.b.has(i)?e.return(h.b.get(i)):(h.D.set(d.id,c),h.b.set(i,c),e.return(c))}})})}function na(B,U,F,j,H,G,V,K,W){return z(function e(){var l,u,p,m,g,v,y,b,_,T,S,E,w,C,k,A,I,x,P,L,R,O,D,N,M;return X(e,function(e){switch(e.j){case 1:return u=(l=Hr).Dc(B.u,U),Y(e,ma(B,Be([u],B.a.retryParameters),0),2);case 2:if(p=e.o,u=p.uri,1!=(m=zr(B.s,p.data,u)).type)throw new ge(2,4,4017);g=[],m.segments.forEach(function(e){e=l.nb(e.b,"EXT-X-KEY"),g.push.apply(g,e)}),v=!1,y=[],b=null;for(var t=q(g),i=t.next();!i.done;i=t.next())if(_=i.value,"NONE"!=(T=ca(_,"METHOD"))){if(v=!0,"AES-128"==T)return B.W=!0,e.return(null);S=ca(_,"KEYFORMAT"),(w=(E=ga[S])?E(_):null)&&(w.keyIds.length&&(b=w.keyIds[0]),y.push(w))}if(v&&!y.length)throw new ge(2,4,4026);return n=B,r=m,a=ya,s=Hr.Ta(r.a,"EXT-X-PLAYLIST-TYPE"),o=Hr.Ta(r.a,"EXT-X-ENDLIST"),o=s&&"VOD"==s.value||o,s=s&&"EVENT"==s.value&&!o,s=!o&&!s,o?pa(n,a.Qa):(pa(n,s?a.zd:a.me),a=ha(r.a,"EXT-X-TARGETDURATION"),a=Number(a.value),n.C=Math.max(a,n.C),n.F=Math.min(a,n.F)),C=function(e,t){if(1==t.length)return t[0];var i=ua(e,t);if(null!=i)return i;throw new ge(2,4,4025,t)}(j,F),Y(e,(c=B,h=j,d=C,f=m,z(function e(){var t,i,n,r,a,s,o,l,u;return X(e,function(e){switch(e.j){case 1:return t=qt,i=f.segments[0].a,n=new Q(i),r=n.ja.split(".").pop(),a=fa[h],(s=a[r])?e.return(s):h==t.ra?d&&"vtt"!=d?e.return("application/mp4"):e.return("text/vtt"):((o=Be([i],c.a.retryParameters)).method="HEAD",Y(e,ma(c,o,1),2));case 2:if(l=e.o,!(u=l.headers["content-type"]))throw new ge(2,4,4021,r);return e.return(u.split(";")[0])}})})),3);case 3:return"audio/mpeg"!=(k=e.o)&&"audio/aac"!=k||(C=""),I=(A=l.Ta(m.a,"EXT-X-MEDIA-SEQUENCE"))?Number(A.value):0,Y(e,oa(B,U,m,I,k,C),4);case 4:return x=e.o,P=x[0].startTime,L=x[x.length-1].endTime,R=L-P,O=new lr(x),D=ra(m),N=void 0,"text"==j&&(N="subtitle"),M={id:B.$++,originalId:V,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:O.find.bind(O),getSegmentReference:O.get.bind(O),initSegmentReference:D,presentationTimeOffset:0,mimeType:k,codecs:C,kind:N,encrypted:v,keyId:b,language:H,label:V,type:j,primary:G,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:[],channelsCount:K,audioSamplingRate:null,closedCaptions:W},e.return({stream:M,Tb:O,drmInfos:y,xc:U,re:u,Zc:P,vg:L,duration:R})}var c,h,d,f,n,r,a,s,o})})}function ra(e){var t=Hr.nb(e.a,"EXT-X-MAP");if(!t.length)return null;if(1<t.length)throw new ge(2,4,4020);var i=ca(t=t[0],"URI"),n=Hr.Dc(e.b,i);return e=0,i=null,(t=Fr(t,"BYTERANGE"))&&(e=t.split("@"),t=Number(e[0]),i=(e=Number(e[1]))+t-1),new ar(function(){return[n]},e,i)}function aa(e,t,i,n){var r=t.b,a=t.a;t=ha(r,"EXTINF").value.split(","),t=n+Number(t[0]);var s=0,o=null;return(r=Hr.Ta(r,"EXT-X-BYTERANGE"))&&(s=r.value.split("@"),r=Number(s[0]),o=(s=s[1]?Number(s[1]):e.a+1)+r-1),new sr(i,n,t,function(){return[a]},s,o)}function sa(t){t.c&&(t.K.forEach(function(e){t.c.ub(e,0)}),t.K=[])}function oa(d,b,_,T,S,E){return z(function e(){var i,n,r,a,s,o,l,u,c,h;return X(e,function(e){switch(e.j){case 1:return i=_.segments,n=[],r=i[0].a,a=aa(null,i[0],T,0),s=ra(_),Y(e,(f=d,p=b,m=s,g=a,v=S,y=E,z(function e(){var r,a,s,o,l,u,c,h,d;return X(e,function(e){switch(e.j){case 1:if(f.m&&(r=f.b.get(p),a=r.Tb,s=a.get(g.position)))return e.return(s.startTime);if("audio/mpeg"==v||"audio/aac"==v)return e.return(null);if("video/mp4"==v||"audio/mp4"==v)return o=[la(f,g)],m&&o.push(la(f,m)),Y(e,Promise.all(o),3);e.A(2);break;case 3:return l=e.o,u=l[0],c=l[1]||l[0],e.return(function(e,t){var i=0;if((new Gn).H("moov",Vn).H("trak",Vn).H("mdia",Vn).fa("mdhd",function(e){e.reader.M(0==e.version?8:16),i=e.reader.G(),e.parser.stop()}).parse(t,!0),!i)throw new ge(2,4,4030);var n=0,r=!1;if((new Gn).H("moof",Vn).H("traf",Vn).fa("tfdt",function(e){n=(0==e.version?e.reader.G():e.reader.Ab())/i,r=!0,e.parser.stop()}).parse(e,!0),!r)throw new ge(2,4,4030);return n}(u.data,c.data));case 2:if("video/mp2t"==v)return Y(e,la(f,g),5);e.A(4);break;case 5:return h=e.o,e.return(function(e){function t(){throw new ge(2,4,4030)}e=new Fn(new DataView(e),0);for(var i=0,n=0;;){if(i=e.ca(),71!=(n=e.la())&&t(),16384&e.Rb()||t(),0!=(n=(48&e.la())>>4)&&2!=n||t(),3==n&&(n=e.la(),e.M(n)),1==e.G()>>8)return e.M(3),0!=(i=e.la()>>6)&&1!=i||t(),0==e.la()&&t(),i=e.la(),n=e.Rb(),e=e.Rb(),(1073741824*((14&i)>>1)+((65534&n)<<14|(65534&e)>>1))/9e4;e.seek(i+188),71!=(n=e.la())&&(e.seek(i+192),n=e.la()),71!=n&&(e.seek(i+204),n=e.la()),71!=n&&t(),e.be(1)}}(h.data));case 4:if("application/mp4"==v||v.startsWith("text/"))return Y(e,la(f,g),7);e.A(6);break;case 7:return d=e.o,e.return((t=v,i=y,n=d.data,gi(t=Qe(t,i))?(vi(i=new pi(null),t),i.Rc(n)):0));case 6:if("video/webm"==v)return e.return(null);throw new ge(2,4,4030)}var t,i,n})})),2);case 2:o=e.o,r.split("/").pop();for(var t=0;t<i.length;++t)l=i[t],u=n[n.length-1],c=0==t?o:u.endTime,h=aa(u,l,T+t,c),n.push(h);return d.K.push(n),sa(d),e.return(n)}var f,p,m,g,v,y})})}function la(o,l){return z(function e(){var t,i,n,r,a,s;return X(e,function(e){switch(e.j){case 1:return t=1,i=kr(l.c(),l.b,l.b+2048-1,o.a.retryParameters),n=kr(l.c(),l.b,l.a,o.a.retryParameters),E(e,2),Y(e,ma(o,i,t),4);case 4:return r=e.o,e.return(r);case 2:if(7001==(a=w(e)).code)throw a;return W("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",i.uris[0]),Y(e,ma(o,n,t),5);case 5:return s=e.o,e.return(s)}})})}function ua(e,t){for(var i=da[e],n=0;n<i.length;n++)for(var r=0;r<t.length;r++)if(i[n].test(t[r].trim()))return t[r].trim();return"text"==e?"":null}function ca(e,t){var i=e.getAttribute(t);if(!i)throw new ge(2,4,4023,t);return i.value}function ha(e,t){var i=Hr.Ta(e,t);if(!i)throw new ge(2,4,4024,t);return i}B("shaka.net.DataUriPlugin",Qr),Qr.parse=function(e){var t=e.split(":");if(t.length<2||"data"!=t[0])throw new ge(2,1,1004,e);if((t=t.slice(1).join(":").split(",")).length<2)throw new ge(2,1,1004,e);var i=t[0];t=d.decodeURIComponent(t.slice(1).join(","));var n=null;if(1<(i=i.split(";")).length&&(n=i[1]),"base64"==n)e=pt.Ba(t).buffer;else{if(n)throw new ge(2,1,1005,e);e=ct(t)}return{data:e,contentType:i[0]}},Me("data",Qr),B("shaka.hls.HlsParser",Zr),(t=Zr.prototype).configure=function(e){this.a=e},t.start=function(n,r){var a=this;return z(function e(){var t,i;return X(e,function(e){switch(e.j){case 1:return a.g=r,Y(e,ma(a,Be([n],a.a.retryParameters),0),2);case 2:return t=e.o,a.u=t.uri,Y(e,(m=a,g=t.data,z(function e(){var n,r,a,s,o,l,u,c,h,d;return X(e,function(e){switch(e.j){case 1:if(0!=(n=zr(m.s,g,m.u)).type)throw new ge(2,4,4022);return Y(e,(f=m,p=n,z(function e(){var t,i,n,r,a,s,o,l,u,c,h,d;return X(e,function(e){switch(e.j){case 1:return t=Hr,i=Vt,n=p.a,r=t.nb(p.a,"EXT-X-MEDIA"),a=r.filter(function(e){return"SUBTITLES"==ca(e,"TYPE")}.bind(f)),s=a.map(function(r){var a=this;return z(function e(){var t;return X(e,function(e){switch(e.j){case 1:return a.a.disableText?e.return(null):(E(e,2),Y(e,(i=a,n=r,z(function e(){var t;return X(e,function(e){switch(e.j){case 1:return ca(n,"TYPE"),Y(e,ia(i,n,[]),2);case 2:return t=e.o,e.return(t.stream)}})})),4));case 4:return e.return(e.o);case 2:if(t=w(e),a.a.hls.ignoreTextStreamFailures)return e.return(null);throw t}var i,n})})}.bind(f)),o=r.filter(function(e){return"CLOSED-CAPTIONS"==ca(e,"TYPE")}),function(e,t){for(var i=q(t),n=i.next();!n.done;n=i.next()){ca(n=n.value,"TYPE");var r=Fr(n,"LANGUAGE")||"und";r=Di(r);var a=ca(n,"GROUP-ID");n=ca(n,"INSTREAM-ID"),e.l.get(a)||e.l.set(a,new Map),e.l.get(a).set(n,r)}}(f,o),Y(e,Promise.all(s),2);case 2:return l=e.o,u=t.nb(n,"EXT-X-STREAM-INF"),c=u.map(function(e){return R=this,O=e,D=p,z(function e(){var t,i,n,r,a,c,h,d,f,p,m,g,v,y,b,_,T,S,E,w,C,k,A,I,x,P,L;return X(e,function(e){switch(e.j){case 1:return t=qt,i=Hr,n=Fr(O,"CODECS","avc1.42E01E,mp4a.40.2"),r=function(e){for(var t=new Set,i=[],n=(e=q(e)).next();!n.done;n=e.next()){var r=Ze(n=n.value)[0];t.has(r)||(i.push(n),t.add(r))}return i}(n.split(/\s*,\s*/)),a=O.getAttribute("RESOLUTION"),h=c=null,d=Fr(O,"FRAME-RATE"),f=Number(ca(O,"BANDWIDTH")),a&&(p=a.value.split("x"),c=p[0],h=p[1]),m=(m=(m=i.nb(D.a,"EXT-X-MEDIA")).filter(function(e){return"CLOSED-CAPTIONS"!=ca(e,"TYPE")})).filter(function(e){var t=Fr(e,"URI")||"";return"SUBTITLES"==(Fr(e,"TYPE")||"")||""!=t}),g=Fr(O,"AUDIO"),v=Fr(O,"VIDEO"),g?m=i.Lc(m,"AUDIO",g):v&&(m=i.Lc(m,"VIDEO",v)),(y=ua(t.ra,r))&&(!(b=Fr(O,"SUBTITLES"))||(_=i.Lc(m,"SUBTITLES",b)).length&&(T=R.D.get(_[0].id))&&(T.stream.codecs=y),Pe(r,y)),S=m.map(function(e){return ia(this,e,r)}.bind(R)),E=[],w=[],Y(e,Promise.all(S),2);case 2:if(k=(k=e.o).filter(function(e){return null!=e}),g?E=k:v&&(w=k),I=!1,E.length||w.length?E.length?(P=ca(O,"URI"),L=E[0].xc,P==L?(A=t.Db,I=!0):A=t.Pa):A=t.Db:1==r.length?(x=ua(t.Pa,r),A=a||d||x?t.Pa:t.Db):(A=t.Pa,r=[r.join(",")]),I){e.A(3);break}return Y(e,(s=R,o=O,l=r,u=A,z(function e(){var t,i,n,r,a;return X(e,function(e){switch(e.j){case 1:return t=qt,i=ca(o,"URI"),s.b.has(i)?e.return(s.b.get(i)):(n=Fr(o,"CLOSED-CAPTIONS"),r=null,u==t.Pa&&n&&"NONE"!=n&&(r=s.l.get(n)),Y(e,na(s,i,l,u,"und",!1,null,null,r),2));case 2:return null==(a=e.o)?e.return(null):s.b.has(i)?e.return(s.b.get(i)):(s.b.set(i,a),e.return(a))}})})),4);case 4:C=e.o;case 3:if(C)C.stream.type==t.Db?E=[C]:w=[C];else if(null===C)return e.return([]);return w&&ta(w),E&&ta(E),e.return(function(e,t,i,n,r,a,s){i.forEach(function(e){(e=e.stream)&&(e.width=Number(r)||void 0,e.height=Number(a)||void 0,e.frameRate=Number(s)||void 0)}.bind(e));var o,l,u,c,h=!!e.a&&e.a.disableAudio;t.length&&!h||(t=[null]),h=!!e.a&&e.a.disableVideo,i.length&&!h||(i=[null]),h=[];for(var d=(t=q(t)).next();!d.done;d=t.next()){d=d.value;for(var f=q(i),p=f.next();!p.done;p=f.next()){var m=p.value;p=d?d.stream:null;var g=m?m.stream:null,v=d?d.drmInfos:null,y=m?m.drmInfos:null;m=(m?m.xc:"")+" - "+(d?d.xc:"");var b=void 0;if(p&&g){if(v.length&&y.length&&!(0<Lt(v,y).length))continue;b=Lt(v,y)}else p?b=v:g&&(b=y);e.S.has(m)||(o=p,l=g,u=n,c=b,p={id:e.$++,language:o?o.language:"und",primary:!!o&&o.primary||!!l&&l.primary,audio:o,video:l,bandwidth:u,drmInfos:c,allowedByApplication:!0,allowedByKeySystem:!0},h.push(p),e.S.add(m))}}return h}(R,E,w,f,c,h,d))}var s,o,l,u})});var R,O,D}.bind(f)),Y(e,Promise.all(c),3);case 3:return h=e.o,d=(d=h.reduce(i.Cc,[])).filter(function(e){return null!=e}),e.return({startTime:0,variants:d,textStreams:l.filter(function(e){return null!=e})})}})})),2);case 2:if(r=e.o,!m.g)throw new ge(2,7,7001);if(m.W&&0==r.variants.length)throw new ge(2,4,4034);m.g.filterAllPeriods([r]),a=1/0,o=1/(s=0);for(var t=q(m.b.values()),i=t.next();!i.done;i=t.next())l=i.value,a=Math.min(a,l.Zc),s=Math.max(s,l.Zc),"text"!=l.stream.type&&(o=Math.min(o,l.duration));if(m.f!=ya.Qa?(m.c=new Cr(0,3*m.C),m.c.Vb(!1)):(m.c=new Cr(null,0),m.c.Vb(!0)),sa(m),m.f!=ya.Qa){for(m.R=m.F,m.f==ya.zd&&(u=m.c.rc,isNaN(m.a.availabilityWindowOverride)||(u=m.a.availabilityWindowOverride),m.c.sd(u)),c=0;95443.7176888889<=s;)c+=95443.7176888889,s-=95443.7176888889;if(c)for(i=(t=q(m.b.values())).next();!i.done;i=t.next())(h=i.value).Zc<95443.7176888889&&(h.stream.presentationTimeOffset=-c,h.Tb.offset(c))}else for(m.c.xa(o),m.c.offset(-a),i=(t=q(m.b.values())).next();!i.done;i=t.next())(d=i.value).stream.presentationTimeOffset=a,d.Tb.offset(-a),ur(d.Tb,o);m.m={presentationTimeline:m.c,periods:[r],offlineSessionIds:[],minBufferTime:0},F(e)}var f,p})})),3);case 3:return 0<(i=a.R)&&a.h.P(i),e.return(a.m)}var m,g})})},t.stop=function(){this.h&&(this.h.stop(),this.h=null);var e=[];return this.i&&(e.push(this.i.destroy()),this.i=null),this.a=this.g=null,this.D.clear(),this.S.clear(),this.b.clear(),this.m=null,Promise.all(e)},t.update=function(){if(this.f!=ya.Qa){for(var e=[],t=q(this.b.values()),i=t.next();!i.done;i=t.next())e.push(ea(this,i.value));return Promise.all(e)}},t.onExpirationUpdated=function(){};var da={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},fa={audio:{mp4:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",ts:"video/mp2t",aac:"audio/aac"},video:{mp4:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}};function pa(e,t){e.f=t,e.c&&e.c.Vb(e.f==ya.Qa),e.f!=ya.Qa||e.h.stop()}function ma(e,t,i){if(!e.i)throw new ge(2,7,7001);return t=e.g.networkingEngine.request(i,t),Oe(e.i,t),t.promise}var ga={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var t=ca(e,"METHOD");return tn("HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227"),["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].includes(t)?(t=ca(e,"URI"),t=Qr.parse(t),t=Wt("com.widevine.alpha",[{initDataType:"cenc",initData:t=new Uint8Array(t.data)}]),(e=Fr(e,"KEYID"))&&(t.keyIds=[e.substr(2).toLowerCase()]),t):null}},va="VOD",ya={Qa:va,me:"EVENT",zd:"LIVE"};function ba(){this.a=new Map}function _a(e,t,i){Ta(e,t).text=i}function Ta(e,t){return e.a.has(t)||e.a.set(t,new Sa),e.a.get(t)}function Sa(){this.text=this.variant=null}function Ea(e,t){this.a=e,this.b=new Set([e]);for(var i=q(t=t||[]),n=i.next();!n.done;n=i.next())this.add(n.value)}function wa(e,t){var i;if(!(i=!!e.audio!=!!t.audio||!!e.video!=!!t.video||e.language!=t.language)&&(i=e.audio&&t.audio)){i=e.audio;var n=t.audio;i=!(i.channelsCount==n.channelsCount&&Ca(i,n)&&ka(i.roles,n.roles))}return!i&&(i=e.video&&t.video)&&(i=!(Ca(i=e.video,n=t.video)&&ka(i.roles,n.roles))),!i}function Ca(e,t){if(e.mimeType==t.mimeType){var i=e.codecs.split(",").map(function(e){return Ze(e)[0]}),n=t.codecs.split(",").map(function(e){return Ze(e)[0]});if(i.length==n.length){i.sort(),n.sort();for(var r=0;r<i.length;r++)if(i[r]!=n[r])return;return 1}}}function ka(e,t){var i=new Set(e),n=new Set(t);if(i.delete("main"),n.delete("main"),i.size==n.size){for(var r=(i=q(i)).next();!r.done;r=i.next())if(!n.has(r.value))return;return 1}}function Aa(e){this.a=e,this.b=new Ia(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,"")}function Ia(e,t,i,n){this.f=e,this.c=t,this.a=i,this.b=void 0===n?"":n}function xa(){this.a=Ra,this.b=(new Map).set(Ra,2).set(La,1)}function Pa(e,t,i){e.b.set(Ra,i).set(La,t)}wr.kd("m3u8",Zr),wr.Bb("application/x-mpegurl",Zr),wr.Bb("application/vnd.apple.mpegurl",Zr),Ea.prototype.add=function(e){return!!wa(this.a,e)&&(this.b.add(e),!0)},Ea.prototype.values=function(){return this.b.values()},Aa.prototype.create=function(e){var t=this,i=e.filter(function(e){return wa(t.a,e)});return i.length?new Ea(i[0],i):this.b.create(e)},Ia.prototype.create=function(e){var t,i,n,r=[];t=e,i=this.f,r=(n=Mi(Di(i),t.map(function(e){return Ni(e)})))?t.filter(function(e){return n==Ni(e)}):[];var a,s,o,l,u=e.filter(function(e){return e.primary});for(r=r.length?r:u.length?u:e,this.c&&(a=r,s=this.c,(e=a.filter(function(e){var t=e.audio;return e=e.video,t&&0<=t.roles.indexOf(s)||e&&0<=e.roles.indexOf(s)})).length&&(r=e)),this.a&&((e=Yi(r,this.a)).length&&(r=e)),this.b&&(o=r,l=this.b,(e=o.filter(function(e){return!!e.audio&&e.audio.label.toLowerCase()==l.toLowerCase()})).length&&(r=e)),e=new Ea(r[0]),u=(r=q(r)).next();!u.done;u=r.next())u=u.value,wa(e.a,u)&&e.add(u);return e};var La=0,Ra=1;function Oa(e,t){this.g=e,this.h=Na(e),this.a=e.a.currentTime,this.f=Date.now()/1e3,this.b=!1,this.i=t,this.c=function(){}}function Da(e){this.a=e}function Na(e){if(e.a.paused||0==e.a.playbackRate||null==e.a.buffered)var t=!1;else e:{t=e.a.buffered,e=e.a.currentTime;for(var i=0;i<t.length;i++){var n=t.start(i),r=t.end(i);if(!(e<n||r-.5<e)){t=!0;break e}}t=!1}return t}function Ma(e,t,i,n,r){var a=this;this.a=e,this.u=t,this.s=i,this.l=r,this.f=new Ke,this.i=!1,this.m=e.readyState,this.c=!1,this.b=n,this.h=!1,this.f.w(e,"waiting",function(){return Ba(a)}),this.g=new de(function(){Ba(a)}).Na(.25)}function Ba(e){if(0!=e.a.readyState){if(e.a.seeking){if(!e.i)return}else e.i=!1;if(!e.a.paused){e.a.readyState!=e.m&&(e.c=!1,e.m=e.a.readyState);var t=e.s.smallGapLimit,i=e.a.currentTime,n=e.a.buffered;e:{if(n&&n.length&&!(1==n.length&&n.end(0)-n.start(0)<1e-6))for(var r=nt("Edge/")||nt("Trident/")||nt("Tizen")||nt("CrKey")?.5:.1,a=0;a<n.length;a++)if(n.start(a)>i&&(0==a||n.end(a-1)-i<=r)){r=a;break e}r=null}if(null==r)e.b&&(i=Na(n=(e=e.b).g),r=n.a.currentTime,a=Date.now()/1e3,e.a==r&&e.h==i||(e.f=a,e.a=r,e.h=i,e.b=!1),(r=a-e.f)>=e.i&&i&&!e.b&&(e.c(e.a,r),e.b=!0,e.a=n.a.currentTime));else if(0!=r||e.h){a=n.start(r);var s=e.u.Ca();if(!(s<=a)){t=(s=a-i)<=t;var o=!1;s<.001||(t||e.c||(e.c=!0,(i=new Ce("largegap",{currentTime:i,gapSize:s})).cancelable=!0,e.l(i),e.s.jumpLargeGaps&&!i.defaultPrevented&&(o=!0)),!t&&!o)||(0!=r&&n.end(r-1),e.a.currentTime=a)}}}}}function Ua(e){var t=this;this.c=e,this.a=new Set,this.b=new de(function(){Fa(t,!1)}).Na(.25)}function Fa(e,t){for(var i=q(e.a),n=i.next();!n.done;n=i.next())n.value.g(e.c.currentTime,t)}function ja(e){for(var t=[],i=(e=q(e)).next();!i.done;i=e.next())for(var n=(i=q(i.value.variants)).next();!n.done;n=i.next())t.push(n.value);return t}function Ha(e,t){for(var i=null,n=q(e),r=n.next();!r.done;r=n.next())t>=(r=r.value).startTime&&(i=r);return i}function Ga(e){this.c=e,this.a=null,this.b=function(){}}function Va(e){var t=this;this.a=e,this.f=!1,this.c=this.a.gc(),this.b=new de(function(){t.a.Ld(.25*t.c)})}function Ka(e){e.b.stop();var t=e.f?0:e.c;if(0<=t)try{return void(e.a.gc()!=t&&e.a.rd(t))}catch(e){}e.b.Na(.25),0!=e.a.gc()&&e.a.rd(0)}function Wa(e,t,i){this.a=e,this.f=t,this.g=i,this.h=!1,this.b=new Ke,this.c=new $a(e),(0<e.readyState?Ya:za)(this,i)}function qa(e){return e.h?e.a.currentTime:e.g}function za(e,t){e.g=t,e.b.ea(e.a,"loadedmetadata"),e.b.da(e.a,"loadedmetadata",function(){Ya(e,t)})}function Ya(e,t){Math.abs(e.a.currentTime-t)<.001?Xa(e):(e.b.da(e.a,"seeking",function(){Xa(e)}),Ja(e.c,0==e.a.currentTime?t:e.a.currentTime))}function Xa(e){e.h=!0,e.b.w(e.a,"seeking",function(){return e.f()})}function $a(e){var t=this;this.b=e,this.h=10,this.g=this.f=this.c=0,this.a=new de(function(){t.c<=0||t.b.currentTime!=t.f?t.a.stop():(t.b.currentTime=t.g,t.c--)})}function Ja(e,t){e.f=e.b.currentTime,e.g=t,e.c=e.h,e.b.currentTime=t,e.a.Na(.1)}function Qa(e){function t(){null==i.c?i.f=!0:(i.b.da(i.a,"seeking",function(){i.f=!0}),i.a.currentTime=Math.max(0,i.a.currentTime+i.c))}var i=this;this.a=e,this.f=!1,this.c=null,this.b=new Ke,0==this.a.readyState?this.b.da(this.a,"loadeddata",t):t()}function Za(e,t,i,n,r,a){var s,o,l=this;this.b=e,this.a=t.presentationTimeline,this.C=t.minBufferTime||0,this.g=i,this.u=r,this.l=null,this.f=new Ma(e,t.presentationTimeline,i,function(e,t){if(!t.stallEnabled)return null;var i=t.stallSkip,n=new Oa(new Da(e),t.stallThreshold);return function(e,t){e.c=t}(n,function(){e.currentTime+=i}),n}(e,i),a),this.c=new Wa(e,function(){var e=l.f;e.i=!0,e.h=!1,e.c=!1;var t=qa(l.c);return e=ts(l,t),e=.001<Math.abs(e-t)&&(t=(new Date).getTime()/1e3,!l.l||l.l<t-1)?(l.l=t,void(0<(t=l.c).a.readyState?Ja(t.c,e):za(t,e))):void l.u()},(s=this,null==(o=n)?o=1/0>s.a.Y()?s.a.ob():s.a.Ca():o<0&&(o=s.a.Ca()+o),es(s,is(s,o)))),this.i=new de(function(){if(0!=l.b.readyState&&!l.b.paused){var e=l.b.currentTime,t=l.a.ob(),i=l.a.Ca();i-t<3&&(t=i-3),e<t&&(e=ts(l,e),l.b.currentTime=e)}}).Na(.25)}function es(e,t){var i=e.a.Y();return i<=t?i-e.g.durationBackoff:t}function ts(e,t){var i=jt.bind(null,e.b.buffered),n=Math.max(e.C,e.g.rebufferingGoal),r=e.g.safeSeekOffset,a=e.a.ob(),s=e.a.Ca(),o=e.a.Y();s-a<3&&(a=s-3);var l=e.a.Lb(n),u=e.a.Lb(r);return n=e.a.Lb(n+r),o<=t?es(e,t):s<t?s:t<a?i(u)?u:n:l<=t||i(t)?t:n}function is(e,t){var i=e.a.ob();return t<i||(i=e.a.Ca())<t?i:t}function ns(){this.b=function(){},this.a=new Set}function rs(e){var i=this;this.h=e,this.f=new Map,this.a=function(){},this.b=function(){},this.c=function(){},this.i=[{eb:null,cb:ss,Wa:function(e,t){return i.a(e,t)}},{eb:as,cb:ss,Wa:function(e,t){return i.a(e,t)}},{eb:os,cb:ss,Wa:function(e,t){return i.a(e,t)}},{eb:ss,cb:as,Wa:function(e,t){return i.b(e,t)}},{eb:ss,cb:os,Wa:function(e,t){return i.b(e,t)}},{eb:as,cb:os,Wa:function(e,t){return i.c(e,t)}},{eb:os,cb:as,Wa:function(e,t){return i.c(e,t)}}]}Oa.prototype.release=function(){this.g=null,this.c=function(){}},Ma.prototype.release=function(){this.f&&(this.f.release(),this.f=null),null!=this.g&&(this.g.stop(),this.g=null),this.b&&(this.b.release(),this.b=null),this.a=this.u=this.l=null},Ma.prototype.dd=function(){this.h=!0,Ba(this)},Ua.prototype.release=function(){this.b.stop();for(var e=q(this.a),t=e.next();!t.done;t=e.next())t.value.release();this.a.clear()},Ga.prototype.release=function(){this.a=this.c=null,this.b=function(){}},Ga.prototype.g=function(e){var t=this.a,i=this.c.periods;t!=(e=Ha(i,e)||i[0])&&this.b(e),this.a=e},Va.prototype.release=function(){this.b&&(this.b.stop(),this.b=null),this.a=null},Va.prototype.set=function(e){this.c=e,Ka(this)},Wa.prototype.release=function(){this.b&&(this.b.release(),this.b=null),null!=this.c&&(this.c.release(),this.c=null),this.f=function(){},this.a=null},$a.prototype.release=function(){this.a&&(this.a.stop(),this.a=null),this.b=null},Qa.prototype.release=function(){this.b&&(this.b.release(),this.b=null),this.a=null},Qa.prototype.m=function(e){this.c=this.f?this.c:e},Qa.prototype.h=function(){return(this.f?this.a.currentTime:this.c)||0},Qa.prototype.s=function(){},Za.prototype.release=function(){this.c&&(this.c.release(),this.c=null),this.f&&(this.f.release(),this.f=null),this.i&&(this.i.stop(),this.i=null),this.b=this.c=this.a=this.g=null,this.u=function(){}},Za.prototype.m=function(e){var t=this.c;0<t.a.readyState?Ja(t.c,e):za(t,e)},Za.prototype.h=function(){var e=qa(this.c);return 0<this.b.readyState&&!this.b.paused?is(this,e):e},Za.prototype.s=function(){this.f.dd()},ns.prototype.release=function(){this.b=function(){},this.a.clear()},rs.prototype.release=function(){this.h=null,this.f.clear(),this.a=function(){},this.b=function(){},this.c=function(){}},rs.prototype.g=function(e,t){for(var i=q(this.h.a),n=i.next();!n.done;n=i.next()){n=n.value;var r=this.f.get(n),a=e<n.startTime?as:e>n.endTime?os:ss;this.f.set(n,a);for(var s=q(this.i),o=s.next();!o.done;o=s.next())(o=o.value).eb==r&&o.cb==a&&o.Wa(n,t)}};var as=1,ss=2,os=3;function ls(e,t){this.a=t,this.c=e,this.g=null,this.l=1,this.u=Promise.resolve(),this.h=[],this.i=new Map,this.b=new Map,this.s=!1,this.F=null,this.D=this.f=this.m=!1,this.C=0}function us(e){return hs(e,"audio")}function cs(e){return hs(e,"video")}function hs(e,t){var i=e.b.get(t);return i?i.Ka||i.stream:null}function ds(c,h){return z(function e(){var t,i,n,r,a,s,o,l,u;return X(e,function(e){switch(e.j){case 1:return t=qt,Y(e,Ii(c.a.L,t.ra),2);case 2:return c.C++,c.D=!1,i=c.C,n=c.a.L,r=new Map,a=new Set,r.set(t.ra,h),a.add(h),Y(e,n.init(r,!1),3);case 3:return c.f?e.return():Y(e,_s(c,a),4);case 4:if(c.f)return e.return();s=c.a.L.g.isTextVisible()||c.g.alwaysStreamText,c.C!=i||c.b.has(t.ra)||c.D||!s||(o=c.a.Ua(),l=As(c,o),u=ys(h,l,0),c.b.set(t.ra,u),Ls(c,u,0)),F(e)}})})}function fs(e,t){var i=e.b.get("video");if(i){var n=i.stream;if(n)if(t){var r=n.trickModeVideo;r&&!i.Ka&&(ms(e,r,!1,0,!1),i.Ka=n)}else(n=i.Ka)&&ms(e,n,!(i.Ka=null),0,!1)}}function ps(e,t,i,n){t.video&&ms(e,t.video,i,n,!1),t.audio&&ms(e,t.audio,i,n,!1)}function ms(t,e,i,n,r){var a=t.b.get(e.type);if(!a&&"text"==e.type&&t.g.ignoreTextStreamFailures)ds(t,e);else if(a){var s=Is(t,e),o=Array.from(t.b.values()).every(function(e){return e.ia==a.ia});i&&s!=a.ia&&o?t.b.forEach(function(e){gs(t,e)}):(a.Ka&&(e.trickModeVideo?e=(a.Ka=e).trickModeVideo:a.Ka=null),(o=t.h[s])&&o.Cb&&(o=t.i.get(e.id))&&o.Cb&&(a.stream!=e||r)&&("text"==e.type&&Si(t.a.L,Qe(e.mimeType,e.codecs)),a.stream=e,a.jc=!0,function(e,t,i){if(!t.Pb)return;var n=e.a.Ua(),r=Ci(e.a.L,t.type);if(null==(i=(i=Es(e,t,n,r,i))&&i.a?i.a-i.b:null))return;var a=t.stream.initSegmentReference;return a&&(i+=(a.a?a.a-a.b:null)||0),a=e.a.getBandwidthEstimate(),8*i/a<r-n-Math.max(e.c.minBufferTime||0,e.g.rebufferingGoal)||t.Pb.b.a>i}(t,a,s)&&a.Pb.abort(),i&&(a.Ra?a.yc=!0:a.Ja?(a.Oa=!0,a.bc=n,a.yc=!0):(Rs(a),Ps(t,a,!0,n).catch(function(e){t.a&&t.a.onError(e)})))))}}function gs(t,e){e.Ra||e.Oa||(e.Ja?(e.Oa=!0,e.bc=0):null==wi(t.a.L,e.type)?null==e.Ga&&Ls(t,e,0):(Rs(e),Ps(t,e,!1,0).catch(function(e){t.a&&t.a.onError(e)})))}function vs(c,h,d,f,p){return z(function e(){var n,r,a,s,o,l,u;return X(e,function(e){switch(e.j){case 1:return n=c.a.Ua(),r=As(c,n),a=qt,s=new Map,o=new Set,h&&(s.set(a.Db,h),o.add(h)),d&&(s.set(a.Pa,d),o.add(d)),f&&(s.set(a.ra,f),o.add(f)),l=c.a.L,u=c.g.forceTransmuxTS,Y(e,l.init(s,u),2);case 2:return c.f?e.return():((i=(t=c).c.presentationTimeline.Y())<1/0?t.a.L.xa(i):t.a.L.xa(Math.pow(2,32)),Y(e,_s(c,o),3));case 3:if(c.f)return e.return();s.forEach(function(e,t){if(!c.b.has(t)){var i=ys(e,r,p);c.b.set(t,i),Ls(c,i,0)}}),F(e)}var t,i})})}function ys(e,t,i){return{stream:e,type:e.type,rb:null,Da:null,Ka:null,jc:!0,ia:t,endOfStream:!1,Ja:!1,Ga:null,Oa:!1,bc:0,yc:!1,Ra:!1,jd:!1,Nb:!1,md:i||0,Pb:null}}function bs(e,t){var i=e.h[t];if(i)return i.promise;i={promise:new ve,Cb:!1},e.h[t]=i;for(var n=new Set,r=q(e.c.periods[t].variants),a=r.next();!a.done;a=r.next())(a=a.value).video&&n.add(a.video),a.video&&a.video.trickModeVideo&&n.add(a.video.trickModeVideo),a.audio&&n.add(a.audio);for(a=(r=q(e.c.periods[t].textStreams)).next();!a.done;a=r.next())n.add(a.value);return e.u=e.u.then(function(){if(!this.f)return _s(this,n)}.bind(e)).then(function(){this.f||(this.h[t].promise.resolve(),this.h[t].Cb=!0)}.bind(e)).catch(function(e){this.f||(this.h[t].promise.catch(function(){}),this.h[t].promise.reject(),delete this.h[t],this.a.onError(e))}.bind(e)),i.promise}function _s(c,h){return z(function e(){var n,r,a,s,o,l,u;return X(e,function(e){switch(e.j){case 1:n=[];for(var t=q(h),i=t.next();!i.done;i=t.next())r=i.value,(a=c.i.get(r.id))?n.push(a.promise):(c.i.set(r.id,{promise:new ve,Cb:!1}),n.push(r.createSegmentIndex()));return E(e,2),Y(e,Promise.all(n),4);case 4:if(c.f)return e.return();S(e,3);break;case 2:if(s=w(e),c.f)return e.return();for(i=(e=q(h)).next();!i.done;i=e.next())o=i.value,c.i.get(o.id).promise.catch(function(){}),c.i.get(o.id).promise.reject(),c.i.delete(o.id);throw s;case 3:for(i=(t=q(h)).next();!i.done;i=t.next())l=i.value,(u=c.i.get(l.id)).Cb||(u.promise.resolve(),u.Cb=!0);F(e)}})})}function Ts(t,e){if(!t.f&&!e.Ja&&null!=e.Ga&&!e.Ra)if(e.Ga=null,e.Oa)Ps(t,e,e.yc,e.bc);else{try{var i=function(t,e){if(Cs(e))return t.a.L.tc(e.stream.originalId||""),null;var i=t.a.Ua(),n=Ss(t,e,i),r=Is(t,e.stream),a=As(t,n),s=function(e,t,i){return"text"==t?null==(e=e.a).b||e.b<i?0:e.b-Math.max(i,e.a):Ht(e=ki(e,t),i)}(t.a.L,e.type,i),o=Math.max(t.c.minBufferTime||0,t.g.rebufferingGoal,t.g.bufferingGoal)*t.l;if(n>=t.c.presentationTimeline.Y())return e.endOfStream=!0,"video"==e.type&&(n=t.b.get("text"))&&"application/cea-608"==n.stream.mimeType&&(n.endOfStream=!0),null;if(e.endOfStream=!1,(e.ia=a)!=r)return null;if(o<=s)return.5;if(a=Ci(t.a.L,e.type),!(a=Es(t,e,i,a,r)))return 1;var l=1/0;return Array.from(t.b.values()).forEach(function(e){Cs(e)||(e=Ss(t,e,i),l=Math.min(l,e))}),n>=l+t.c.presentationTimeline.b?1:(e.md=0,function(e,u,c,t,h){var d=e.c.periods[t],f=u.stream,i=e.c.presentationTimeline.Y(),n=e.c.periods[t+1];t=function(e,t,i,n,r){return t.jc?(i=function(e,t,i,n,r){return"text"==t?(e.a.m=i,(e=e.a).f=n,e.h=r,Promise.resolve()):Promise.all([xi(e,t,e.qe.bind(e,t)),xi(e,t,e.Xf.bind(e,t,i)),xi(e,t,e.Uf.bind(e,t,n,r))])}(e.a.L,t.type,e.c.periods[i].startTime-t.stream.presentationTimeOffset,n,r),t.stream.initSegmentReference?(e=xs(e,t,t.stream.initSegmentReference).then(function(e){if(!this.f)return Ai(this.a.L,t.type,e,null,null,t.stream.closedCaptions&&0<t.stream.closedCaptions.size)}.bind(e)).catch(function(e){return t.jc=!0,Promise.reject(e)}),Promise.all([i,e])):i):Promise.resolve()}(e,u,t,Math.max(0,d.startTime-.1),n?n.startTime+.01:i),u.Ja=!0,u.jc=!1,i=xs(e,u,h),Promise.all([t,i]).then(function(e){if(!this.f&&!this.m)return t=this,i=u,n=c,r=d,a=f,s=h,o=e[1],l=a.closedCaptions&&0<a.closedCaptions.size,null!=a.emsgSchemeIdUris&&0<a.emsgSchemeIdUris.length&&(new Gn).fa("emsg",t.K.bind(t,r,s,a.emsgSchemeIdUris)).parse(o),function(e,t,i){var n=Math.max(e.g.bufferBehind,e.c.presentationTimeline.b),r=wi(e.a.L,t.type);return null==r||(i=i-r-n)<=0?Promise.resolve():e.a.L.remove(t.type,r,r+i).then(function(){}.bind(e))}(t,i,n).then(function(){if(!this.f)return Ai(this.a.L,i.type,o,s.startTime+r.startTime,s.endTime+r.startTime,l)}.bind(t)).then(function(){if(!this.f)return i.rb=a,i.Da=s,Promise.resolve()}.bind(t));var t,i,n,r,a,s,o,l}.bind(e)).then(function(){this.f||this.m||(u.Ja=!1,u.jd=!1,u.Oa||this.a.dd(),Ls(this,u,0),function(e,t){if(!e.s){var i=Array.from(e.b.values());if(1==i.length&&"text"==i[0].type||(e.s=i.every(function(e){return"text"==e.type||!e.Oa&&!e.Ra&&e.Da})),e.s){for(i=Is(e,t),e.h[i]||bs(e,i).then(function(){this.f||this.a.Nd()}.bind(e)).catch(Vt.kc),i=0;i<e.c.periods.length;++i)bs(e,i).catch(Vt.kc);e.a.wf&&e.a.wf()}}}(this,f))}.bind(e)).catch(function(e){this.f||this.m||(u.Ja=!1,"text"==u.type&&this.g.ignoreTextStreamFailures?this.b.delete("text"):7001==e.code?(u.Ja=!1,u.Ga=null,Ls(this,u,0)):3017==e.code?function(e,t,i){if(!Array.from(e.b.values()).some(function(e){return e!=t&&e.jd})){var n=Math.round(100*e.l);if(20<n)e.l-=.2;else{if(!(4<n))return t.Nb=!0,e.m=!0,e.a.onError(i);e.l-=.04}t.jd=!0}Ls(e,t,4)}(this,u,e):(u.Nb=!0,e.severity=2,Os(this,e)))}.bind(e))}(t,e,i,r,a),null)}(t,e);null!=i&&(Ls(t,e,i),e.Nb=!1)}catch(e){return void Os(t,e)}i=Array.from(t.b.values()),function(e,t){var i=Is(e,t.stream);if(t.ia!=i){var o=t.ia,l=Array.from(e.b.values());l.every(function(e){return e.ia==o||Cs(e)})&&l.every(ks)&&bs(e,o).then(function(){if(!this.f&&l.every(function(e){var t=ks(e),i=Is(this,e.stream);return!!Cs(e)||t&&e.ia==o&&i!=o}.bind(this))){var e=this.c.periods[o],t=this.a.Od(e),i=new Map;t.variant&&t.variant.video&&i.set("video",t.variant.video),t.variant&&t.variant.audio&&i.set("audio",t.variant.audio),t.text&&i.set("text",t.text);for(var n=(t=q(this.b.keys())).next();!n.done;n=t.next())if(n=n.value,!i.has(n)&&"text"!=n)return void this.a.onError(new ge(2,5,5005));for(n=(t=q(Array.from(i.keys()))).next();!n.done;n=t.next())if(n=n.value,!this.b.has(n)){if("text"!=n)return void this.a.onError(new ge(2,5,5005));vs(this,null,null,i.get("text"),e.startTime),i.delete(n)}for(n=(t=q(Array.from(this.b.keys()))).next();!n.done;n=t.next()){n=n.value;var r=this.b.get(n),a=i.get(n);if(a){var s=Cs(r);s&&(r.ia=o,r.md=e.startTime),ms(this,a,!1,0,!1),s&&Cs(r)||Ls(this,this.b.get(n),0)}else this.b.delete(n)}this.a.Nd()}}.bind(e)).catch(Vt.kc)}}(t,e),t.s&&i.every(function(e){return e.endOfStream})&&t.a.L.endOfStream().then(function(){if(!this.f){var e=this.a.L.Y();0!=e&&e<this.c.presentationTimeline.Y()&&this.c.presentationTimeline.xa(e)}}.bind(t))}}function Ss(e,t,i){return t.rb&&t.Da?(i=Is(e,t.rb),e.c.periods[i].startTime+t.Da.endTime):Math.max(i,t.md)}function Es(e,t,i,n,r){if(t.Da&&t.stream==t.rb)return ws(e,t,r,t.Da.position+1);if(null==(i=t.Da?(i=Is(e,t.rb),t.stream.findSegmentPosition(Math.max(0,e.c.periods[i].startTime+t.Da.endTime-e.c.periods[r].startTime))):t.stream.findSegmentPosition(Math.max(0,(n||i)-e.c.periods[r].startTime))))return null;var a=null;return null==n&&(a=ws(e,t,r,Math.max(0,i-1))),a||ws(e,t,r,i)}function ws(e,t,i,n){return i=e.c.periods[i],(t=t.stream.getSegmentReference(n))?(e=(n=e.c.presentationTimeline).Mb(),n=n.pb(),i.startTime+t.endTime<e||i.startTime+t.startTime>n?null:t):null}function Cs(e){return e&&"text"==e.type&&"application/cea-608"==e.stream.mimeType}function ks(e){return!e.Ja&&null==e.Ga&&!e.Oa&&!e.Ra}function As(e,t){var i=Ha(e.c.periods,t+zt);return i?e.c.periods.indexOf(i):0}function Is(e,t){for(var i=e.c.periods,n=0;n<i.length;n++){for(var r=i[n],a=new Set,s=q(r.variants),o=s.next();!o.done;o=s.next())(o=o.value).audio&&a.add(o.audio),o.video&&a.add(o.video),o.video&&o.video.trickModeVideo&&a.add(o.video.trickModeVideo);for(s=(r=q(r.textStreams)).next();!s.done;s=r.next())a.add(s.value);if(a.has(t))return n}return-1}function xs(e,t,i){return i=kr(i.c(),i.b,i.a,e.g.retryParameters),e=e.a.tb.request(1,i),(t.Pb=e).promise.then(function(e){return t.Pb=null,e.data})}function Ps(n,r,a,s){return z(function e(){var t,i;return X(e,function(e){switch(e.j){case 1:return r.Oa=!1,r.yc=!1,r.bc=0,r.Ra=!0,Y(e,s?(t=n.a.Ua(),i=n.a.L.Y(),n.a.L.remove(r.type,t+s,i)):Ii(n.a.L,r.type).then(function(){if(!this.f&&a)return this.a.L.flush(r.type)}.bind(n)),2);case 2:if(n.f)return e.return();r.rb=null,r.Da=null,r.Ra=!1,r.endOfStream=!1,Ls(n,r,0),F(e)}})})}function Ls(i,n,e){n.Ga=new he(function(){return z(function e(){var t;return X(e,function(e){switch(e.j){case 1:return E(e,2),Y(e,Ts(i,n),4);case 4:S(e,0);break;case 2:t=w(e),i.a&&i.a.onError(t),F(e)}})})}).P(e)}function Rs(e){null!=e.Ga&&(e.Ga.stop(),e.Ga=null)}function Os(e,t){pe(e.F).then(function(){this.f||(this.a.onError(t),t.handled||this.g.failureCallback(t))}.bind(e))}function Ds(e,t,i,n,r,a){if(200<=i&&i<=299&&202!=i)return{uri:r||n,fd:n,data:t,headers:e,fromCache:!!e["x-shaka-from-cache"]};r=null;try{r=ut(t)}catch(e){}throw new ge(401==i||403==i?2:1,1,1001,n,i,r,e,a)}function Ns(e,t,i,n){var r=new Ns.b;$e(t.headers).forEach(function(e,t){r.append(t,e)});var a=new Ns.a,s={Ad:!1,ie:!1};if(e=new ye(e=Ns.l(e,i,{body:t.body||void 0,headers:r,method:t.method,signal:a.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},s,n),function(){return s.Ad=!0,a.abort(),Promise.resolve()}),t=t.retryParameters.timeout){var o=new de(function(){s.ie=!0,a.abort()});o.P(t/1e3),e.finally(function(){o.stop()})}return e}function Ms(o,t,l,i){var n=new Ms.f,r=Date.now(),u=0;return new ye(new Promise(function(a,s){for(var e in n.open(t.method,o,!0),n.responseType="arraybuffer",n.timeout=t.retryParameters.timeout,n.withCredentials=t.allowCrossSiteCredentials,n.onabort=function(){s(new ge(1,1,7001,o,l))},n.onload=function(e){for(var t=(e=e.target).getAllResponseHeaders().trim().split("\r\n"),i={},n=(t=q(t)).next();!n.done;n=t.next())i[(n=n.value.split(": "))[0].toLowerCase()]=n.slice(1).join(": ");try{var r=Ds(i,e.response,e.status,o,e.responseURL,l);a(r)}catch(e){s(e)}},n.onerror=function(e){s(new ge(1,1,1002,o,e,l))},n.ontimeout=function(){s(new ge(1,1,1003,o,l))},n.onprogress=function(e){var t=Date.now();(100<t-r||e.lengthComputable&&e.loaded==e.total)&&(i(t-r,e.loaded-u,e.total-e.loaded),u=e.loaded,r=t)},t.headers)n.setRequestHeader(e.toLowerCase(),t.headers[e]);n.send(t.body)}),function(){return n.abort(),Promise.resolve()})}function Bs(){this.a=this.f=this.b=0,this.c=new Map,this.g=0}function Us(e,t,i){this.h=e,this.b=new Map,this.c=!1,this.g=t,this.f=i,this.a=new Bs}function Fs(l,e,u,t,c,h){var d=function(e,t){e.b+=t;var i=e.g;return e.g++,e.c.set(i,t),i}(l.a,t);t=l.b.get(e)||Promise.resolve(),l.b.set(e,t.then(function(){return z(function e(){var a,s,o;return X(e,function(e){switch(e.j){case 1:return Y(e,(n=l,r=u,z(function e(){var t;return X(e,function(e){switch(e.j){case 1:return Y(e,n.h.request(1,r).promise,2);case 2:return t=e.o,e.return(t.data)}})})),2);case 2:if(a=e.o,l.c)throw new ge(2,9,7001);if(c){s=new Uint8Array(a);for(var t=q(new Yn(s).data),i=t.next();!i.done;i=t.next())o=i.value,l.f(o)}return l.a.close(d,a.byteLength),t=l.a,l.g(0==t.b?0:t.f/t.b,l.a.a),e.return(h(a))}var n,r})})}))}function js(e,t){var i=this;this.c=e,this.b=e.objectStore(t),this.a=new ve,e.onabort=function(e){e.preventDefault(),i.a.reject()},e.onerror=function(e){e.preventDefault(),i.a.reject()},e.oncomplete=function(){i.a.resolve()}}function Hs(n,r){return new Promise(function(t,e){var i=n.b.openCursor();i.onerror=e,i.onsuccess=function(e){if(!(e=e.target.result))return t();r(e.key,e.value,e),e.continue()}})}function Gs(e){this.b=e,this.a=[]}function Vs(e,t){return Ws(e,t,"readonly")}function Ks(e,t){return Ws(e,t,"readwrite")}function Ws(e,t,i){var n=new js(i=e.b.transaction([t],i),t);return e.a.push(n),n.promise().then(function(){Pe(e.a,n)},function(){Pe(e.a,n)}),n}function qs(e){this.a=new Gs(e)}function zs(){this.a=new Map}function Ys(e,t,i){if(!(e=e.a.get(t)))throw new ge(2,9,9013,"Could not find mechanism with name "+t);if(!(t=e.getCells().get(i)))throw new ge(2,9,9013,"Could not find cell with name "+i);return t}function Xs(e,t){$s.set(e,t)}ls.prototype.destroy=function(){for(var e=q(this.b.values()),t=e.next();!t.done;t=e.next())Rs(t.value);return this.b.clear(),this.i.clear(),this.g=this.h=this.u=this.c=this.a=null,this.f=!0,Promise.resolve()},ls.prototype.configure=function(e){this.g=e,this.F=new fe({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0},!0)},ls.prototype.start=function(){var r=this;return z(function e(){var t,i,n;return X(e,function(e){switch(e.j){case 1:return t=r.a.Ua(),i=As(r,t),(n=r.a.Od(r.c.periods[i])).variant||n.text?Y(e,vs(r,n.variant?n.variant.audio:null,n.variant?n.variant.video:null,n.text,t),2):e.return(new ge(2,5,5005));case 2:if(r.f)return e.return();r.a&&r.a.lf&&r.a.lf(),F(e)}})})},ls.prototype.K=function(e,t,i,n){var r=n.reader.gd(),a=n.reader.gd(),s=n.reader.G(),o=n.reader.G(),l=n.reader.G(),u=n.reader.G();n=n.reader.Za(n.reader.J.byteLength-n.reader.ca()),e=e.startTime+t.startTime+o/s,i.includes(r)&&("urn:mpeg:dash:event:2012"==r?this.a.mf():this.a.onEvent(new Ce("emsg",{detail:{startTime:e,endTime:e+l/s,schemeIdUri:r,value:a,timescale:s,presentationTimeDelta:o,eventDuration:l,id:u,messageData:n}})))},B("shaka.net.HttpFetchPlugin",Ns),Ns.l=function(f,p,m,g,v){return z(function e(){var t,i,n,r,a,s,o,l,u,c,h,d;return X(e,function(e){switch(e.j){case 1:return t=Ns.g,i=Ns.c,s=a=0,o=Date.now(),E(e,2),Y(e,t(f,m),4);case 4:return n=e.o,l=n.clone().body.getReader(),c=(u=n.headers.get("Content-Length"))?parseInt(u,10):0,new i({start:function(r){!function n(){return z(function e(){var t,i;return X(e,function(e){switch(e.j){case 1:return E(e,2),Y(e,l.read(),4);case 4:t=e.o,S(e,3);break;case 2:return w(e),e.return();case 3:t.done||(a+=t.value.byteLength),(100<(i=Date.now())-o||t.done)&&(v(i-o,a-s,c-a),s=a,o=i),t.done?r.close():(r.enqueue(t.value),n()),F(e)}})})}()}}),Y(e,n.arrayBuffer(),5);case 5:r=e.o,S(e,3);break;case 2:if(h=w(e),g.Ad)throw new ge(1,1,7001,f,p);if(g.ie)throw new ge(1,1,1003,f,p);throw new ge(1,1,1002,f,h,p);case 3:return d={},n.headers.forEach(function(e,t){d[t.trim()]=e}),e.return(Ds(d,r,n.status,f,n.url,p))}})})},Ns.isSupported=Ns.isSupported=function(){if(!d.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!(!d.fetch||!d.AbortController)},Ns.g=d.fetch,Ns.a=d.AbortController,Ns.c=d.ReadableStream,Ns.b=d.Headers,Ns.isSupported()&&(Me("http",Ns,2),Me("https",Ns,2)),B("shaka.net.HttpXHRPlugin",Ms),Ms.f=d.XMLHttpRequest,Me("http",Ms,1),Me("https",Ms,1),Bs.prototype.close=function(e,t){if(this.c.has(e)){var i=this.c.get(e);this.c.delete(e),this.f+=i,this.a+=t}},Us.prototype.destroy=function(){return this.c=!0,Promise.all(this.b.values()).then(function(){},function(){})},js.prototype.abort=function(){try{this.c.abort()}catch(e){}return this.a.catch(function(){})},js.prototype.store=function(){return this.b},js.prototype.promise=function(){return this.a},Gs.prototype.destroy=function(){return Promise.all(this.a.map(function(e){return e.abort()}))},qs.prototype.destroy=function(){return this.a.destroy()},qs.prototype.getAll=function(){var n=this;return z(function e(){var t,i;return X(e,function(e){switch(e.j){case 1:return t=Vs(n.a,"session-ids"),i=[],Y(e,Hs(t,function(e,t){i.push(t)}),2);case 2:return Y(e,t.promise(),3);case 3:return e.return(i)}})})},qs.prototype.add=function(e){for(var t=Ks(this.a,"session-ids"),i=t.store(),n=(e=q(e)).next();!n.done;n=e.next())i.add(n.value);return t.promise()},qs.prototype.remove=function(n){var i=this;return z(function e(){var t;return X(e,function(e){switch(e.j){case 1:return Y(e,Hs(t=Ks(i.a,"session-ids"),function(e,t,i){0<=n.indexOf(t.sessionId)&&i.delete()}),2);case 2:return Y(e,t.promise(),0)}})})},zs.prototype.destroy=function(){for(var e=[],t=q(this.a.values()),i=t.next();!i.done;i=t.next())e.push(i.value.destroy());return this.a.clear(),Promise.all(e)},zs.prototype.init=function(){var n=this;$s.forEach(function(e,t){var i=e();i&&n.a.set(t,i)});for(var e=[],t=q(this.a.values()),i=t.next();!i.done;i=t.next())e.push(i.value.init());return Promise.all(e)},zs.prototype.erase=function(){var n=this;return z(function e(){var t,i;return X(e,function(e){switch(e.j){case 1:return t=Array.from(n.a.values()),(i=0<t.length)||$s.forEach(function(e){(e=e())&&t.push(e)}),Y(e,Promise.all(t.map(function(e){return e.erase()})),2);case 2:if(!i)return Y(e,Promise.all(t.map(function(e){return e.destroy()})),0);e.A(0)}})})},B("shaka.offline.StorageMuxer.register",Xs),B("shaka.offline.StorageMuxer.unregister",function(e){$s.delete(e)});var $s=new Map;function Js(e){this.a=new Gs(e)}function Qs(e){return Promise.reject(new ge(2,9,9011,"Cannot add new value to "+e))}function Zs(e,t,i,n){var r=(e=Ks(e.a,t)).store();return i.forEach(function(e){r.delete(e).onsuccess=function(){return n(e)}}),e.promise()}function eo(e,t,i){var n=(e=Vs(e.a,t)).store(),r={},a=[];return i.forEach(function(t){n.get(t).onsuccess=function(e){null==(e=e.target.result)&&a.push(t),r[t]=e}}),e.promise().then(function(){return a.length?Promise.reject(new ge(2,9,9012,"Could not find values for "+a)):i.map(function(e){return r[e]})})}function to(e){return{originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,periods:e.periods.map(io),sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata}}function io(e){return function(e){var t=e.streams.filter(function(e){return"audio"==e.contentType}),n=e.streams.filter(function(e){return"video"==e.contentType});if(!t.every(function(e){return e.variantIds})||!n.every(function(e){return e.variantIds})){t.forEach(function(e){e.variantIds=[]}),n.forEach(function(e){e.variantIds=[]});var r=0;if(n.length&&!t.length){var i=r++;n.forEach(function(e){e.variantIds.push(i)})}if(!n.length&&t.length){var a=r++;t.forEach(function(e){e.variantIds.push(a)})}n.length&&t.length&&t.forEach(function(i){n.forEach(function(e){var t=r++;i.variantIds.push(t),e.variantIds.push(t)})})}}(e),e.streams.forEach(function(){}),{startTime:e.startTime,streams:e.streams.map(no)}}function no(e){var t=e.df?so(e.df):null;return{id:e.id,originalId:null,primary:e.primary,presentationTimeOffset:e.presentationTimeOffset,contentType:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,initSegmentKey:t,encrypted:e.encrypted,keyId:e.keyId,segments:e.segments.map(ro),variantIds:e.variantIds}}function ro(e){var t=so(e.uri);return{startTime:e.startTime,endTime:e.endTime,dataKey:t}}function ao(e){return{data:e.data}}function so(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new ge(2,9,9004,"Could not parse uri "+e)}function oo(e,t,i,n){this.a=new Gs(e),this.c=t,this.b=i,this.f=n}function lo(e,t,i){if(e.f)return Promise.reject(new ge(1,9,9011,"Cannot add new value to "+t));var n=(e=Ks(e.a,t)).store(),r=[];return i.forEach(function(e){n.add(e).onsuccess=function(e){r.push(e.target.result)}}),e.promise().then(function(){return r})}function uo(e,t,i,n){var r=(e=Ks(e.a,t)).store();return i.forEach(function(e){r.delete(e).onsuccess=function(){return n(e)}}),e.promise()}function co(e,t,i){var n=(e=Vs(e.a,t)).store(),r={},a=[];return i.forEach(function(e){var t=n.get(e);t.onsuccess=function(){null==t.result&&a.push(e),r[e]=t.result}}),e.promise().then(function(){return a.length?Promise.reject(new ge(1,9,9012,"Could not find values for "+a)):i.map(function(e){return r[e]})})}function ho(){this.g=this.c=this.b=this.a=this.f=null}function fo(e,t,i,n){this.a=e,this.g=t,this.f=i,this.c=n,this.b=["offline:",e,"/",t,"/",i,"/",n].join("")}function po(e){if(null==(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var i=e[2];if(!i)return null;var n=e[3];return n&&null!=t?new fo(t,i,n,Number(e[4])):null}function mo(e,t){this.b=e,this.a=t}function go(i,t,n){var e=t.streams.filter(function(e){return"audio"==e.contentType}),r=t.streams.filter(function(e){return"video"==e.contentType});return e=function(e,t,i){for(var n=new Set,r=q(t),a=r.next();!a.done;a=r.next()){var s=q(a.value.variantIds);for(a=s.next();!a.done;a=s.next())n.add(a.value)}for(r=q(i),a=r.next();!a.done;a=r.next())for(s=q(a.value.variantIds),a=s.next();!a.done;a=s.next())n.add(a.value);for(r=new Map,n=q(n),a=n.next();!a.done;a=n.next())a=a.value,r.set(a,{id:a,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0});for(t=q(t),n=t.next();!n.done;n=t.next())for(n=n.value,a=vo(e,n),s=q(n.variantIds),n=s.next();!n.done;n=s.next())(n=r.get(n.value)).language=a.language,n.primary=n.primary||a.primary,n.audio=a;for(i=q(i),t=i.next();!t.done;t=i.next())for(n=t.value,t=vo(e,n),a=q(n.variantIds),n=a.next();!n.done;n=a.next())(n=r.get(n.value)).primary=n.primary||t.primary,n.video=t;return r}(i,e,r),r=t.streams.filter(function(e){return"text"==e.contentType}).map(function(e){return vo(i,e)}),t.streams.forEach(function(e){e=e.segments.map(function(e,t){return yo(i,t,e)}),n.ub(e,t.startTime)}),{startTime:t.startTime,variants:Array.from(e.values()),textStreams:r}}function vo(i,e){var t,n,r,a=e.segments.map(function(e,t){return yo(i,t,e)}),s=new lr(a);return a={id:e.id,originalId:e.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return s.find(e)},getSegmentReference:function(e){return s.get(e)},initSegmentReference:null,presentationTimeOffset:e.presentationTimeOffset,mimeType:e.mimeType,codecs:e.codecs,width:e.width||void 0,height:e.height||void 0,frameRate:e.frameRate||void 0,pixelAspectRatio:e.pixelAspectRatio||void 0,kind:e.kind,encrypted:e.encrypted,keyId:e.keyId,language:e.language,label:e.label||null,type:e.contentType,primary:e.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},null!=e.initSegmentKey&&(a.initSegmentReference=(t=i,n=e.initSegmentKey,r=new fo("segment",t.b,t.a,n),new ar(function(){return[r.toString()]},0,null))),a}function yo(e,t,i){var n=new fo("segment",e.b,e.a,i.dataKey);return new sr(t,i.startTime,i.endTime,function(){return[n.toString()]},0,null)}function bo(){this.a=null}function _o(e){var t=po(e);return t&&"manifest"==t.a?_o.h(e):t&&"segment"==t.a?_o.i(t.key(),t):be(new ge(2,1,9004,e))}function To(b,_,T){return z(function e(){var f,p,m,g,v,y;return X(e,function(e){switch(e.j){case 1:f=[];for(var t=[],i=q(T),n=i.next();!n.done;n=i.next()){n=n.value;for(var r=!1,a=q(t),s=a.next();!s.done;s=a.next())if(s=s.value,o=s.info,l=n,o.keySystem==l.keySystem&&o.licenseUri==l.licenseUri&&Le(o.audioCapabilities,l.audioCapabilities,u)&&Le(o.videoCapabilities,l.videoCapabilities,u)){s.sessionIds.push(n.sessionId),r=!0;break}r||t.push({info:n,sessionIds:[n.sessionId]})}p=q(t),m=p.next();case 2:if(m.done){e.A(4);break}return g=m.value,c=b,h=_,d=g,v=z(function e(){var l,u;return X(e,function(e){switch(e.j){case 1:return l=new mt({tb:h,onError:function(){},mc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),E(e,2),l.configure(c),Y(e,(t=l,i=d.info.keySystem,n=d.info.licenseUri,r=d.info.serverCertificate,a=d.info.audioCapabilities,s=d.info.videoCapabilities,(o=new Map).set(i,{audioCapabilities:a,videoCapabilities:s,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:i,drmInfos:[{keySystem:i,licenseServerUri:n,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:r,initData:null,keyIds:null}]}),wt(t,o)),4);case 4:S(e,3);break;case 2:return w(e),Y(e,l.destroy(),5);case 5:return e.return([]);case 3:return E(e,6),Y(e,yt(l),8);case 8:S(e,7);break;case 6:return w(e),Y(e,l.destroy(),9);case 9:return e.return([]);case 7:return u=[],Y(e,Promise.all(d.sessionIds.map(function(t){return z(function e(){return X(e,function(e){switch(e.j){case 1:return E(e,2),Y(e,(r=l,a=t,z(function e(){var t,i,n;return X(e,function(e){switch(e.j){case 1:return Y(e,Ct(r,a),2);case 2:return(t=e.o)?(i=[],(n=r.b.get(t))&&(n.ya=new ve,i.push(n.ya)),i.push(t.remove()),Y(e,Promise.all(i),0)):e.return()}})})),4);case 4:u.push(t),S(e,0);break;case 2:w(e),F(e)}var r,a})})})),10);case 10:return Y(e,l.destroy(),11);case 11:return e.return(u)}var t,i,n,r,a,s,o})}),Y(e,v,5);case 5:y=e.o,f=f.concat(y),m=p.next(),e.A(2);break;case 4:return e.return(f)}var c,h,d,o,l;function u(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}})})}function So(e,t){var i=Sl(),n=this;this.g=t,this.c=e,this.i=i,this.h=null,this.f=[],this.b=this.a=null,this.l=!0,this.m=Promise.resolve().then(function(){return r=n,z(function e(){return X(e,function(e){switch(e.j){case 1:if(r.l){if(0==r.f.length||r.a&&!r.a.Va)var t=!1;else{r.a&&(r.a.va.Ya(),r.a=null);var i=(t=r.f.shift()).create(r.i);i?(t.va.vb(),r.a={node:i.node,payload:i.payload,Va:i.Va,va:t.va}):t.va.nc(),t=!0}return t=t?Promise.resolve():r.a?(n=r,z(function e(){var t,i;return X(e,function(e){switch(e.j){case 1:return n.c=n.g.Te(n.c,n.i,n.a.node,n.a.payload),E(e,2),n.b=n.g.Be(n.c,n.i,n.a.payload),Y(e,n.b.promise,4);case 4:n.b=null,n.c==n.a.node&&(n.a.va.lc(),n.a=null),S(e,0);break;case 2:return 7001==(t=w(e)).code?n.a.va.Ya():n.a.va.onError(t),n.a=null,n.b=null,Y(e,(i=n).g.handleError(n.i,t),5);case 5:i.c=e.o,F(e)}})})):(r.g.kf(r.c),r.h=new ve,r.h),Y(e,t,1)}e.A(0)}var n})});var r})}function Eo(e,t){var i={vb:function(){},lc:function(){},Ya:function(){},onError:function(){},nc:function(){},xg:function(){}};return e.f.push({create:t,va:i}),e.b&&e.b.abort(),wo(e),i}function wo(e){e.h&&(e.h.resolve(),e.h=null)}function Co(e){this.a=null;for(var t=0;t<e.textTracks.length;++t){var i=e.textTracks[t];i.mode="disabled","Shaka Player TextTrack"==i.label&&(this.a=i)}this.a||(this.a=e.addTextTrack("subtitles","Shaka Player TextTrack")),this.a.mode="hidden"}function ko(e){if(e.startTime>=e.endTime)return null;var t=new VTTCue(e.startTime,e.endTime,e.payload);t.lineAlign=e.lineAlign,t.positionAlign=e.positionAlign,t.size=e.size;try{t.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=t.align&&(t.align="middle"),"vertical-lr"==e.writingMode?t.vertical="lr":"vertical-rl"==e.writingMode&&(t.vertical="rl"),1==e.lineInterpretation&&(t.snapToLines=!1),null!=e.line&&(t.line=e.line),null!=e.position&&(t.position=e.position),t}function Ao(e,t){var i=e.mode;e.mode="showing"==i?"showing":"hidden";for(var n=e.cues,r=n.length-1;0<=r;r--){var a=n[r];a&&t(a)&&e.removeCue(a)}e.mode=i}function Io(e,t,i,n,r){var a,s=r in n,o=!0;for(a in t){var l=r+"."+a,u=s?n[r]:i[a];s||a in i?void 0===t[a]?void 0===u||s?delete e[a]:e[a]=Ie(u):u.constructor==Object&&t[a]&&t[a].constructor==Object?(e[a]||(e[a]=Ie(u)),l=Io(e[a],t[a],u,n,l),o=o&&l):typeof t[a]!=typeof u||null==t[a]||t[a].constructor!=u.constructor?o=!1:e[a]=t[a]:o=!1}return o}function xo(e,t){for(var i={},n=i,r=0,a=0;!((r=e.indexOf(".",r))<0);)0!=r&&"\\"==e[r-1]||(n[a=e.substring(a,r).replace(/\\\./g,".")]={},n=n[a],a=r+1),r+=1;return n[e.substring(a).replace(/\\\./g,".")]=t,i}function Po(){}function Lo(){var e=5e5,t=1/0;navigator.connection&&(e=1e6*navigator.connection.downlink,navigator.connection.saveData&&(t=360));var i={retryParameters:me(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:At,fairPlayTransform:!0},n={retryParameters:me(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,dash:{customScheme:function(e){if(e)return null},clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1},hls:{ignoreTextStreamFailures:!1}},r={retryParameters:me(),failureCallback:function(){},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0};nt("Web0S")&&(r.stallEnabled=!1);var a={trackSelectionCallback:function(e){return e},progressCallback:function(){},usePersistentLicense:!0},s={drm:i,manifest:n,streaming:r,offline:a,abrFactory:Qi,abr:{enabled:!0,defaultBandwidthEstimate:e,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:t,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null}};return a.trackSelectionCallback=function(e){return function(e,t){var i=e.filter(function(e){return"variant"==e.type}),n=[],r=Mi(t,i.map(function(e){return e.language}));r&&(n=i.filter(function(e){return Di(e.language)==r})),0==n.length&&(n=i.filter(function(e){return e.primary})),0==n.length&&(i.map(function(e){return e.language}),n=i);var a=n.filter(function(e){return e.height&&e.height<=480});if(a.length&&(a.sort(function(e,t){return t.height-e.height}),n=a.filter(function(e){return e.height==a[0].height})),i=[],n.length){var s=Math.floor(n.length/2);n.sort(function(e,t){return e.bandwidth-t.bandwidth}),i.push(n[s])}for(n=q(e),s=n.next();!s.done;s=n.next())"text"==(s=s.value).type&&i.push(s);return i}(e,s.preferredAudioLanguage)},s}function Ro(e,t,i){var n={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return Io(e,t,i||Lo(),n,"")}function Oo(){this.a=null,this.b=[]}function Do(e,t){if(null==e.a)e.a={timestamp:Date.now()/1e3,state:t,duration:0};else{var i=Date.now()/1e3;e.a.duration=i-e.a.timestamp,e.a.state!=t&&(e.b.push(e.a),e.a={timestamp:i,state:t,duration:0})}}function No(e,t){var i=0;e.a&&e.a.state==t&&(i+=e.a.duration);for(var n=q(e.b),r=n.next();!r.done;r=n.next())i+=(r=r.value).state==t?r.duration:0;return i}function Mo(){this.b=this.c=null,this.a=[]}function Bo(){this.f=this.s=this.h=this.b=this.i=this.l=this.m=this.g=this.u=NaN,this.a=new Oo,this.c=new Mo}function Uo(e,t){var i,o=this;Ae.call(this),this.i=Cl,this.a=null,this.gb=!1,this.g=new Ke,this.zc=this.l=this.Eb=this.b=this.s=this.f=this.Wb=this.C=this.Xb=this.W=this.ib=this.m=this.F=this.h=this.K=null,this.Kd=1e9,this.Zb=new Set,this.kb=!0,this.pa=null,this.Hd=!1,this.Fd=0,this.oa=null,this.$=new ba,this.c=Yo(this),this.$b={width:1/0,height:1/0},this.u=null,this.Fb=new Ia(this.c.preferredAudioLanguage,this.c.preferredVariantRole,this.c.preferredAudioChannelCount),this.na=this.c.preferredTextLanguage,this.fb=this.c.preferredTextRole,t&&t(this),this.K=(i=this,new De(function(e,t){i.l&&i.l.segmentDownloaded(e,t)})),this.g.w(d,"online",function(){o.nd()}),this.D={name:"detach"},this.R={name:"attach"},this.Ha={name:"unload"},this.Ic={name:"manifest-parser"},this.Gc={name:"manifest"},this.hb={name:"media-source"},this.Ac={name:"drm-engine"},this.S={name:"load"},this.Nc={name:"src-equals-drm-engine"},this.jb={name:"src-equals"};var n=new Map;n.set(this.R,function(e,t){return Se((i=o,r=t,null==(n=e).v&&(n.v=r.v,i.g.w(n.v,"error",function(){var e=cl(i);e&&i.Ma(e)})),i.a=n.v,Promise.resolve()));var i,n,r}),n.set(this.D,function(e){return e.v&&(o.g.ea(e.v,"error"),e.v=null),o.a=null,Se(e=Promise.resolve())}),n.set(this.Ha,function(e){return Se(Go(o,e))}),n.set(this.hb,function(e){var a,s;return a=o,s=e,Se(e=z(function e(){var t,i,n,r;return X(e,function(e){switch(e.j){case 1:return t=new(d.muxjs?Bt:Ut),i=a.c.textDisplayFactory,n=new i,a.Bc=i,Y(e,(r=new bi(s.v,t,n)).s,2);case 2:a.F=r,F(e)}})}))}),n.set(this.Ic,function(e,t){var r,a,s;return Se((r=o,a=e,s=t,z(function e(){var t,i,n;return X(e,function(e){switch(e.j){case 1:if(a.Aa=s.Aa,a.mimeType=s.mimeType,a.uri=s.uri,t=a.uri,i=r.K,r.Eb=t,a.Aa){r.s=a.Aa(),e.A(2);break}return n=r,Y(e,wr.create(t,i,r.c.manifest.retryParameters,a.mimeType),3);case 3:n.s=e.o;case 2:r.s.configure(r.c.manifest),F(e)}})})))}),n.set(this.Gc,function(e){return function(r,e){var a=e.uri,t=r.K;r.Wb=new ns,function(e,t){e.b=t}(r.Wb,function(e){ul(r,"timelineregionadded",e)});var s={networkingEngine:t,filterNewPeriod:function(e){return r.Jc(e)},filterAllPeriods:function(e){return Xo(r,e)},onTimelineRegionAdded:function(e){var t=r.Wb;e:{for(var i=q(t.a),n=i.next();!n.done;n=i.next())if((n=n.value).schemeIdUri==e.schemeIdUri&&n.id==e.id&&n.startTime==e.startTime&&n.endTime==e.endTime){i=n;break e}i=null}null==i&&(t.a.add(e),t.b(e))},onEvent:function(e){return r.dispatchEvent(e)},onError:function(e){return r.Ma(e)}};return new ye(Promise.resolve().then(function(){return z(function e(){var n;return X(e,function(e){switch(e.j){case 1:return Y(e,(n=r).s.start(a,s),2);case 2:if(n.b=e.o,r.dispatchEvent(new Ce("manifestparsed")),0==r.b.periods.length)throw new ge(2,4,4014);(i=r.b.periods).some(function(e){return e.variants.some(t)})&&i.forEach(function(e){e.variants=e.variants.filter(t)}),F(e)}function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}var i})})}),function(){return r.s.stop()})}(o,e)}),n.set(this.Ac,function(){var i;return Se((i=o,z(function e(){return X(e,function(e){switch(e.j){case 1:return i.h=new mt({tb:i.K,onError:function(e){i.Ma(e)},mc:function(e){hl(i,e)},onExpirationUpdated:function(e,t){dl(i,e,t)},onEvent:function(e){i.dispatchEvent(e)}}),i.h.configure(i.c.drm),Y(e,gt(i.h,ja(i.b.periods),i.b.offlineSessionIds),2);case 2:Xo(i,i.b.periods),F(e)}})})))}),n.set(this.S,function(e,t){return Se((S=o,E=e,w=t,z(function e(){var f,p,m,g,v,y,b,_,T;return X(e,function(e){switch(e.j){case 1:return E.startTime=w.startTime,f=E.v,p=E.uri,S.Eb=p,S.u=new Bo,m=function(){return Zo(S)},g=function(){var e=S.a.playbackRate;0!=e&&S.W.set(e)},S.g.w(f,"playing",m),S.g.w(f,"pause",m),S.g.w(f,"ended",m),S.g.w(f,"ratechange",g),v=S.c.abrFactory,S.l&&S.zc==v||(S.zc=v,S.l=new v,S.l.configure(S.c.abr)),function(e,t){for(var i=0;i<t.length;i++){for(var n=t[i],r=new Map,a=q(n.variants),s=a.next();!s.done;s=a.next())if((s=s.value).video&&s.video.closedCaptions)for(var o=q((s=s.video).closedCaptions.keys()),l=o.next();!l.done;l=o.next())if(l=l.value,!r.has(l)){var u={id:e.Kd++,originalId:l,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",codecs:"",kind:"caption",encrypted:!1,keyId:null,language:s.closedCaptions.get(l),label:null,type:"text",primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:s.roles,channelsCount:null,audioSamplingRate:null,closedCaptions:null};r.set(l,u)}for(r=q(r.values()),a=r.next();!a.done;a=r.next())n.textStreams.push(a.value)}}(S,S.b.periods),S.Fb=new Ia(S.c.preferredAudioLanguage,S.c.preferredVariantRole,S.c.preferredAudioChannelCount),S.na=S.c.preferredTextLanguage,c=S.b.presentationTimeline,h=S.c.playRangeStart,d=S.c.playRangeEnd,0<h&&(c.V()||c.fe(h)),d<c.Y()&&(c.V()||c.xa(d)),Y(e,S.h.Gb(f),2);case 2:return S.l.init(function(e,t,i){t=void 0!==t&&t,i=void 0===i?0:i;e:{for(var n=q(S.b.periods),r=n.next();!r.done;r=n.next())if((r=r.value).variants.includes(e)){n=r;break e}n=null}qo(S,n,e,!0),S.f&&(ps(S.f,e,t,i),nl(S))}),S.m=(l=S,u=E.startTime,new Za(l.a,l.b,l.c.streaming,u,function(){l.ib&&Fa(l.ib,!0),l.f&&function(i){function e(e){var t=i.a.L;return e="text"==e?null!=(e=t.a).a&&null!=e.b&&n>=e.a&&n<e.b:jt(e=ki(t,e),n,r)}var n=i.a.Ua(),r=i.g.smallGapLimit,t=As(i,n);if(Xe(i.b.values(),function(e){return e.ia==t}))for(var a=q(i.b.keys()),s=a.next();!s.done;s=a.next())e(s=s.value)||gs(i,i.b.get(s));else Xe(i.b.keys(),e)||i.b.forEach(function(e){gs(i,e)})}(l.f),l.C&&Ko(l)},function(e){return l.dispatchEvent(e)})),S.ib=function(i){var e=new Ga(i.b);!function(e,t){e.b=t}(e,function(){rl(i)});var t=new rs(i.Wb);!function(e,t,i,n){e.a=t,e.b=i,e.c=n}(t,function(e){ul(i,"timelineregionenter",e)},function(e){ul(i,"timelineregionexit",e)},function(e,t){t||(ul(i,"timelineregionenter",e),ul(i,"timelineregionexit",e))});var n=new Ua(i.a);return n.a.add(e),n.a.add(t),n}(S),S.W=new Va({gc:function(){return E.v.playbackRate},rd:function(e){E.v.playbackRate=e},Ld:function(e){E.v.currentTime+=e}}),y=Math.max(S.b.minBufferTime,S.c.streaming.rebufferingGoal),Vo(S,y),S.f=new ls((o=S).b,{Ua:function(){return o.m.h()},getBandwidthEstimate:function(){return o.l.getBandwidthEstimate()},L:o.F,tb:o.K,Od:o.hf.bind(o),Nd:o.ve.bind(o),onError:o.Ma.bind(o),onEvent:function(e){return o.dispatchEvent(e)},mf:o.nf.bind(o),dd:o.uf.bind(o)}),S.f.configure(S.c.streaming),function(e){function i(e){var t="";e.video&&(t=Ze(e.video.codecs)[0]);var i="";return e.audio&&(i=Ze(e.audio.codecs)[0]),t+"-"+i}var t=e.b.periods.reduce(function(e,t){return e.concat(t.variants)},[]);t=Yi(t,e.c.preferredAudioChannelCount);var n=new ke;t.forEach(function(e){var t=i(e);n.push(t,e)});var a=null,s=1/0;n.forEach(function(e,t){var i=0,n=0;t.forEach(function(e){i+=e.bandwidth||0,++n});var r=i/n;r<s&&(a=e,s=r)}),e.b.periods.forEach(function(e){e.variants=e.variants.filter(function(e){return i(e)==a})})}(S),S.i=kl,S.dispatchEvent(new Ce("streaming")),Y(e,S.f.start(),3);case 3:S.c.streaming.startAtSegmentBoundary&&(b=S.m.h(),n=b,r=us((i=S).f),a=cs(i.f),s=yl(i),r=t(r,n),_=null!=(a=t(a,n))&&null!=r?Math.max(a,r):null!=a?a:null!=r?r:n,S.m.m(_)),S.b.periods.forEach(S.Jc.bind(S)),rl(S),nl(S),(T=yl(S)||S.b.periods[0]).variants.some(function(e){return e.primary}),el(S,T.variants),S.g.da(f,"loadeddata",function(){S.u.b=Date.now()/1e3-w.ud}),F(e)}function t(e,t){if(!e)return null;var i=e.findSegmentPosition(t-s.startTime);return null!=i&&(i=e.getSegmentReference(i))?i.startTime+s.startTime:null}var i,n,r,a,s,o,l,u,c,h,d})})));var S,E,w}),n.set(this.Nc,function(e){var n,r;return n=o,r=e,Se(e=z(function e(){var t,i;return X(e,function(e){switch(e.j){case 1:return t=qt,n.h=new mt({tb:n.K,onError:function(e){n.Ma(e)},mc:function(e){hl(n,e)},onExpirationUpdated:function(e,t){dl(n,e,t)},onEvent:function(e){n.dispatchEvent(e)}}),n.h.configure(n.c.drm),i={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:t.Pa,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},Y(e,gt(n.h,[i],[]),2);case 2:return Y(e,n.h.Gb(r.v),0)}})}))}),n.set(this.jb,function(e,t){return function(e,t,i){function n(){return Zo(e)}if(t.uri=i.uri,t.startTime=i.startTime,e.Eb=t.uri,e.u=new Bo,e.m=new Qa(t.v),null!=t.startTime&&e.m.m(t.startTime),e.W=new Va({gc:function(){return t.v.playbackRate},rd:function(e){t.v.playbackRate=e},Ld:function(e){t.v.currentTime+=e}}),Vo(e,e.c.streaming.rebufferingGoal),e.g.w(t.v,"playing",n),e.g.w(t.v,"pause",n),e.g.w(t.v,"ended",n),e.g.da(t.v,"loadeddata",function(){e.u.b=Date.now()/1e3-i.ud}),e.a.audioTracks&&(e.g.w(e.a.audioTracks,"addtrack",function(){return rl(e)}),e.g.w(e.a.audioTracks,"removetrack",function(){return rl(e)}),e.g.w(e.a.audioTracks,"change",function(){return rl(e)})),e.a.textTracks){var r=e.a.textTracks;e.g.w(r,"addtrack",function(){return rl(e)}),e.g.w(r,"removetrack",function(){return rl(e)}),e.g.w(r,"change",function(){return rl(e)})}t.v.src=t.uri,e.i=Al,e.dispatchEvent(new Ce("streaming"));var a=new ve;return e.a.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA?a.resolve():e.a.error?a.reject(cl(e)):(e.g.da(e.a,"loadeddata",function(){a.resolve()}),e.g.da(e.a,"error",function(){a.reject(cl(e))})),new ye(a,function(){return a.reject(new ge(2,7,7001)),Promise.resolve()})}(o,e,t)}),this.lb=new So(this.D,{Te:function(e,t,i,n){var r=null;return e==o.D&&(r=i==o.D?o.D:o.R),e==o.R&&(r=i==o.D||t.v!=n.v?o.D:i==o.R?o.R:i==o.hb||i==o.S?o.hb:i==o.jb?o.Nc:null),e==o.hb&&(r=i==o.S&&t.v==n.v?o.Ic:o.Ha),e==o.Ic&&(r=Tl(o.S,o.Gc,o.Ha,i,t,n)),e==o.Gc&&(r=Tl(o.S,o.Ac,o.Ha,i,t,n)),e==o.Ac&&(r=Tl(o.S,o.S,o.Ha,i,t,n)),e==o.Nc&&(r=i==o.jb&&t.v==n.v?o.jb:o.Ha),e!=o.S&&e!=o.jb||(r=o.Ha),e==o.Ha&&(r=n.v&&t.v==n.v?o.R:o.D),r},Be:function(e,t,i){return o.dispatchEvent(new Ce("onstatechange",{state:e.name})),n.get(e)(t,i)},handleError:function(t){return z(function e(){return X(e,function(e){switch(e.j){case 1:return Y(e,Go(o,t),2);case 2:return e.return(t.v?o.R:o.D)}})})},kf:function(e){o.dispatchEvent(new Ce("onstateidle",{state:e.name}))}}),e&&this.Gb(e,!0)}(t=Js.prototype).destroy=function(){return this.a.destroy()},t.hasFixedKeySpace=function(){return!0},t.addSegments=function(){return Qs("segment")},t.removeSegments=function(e,t){return Zs(this,"segment",e,t)},t.getSegments=function(e){return eo(this,"segment",e).then(function(e){return e.map(ao)})},t.addManifests=function(){return Qs("manifest")},t.updateManifestExpiration=function(t,i){var e=Ks(this.a,"manifest"),n=e.store(),r=new ve;return n.get(t).onsuccess=function(e){(e=e.target.result)?(e.expiration=i,n.put(e),r.resolve()):r.reject(new ge(2,9,9012,"Could not find values for "+t))},e.promise().then(function(){return r})},t.removeManifests=function(e,t){return Zs(this,"manifest",e,t)},t.getManifests=function(e){return eo(this,"manifest",e).then(function(e){return e.map(to)})},t.getAllManifests=function(){var n=this;return z(function e(){var t,i;return X(e,function(e){switch(e.j){case 1:return t=Vs(n.a,"manifest"),i=new Map,Y(e,Hs(t,function(e,t){i.set(e,to(t))}),2);case 2:return Y(e,t.promise(),3);case 3:return e.return(i)}})})},(t=oo.prototype).destroy=function(){return this.a.destroy()},t.hasFixedKeySpace=function(){return this.f},t.addSegments=function(e){return lo(this,this.c,e)},t.removeSegments=function(e,t){return uo(this,this.c,e,t)},t.getSegments=function(e){return co(this,this.c,e)},t.addManifests=function(e){return lo(this,this.b,e)},t.updateManifestExpiration=function(t,i){var e=Ks(this.a,this.b),n=e.store();return n.get(t).onsuccess=function(e){(e=e.target.result)&&(e.expiration=i,n.put(e,t))},e.promise()},t.removeManifests=function(e,t){return uo(this,this.b,e,t)},t.getManifests=function(e){return co(this,this.b,e)},t.getAllManifests=function(){var n=this;return z(function e(){var t,i;return X(e,function(e){switch(e.j){case 1:return t=Vs(n.a,n.b),i=new Map,Y(e,Hs(t,function(e,t){i.set(e,t)}),2);case 2:return Y(e,t.promise(),3);case 3:return e.return(i)}})})},(t=ho.prototype).init=function(){var i=this,n=new ve,t=d.indexedDB.open("shaka_offline_db",4);return t.onsuccess=function(e){e=e.target.result;var t=(i.f=e).objectStoreNames;t=t.contains("manifest")&&t.contains("segment")?new Js(e):null,i.a=t,t=(t=e.objectStoreNames).contains("manifest-v2")&&t.contains("segment-v2")?new oo(e,"segment-v2","manifest-v2",!0):null,i.b=t,t=(t=e.objectStoreNames).contains("manifest-v3")&&t.contains("segment-v3")?new oo(e,"segment-v3","manifest-v3",!1):null,i.c=t,e=e.objectStoreNames.contains("session-ids")?new qs(e):null,i.g=e,n.resolve()},t.onupgradeneeded=function(e){e=e.target.result;for(var t=q(["segment-v3","manifest-v3","session-ids"]),i=t.next();!i.done;i=t.next())i=i.value,e.objectStoreNames.contains(i)||e.createObjectStore(i,{autoIncrement:!0})},t.onerror=function(e){n.reject(new ge(2,9,9001,t.error)),e.preventDefault()},n},t.destroy=function(){var t=this;return z(function e(){return X(e,function(e){switch(e.j){case 1:if(t.a)return Y(e,t.a.destroy(),2);e.A(2);break;case 2:if(t.b)return Y(e,t.b.destroy(),4);e.A(4);break;case 4:if(t.c)return Y(e,t.c.destroy(),6);e.A(6);break;case 6:if(t.g)return Y(e,t.g.destroy(),8);e.A(8);break;case 8:t.f&&t.f.close(),F(e)}})})},t.getCells=function(){var e=new Map;return this.a&&e.set("v1",this.a),this.b&&e.set("v2",this.b),this.c&&e.set("v3",this.c),e},t.getEmeSessionCell=function(){return this.g},t.erase=function(){var n=this;return z(function e(){return X(e,function(e){switch(e.j){case 1:if(n.a)return Y(e,n.a.destroy(),2);e.A(2);break;case 2:if(n.b)return Y(e,n.b.destroy(),4);e.A(4);break;case 4:if(n.c)return Y(e,n.c.destroy(),6);e.A(6);break;case 6:return n.f&&n.f.close(),Y(e,(t=new ve,(i=d.indexedDB.deleteDatabase("shaka_offline_db")).onblocked=function(){},i.onsuccess=function(){t.resolve()},i.onerror=function(e){t.reject(new ge(2,9,9001,i.error)),e.preventDefault()},t),8);case 8:return n.f=null,n.a=null,n.b=null,n.c=null,Y(e,n.init(),0)}var t,i})})},Xs("idb",function(){return d.indexedDB?new ho:null}),fo.prototype.wa=function(){return this.g},fo.prototype.ba=function(){return this.f},fo.prototype.key=function(){return this.c},fo.prototype.toString=function(){return this.b},(t=bo.prototype).configure=function(){},t.start=function(s){var o=this;return z(function e(){var t,i,n,r,a;return X(e,function(e){switch(e.j){case 1:return(t=po(s),null==(o.a=t)||"manifest"!=t.a)?e.return(Promise.reject(new ge(2,1,9004,t))):(i=new zs,L(e,2),Y(e,i.init(),4));case 4:return Y(e,Ys(i,t.wa(),t.ba()),5);case 5:return Y(e,e.o.getManifests([t.key()]),6);case 6:return n=e.o,r=n[0],a=new mo(t.wa(),t.ba()),e.return(function(t,e){var i=new Cr(null,0);i.xa(e.duration);var n=e.periods.map(function(e){return go(t,e,i)}),r=e.drmInfo?[e.drmInfo]:[];return e.drmInfo&&n.forEach(function(e){e.variants.forEach(function(e){e.drmInfos=r})}),{presentationTimeline:i,minBufferTime:2,offlineSessionIds:e.sessionIds,periods:n}}(a,r));case 2:return R(e),Y(e,i.destroy(),7);case 7:O(e,0)}})})},t.stop=function(){return Promise.resolve()},t.update=function(){},t.onExpirationUpdated=function(l,u){var c=this;return z(function e(){var t,i,n,r,a,s,o;return X(e,function(e){switch(e.j){case 1:return t=c.a,i=new zs,E(e,2,3),Y(e,i.init(),5);case 5:return Y(e,Ys(i,t.wa(),t.ba()),6);case 6:return Y(e,(n=e.o).getManifests([t.key()]),7);case 7:if(r=e.o,a=r[0],s=a.sessionIds.includes(l),o=null==a.expiration||a.expiration>u,s&&o)return Y(e,n.updateManifestExpiration(t.key(),u),3);e.A(3);break;case 3:return R(e),Y(e,i.destroy(),10);case 10:O(e,0);break;case 2:w(e),e.A(3)}})})},wr.Bb("application/x-offline-manifest",bo),B("shaka.offline.OfflineScheme",_o),_o.h=function(e){return Te(e={uri:e,fd:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}})},_o.i=function(e,t){var i=new zs;return Te(void 0).U(function(){return i.init()}).U(function(){return Ys(i,t.wa(),t.ba())}).U(function(e){return e.getSegments([t.key()])}).U(function(e){return{uri:t,fd:t,data:e[0].data,headers:{}}}).finally(function(){return i.destroy()})},Me("offline",_o),So.prototype.destroy=function(){var n=this;return z(function e(){return X(e,function(e){switch(e.j){case 1:return n.l=!1,n.b&&n.b.abort(),wo(n),Y(e,n.m,2);case 2:n.a&&n.a.va.Ya();for(var t=q(n.f),i=t.next();!i.done;i=t.next())i.value.va.Ya();n.a=null,n.f=[],n.g=null,F(e)}})})},B("shaka.text.SimpleTextDisplayer",Co),Co.prototype.remove=Co.prototype.remove=function(t,i){return!!this.a&&(Ao(this.a,function(e){return e.startTime<i&&e.endTime>t}),!0)},Co.prototype.append=Co.prototype.append=function(e){for(var t=ko,i=[],n=0;n<e.length;n++){var r=t(e[n]);r&&i.push(r)}i.slice().sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:i.indexOf(t)-i.indexOf(e)}).forEach(function(e){this.a.addCue(e)}.bind(this))},Co.prototype.destroy=Co.prototype.destroy=function(){return this.a&&Ao(this.a,function(){return 1}),this.a=null,Promise.resolve()},Co.prototype.isTextVisible=Co.prototype.isTextVisible=function(){return"showing"==this.a.mode},Co.prototype.setTextVisibility=Co.prototype.setTextVisibility=function(e){this.a.mode=e?"showing":"hidden"},B("shaka.util.ConfigUtils.mergeConfigObjects",Io),B("shaka.util.ConfigUtils.convertToConfigObject",xo),B("shaka.util.PlayerConfiguration",Po),Po.mergeConfigObjects=Ro,U(Uo,Ae),B("shaka.Player",Uo),Uo.prototype.destroy=Uo.prototype.destroy=function(){var i=this;return z(function e(){var t;return X(e,function(e){switch(e.j){case 1:return i.i==wl?e.return():(i.i=wl,t=Eo(i.lb,function(){return{node:i.D,payload:Sl(),Va:!1}}),Y(e,new Promise(function(e){t.vb=function(){},t.lc=function(){e()},t.Ya=function(){e()},t.onError=function(){e()},t.nc=function(){e()}}),2));case 2:return Y(e,i.lb.destroy(),3);case 3:if(i.g&&(i.g.release(),i.g=null),i.zc=null,i.l=null,i.c=null,i.K)return Y(e,i.K.destroy(),5);e.A(0);break;case 5:i.K=null,F(e)}})})},Uo.version="v2.5.8";var Fo=["2","5"];an=new function(e){this.a=e,this.c=nn,this.b=rn}(new en(Number(Fo[0]),Number(Fo[1])));var jo=["output-restricted","internal-error"],Ho={};function Go(t,i){return z(function e(){return X(e,function(e){switch(e.j){case 1:if(t.i!=wl&&(t.i=Cl),t.dispatchEvent(new Ce("unloading")),i.Aa=null,i.mimeType=null,i.startTime=null,i.uri=null,i.v&&(t.g.ea(i.v,"loadeddata"),t.g.ea(i.v,"playing"),t.g.ea(i.v,"pause"),t.g.ea(i.v,"ended"),t.g.ea(i.v,"ratechange")),t.ib&&(t.ib.release(),t.ib=null),t.Xb&&(t.Xb.stop(),t.Xb=null),t.s)return Y(e,t.s.stop(),3);e.A(2);break;case 3:t.s=null;case 2:if(t.l)return Y(e,t.l.stop(),4);e.A(4);break;case 4:if(t.f)return Y(e,t.f.destroy(),7);e.A(6);break;case 7:t.f=null;case 6:if(t.m&&(t.m.release(),t.m=null),t.F)return Y(e,t.F.destroy(),9);e.A(8);break;case 9:t.F=null;case 8:if(i.v&&i.v.src)return Y(e,new Promise(function(e){return new de(e).P(.1)}),11);e.A(10);break;case 11:i.v.removeAttribute("src"),i.v.load();case 10:if(t.h)return Y(e,t.h.destroy(),13);e.A(12);break;case 13:t.h=null;case 12:t.$.a.clear(),t.Eb=null,t.C=null,t.Zb.clear(),t.b=null,t.u=null,t.Bc=null,t.kb=!0,Qo(t),F(e)}})})}function Vo(e,t){e.C=new xa,e.C.a=La,Pa(e.C,t,Math.min(.5,t/2)),Qo(e),e.Xb=new de(function(){Ko(e)}).Na(.25)}function Ko(e){switch(e.i){case Al:var t=!!e.a.ended||Ft(e.a.buffered)>=e.a.duration-1;break;case kl:e:if(e.a.ended||Ei(e.F))t=!0;else{if(e.b.presentationTimeline.V()){var i=e.b.presentationTimeline.pb();if(Ft(e.a.buffered)>=i){t=!0;break e}}t=!1}break;default:t=!1}var n=Ht(e.a.buffered,e.a.currentTime),r=t,a=(i=e.C).b.get(i.a);t=i.a,n=r||a<=n?Ra:La,t!=(i.a=n)&&Qo(e)}function Wo(t){if(t.s&&t.s.configure(t.c.manifest),t.h&&t.h.configure(t.c.drm),t.f){t.f.configure(t.c.streaming);try{t.b.periods.forEach(t.Jc.bind(t))}catch(e){t.Ma(e)}var e=us(t.f),i=cs(t.f),n=yl(t);e=Ji(e,i,n.variants),t.l&&e&&e.allowedByApplication&&e.allowedByKeySystem?el(t,n.variants):tl(t,n)}if(t.F&&(n=t.c.textDisplayFactory,t.Bc!=n)){e=new n;var r=(i=t.F).g;i.g=e,r&&(e.setTextVisibility(r.isTextVisible()),r.destroy()),i.a&&(i.a.c=e),t.Bc=n,t.f&&((e=(n=t.f).b.get("text"))&&ms(n,e.stream,!0,0,!0))}t.l&&(t.l.configure(t.c.abr),t.c.abr.enabled&&!t.kb?t.l.enable():t.l.disable(),ll(t)),t.C&&(n=t.c.streaming.rebufferingGoal,t.b&&(n=Math.max(n,t.b.minBufferTime)),Pa(t.C,n,Math.min(.5,n/2)))}function qo(e,t,i,n){Ta(e.$,t).variant=i,(e=e.u.c).c!=i&&(e.c=i,e.a.push({timestamp:Date.now()/1e3,id:i.id,type:"variant",fromAdaptation:n,bandwidth:i.bandwidth}))}function zo(e,t,i,n){_a(e.$,t,i),(e=e.u.c).b!=i&&(e.b=i,e.a.push({timestamp:Date.now()/1e3,id:i.id,type:"text",fromAdaptation:n,bandwidth:null}))}function Yo(t){var e=Lo();return e.streaming.failureCallback=function(e){t.V()&&[1001,1002,1003].includes(e.code)&&(e.severity=1,t.nd())},e.textDisplayFactory=function(){return new Co(t.a)},e}function Xo(e,t){var i,n,r=e.f?us(e.f):null,a=e.f?cs(e.f):null;if(t.forEach(ji.bind(null,e.h,r,a)),i=function(e){return e.variants.some(zi)},n=0,t.forEach(function(e){n+=i(e)?1:0}),0==(r=n))throw new ge(2,4,4032);if(r<t.length)throw new ge(2,4,4011);t.forEach(function(e){Fi(e.variants,this.c.restrictions,this.$b)&&this.f&&yl(this)==e&&rl(this),fl(this,e.variants)}.bind(e))}function $o(e,t,i,n){i=void 0!==i&&i,n=void 0===n?0:n,e.kb?(e.pa=t,e.Hd=i,e.Fd=n):(ps(e.f,t,i,n),al(e))}function Jo(e,t){e.kb?e.oa=t:(ms(e.f,t,!0,0,!1),sl(e))}function Qo(e){var t=e.Tc();if(e.u&&e.C&&e.m){var i=e.W;i.f=t,Ka(i),Zo(e)}e.dispatchEvent(new Ce("buffering",{buffering:t}))}function Zo(e){if(e.u&&e.C){var t=e.u.a;e.C.a==La?Do(t,"buffering"):e.a.paused?Do(t,"paused"):e.a.ended?Do(t,"ended"):Do(t,"playing")}}function el(t,e){try{fl(t,e)}catch(e){return t.Ma(e),null}var i=e.filter(function(e){return zi(e)});return i=t.Fb.create(i),t.l.setVariants(Array.from(i.values())),t.l.chooseVariant()}function tl(e,t){il(e,t,!1);var i=!1;i=void 0===i||i;var n=Xi(t.textStreams,e.na,e.fb)[0]||null;n&&(e.c.streaming.alwaysStreamText||e.ic())&&(zo(e,t,n,!0),Jo(e,n)),i&&nl(e),nl(e)}function il(e,t,i){i=void 0===i||i;var n=el(e,t.variants);n&&(qo(e,t,n,!0),$o(e,n,!0)),i&&nl(e)}function nl(e){pl(e,new Ce("adaptation"))}function rl(e){pl(e,new Ce("trackschanged"))}function al(e){pl(e,new Ce("variantchanged"))}function sl(e){pl(e,new Ce("textchanged"))}function ol(e){pl(e,new Ce("texttrackvisibility"))}function ll(e){pl(e,new Ce("abrstatuschanged",{wg:e.c.abr.enabled}))}function ul(e,t,i){e.dispatchEvent(new Ce(t,{detail:{schemeIdUri:i.schemeIdUri,value:i.value,startTime:i.startTime,endTime:i.endTime,id:i.id,eventElement:i.eventElement}}))}function cl(e){if(!e.a.error)return null;var t=e.a.error.code;if(1==t)return null;var i=e.a.error.msExtendedCode;return i&&(i<0&&(i+=Math.pow(2,32)),i=i.toString(16)),new ge(2,3,3016,t,i,e.a.error.message)}function hl(e,n){if(e.f){var t=yl(e),r=!1,i=Object.keys(n),a=1==i.length&&"00"==i[0];i.length&&e.b.periods.forEach(function(e){e.variants.forEach(function(i){var e,t;t=[],(e=i).audio&&t.push(e.audio),e.video&&t.push(e.video),t.forEach(function(e){var t=i.allowedByKeySystem;e.keyId&&(e=n[a?"00":e.keyId],i.allowedByKeySystem=!!e&&!jo.includes(e)),t!=i.allowedByKeySystem&&(r=!0)})})}),(i=Ji(i=us(e.f),cs(e.f),t.variants))&&!i.allowedByKeySystem&&il(e,t),r&&(rl(e),el(e,t.variants))}}function dl(e,t,i){e.s&&e.s.onExpirationUpdated&&e.s.onExpirationUpdated(t,i),e.dispatchEvent(new Ce("expirationupdated"))}function fl(e,t){var i=e.h?Je(e.h.W):{},n=Object.keys(i);n=n.length&&"00"==n[0];for(var r=!1,a=!1,s=[],o=[],l=q(t),u=l.next();!u.done;u=l.next()){var c=[];(u=u.value).audio&&c.push(u.audio),u.video&&c.push(u.video);for(var h=(c=q(c)).next();!h.done;h=c.next())if((h=h.value).keyId){var d=i[n?"00":h.keyId];d?jo.includes(d)&&(o.includes(d)||o.push(d)):s.includes(h.keyId)||s.push(h.keyId)}u.allowedByApplication?u.allowedByKeySystem&&(r=!0):a=!0}if(!r)throw new ge(2,4,4012,{hasAppRestrictions:a,missingKeys:s,restrictedKeyStatuses:o})}function pl(t,i){z(function e(){return X(e,function(e){switch(e.j){case 1:return Y(e,Promise.resolve(),2);case 2:t.i!=wl&&t.dispatchEvent(i),F(e)}})})}function ml(e){for(var t=new Set,i=(e=q(e)).next();!i.done;i=e.next())(i=i.value).language?t.add(Di(i.language)):t.add("und");return t}function gl(e){for(var t=new Map,i=(e=q(e)).next();!i.done;i=e.next()){var n=i.value;i="und";var r=[];for(n.language&&(i=Di(n.language)),(r="variant"==n.type?n.audioRoles:n.roles)&&r.length||(r=[""]),t.has(i)||t.set(i,new Set),r=(n=q(r)).next();!r.done;r=n.next())r=r.value,t.get(i).add(r)}var a=[];return t.forEach(function(e,t){for(var i=q(e),n=i.next();!n.done;n=i.next())a.push({language:t,role:n.value})}),a}function vl(e){return null==(e=yl(e))?[]:e.variants.filter(function(e){return zi(e)})}function yl(e){for(var t=e.m.h(),i=null,n=(e=q(e.b.periods)).next();!n.done;n=e.next())(n=n.value).startTime<=t&&(i=n);return i}function bl(e){var t=yl(e);return Ta(e.$,t).variant}function _l(){return new ge(2,7,7e3)}function Tl(e,t,i,n,r,a){return n==e&&r.v==a.v&&r.uri==a.uri&&r.mimeType==a.mimeType&&r.Aa==a.Aa?t:i}function Sl(){return{Aa:null,v:null,mimeType:null,startTime:null,ud:null,uri:null}}function El(i){return new Promise(function(e,t){i.Ya=function(){return t(_l())},i.lc=function(){return e()},i.onError=function(e){return t(e)},i.nc=function(){return t(_l())}})}Uo.registerSupportPlugin=function(e,t){Ho[e]=t},Uo.isBrowserSupported=function(){return!!(d.Promise&&d.Uint8Array&&Array.prototype.forEach&&d.MediaKeys&&d.navigator&&d.navigator.requestMediaKeySystemAccess&&d.MediaKeySystemAccess&&d.MediaKeySystemAccess.prototype.getConfiguration)&&(!!tt()||it("application/x-mpegurl"))},Uo.probeSupport=function(){return xt().then(function(e){for(var t=wr.Ef(),i={},n=q('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),r=n.next();!r.done;r=n.next()){i[r=r.value]=tt()?!!gi(r)||(MediaSource.isTypeSupported(r)||Xt(r)):it(r);var a=r.split(";")[0];i[a]=i[a]||i[r]}for(var s in e={manifest:t,media:i,drm:e},Ho)e[s]=Ho[s]();return e})},Uo.prototype.attach=Uo.prototype.Gb=function(e,t){if(t=void 0===t||t,this.i==wl)return Promise.reject(_l());var i=Sl();i.v=e,tt()||(t=!1);var n=t?this.hb:this.R,r=Eo(this.lb,function(){return{node:n,payload:i,Va:!1}});return r.vb=function(){},El(r)},Uo.prototype.detach=Uo.prototype.detach=function(){var e=this;if(this.i==wl)return Promise.reject(_l());var t=Eo(this.lb,function(){return{node:e.D,payload:Sl(),Va:!1}});return t.vb=function(){},El(t)},Uo.prototype.unload=Uo.prototype.xd=function(i){var n=this;if(i=void 0===i||i,this.i==wl)return Promise.reject(_l());tt()||(i=!1);var r=Sl(),e=Eo(this.lb,function(e){var t=e.v&&i?n.hb:e.v?n.R:n.D;return r.v=e.v,{node:t,payload:r,Va:!1}});return e.vb=function(){},El(e)},Uo.prototype.load=Uo.prototype.load=function(e,t,i){if(this.i==wl)return Promise.reject(_l());this.dispatchEvent(new Ce("loading"));var n=Sl();n.uri=e,n.ud=Date.now()/1e3,i&&"string"!=typeof i&&(tn("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),n.Aa=function(){return new i}),i&&"string"==typeof i&&(n.mimeType=i),void 0!==t&&(n.startTime=t);var r=function(e,t){if(t.Aa)return;if(!tt())return 1;var i=t.mimeType,n=t.uri||"";return!!(i=i||{mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"}[wr.getExtension(n)])&&(""!=(t.v||rt()).canPlayType(i)&&(!wr.isSupported(n,i)||!!navigator.vendor&&navigator.vendor.includes("Apple")&&e.c.streaming.useNativeHlsOnSafari))}(this,n)?this.jb:this.S,a=Eo(this.lb,function(e){return null==e.v?null:(n.v=e.v,{node:r,payload:n,Va:!0})});return a.vb=function(){},new Promise(function(e,t){a.nc=function(){return t(new ge(2,7,7002))},a.lc=function(){return e()},a.Ya=function(){return t(_l())},a.onError=function(e){return t(e)}})},Uo.prototype.configure=Uo.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=xo(e,t));var i=Ro(this.c,e,Yo(this));return Wo(this),i},Uo.prototype.getConfiguration=Uo.prototype.getConfiguration=function(){var e=Yo(this);return Ro(e,this.c,Yo(this)),e},Uo.prototype.resetConfiguration=Uo.prototype.Mf=function(){for(var e in this.c)delete this.c[e];Ro(this.c,Yo(this),Yo(this)),Wo(this)},Uo.prototype.getLoadMode=Uo.prototype.Me=function(){return this.i},Uo.prototype.getMediaElement=Uo.prototype.Re=function(){return this.a},Uo.prototype.getNetworkingEngine=Uo.prototype.Kb=function(){return this.K},Uo.prototype.getAssetUri=Uo.prototype.ec=function(){return this.Eb},Uo.prototype.getManifestUri=Uo.prototype.Pe=function(){return tn("getManifestUri",'Please use "getAssetUri" instead.'),this.ec()},Uo.prototype.isLive=Uo.prototype.V=function(){return this.b?this.b.presentationTimeline.V():!(!this.a||!this.a.src)&&1/0==this.a.duration},Uo.prototype.isInProgress=Uo.prototype.Xa=function(){return!!this.b&&this.b.presentationTimeline.Xa()},Uo.prototype.isAudioOnly=Uo.prototype.ef=function(){if(this.b){if(!this.b.periods.length)return!1;var e=this.b.periods[0].variants;return!!e.length&&!e[0].video}return!(!this.a||!this.a.src)&&(this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight)},Uo.prototype.seekRange=Uo.prototype.Of=function(){if(this.b){var e=this.b.presentationTimeline;return{start:e.ob(),end:e.Ca()}}return this.a&&this.a.src&&(e=this.a.seekable).length?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},Uo.prototype.keySystem=Uo.prototype.keySystem=function(){return Tt(this.drmInfo())},Uo.prototype.drmInfo=Uo.prototype.drmInfo=function(){return this.h?this.h.a:null},Uo.prototype.getExpiration=Uo.prototype.Jb=function(){return this.h?this.h.Jb():1/0},Uo.prototype.isBuffering=Uo.prototype.Tc=function(){return!!this.C&&this.C.a==La},Uo.prototype.getPlaybackRate=Uo.prototype.Ue=function(){if(this.W){var e=this.W;e=e.f?0:e.c}else e=0;return e},Uo.prototype.trickPlay=Uo.prototype.gg=function(e){0==e?W("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.W.set(e),this.i==kl&&fs(this.f,1<Math.abs(e)))},Uo.prototype.cancelTrickPlay=Uo.prototype.we=function(){this.i==Al&&this.W.set(1),this.i==kl&&(this.W.set(1),fs(this.f,!1))},Uo.prototype.getVariantTracks=Uo.prototype.Sc=function(){if(this.b&&this.m){for(var e=bl(this),t=[],i=q(vl(this)),n=i.next();!n.done;n=i.next()){var r=Gi(n=n.value);r.active=n==e,t.push(r)}return t}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map(function(e){var t=qi(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind?(t.primary=!0,t.roles=["main"],t.audioRoles=["main"]):t.audioRoles=[],t}):[]},Uo.prototype.getTextTracks=Uo.prototype.qb=function(){if(this.b&&this.m){for(var e=function(e){var t=yl(e);if(null==t)return null;if(!Ta(e.$,t).text){var i=Xi(t.textStreams,e.na,e.fb);i.length&&_a(e.$,t,i[0])}return Ta(e.$,t).text}(this),t=[],i=q(function(t){var e=yl(t);return null==e?[]:e.textStreams.filter(function(e){return!t.Zb.has(e)})}(this)),n=i.next();!n.done;n=i.next()){var r=Vi(n=n.value);r.active=n==e,t.push(r)}return t}return this.a&&this.a.src&&this.a.textTracks?Array.from(this.a.textTracks).map(function(e){var t=qi(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="application/cea-608"),t}):[]},Uo.prototype.selectTextTrack=Uo.prototype.od=function(t){if(this.b&&this.f){var e=yl(this),i=e.textStreams.find(function(e){return e.id==t.id});i&&(zo(this,e,i,!1),Jo(this,i),this.na=i.language)}else if(this.a&&this.a.src&&this.a.textTracks){for(i=(e=q(e=Array.from(this.a.textTracks))).next();!i.done;i=e.next())Ki(i=i.value)==t.id?i.mode=this.gb?"showing":"hidden":i.mode="disabled";sl(this)}},Uo.prototype.selectEmbeddedTextTrack=Uo.prototype.Qf=function(){tn("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var e=this.qb().filter(function(e){return"application/cea-608"==e.mimeType});0<e.length&&this.od(e[0])},Uo.prototype.usingEmbeddedTextTrack=Uo.prototype.lg=function(){tn("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var e=this.qb().filter(function(e){return e.active})[0];return!!e&&"application/cea-608"==e.mimeType},Uo.prototype.selectVariantTrack=Uo.prototype.Sf=function(t,e,i){if(i=void 0===i?0:i,this.b&&this.f){var n=yl(this);this.c.abr.enabled&&W("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var r=n.variants.find(function(e){return e.id==t.id});r&&zi(r)&&(qo(this,n,r,!1),$o(this,r,e,i),this.Fb=new Aa(r),el(this,n.variants))}else if(this.a&&this.a.audioTracks){for(i=(e=q(e=Array.from(this.a.audioTracks))).next();!i.done;i=e.next())Ki(i=i.value)==t.id&&(i.enabled=!0);al(this)}},Uo.prototype.getAudioLanguagesAndRoles=Uo.prototype.He=function(){return gl(this.Sc())},Uo.prototype.getTextLanguagesAndRoles=Uo.prototype.af=function(){return gl(this.qb())},Uo.prototype.getAudioLanguages=Uo.prototype.Ge=function(){return Array.from(ml(this.Sc()))},Uo.prototype.getTextLanguages=Uo.prototype.$e=function(){return Array.from(ml(this.qb()))},Uo.prototype.selectAudioLanguage=Uo.prototype.Pf=function(e,t){if(this.b&&this.m){var i=yl(this);this.Fb=new Ia(e,t||"",0),il(this,i)}else if(this.a&&this.a.audioTracks){for(var n=(i=q(i=Array.from(this.a.audioTracks))).next();!n.done;n=i.next())(n=n.value).language==e&&(n.enabled=!0);al(this)}},Uo.prototype.selectTextLanguage=Uo.prototype.Rf=function(t,e){if(this.b&&this.m){var i=yl(this);this.na=t,this.fb=e||"";var n=Xi(i.textStreams,this.na,this.fb)[0]||null;n&&(zo(this,i,n,!1),(this.c.streaming.alwaysStreamText||this.ic())&&Jo(this,n))}else(i=this.qb().filter(function(e){return e.language==t})[0])&&this.od(i)},Uo.prototype.selectVariantsByLabel=Uo.prototype.Tf=function(e){if(this.b&&this.m){for(var t=yl(this),i=null,n=q(vl(this)),r=n.next();!r.done;r=n.next())if((r=r.value).audio.label==e){i=r;break}null!=i&&(this.Fb=new Ia(i.language,"",0,e),il(this,t))}},Uo.prototype.isTextTrackVisible=Uo.prototype.ic=function(){var e=this.gb;return this.b?this.F.g.isTextVisible():this.a&&this.a.src&&this.a.textTracks?Array.from(this.a.textTracks).some(function(e){return"showing"==e.mode}):e},Uo.prototype.setTextTrackVisibility=Uo.prototype.Wf=function(o){var l=this;return z(function e(){var n,r,a,s;return X(e,function(e){switch(e.j){case 1:if(l.gb==(n=o))return e.return();if(l.gb=n,l.i!=kl){if(l.a&&l.a.src&&l.a.textTracks)for(var t=q(Array.from(l.a.textTracks)),i=t.next();!i.done;i=t.next())"disabled"!=(r=i.value).mode&&(r.mode=o?"showing":"hidden");e.A(2);break}if(l.F.g.setTextVisibility(o),l.c.streaming.alwaysStreamText){e.A(2);break}if(!o){(t=l.f).D=!0,(i=t.b.get("text"))&&(Rs(i),t.b.delete("text")),e.A(2);break}if(a=yl(l),0<(s=Xi(a.textStreams,l.na,l.fb)).length)return Y(e,ds(l.f,s[0]),2);e.A(2);break;case 2:ol(l),F(e)}})})},Uo.prototype.getPlayheadTimeAsDate=Uo.prototype.We=function(){if(!this.V())return null;if(this.b)return new Date(1e3*(this.b.presentationTimeline.f+this.a.currentTime));if(this.a&&this.a.getStartDate){var e=this.a.getStartDate();return isNaN(e.getTime())?null:new Date(e.getTime()+1e3*this.a.currentTime)}return null},Uo.prototype.getPresentationStartTimeAsDate=Uo.prototype.Ye=function(){if(!this.V())return null;if(this.b)return new Date(1e3*this.b.presentationTimeline.f);if(this.a&&this.a.getStartDate){var e=this.a.getStartDate();return isNaN(e.getTime())?null:e}return null},Uo.prototype.getBufferedInfo=Uo.prototype.Oc=function(){var e={total:[],audio:[],video:[],text:[]};return this.i==Al&&(e.total=Gt(this.a.buffered)),this.i==kl&&this.F.Oc(e),e},Uo.prototype.getStats=Uo.prototype.getStats=function(){if(this.i!=kl&&this.i!=Al)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,switchHistory:[],stateHistory:[]};Zo(this);var e=this.a;if(e.getVideoPlaybackQuality){e=e.getVideoPlaybackQuality();var t=this.u,i=Number(e.totalVideoFrames);t.m=Number(e.droppedVideoFrames),t.l=i,this.u.i=Number(e.corruptedVideoFrames)}e=this.h?(e=this.h).K?e.K:NaN:NaN,this.u.h=e,this.i==kl&&((e=bl(this))&&(this.u.s=e.bandwidth),e&&e.video&&(t=this.u,i=e.video.height||NaN,t.u=e.video.width||NaN,t.g=i),e=this.l.getBandwidthEstimate(),this.u.f=e);var n=this.u;e=n.u,t=n.g,i=n.s;for(var r=n.l,a=n.m,s=n.i,o=n.f,l=n.b,u=No(n.a,"playing"),c=No(n.a,"paused"),h=No(n.a,"buffering"),d=n.h,f=function(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var i=[],n=q(e.b),r=n.next();!r.done;r=n.next())i.push(t(r.value));return e.a&&i.push(t(e.a)),i}(n.a),p=[],m=(n=q(n.c.a)).next();!m.done;m=n.next())m=m.value,p.push({timestamp:m.timestamp,id:m.id,type:m.type,fromAdaptation:m.fromAdaptation,bandwidth:m.bandwidth});return{width:e,height:t,streamBandwidth:i,decodedFrames:r,droppedFrames:a,corruptedFrames:s,estimatedBandwidth:o,loadLatency:l,playTime:u,pauseTime:c,bufferingTime:h,licenseTime:d,stateHistory:f,switchHistory:p}},Uo.prototype.addTextTrack=Uo.prototype.addTextTrack=function(c,h,d,f,p,m){var g=this;return z(function e(){var t,i,n,r,a,s,o,l,u;return X(e,function(e){switch(e.j){case 1:if(g.i==Al)throw Error("State error!");if(g.i!=kl)throw Error("State error!");if(t=yl(g),i=qt,n=g.b.periods.indexOf(t),a=(r=n+1)>=g.b.periods.length?g.b.presentationTimeline.Y():g.b.periods[r].startTime,1/0==(s=a-t.startTime))throw new ge(1,4,4033);return o=new sr(1,0,s,function(){return[c]},0,null),l={id:g.Kd++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(e){return 1==e?o:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:f,codecs:p||"",kind:d,encrypted:!1,keyId:null,language:h,label:m||null,type:i.ra,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},g.Zb.add(l),t.textStreams.push(l),Y(e,ds(g.f,l),2);case 2:return(u=hs(g.f,"text"))&&_a(g.$,t,u),g.Zb.delete(l),tl(g,t),rl(g),e.return(Vi(l))}})})},Uo.prototype.setMaxHardwareResolution=Uo.prototype.qd=function(e,t){this.$b.width=e,this.$b.height=t},Uo.prototype.retryStreaming=Uo.prototype.nd=function(){if(this.i==kl){var e=this.f;if(e.f)e=!1;else if(e.m)e=!1;else{for(var t=q(e.b.values()),i=t.next();!i.done;i=t.next())(i=i.value).Nb&&(i.Nb=!1,Ls(e,i,.1));e=!0}}else e=!1;return e},Uo.prototype.getManifest=Uo.prototype.Ne=function(){return this.b},Uo.prototype.getManifestParserFactory=Uo.prototype.Oe=function(){return this.s?this.s.constructor:null},(t=Uo.prototype).Jc=function(e){var t=this.f?us(this.f):null,i=this.f?cs(this.f):null;if(ji(this.h,t,i,e),!(t=e.variants).some(zi))throw new ge(2,4,4011);if(fl(this,e.variants),Fi(t,this.c.restrictions,this.$b)&&this.f&&yl(this)==e&&rl(this),e=this.h?this.h.a:null)for(i=(t=q(t)).next();!i.done;i=t.next())for(var n=(i=q(i.value.drmInfos)).next();!n.done;n=i.next())if((n=n.value).keySystem==e.keySystem)for(var r=(n=q(n.initData||[])).next();!r.done;r=n.next())r=r.value,_t(this.h,r.initDataType,r.initData)},t.hf=function(e){try{this.kb=!0,this.l.disable(),ll(this);var t=el(this,e.variants),i=Xi(e.textStreams,this.na,this.fb)[0]||null;this.pa&&(e.variants.includes(this.pa)&&(t=this.pa),this.pa=null),this.oa&&(e.textStreams.includes(this.oa)&&(i=this.oa),this.oa=null),t&&qo(this,e,t,!0),i&&zo(this,e,i,!0);var n=this.f,r=n.b.get("video");if(r)var a=n.c.periods[r.ia];else{var s=n.b.get("audio");a=s?n.c.periods[s.ia]:null}var o=t?t.audio:null;if(!a&&i){var l;if(l=o){e=i;var u=Di(this.c.preferredTextLanguage),c=Di(o.language),h=Di(e.language);l=Ri(h,u)&&!Ri(c,h)}l&&(this.gb=!0),this.gb&&this.F.g.setTextVisibility(!0),ol(this)}return this.c.streaming.alwaysStreamText||this.ic()?{variant:t,text:i}:{variant:t,text:null}}catch(e){return this.Ma(e),{variant:null,text:null}}},t.ve=function(){this.kb=!1,this.c.abr.enabled&&(this.l.enable(),ll(this)),this.pa&&(ps(this.f,this.pa,this.Hd,this.Fd),al(this),this.pa=null),this.oa&&(ms(this.f,this.oa,!0,0,!1),sl(this),this.oa=null)},t.nf=function(){this.s&&this.s.update&&this.s.update()},t.uf=function(){this.m&&this.m.s()},t.Ma=function(e){if(this.i!=wl){var t=new Ce("error",{detail:e});this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)}};var wl=0,Cl=1,kl=2,Al=3;function Il(e,t){var i=go(new mo(e.wa(),e.ba()),t.periods[0],new Cr(null,0)),n=t.appMetadata||{};return i=xl(i),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:i,appMetadata:n}}function xl(e){for(var t=[],i=e.variants.filter(function(e){return zi(e)}),n=(i=q(i)).next();!n.done;n=i.next())t.push(Gi(n.value));for(i=(e=q(e.textStreams)).next();!i.done;i=e.next())t.push(Vi(i.value));return t}function Pl(){this.a={}}function Ll(e,t){var i=e.a[t];return null==i&&(i=0),i}function Rl(e){this.a=!1,this.b=new ve,this.c=e}function Ol(e){var s=new Nl;e.periods.forEach(function(e,t){var i,n,r=Bl(e.variants);if(0==t)for(var a=(r=q(r.a)).next();!a.done;a=r.next())s.add(a.value);else n=r,(i=s).a=i.a.filter(function(e){return Ml(n,e)})});for(var t=(e=q(e.periods)).next();!t.done;t=e.next())(t=t.value).variants=t.variants.filter(function(e){return Ml(s,new Dl(e))})}function Dl(e){var t=e.audio;e=e.video,this.b=t?t.mimeType:null,this.a=t?t.codecs.split(".")[0]:null,this.f=e?e.mimeType:null,this.c=e?e.codecs.split(".")[0]:null}function Nl(){this.a=[]}function Ml(e,t){return e.a.some(function(e){return t.b==e.b&&t.a==e.a&&t.f==e.f&&t.c==e.c})}function Bl(e){for(var t=new Nl,i=(e=q(e)).next();!i.done;i=e.next())t.add(new Dl(i.value));return t}function Ul(e){var i=this;if(e&&e.constructor!=Uo)throw new ge(2,9,9008);this.b=this.a=null,e?(this.a=e.c,this.b=e.Kb()):(this.a=Lo(),this.b=new De),this.f=!1,this.c=[],this.g=[];var n=!e;this.h=new Rl(function(){return z(function e(){var t;return X(e,function(e){switch(e.j){case 1:return t=function(){},Y(e,Promise.all(i.g.map(function(e){return e.then(t,t)})),2);case 2:if(n)return Y(e,i.b.destroy(),3);e.A(3);break;case 3:i.a=null,i.b=null,F(e)}})})})}function Fl(){if(tt())e:{for(var e=q($s.values()),t=e.next();!t.done;t=e.next())if(t=(t=t.value)()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function jl(e,t){for(var i=[],n=q(e.periods),r=n.next();!r.done;r=n.next())for(var a=(r=q(r.value.streams)).next();!a.done;a=r.next())a=a.value,t&&"video"==a.contentType?i.push({contentType:Qe(a.mimeType,a.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=a.contentType||i.push({contentType:Qe(a.mimeType,a.codecs),robustness:e.drmInfo.audioRobustness});return i}function Hl(a,s,o,l,e,u){var c={id:u.id,originalId:u.originalId,primary:u.primary,presentationTimeOffset:u.presentationTimeOffset||0,contentType:u.type,mimeType:u.mimeType,codecs:u.codecs,frameRate:u.frameRate,pixelAspectRatio:u.pixelAspectRatio,kind:u.kind,language:u.language,label:u.label,width:u.width||null,height:u.height||null,initSegmentKey:null,encrypted:u.encrypted,keyId:u.keyId,segments:[],variantIds:[]};e=e.presentationTimeline.Mb();var h=u.id,t=u.initSegmentReference;return t&&(t=kr(t.c(),t.b,t.a,a.a.streaming.retryParameters),Fs(s,h,t,.5*Ll(l,u.id),!0,function(i){return z(function e(){var t;return X(e,function(e){switch(e.j){case 1:return Y(e,o.addSegments([{data:i}]),2);case 2:t=e.o,a.c.push(t[0]),c.initSegmentKey=t[0],F(e)}})})})),function(e,t,i){for(var n=null==(t=e.findSegmentPosition(t))?null:e.getSegmentReference(t);n;)i(n),n=e.getSegmentReference(++t)}(u,e,function(n){var e,t,i,r=kr(n.c(),n.b,n.a,a.a.streaming.retryParameters);Fs(s,h,r,(e=l,t=u.id,i=(i=n).endTime-i.startTime,Ll(e,t)*i),!1,function(i){return z(function e(){var t;return X(e,function(e){switch(e.j){case 1:return Y(e,o.addSegments([{data:i}]),2);case 2:t=e.o,a.c.push(t[0]),c.segments.push({startTime:n.startTime,endTime:n.endTime,dataKey:t[0]}),F(e)}})})})}),c}function Gl(e){if(e.h.a)throw new ge(2,9,7001)}function Vl(){if(!Fl())throw new ge(2,9,9e3)}function Kl(t,i){return z(function e(){return X(e,function(e){switch(e.j){case 1:return t.g.push(i),L(e,2),Y(e,i,4);case 4:return e.return(e.o);case 2:R(e),Pe(t.g,i),O(e,0)}})})}function Wl(e){for(var t=new Set,i=(e=q(e.periods)).next();!i.done;i=e.next()){for(var n=q((i=i.value).textStreams),r=n.next();!r.done;r=n.next())t.add(r.value);for(n=(i=q(i.variants)).next();!n.done;n=i.next())(n=n.value).audio&&t.add(n.audio),n.video&&t.add(n.video)}return t}function ql(e){e.variants.map(function(e){return e.video});var t=new Set(e.variants.map(function(e){return e.audio}));e=e.textStreams;for(var i=q(t),n=i.next();!n.done;n=i.next())for(var r=(n=q(t)).next();!r.done;r=n.next());for(i=(t=q(e)).next();!i.done;i=t.next())for(n=(i=q(e)).next();!n.done;n=i.next());}Uo.LoadMode={DESTROYED:wl,NOT_LOADED:Cl,MEDIA_SOURCE:kl,SRC_EQUALS:Al},Rl.prototype.destroy=function(){var e=this;return this.a?this.b:(this.a=!0,this.c().then(function(){e.b.resolve()},function(){e.b.resolve()}))},Nl.prototype.add=function(e){Ml(this,e)||this.a.push(e)},B("shaka.offline.Storage",Ul),Ul.support=Fl,Ul.prototype.destroy=Ul.prototype.destroy=function(){return this.h.destroy()},Ul.prototype.configure=Ul.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=xo(e,t));var i=e,n=!1;return null!=i.trackSelectionCallback&&(n=!0,i.offline=i.offline||{},i.offline.trackSelectionCallback=i.trackSelectionCallback,delete i.trackSelectionCallback),null!=i.progressCallback&&(n=!0,i.offline=i.offline||{},i.offline.progressCallback=i.progressCallback,delete i.progressCallback),null!=i.usePersistentLicense&&(n=!0,i.offline=i.offline||{},i.offline.usePersistentLicense=i.usePersistentLicense,delete i.usePersistentLicense),n&&tn("Storage.configure with OfflineConfig","Please configure storage with a player configuration."),Ro(this.a,e)},Ul.prototype.getConfiguration=Ul.prototype.getConfiguration=function(){var e=Lo();return Ro(e,this.a,Lo()),e},Ul.prototype.getNetworkingEngine=Ul.prototype.Kb=function(){return this.b},Ul.prototype.store=Ul.prototype.store=function(i,e,n){var b,_,T,S,r=this;return Kl(this,(b=this,_=i,T=e||{},S=function(){return z(function e(){var t;return X(e,function(e){switch(e.j){case 1:return n&&"string"!=typeof n?(tn("Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),e.return(new n)):Y(e,wr.create(i,r.b,r.a.manifest.retryParameters,n),2);case 2:return t=e.o,e.return(t)}})})},z(function e(){var n,r,a,f,p,m,g,v,y;return X(e,function(e){switch(e.j){case 1:return Vl(),b.f?e.return(Promise.reject(new ge(2,9,9006))):(b.f=!0,Y(e,(c=b,h=_,d=S,z(function e(){var t,i,n,r,a,s;return X(e,function(e){switch(e.j){case 1:return t=null,i=c.b,n={networkingEngine:i,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){t=e}},Y(e,d(),2);case 2:return(r=e.o).configure(c.a.manifest),Gl(c),L(e,3),Y(e,r.start(h,n),5);case 5:return a=e.o,Gl(c),s=Wl(a),Y(e,Promise.all(Array.from(s).map(function(e){return e.createSegmentIndex()})),6);case 6:if(Gl(c),t)throw t;return e.return(a);case 3:return R(e),Y(e,r.stop(),7);case 7:O(e,0)}})})),2));case 2:if(n=e.o,Gl(b),n.presentationTimeline.V()||n.presentationTimeline.Xa())throw new ge(2,9,9005,_);return r=null,a=new zs,p=f=null,E(e,3,4),Y(e,(o=b,l=n,u=function(e){p=p||e},z(function e(){var r,a,s;return X(e,function(e){switch(e.j){case 1:return r=new mt({tb:o.b,onError:u,mc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),a=ja(l.periods),s=o.a,r.configure(s.drm),Y(e,(t=r,i=a,n=s.offline.usePersistentLicense,t.s=[],t.D=n,vt(t,i)),2);case 2:return Y(e,yt(r),3);case 3:return Y(e,bt(r),4);case 4:return e.return(r)}var t,i,n})})),6);case 6:if(r=e.o,Gl(b),p)throw p;return i=r,function(e,t){for(var i={width:1/0,height:1/0},n=q(e.periods),r=n.next();!r.done;r=n.next())(r=r.value).variants=r.variants.filter(function(e){return Ui(e,t,i)})}(t=n,(s=b).a.restrictions),function(e){for(var t=(e=q(e.periods)).next();!t.done;t=e.next())(t=t.value).variants=t.variants.filter(function(e){var t=!0;return e.audio&&(t=t&&Ti(e.audio)),e.video&&(t=t&&Ti(e.video)),t})}(t),function(e,t){for(var i=q(e.periods),n=i.next();!n.done;n=i.next())(n=n.value).variants=n.variants.filter(function(e){return Pt(t,e)})}(t,i),Ol(t),function(e,i){var n=new Nl;e.periods.forEach(function(e,t){0<t&&(e.variants=e.variants.filter(function(e){return Ml(n,new Dl(e))})),i(e),n=Bl(e.variants)})}(t,function(e){for(var t=[],i=q(e.variants),n=i.next();!n.done;n=i.next())t.push(Gi(n.value));for(n=(i=q(e.textStreams)).next();!n.done;n=i.next())t.push(Vi(n.value));t=s.a.offline.trackSelectionCallback(t);var r=new Set,a=new Set;for(i=(t=q(t)).next();!i.done;i=t.next())"variant"==(i=i.value).type&&r.add(i.id),"text"==i.type&&a.add(i.id);e.variants=e.variants.filter(function(e){return r.has(e.id)}),e.textStreams=e.textStreams.filter(function(e){return a.has(e.id)})}),function(e){if(0==e.periods.length)throw new ge(2,4,4014);for(var t=(e=q(e.periods)).next();!t.done;t=e.next())ql(t.value)}(t),Y(e,a.init(),7);case 7:return Gl(b),Y(e,function(e){var n=null;if(e.a.forEach(function(e,i){e.getCells().forEach(function(e,t){e.hasFixedKeySpace()||n||(n={path:{wa:i,ba:t},ba:e})})}),n)return n;throw new ge(2,9,9013,"Could not find a cell that supports add-operations")}(a),8);case 8:return f=e.o,Gl(b),Y(e,(C=b,k=f.ba,A=r,I=n,x=_,P=T,z(function e(){var v,y,b,_,T,S,E,w;return X(e,function(e){switch(e.j){case 1:return f=x,m=P,g=null==(p=I).expiration?1/0:p.expiration,v={offlineUri:null,originalManifestUri:f,duration:p.presentationTimeline.Y(),size:0,expiration:g,tracks:p=xl(p.periods[0]),appMetadata:m},y=I.periods.some(function(e){return e.variants.some(function(e){return e.drmInfos&&e.drmInfos.length})}),b=I.periods.some(function(e){return e.variants.some(function(e){return e.drmInfos.some(function(e){return e.initData&&e.initData.length})})}),_=y&&!b,T=new Us(C.b,function(e,t){v.size=t,C.a.offline.progressCallback(v,e)},function(e){_&&C.a.offline.usePersistentLicense&&_t(A,"cenc",e)}),L(e,2),i=C,n=T,r=k,a=A,s=I,o=x,l=P,u=new Pl,c=s.periods.map(function(e){return function(e,t,i,a,n,r){n.periods.forEach(function(e){e.variants.forEach(function(e){var t=e.audio,i=e.video;if(t&&!i&&(a.a[t.id]=t.bandwidth||e.bandwidth),!t&&i&&(a.a[i.id]=i.bandwidth||e.bandwidth),t&&i){var n=t.bandwidth||393216,r=i.bandwidth||e.bandwidth-n;r<=0&&(r=e.bandwidth),a.a[t.id]=n,a.a[i.id]=r}}),e.textStreams.forEach(function(e){a.a[e.id]=52})});for(var s=Wl(n),o=new Map,l=(s=q(s)).next();!l.done;l=s.next()){l=l.value;var u=Hl(e,t,i,a,n,l);o.set(l.id,u)}return r.variants.forEach(function(e){e.audio&&o.get(e.audio.id).variantIds.push(e.id),e.video&&o.get(e.video.id).variantIds.push(e.id)}),{startTime:r.startTime,streams:Array.from(o.values())}}(i,n,r,u,s,e)}),h=a.a,d=i.a.offline.usePersistentLicense,h&&d&&(h.initData=[]),E=S={originalManifestUri:o,duration:s.presentationTimeline.Y(),size:0,expiration:a.Jb(),periods:c,sessionIds:d?Et(a):[],drmInfo:h,appMetadata:l},Y(e,(t=T,z(function e(){return X(e,function(e){switch(e.j){case 1:return Y(e,Promise.all(t.b.values()),2);case 2:return e.return(t.a.a)}})})),4);case 4:if(E.size=e.o,S.expiration=A.Jb(),w=Et(A),S.sessionIds=C.a.offline.usePersistentLicense?w:[],y&&C.a.offline.usePersistentLicense&&!w.length)throw new ge(2,9,9007);return e.return(S);case 2:return R(e),Y(e,T.destroy(),5);case 5:O(e,0)}var t,i,n,r,a,s,o,l,u,c,h,d,f,p,m,g})})),9);case 9:if(m=e.o,Gl(b),p)throw p;return Y(e,f.ba.addManifests([m]),10);case 10:return g=e.o,Gl(b),v=new fo("manifest",f.path.wa,f.path.ba,g[0]),e.return(Il(v,m));case 4:return R(e),b.f=!1,b.c=[],Y(e,a.destroy(),11);case 11:if(r)return Y(e,r.destroy(),12);e.A(12);break;case 12:O(e,0);break;case 3:if(y=w(e),f)return Y(e,f.ba.removeSegments(b.c,function(){}),14);e.A(14);break;case 14:throw p||y}var C,k,A,I,x,P,s,t,i,o,l,u,c,h,d})})))},Ul.prototype.getStoreInProgress=Ul.prototype.Ze=function(){return this.f},Ul.prototype.remove=Ul.prototype.remove=function(e){return Kl(this,(b=this,_=e,z(function e(){var f,p,m,g,v,y;return X(e,function(e){switch(e.j){case 1:return Vl(),null==(f=po(_))||"manifest"!=f.a?e.return(Promise.reject(new ge(2,9,9004,_))):(p=f,m=new zs,L(e,2),Y(e,m.init(),4));case 4:return Y(e,Ys(m,p.wa(),p.ba()),5);case 5:return Y(e,(g=e.o).getManifests([p.key()]),6);case 6:return v=e.o,y=v[0],Y(e,Promise.all([(c=b,h=y,d=m,z(function e(){return X(e,function(e){switch(e.j){case 1:return Y(e,(r=c.b,a=c.a.drm,s=d,o=h,z(function e(){var t,i,n;return X(e,function(e){switch(e.j){case 1:return o.drmInfo?(t=function(e){var t=Array.from(e.a.keys());if(!t.length)throw new ge(2,9,9e3,"No supported storage mechanisms found");return e.a.get(t[0]).getEmeSessionCell()}(s),i=o.sessionIds.map(function(e){return{sessionId:e,keySystem:o.drmInfo.keySystem,licenseUri:o.drmInfo.licenseServerUri,serverCertificate:o.drmInfo.serverCertificate,audioCapabilities:jl(o,!1),videoCapabilities:jl(o,!0)}}),Y(e,To(a,r,i),2)):e.return();case 2:return n=e.o,Y(e,t.remove(n),3);case 3:return Y(e,t.add(i.filter(function(e){return-1==n.indexOf(e.sessionId)})),0)}})})),0)}var r,a,s,o})})),(i=b,n=g,r=p,s=function(e){var t=[];return e.periods.forEach(function(e){e.streams.forEach(function(e){null!=e.initSegmentKey&&t.push(e.initSegmentKey),e.segments.forEach(function(e){t.push(e.dataKey)})})}),t}(a=y),o=s.length+1,l=0,u=Il(r,a),Promise.all([n.removeSegments(s,t),n.removeManifests([r.key()],t)]))]),2);case 2:return R(e),Y(e,m.destroy(),8);case 8:O(e,0)}function t(){l+=1,i.a.offline.progressCallback(u,l/o)}var i,n,r,a,s,o,l,u,c,h,d})})));var b,_},Ul.prototype.removeEmeSessions=Ul.prototype.Jf=function(){return Kl(this,(h=this,z(function e(){var r,a,i,s,n,o,l,u,c;return X(e,function(e){switch(e.j){case 1:return Vl(),r=h.b,a=h.a.drm,i=new zs,s=!1,L(e,2),Y(e,i.init(),4);case 4:for(n=[],t=function(e){return n.push(e)},i.a.forEach(function(e){t(e.getEmeSessionCell())}),o=Promise.resolve(),l={},u=q(n),c=u.next();!c.done;l={sc:l.sc},c=u.next())l.sc=c.value,o=o.then(function(n){return function(){return z(function e(){var t,i;return X(e,function(e){switch(e.j){case 1:return Y(e,n.sc.getAll(),2);case 2:return t=e.o,Y(e,To(a,r,t),3);case 3:return i=e.o,Y(e,n.sc.remove(i),4);case 4:i.length!=t.length&&(s=!0),F(e)}})})}}(l));return Y(e,o,2);case 2:return R(e),Y(e,i.destroy(),6);case 6:O(e,3);break;case 3:return e.return(!s)}var t})})));var h},Ul.prototype.list=Ul.prototype.list=function(){return Kl(this,z(function e(){var r,t,i;return X(e,function(e){switch(e.j){case 1:return Vl(),r=[],t=new zs,L(e,2),Y(e,t.init(),4);case 4:return i=Promise.resolve(),n=function(n,t){i=i.then(function(){return z(function e(){return X(e,function(e){switch(e.j){case 1:return Y(e,t.getAllManifests(),2);case 2:e.o.forEach(function(e,t){var i=Il(new fo("manifest",n.wa,n.ba,t),e);r.push(i)}),F(e)}})})})},t.a.forEach(function(e,i){e.getCells().forEach(function(e,t){n({wa:i,ba:t},e)})}),Y(e,i,2);case 2:return R(e),Y(e,t.destroy(),6);case 6:O(e,3);break;case 3:return e.return(r)}var n})}))},Ul.deleteAll=function(){return z(function e(){var t;return X(e,function(e){switch(e.j){case 1:return t=new zs,L(e,2),Y(e,t.erase(),2);case 2:return R(e),Y(e,t.destroy(),5);case 5:O(e,0)}})})},Ho.offline=Fl,B("shaka.polyfill.installAll",function(){for(var e=0;e<Xl.length;++e)try{Xl[e].te()}catch(e){W("Error installing polyfill!",e)}});var zl,Yl,Xl=[];function $l(e,t){for(var i={priority:t=t||0,te:e},n=0;n<Xl.length;n++)if(Xl[n].priority<t)return void Xl.splice(n,0,i);Xl.push(i)}function Jl(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();if("function"==typeof Event)var i=new Event(t,e);else(i=document.createEvent("Event")).initEvent(t,e.bubbles,e.cancelable);e.target.dispatchEvent(i)}function Ql(e,t,i){if("input"==e)switch(this.type){case"range":e="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,e,t,i)}function Zl(){var n=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(e){for(var t=[],i=0;i<arguments.length;++i)t[i]=arguments[i];return(t=n.apply(this,t)).abort=function(){},t}}function eu(e,t){try{var i=new tu(e,t);return Promise.resolve(i)}catch(e){return Promise.reject(e)}}function tu(e,t){if((this.keySystem=e).startsWith("com.apple.fps"))for(var i=q(t),n=i.next();!n.done;n=i.next()){var r=n.value;if("required"==r.persistentState)n=null;else{var a=!(n={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:r.initDataTypes,sessionTypes:["temporary"],label:r.label}),s=!1;if(r.audioCapabilities)for(var o=q(r.audioCapabilities),l=o.next();!l.done;l=o.next())if((l=l.value).contentType){a=!0;var u=l.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,u)&&(n.audioCapabilities.push(l),s=!0)}if(r.videoCapabilities)for(l=(r=q(r.videoCapabilities)).next();!l.done;l=r.next())(o=l.value).contentType&&(a=!0,l=o.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,l)&&(n.videoCapabilities.push(o),s=!0));a||(s=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),n=s?n:null}if(n)return void(this.a=n)}throw(i=Error("Unsupported keySystem")).name="NotSupportedError",i.code=DOMException.NOT_SUPPORTED_ERR,i}function iu(e){var t=this.mediaKeys;return t&&t!=e&&ru(t,null),delete this.mediaKeys,(this.mediaKeys=e)?ru(e,this):Promise.resolve()}function nu(e){this.b=new WebKitMediaKeys(e),this.a=new Ke}function ru(e,t){if(e.a.$a(),!t)return Promise.resolve();e.a.w(t,"webkitneedkey",su);try{return 1<=t.readyState?t.webkitSetMediaKeys(e.b):e.a.da(t,"loadedmetadata",function(){t.webkitSetMediaKeys(e.b)}),Promise.resolve()}catch(e){return Promise.reject(e)}}function au(e){Ae.call(this),this.b=null,this.g=e,this.c=this.a=null,this.f=new Ke,this.sessionId="",this.expiration=NaN,this.closed=new ve,this.keyStatuses=new lu}function su(e){var t=new Event("encrypted");t.initDataType="cenc",t.initData=e.initData,this.dispatchEvent(t)}function ou(e,t){var i=e.keyStatuses;i.size=null==t?0:1,i.a=t,e.dispatchEvent(new Ce("keystatuseschange"))}function lu(){this.size=0,this.a=void 0}function uu(e,t){try{var i=new cu(e,t);return Promise.resolve(i)}catch(e){return Promise.reject(e)}}function cu(e,t){this.keySystem=e;for(var i=!1,n=0;n<t.length;++n){var r=t[n],a={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:r.initDataTypes,sessionTypes:["temporary"],label:r.label},s=!1;if(r.audioCapabilities)for(var o=0;o<r.audioCapabilities.length;++o){var l=r.audioCapabilities[o];if(l.contentType){s=!0;var u=l.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,u)&&(a.audioCapabilities.push(l),i=!0)}}if(r.videoCapabilities)for(o=0;o<r.videoCapabilities.length;++o)(l=r.videoCapabilities[o]).contentType&&(s=!0,u=l.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,u)&&(a.videoCapabilities.push(l),i=!0));if(s||(i=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),"required"==r.persistentState&&(i=!1),i)return void(this.a=a)}throw(i=Error("Unsupported keySystem")).name="NotSupportedError",i.code=DOMException.NOT_SUPPORTED_ERR,i}function hu(e){var t=this.mediaKeys;return t&&t!=e&&fu(t,null),delete this.mediaKeys,(this.mediaKeys=e)?fu(e,this):Promise.resolve()}function du(e){this.a=new MSMediaKeys(e),this.b=new Ke}function fu(e,t){if(e.b.$a(),!t)return Promise.resolve();e.b.w(t,"msneedkey",mu);var i=e;try{return 1<=t.readyState?t.msSetMediaKeys(e.a):t.addEventListener("loadedmetadata",function e(){t.msSetMediaKeys(i.a),t.removeEventListener("loadedmetadata",e)}),Promise.resolve()}catch(e){return Promise.reject(e)}}function pu(e){Ae.call(this),this.c=null,this.g=e,this.b=this.a=null,this.f=new Ke,this.sessionId="",this.expiration=NaN,this.closed=new ve,this.keyStatuses=new vu}function mu(e){if(e.initData){var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="cenc",t.initData=function(e){if(!e)return e;var t=new Yn(e);if(t.data.length<=1)return e;e=[];for(var i={},n=(t=q(t.data)).next();!n.done;i={hc:i.hc},n=t.next())i.hc=n.value,e.some(function(t){return function(e){return pt.za(e,t.hc)}}(i))||e.push(i.hc);return pt.concat.apply(pt,I(e))}(e.initData),this.dispatchEvent(t)}}function gu(e,t){var i=e.keyStatuses;i.size=null==t?0:1,i.a=t,e.dispatchEvent(new Ce("keystatuseschange"))}function vu(){this.size=0,this.a=void 0}function yu(){return Promise.reject(Error("The key system specified is not supported."))}function bu(e){return null==e?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function _u(){throw new TypeError("Illegal constructor.")}function Tu(){throw new TypeError("Illegal constructor.")}B("shaka.polyfill.register",$l),$l(function(){Pc()},-1),$l(function(){if(d.Document){var e=Element.prototype;e.requestFullscreen=e.requestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen||e.webkitRequestFullscreen,(e=Document.prototype).exitFullscreen=e.exitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen||e.webkitExitFullscreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",Jl),document.addEventListener("webkitfullscreenerror",Jl),document.addEventListener("mozfullscreenchange",Jl),document.addEventListener("mozfullscreenerror",Jl),document.addEventListener("MSFullscreenChange",Jl),document.addEventListener("MSFullscreenError",Jl)}}),$l(function(){var t=!1;if(nt("CrKey"))t=!0;else try{d.indexedDB&&(t=!1)}catch(e){t=!0}t&&delete d.indexedDB}),$l(function(){nt("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=Ql)}),$l(function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})}),$l(function(){}),$l(function(){if(d.MediaSource)if(d.cast&&cast.__platform__&&cast.__platform__.canDisplayType)c=MediaSource.isTypeSupported,h=/^dv(?:h[e1]|a[v1])\./,MediaSource.isTypeSupported=function(e){for(var t=e.split(/ *; */),i=t[0],n={},r=1;r<t.length;++r){var a=t[r].split("="),s=a[0];a=a[1].replace(/"(.*)"/,"$1"),n[s]=a}if(!(t=n.codecs))return c(e);var o=!1,l=!1;for(var u in e=t.split(",").filter(function(e){return h.test(e)&&(l=!0),/^(hev|hvc)1\.2/.test(e)&&(o=!0),!0}),l&&(o=!1),n.codecs=e.join(","),o&&(n.eotf="smpte2084"),n)i+="; "+u+'="'+n[u]+'"';return cast.__platform__.canDisplayType(i)};else if(navigator.vendor&&navigator.vendor.includes("Apple")){var e=navigator.appVersion.match(/Version\/(\d+)/);e=parseInt(e[1],10),n=MediaSource.isTypeSupported,MediaSource.isTypeSupported=function(e){return"mp2t"!=e.split(/ *; */)[0].split("/")[1].toLowerCase()&&n(e)},e<=10?d.MediaSource=null:e<=12?(Zl(),i=SourceBuffer.prototype.remove,SourceBuffer.prototype.remove=function(e,t){return i.call(this,e,t-.001)}):Zl()}else nt("Tizen")&&(t=MediaSource.isTypeSupported,MediaSource.isTypeSupported=function(e){return"opus"!=Ze(e)[0]&&t(e)});var t,i,n,c,h}),tu.prototype.createMediaKeys=function(){var e=new nu(this.keySystem);return Promise.resolve(e)},tu.prototype.getConfiguration=function(){return this.a},nu.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new au(this.b,e)},nu.prototype.setServerCertificate=function(e){return Promise.resolve(!0)},U(au,Ae),(t=au.prototype).generateRequest=function(e,t){this.a=new ve;try{this.b=this.g.createSession("video/mp4",new Uint8Array(t)),this.sessionId=this.b.sessionId||"",this.f.w(this.b,"webkitkeymessage",this.ag.bind(this)),this.f.w(this.b,"webkitkeyadded",this.Zf.bind(this)),this.f.w(this.b,"webkitkeyerror",this.$f.bind(this)),ou(this,"status-pending")}catch(e){this.a.reject(e)}return this.a},t.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},t.update=function(e){this.c=new ve;try{this.b.update(new Uint8Array(e))}catch(e){this.c.reject(e)}return this.c},t.close=function(){try{this.b.close(),this.closed.resolve(),this.f.$a()}catch(e){this.closed.reject(e)}return this.closed},t.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},t.ag=function(e){this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new Ce("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:e.message.buffer}))},t.Zf=function(){this.c&&(ou(this,"usable"),this.c.resolve(),this.c=null)},t.$f=function(){var e=Error("EME PatchedMediaKeysApple key error");if(e.errorCode=this.b.error,null!=this.a)this.a.reject(e),this.a=null;else if(null!=this.c)this.c.reject(e),this.c=null;else switch(this.b.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:ou(this,"output-not-allowed");break;default:ou(this,"internal-error")}},(t=lu.prototype).forEach=function(e){this.a&&e(this.a,zl)},t.get=function(e){if(this.has(e))return this.a},t.has=function(e){var t=zl;return!(!this.a||!pt.za(new Uint8Array(e),new Uint8Array(t)))},t.entries=function(){},t.keys=function(){},t.values=function(){},$l(function(){d.HTMLVideoElement&&d.WebKitMediaKeys&&(zl=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=iu,d.MediaKeys=nu,d.MediaKeySystemAccess=tu,navigator.requestMediaKeySystemAccess=eu)}),cu.prototype.createMediaKeys=function(){var e=new du(this.keySystem);return Promise.resolve(e)},cu.prototype.getConfiguration=function(){return this.a},du.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new pu(this.a,e)},du.prototype.setServerCertificate=function(){return Promise.resolve(!1)},U(pu,Ae),(t=pu.prototype).generateRequest=function(e,t){this.a=new ve;try{this.c=this.g.createSession("video/mp4",new Uint8Array(t),null),this.f.w(this.c,"mskeymessage",this.sf.bind(this)),this.f.w(this.c,"mskeyadded",this.qf.bind(this)),this.f.w(this.c,"mskeyerror",this.rf.bind(this)),gu(this,"status-pending")}catch(e){this.a.reject(e)}return this.a},t.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},t.update=function(e){this.b=new ve;try{this.c.update(new Uint8Array(e))}catch(e){this.b.reject(e)}return this.b},t.close=function(){try{this.c.close(),this.closed.resolve(),this.f.$a()}catch(e){this.closed.reject(e)}return this.closed},t.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},t.sf=function(e){this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new Ce("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:e.message.buffer}))},t.qf=function(){this.a?(gu(this,"usable"),this.a.resolve(),this.a=null):this.b&&(gu(this,"usable"),this.b.resolve(),this.b=null)},t.rf=function(){var e=Error("EME PatchedMediaKeysMs key error");if(e.errorCode=this.c.error,null!=this.a)this.a.reject(e),this.a=null;else if(null!=this.b)this.b.reject(e),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:gu(this,"output-not-allowed");break;default:gu(this,"internal-error")}},(t=vu.prototype).forEach=function(e){this.a&&e(this.a,Yl)},t.get=function(e){if(this.has(e))return this.a},t.has=function(e){var t=Yl;return!(!this.a||!pt.za(new Uint8Array(e),new Uint8Array(t)))},t.entries=function(){},t.keys=function(){},t.values=function(){},$l(function(){!d.HTMLVideoElement||!d.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(Yl=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=hu,d.MediaKeys=du,d.MediaKeySystemAccess=cu,navigator.requestMediaKeySystemAccess=uu)}),_u.prototype.createSession=function(){},_u.prototype.setServerCertificate=function(){},Tu.prototype.getConfiguration=function(){},Tu.prototype.createMediaKeys=function(){},$l(function(){!d.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(navigator.requestMediaKeySystemAccess=yu,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=bu,d.MediaKeys=_u,d.MediaKeySystemAccess=Tu)},-10);var Su,Eu="";function wu(e){return Eu?Eu+e.charAt(0).toUpperCase()+e.slice(1):e}function Cu(e,t){try{var i=new Au(e,t);return Promise.resolve(i)}catch(e){return Promise.reject(e)}}function ku(e){var t=this.mediaKeys;return t&&t!=e&&xu(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&xu(e,this),Promise.resolve()}function Au(e,t){this.a=this.keySystem=e;var i=!1;"org.w3.clearkey"==e&&(i=!(this.a="webkit-org.w3.clearkey"));var n=!1,r=document.getElementsByTagName("video");r=r.length?r[0]:document.createElement("video");for(var a=0;a<t.length;++a){var s=t[a],o={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:s.initDataTypes,sessionTypes:["temporary"],label:s.label},l=!1;if(s.audioCapabilities)for(var u=0;u<s.audioCapabilities.length;++u){var c=s.audioCapabilities[u];if(c.contentType){l=!0;var h=c.contentType.split(";")[0];r.canPlayType(h,this.a)&&(o.audioCapabilities.push(c),n=!0)}}if(s.videoCapabilities)for(u=0;u<s.videoCapabilities.length;++u)(c=s.videoCapabilities[u]).contentType&&(l=!0,r.canPlayType(c.contentType,this.a)&&(o.videoCapabilities.push(c),n=!0));if(l||(n=r.canPlayType("video/mp4",this.a)||r.canPlayType("video/webm",this.a)),"required"==s.persistentState&&(i?(o.persistentState="required",o.sessionTypes=["persistent-license"]):n=!1),n)return void(this.b=o)}throw i="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(i="None of the requested configurations were supported."),(i=Error(i)).name="NotSupportedError",i.code=DOMException.NOT_SUPPORTED_ERR,i}function Iu(e){this.g=e,this.b=null,this.a=new Ke,this.c=[],this.f={}}function xu(e,t){e.b=t,e.a.$a();var i=Eu;t&&(e.a.w(t,i+"needkey",e.xf.bind(e)),e.a.w(t,i+"keymessage",e.dg.bind(e)),e.a.w(t,i+"keyadded",e.bg.bind(e)),e.a.w(t,i+"keyerror",e.cg.bind(e)))}function Pu(e,t){var i=e.f[t];return i||((i=e.c.shift())?(i.sessionId=t,e.f[t]=i):null)}function Lu(e,t,i){Ae.call(this),this.f=e,this.h=!1,this.a=this.b=null,this.c=t,this.g=i,this.sessionId="",this.expiration=NaN,this.closed=new ve,this.keyStatuses=new Du}function Ru(t,e,i){if(t.h)return Promise.reject(Error("The session is already initialized."));t.h=!0;try{if("persistent-license"==t.g)if(i)var n=new Uint8Array(ct("LOAD_SESSION|"+i));else{var r=ct("PERSISTENT|"),a=new Uint8Array(r.byteLength+e.byteLength);a.set(new Uint8Array(r),0),a.set(new Uint8Array(e),r.byteLength),n=a}else n=new Uint8Array(e)}catch(e){return Promise.reject(e)}t.b=new ve;var s=wu("generateKeyRequest");try{t.f[s](t.c,n)}catch(e){if("InvalidStateError"!=e.name)return t.b=null,Promise.reject(e);new de(function(){try{t.f[s](t.c,n)}catch(e){t.b.reject(e),t.b=null}}).P(.01)}return t.b}function Ou(e,t){var i=e.keyStatuses;i.size=null==t?0:1,i.a=t,e.dispatchEvent(new Ce("keystatuseschange"))}function Du(){this.size=0,this.a=void 0}function Nu(e){if("picture-in-picture"==(e=e.target).webkitPresentationMode){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function Mu(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function Bu(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function Uu(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function Fu(e,t,i){return new d.TextTrackCue(e,t,i)}function ju(e,t,i){return new d.TextTrackCue(e+"-"+t+"-"+i,e,t,i)}function Hu(){}Au.prototype.createMediaKeys=function(){var e=new Iu(this.a);return Promise.resolve(e)},Au.prototype.getConfiguration=function(){return this.b},(t=Iu.prototype).createSession=function(e){if("temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.b||document.createElement("video");return t.src||(t.src="about:blank"),e=new Lu(t,this.g,e),this.c.push(e),e},t.setServerCertificate=function(){return Promise.resolve(!1)},t.xf=function(e){var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="webm",t.initData=e.initData,this.b.dispatchEvent(t)},t.dg=function(e){var t=Pu(this,e.sessionId);t&&(e=new Ce("message",{messageType:null==t.keyStatuses.a?"licenserequest":"licenserenewal",message:e.message}),t.b&&(t.b.resolve(),t.b=null),t.dispatchEvent(e))},t.bg=function(e){(e=Pu(this,e.sessionId))&&(Ou(e,"usable"),e.a&&e.a.resolve(),e.a=null)},t.cg=function(e){var t=Pu(this,e.sessionId);t&&t.handleError(e)},U(Lu,Ae),(t=Lu.prototype).handleError=function(e){var t=Error("EME v0.1b key error");t.errorCode=e.errorCode,t.errorCode.systemCode=e.systemCode,!e.sessionId&&this.b?(t.method="generateRequest",45==e.systemCode&&(t.message="Unsupported session type."),this.b.reject(t),this.b=null):e.sessionId&&this.a?(t.method="update",this.a.reject(t),this.a=null):(t=e.systemCode,e.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Ou(this,"output-restricted"):Ou(this,1==t?"expired":"internal-error"))},t.td=function(e,t){if(this.a)this.a.then(this.td.bind(this,e,t)).catch(this.td.bind(this,e,t));else{if(this.a=e,"webkit-org.w3.clearkey"==this.c){var i=ot(t),n=JSON.parse(i);"oct"!=n.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),i=pt.Ba(n.keys[0].k),n=pt.Ba(n.keys[0].kid)}else i=new Uint8Array(t),n=null;var r=wu("addKey");try{this.f[r](this.c,i,n,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}},t.generateRequest=function(e,t){return Ru(this,t,null)},t.load=function(e){return"persistent-license"==this.g?Ru(this,null,e):Promise.reject(Error("Not a persistent session."))},t.update=function(e){var t=new ve;return this.td(t,e),t},t.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=wu("cancelKeyRequest");try{this.f[e](this.c,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed},t.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()},(t=Du.prototype).forEach=function(e){this.a&&e(this.a,Su)},t.get=function(e){if(this.has(e))return this.a},t.has=function(e){var t=Su;return!(!this.a||!pt.za(new Uint8Array(e),new Uint8Array(t)))},t.entries=function(){},t.keys=function(){},t.values=function(){},$l(function(){if(!(!d.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)Eu="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;Su=new Uint8Array([0]).buffer,navigator.requestMediaKeySystemAccess=Cu,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=ku,d.MediaKeys=Iu,d.MediaKeySystemAccess=Au}}),$l(function(){if(d.HTMLVideoElement){var e=HTMLVideoElement.prototype;e.requestPictureInPicture&&document.exitPictureInPicture||!e.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,e.requestPictureInPicture=Mu,document.exitPictureInPicture=Bu,document.addEventListener("webkitpresentationmodechanged",Nu,!0))}}),$l(function(){if(d.HTMLMediaElement){var t=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch(function(){}),e}}}),$l(function(){if(d.HTMLVideoElement){var e=HTMLVideoElement.prototype;!e.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in e&&(e.getVideoPlaybackQuality=Uu)}}),$l(function(){if(!d.VTTCue&&d.TextTrackCue){var e=TextTrackCue.length;if(3==e)d.VTTCue=Fu;else if(6==e)d.VTTCue=ju;else{try{var t=!!Fu(1,2,"")}catch(e){t=!1}t&&(d.VTTCue=Fu)}}}),Hu.prototype.parseInit=function(){},Hu.prototype.parseMedia=function(e,t){var i=ot(e),n=[],r=new DOMParser,a=null;if(""==i)return n;try{a=r.parseFromString(i,"text/xml")}catch(e){throw new ge(2,2,2005,"Failed to parse TTML.")}if(a){if(i=a.getElementsByTagName("parsererror")[0])throw new ge(2,2,2005,i.textContent);if(!(r=a.getElementsByTagName("tt")[0]))throw new ge(2,2,2005,"TTML does not contain <tt> tag.");var s=$n.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","frameRate"),o=$n.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","subFrameRate"),l=$n.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","frameRateMultiplier"),u=$n.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","tickRate");if(a=r.getAttribute("xml:space")||"default",i=r.getAttribute("tts:extent"),"default"!=a&&"preserve"!=a)throw new ge(2,2,2005,"Invalid xml:space value: "+a);a="default"==a,s=new cc(s,o,l,u),o=tc(r.getElementsByTagName("metadata")[0]),l=tc(r.getElementsByTagName("styling")[0]),u=tc(r.getElementsByTagName("layout")[0]);for(var c=[],h=0;h<u.length;h++){var d,f,p=u[h],m=l,g=i,v=new hi,y=p.getAttribute("xml:id");if(y)v.id=y,y=null,g&&(y=Ku.exec(g)||qu.exec(g)),g=y?Number(y[1]):null,y=y?Number(y[2]):null,(d=ac(p,m,"extent"))&&(null!=(d=(f=Ku.exec(d))||qu.exec(d))&&(v.width=null!=g?100*Number(d[1])/g:Number(d[1]),v.height=null!=y?100*Number(d[2])/y:Number(d[2]),v.widthUnits=f||null!=g?di:0,v.heightUnits=f||null!=y?di:0)),(p=ac(p,m,"origin"))&&(null!=(d=(f=Ku.exec(p))||qu.exec(p))&&(v.viewportAnchorX=null!=y?100*Number(d[1])/y:Number(d[1]),v.viewportAnchorY=null!=g?100*Number(d[2])/g:Number(d[2]),v.viewportAnchorUnits=f||null!=g?di:0));else v=null;v&&c.push(v)}for(r=(i=q(i=(i=r.getElementsByTagName("body")[0])?Array.from(i.querySelectorAll("[begin]")):[])).next();!r.done;r=i.next())(r=ic(r.value,t.periodStart,s,o,l,u,c,a,!1))&&n.push(r)}return n};var Gu,Vu,Ku=/^(\d{1,2}(?:\.\d+)?|100)% (\d{1,2}(?:\.\d+)?|100)%$/,Wu=/^(\d+px|\d+em)$/,qu=/^(\d+)px (\d+)px$/,zu=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Yu=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,Xu=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,$u=/^(\d*(?:\.\d*)?)f$/,Ju=/^(\d*(?:\.\d*)?)t$/,Qu=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,Zu={left:si,center:"center",right:"end",start:si,end:"end"},ec={left:"line-left",center:"center",right:"line-right"};function tc(e){var t=[];if(!e)return t;for(var i=q(e.childNodes),n=i.next();!n.done;n=i.next())(n=n.value).nodeType==Node.ELEMENT_NODE&&"br"!==n.nodeName&&(n=tc(n),t=t.concat(n));return t.length||t.push(e),t}function ic(e,t,i,n,r,a,s,o,l){if(l&&"br"==e.nodeName)return(e=new Jt(0,0,"")).spacer=!0,e;var u=/^[\s\n]*$/.test(e.textContent),c=e.nodeType==Node.ELEMENT_NODE&&!e.hasAttribute("begin")&&!e.hasAttribute("end");if(e.nodeType!=Node.ELEMENT_NODE||c&&u||c&&!l)return null;u=lc(e.getAttribute("begin"),i),c=lc(e.getAttribute("end"),i);var h=lc(e.getAttribute("dur"),i);if(null==c&&null!=h&&(c=u+h),!l&&(null==u||null==c))throw new ge(2,2,2001);if(u+=t,c+=t,h="",l=[],Array.from(e.childNodes).find(function(e){return e.nodeType===Node.TEXT_NODE&&/\w+/.test(e.textContent)}))h=function e(t,i){for(var n="",r=q(t.childNodes),a=r.next();!a.done;a=r.next())"br"==(a=a.value).nodeName&&t.childNodes[0]!==a?n+="\n":a.childNodes&&0<a.childNodes.length?n+=e(a,i):n+=i?a=(a=a.textContent.trim()).replace(/\s+/g," "):a.textContent;return n}(e,o);else for(var d=q(e.childNodes),f=d.next();!f.done;f=d.next())(f=ic(f.value,t,i,n,r,a,s,o,!0))&&l.push(f);if((t=new Jt(u,c,h)).nestedCues=l,(a=oc(e,"region",a,"")[0])&&a.getAttribute("xml:id")){var p=a.getAttribute("xml:id");t.region=s.filter(function(e){return e.id==p})[0]}return function(e,t,i,n,r){"rtl"==rc(t,i,r,"direction")&&(e.direction="rtl");var a=rc(t,i,r,"writingMode");"tb"==a||"tblr"==a?e.writingMode="vertical-lr":"tbrl"==a?e.writingMode="vertical-rl":"rltb"==a||"rl"==a?e.direction="rtl":a&&(e.direction=ni),(a=rc(t,i,r,"textAlign"))?(e.positionAlign=ec[a],e.lineAlign=Zu[a],e.textAlign=ei[a.toUpperCase()]):e.textAlign="start",(a=rc(t,i,r,"displayAlign"))&&(e.displayAlign=ii[a.toUpperCase()]);(a=rc(t,i,r,"color"))&&(e.color=a);(a=rc(t,i,r,"backgroundColor"))&&(e.backgroundColor=a);(a=rc(t,i,r,"fontFamily"))&&(e.fontFamily=a);(a=rc(t,i,r,"fontWeight"))&&"bold"==a&&(e.fontWeight=700),(a=rc(t,i,r,"wrapOption"))&&"noWrap"==a&&(e.wrapLine=!1),(a=rc(t,i,r,"lineHeight"))&&a.match(Wu)&&(e.lineHeight=a),(a=rc(t,i,r,"fontSize"))&&a.match(Wu)&&(e.fontSize=a),(a=rc(t,i,r,"fontStyle"))&&(e.fontStyle=ci[a.toUpperCase()]);if(n){a=n.getAttribute("imagetype");var s=n.getAttribute("encoding");n=n.textContent.trim(),"PNG"==a&&"Base64"==s&&n&&(e.backgroundImage="data:image/png;base64,"+n)}(i=ac(i,r,"textDecoration"))&&nc(e,i),(t=sc(t,r,"textDecoration"))&&nc(e,t)}(t,e,a,n=oc(e,"smpte:backgroundImage",n,"#")[0],r),t}function nc(e,t){for(var i=t.split(" "),n=0;n<i.length;n++)switch(i[n]){case"underline":e.textDecoration.includes("underline")||e.textDecoration.push("underline");break;case"noUnderline":e.textDecoration.includes("underline")&&Pe(e.textDecoration,"underline");break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&Pe(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&Pe(e.textDecoration,"overline")}}function rc(e,t,i,n){return(e=sc(e,i,n))?e:ac(t,i,n)}function ac(e,t,i){for(var n=tc(e),r=0;r<n.length;r++){var a=$n.getAttributeNS(n[r],"http://www.w3.org/ns/ttml#styling",i);if(a)return a}return(e=oc(e,"style",t,"")[0])?$n.getAttributeNS(e,"http://www.w3.org/ns/ttml#styling",i):null}function sc(e,t,i){var n=$n.getAttributeNS(e,"http://www.w3.org/ns/ttml#styling",i);if(n)return n;for(e=oc(e,"style",t,""),t=null,n=0;n<e.length;n++){var r=$n.getAttributeNS(e[n],"http://www.w3.org/ns/ttml#styling",i);r&&(t=r)}return t}function oc(e,t,i,n){var r=[];if(!e||i.length<1)return r;var a=e;for(e=null;a&&!(e=a.getAttribute(t))&&(a=a.parentNode)instanceof Element;);if(t=e)for(e=(t=q(t=t.split(" "))).next();!e.done;e=t.next()){e=e.value;for(var s=(a=q(i)).next();!s.done;s=a.next())if(n+(s=s.value).getAttribute("xml:id")==e){r.push(s);break}}return r}function lc(e,t){var i=null;if(zu.test(e)){i=zu.exec(e);var n=Number(i[1]),r=Number(i[2]),a=Number(i[3]),s=Number(i[4]);i=(a+=(s+=(Number(i[5])||0)/t.b)/t.frameRate)+60*r+3600*n}else Yu.test(e)?i=uc(Yu,e):Xu.test(e)?i=uc(Xu,e):$u.test(e)?(i=$u.exec(e),i=Number(i[1])/t.frameRate):Ju.test(e)?(i=Ju.exec(e),i=Number(i[1])/t.a):Qu.test(e)&&(i=uc(Qu,e));return i}function uc(e,t){var i=e.exec(t);return null==i||""==i[0]?null:(Number(i[4])||0)/1e3+(Number(i[3])||0)+60*(Number(i[2])||0)+3600*(Number(i[1])||0)}function cc(e,t,i,n){this.frameRate=Number(e)||30,this.b=Number(t)||1,this.a=Number(n),0==this.a&&(this.a=e?this.frameRate*this.b:1),i&&(e=/^(\d+) (\d+)$/g.exec(i))&&(this.frameRate*=Number(e[1])/Number(e[2]))}function hc(){this.a=new Hu}function dc(){}function fc(e,t,i){var n,r,a,s;(n=/^align:(start|middle|center|end|left|right)$/.exec(t))?(t=n[1],e.textAlign="middle"==t?Zt:ei[t.toUpperCase()]):(n=/^vertical:(lr|rl)$/.exec(t))?e.writingMode="lr"==n[1]?"vertical-lr":"vertical-rl":(n=/^size:([\d.]+)%$/.exec(t))?e.size=Number(n[1]):(n=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(t))?(e.position=Number(n[1]),n[2]&&(t=n[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center")):(n=/^region:(.*)$/.exec(t))?(r=i,a=n[1],(t=(s=r.filter(function(e){return e.id==a})).length?s[0]:null)&&(e.region=t)):(i=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))?(e.lineInterpretation=1,e.line=Number(i[1]),i[2]&&(e.lineAlign=oi[i[2].toUpperCase()])):(i=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))&&(e.lineInterpretation=ai,e.line=Number(i[1]),i[2]&&(e.lineAlign=oi[i[2].toUpperCase()]))}function pc(e){if(null==(e=Kr(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g)))return null;var t=Number(e[2]),i=Number(e[3]);return 59<t||59<i?null:Number(e[4])/1e3+i+60*t+3600*(Number(e[1])||0)}function mc(){this.a=null}function gc(e,t,i){var n,r,a;return(new Gn).H("payl",Wn(function(e){n=ot(e)})).H("iden",Wn(function(e){r=ot(e)})).H("sttg",Wn(function(e){a=ot(e)})).parse(e),n?function(e,t,i,n,r){if(e=new Jt(n,r,e),t&&(e.id=t),i)for(t=new Gr(i),i=Wr(t);i;)fc(e,i,[]),Vr(t),i=Wr(t);return e}(n,r,a,t,i):null}
/*
     @license
     EME Encryption Scheme Polyfill
     Copyright 2019 Google LLC
     SPDX-License-Identifier: Apache-2.0
    */
function vc(){}function yc(){Gu?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(Gu=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=bc):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function bc(i,n){var r=this;return z(function e(){var t;return X(e,function(e){switch(e.j){case 1:return console.assert(r==navigator,'bad "this" for requestMediaKeySystemAccess'),Y(e,Gu.call(r,i,n),2);case 2:return Ic(t=e.o)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=Gu,e.return(t)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=_c,e.return(_c.call(r,i,n)))}})})}function _c(h,d){var f=this;return z(function e(){var n,r,a,s,o,l,u,c;return X(e,function(e){switch(e.j){case 1:console.assert(f==navigator,'bad "this" for requestMediaKeySystemAccess'),n=Ac(h),r=[];for(var t=q(d),i=t.next();!i.done;i=t.next())a=i.value,s=Tc(a.videoCapabilities,n),o=Tc(a.audioCapabilities,n),a.videoCapabilities&&a.videoCapabilities.length&&!s.length||a.audioCapabilities&&a.audioCapabilities.length&&!o.length||((l=Object.assign({},a)).videoCapabilities=s,l.audioCapabilities=o,r.push(l));if(!r.length)throw(u=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",u.code=DOMException.NOT_SUPPORTED_ERR,u;return Y(e,Gu.call(f,h,r),2);case 2:return c=e.o,e.return(new kc(c,n))}})})}function Tc(e,t){return e?e.filter(function(e){return!e.encryptionScheme||e.encryptionScheme==t}):e}function Sc(){}function Ec(){navigator.mediaCapabilities?(Vu=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=wc):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function wc(i){var n=this;return z(function e(){var t;return X(e,function(e){switch(e.j){case 1:return console.assert(n==navigator.mediaCapabilities,'bad "this" for decodingInfo'),Y(e,Vu.call(n,i),2);case 2:return(t=e.o,i.keySystemConfiguration)?Ic(t.keySystemAccess)?(console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=Vu,e.return(t)):(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=Cc,e.return(Cc.call(n,i))):e.return(t)}})})}function Cc(l){var u=this;return z(function e(){var t,i,n,r,a,s,o;return X(e,function(e){switch(e.j){case 1:return console.assert(u==navigator.mediaCapabilities,'bad "this" for decodingInfo'),t=null,l.keySystemConfiguration&&(i=l.keySystemConfiguration,n=i.keySystem,r=i.audio&&i.audio.encryptionScheme,a=i.video&&i.video.encryptionScheme,t=Ac(n),s={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:l},r&&r!=t||a&&a!=t)?e.return(s):Y(e,Vu.call(u,l),2);case 2:return(o=e.o).keySystemAccess&&(o.keySystemAccess=new kc(o.keySystemAccess,t)),e.return(o)}})})}function kc(e,t){this.b=e,this.a=t,this.keySystem=e.keySystem}function Ac(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function Ic(e){var t=(e=e.getConfiguration()).audioCapabilities&&e.audioCapabilities[0];return void 0!==(e.videoCapabilities&&e.videoCapabilities[0]||t).encryptionScheme}function xc(){}function Pc(){yc(),Ec()}mi["application/ttml+xml"]=Hu,hc.prototype.parseInit=function(e){var t=!1;if((new Gn).H("moov",Vn).H("trak",Vn).H("mdia",Vn).H("minf",Vn).H("stbl",Vn).fa("stsd",Kn).H("stpp",function(e){t=!0,e.parser.stop()}).parse(e),!t)throw new ge(2,2,2007)},hc.prototype.parseMedia=function(e,t){var i=!1,n=[];if((new Gn).H("mdat",Wn(function(e){i=!0,n=n.concat(this.a.parseMedia(e,t))}.bind(this))).parse(e),!i)throw new ge(2,2,2007);return n},mi['application/mp4; codecs="stpp"']=hc,mi['application/mp4; codecs="stpp.TTML.im1t"']=hc,dc.prototype.parseInit=function(){},dc.prototype.parseMedia=function(e,t){var i=ot(e);if(i=(i=i.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m),!/^WEBVTT($|[ \t\n])/m.test(i[0]))throw new ge(2,2,2e3);var n=t.segmentStart;if(null==n&&i[n=0].includes("X-TIMESTAMP-MAP")){var r=i[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),a=i[0].match(/MPEGTS:(\d+)/m);if(r&&a){if(null==(n=pc(new Gr(r[1]))))throw new ge(2,2,2e3);n=t.periodStart+(Number(a[1])/9e4-n)}}a=[];var s=i[0].split("\n");for(r=1;r<s.length;r++)if(/^Region:/.test(s[r])){var o=new Gr(s[r]),l=new hi;Wr(o),Vr(o);for(var u=Wr(o);u;){var c=l,h=u;(u=/^id=(.*)$/.exec(h))?c.id=u[1]:(u=/^width=(\d{1,2}|100)%$/.exec(h))?c.width=Number(u[1]):(u=/^lines=(\d+)$/.exec(h))?(c.height=Number(u[1]),c.heightUnits=2):(u=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(h))?(c.regionAnchorX=Number(u[1]),c.regionAnchorY=Number(u[2])):(u=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(h))?(c.viewportAnchorX=Number(u[1]),c.viewportAnchorY=Number(u[2])):/^scroll=up$/.exec(h)&&(c.scroll="up"),Vr(o),u=Wr(o)}a.push(l)}for(r=[],o=1;o<i.length;o++){if(u=s=i[o].split("\n"),h=n,s=a,1==u.length&&!u[0]||/^NOTE($|[ \t])/.test(u[0])||"STYLE"==u[0])s=null;else{l=null,u[0].includes("--\x3e")||(l=u[0],u.splice(0,1));var d=pc(c=new Gr(u[0])),f=Kr(c,/[ \t]+--\x3e[ \t]+/g),p=pc(c);if(null==d||null==f||null==p)throw new ge(2,2,2001);for(u=new Jt(d+h,p+h,u.slice(1).join("\n").trim()),Vr(c),h=Wr(c);h;)fc(u,h,s),Vr(c),h=Wr(c);null!=l&&(u.id=l),s=u}s&&r.push(s)}return r},mi["text/vtt"]=dc,mi['text/vtt; codecs="vtt"']=dc,mc.prototype.parseInit=function(e){var t=!1;if((new Gn).H("moov",Vn).H("trak",Vn).H("mdia",Vn).fa("mdhd",function(e){0==e.version?(e.reader.M(4),e.reader.M(4),this.a=e.reader.G(),e.reader.M(4)):(e.reader.M(8),e.reader.M(8),this.a=e.reader.G(),e.reader.M(8)),e.reader.M(4)}.bind(this)).H("minf",Vn).H("stbl",Vn).fa("stsd",Kn).H("wvtt",function(){t=!0}).parse(e),!this.a)throw new ge(2,2,2008);if(!t)throw new ge(2,2,2008)},mc.prototype.parseMedia=function(e,s){var o=this;if(!this.a)throw new ge(2,2,2008);var t,l=0,u=[],c=[],i=!1,h=!1,n=!1,d=null;if((new Gn).H("moof",Vn).H("traf",Vn).fa("tfdt",function(e){i=!0,l=0==e.version?e.reader.G():e.reader.Ab()}).fa("tfhd",function(e){var t=e.flags;(e=e.reader).M(4),1&t&&e.M(8),2&t&&e.M(4),d=8&t?e.G():null}).fa("trun",function(e){h=!0;var t=e.version,i=e.flags,n=(e=e.reader).G();1&i&&e.M(4),4&i&&e.M(4);for(var r=[],a=0;a<n;a++){var s={duration:null,sampleSize:null,vd:null};256&i&&(s.duration=e.G()),512&i&&(s.sampleSize=e.G()),1024&i&&e.M(4),2048&i&&(s.vd=0==t?e.G():e.$d()),r.push(s)}u=r}).H("mdat",Wn(function(e){n=!0,t=e})).parse(e),!n&&!i&&!h)throw new ge(2,2,2008);var f=l,p=new Fn(new DataView(t.buffer,t.byteOffset,t.byteLength),0);return u.forEach(function(e){var t=e.duration||d,i=e.vd?l+e.vd:f;f=i+(t||0);var n=0;do{var r=p.G();n+=r;var a=null;"vttc"==zn(p.G())?8<r&&(a=p.Za(r-8)):p.M(r-8),t&&a&&c.push(gc(a,s.periodStart+i/o.a,s.periodStart+f/o.a))}while(e.sampleSize&&n<e.sampleSize)}),c.filter(Vt.Ia)},mi['application/mp4; codecs="wvtt"']=mc,B("shaka.util.Dom.createHTMLElement",function(e){return document.createElement(e)}),B("shaka.util.Dom.createVideoElement",function(){var e=document.createElement("video");return e.muted=!0,e.width=600,e.height=400,e}),B("shaka.util.Dom.asHTMLElement",function(e){return e}),B("shaka.util.Dom.asHTMLMediaElement",function(e){return e}),B("shaka.util.Dom.removeAllChildren",function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}),B("EmeEncryptionSchemePolyfill",vc),vc.install=yc,B("McEncryptionSchemePolyfill",Sc),Sc.install=Ec,kc.prototype.getConfiguration=function(){var e=this.b.getConfiguration();if(e.videoCapabilities)for(var t=q(e.videoCapabilities),i=t.next();!i.done;i=t.next())i.value.encryptionScheme=this.a;if(e.audioCapabilities)for(i=(t=q(e.audioCapabilities)).next();!i.done;i=t.next())i.value.encryptionScheme=this.a;return e},kc.prototype.createMediaKeys=function(){return this.b.createMediaKeys()},B("EncryptionSchemePolyfills",xc),xc.install=Pc,Lc.De&&(Lc.De=xc)}.call(t,e,e),t.shaka)n[i]=t.shaka[i]}()}),Cl=window.shaka?window.shaka:wl,kl=function(){function e(){}var t=e.prototype;return t.languageCode=function(e){return e?e.split("-")[0]:null},t.remainingTime=function(){var e=this.duration();return e===1/0||0===e?1/0:e-this.currentTime()},t.supportsEpgProgramChange=function(){return this.supportsEpgProgramChange_||!1},t.base=function(){},t.triggerRecoverableTechError=function(e,t){Fa("RecoverableTechError",t,e);var i="Tech: "+t+"  Can't load video: error category: "+(e.category||"")+" code: "+(e.code||"")+" message: "+(e.message||"");this.trigger(va.RECOVERABLE_ASSET_ERROR,{source:this.options_.source,techName:t,message:i,error:e})},t.trackDuration=function(){this.durationInterval&&this.stopTrackingDuration(),this.preDuration_=0,this.durationInterval=this.setInterval(function(){this.isReady_&&this.onDurationUpdate()},1e3)},t.stopTrackingDuration=function(){this.durationInterval&&(this.clearInterval(this.durationInterval),this.durationInterval=null,this.preDuration_=0,this.trigger(va.DURATION_CHANGE))},t.onDurationUpdate=function(){var e=this.duration();this.preDuration_!==e&&(!this.preDuration_||0===e||1<=e-this.preDuration_||e-this.preDuration_<=-1)&&(this.preDuration_=this.duration(),this.trigger(va.DURATION_CHANGE))},t.fetchWidevineCertificate=function(t,i){var n=this;Fa("fetchWidevineCertificate");var e=new XMLHttpRequest;e.addEventListener("error",this.checkForRecoverableErrors,!1),e.responseType="arraybuffer",e.addEventListener("load",function(e){n.onWidevineCertificateLoad_(e,{callback:i,certificateUrl:t})},!1),e.open("GET",t,!0),e.send()},t.onWidevineCertificateLoad_=function(e,t){var i=t.callback,n=t.certificateUrl;Fa("onWidevineCertificateLoad"),this.trigger({type:va.DRM_SESSION_UPDATE,bubbles:!0},{messageType:"WIDEVINE_CERTIFICATE_REQUEST",code:void 0,info:n});var r=e.target;if(r.status<300&&4===r.readyState){var a=new Uint8Array(e.target.response);this.trigger({type:va.DRM_SESSION_UPDATE,bubbles:!0},{messageType:"WIDEVINE_CERTIFICATE_RESPONSE",code:void 0,info:"onWidevineCertificateLoad"}),i(a)}else{var s={message:"onWidevineCertificateLoad",code:r.status};if("arraybuffer"===r.responseType){var o=new TextDecoder("utf-8");s.message=o.decode(r.response)}s.category=6,i(null,s)}},t.baseHandleSource=function(i,n){var r=this;if(!i.src)return!1;var e=i.licenseServer||i.licenseserver,t=i.keySystems||i.keysystems;if(T.document.documentMode||Is||Cs||ks&&Es||vs||Ts||Ls)this.certificate_=null;else if(i.certificateServer&&!this.certificate_&&(e||t&&!wa(t)))return this.fetchWidevineCertificate(i.certificateServer,function(e,t){e?("EmpDashif"===r.name_?r.certificate_=Aa(e):r.certificate_=e,r.handleSource(i,n)):r.checkForRecoverableErrors(t||{message:"no certificate",category:6})}),!1;this.stopTrackingDuration&&this.stopTrackingDuration(),this.stopped_=!1,this.ended_=!1,this.hasStarted_=!1,this.hasMetadata_=!1,this.options_.source=i;var a=this.options_.audioLanguage,s=this.options_.subtitleLanguage;return this.options_=Ta(this.options_,i.options),a&&(this.options_.audioLanguage=a),s&&(this.options_.subtitleLanguage=s),this.currentProgram_=null,this.currentVOD_=null,(e||t)&&(this.playToken=i.playToken||i.playtoken),this.clearTracks(["text"]),!0},t.program=function(e){if(void 0===e)return this.currentProgram_;this.currentProgram_=e,this.currentVOD_=null,e&&e.asset&&this.options_.source&&(this.options_.source.assetId=e.asset.assetId)},t.VOD=function(e){if(void 0===e)return this.currentVOD_;this.currentVOD_=e,this.currentProgram_=null,e&&this.options_.source&&(this.options_.source.assetId=e.assetId)},t.isTechTextTrackSynchronized=function(e){e=e.sort();for(var t=this.textTracks(),i=[],n=0;n<t.length;n++)i.push(t[n].language);i=i.sort();var r=e.join()===i.join();return Fa("isTextTrackSynchronized",r),r},t.syncVideojsTexttrackVisibility=function(){Fa("syncVideojsTexttrackVisibility"),this.blockLocalTrackChange=!0;var e=this.textTracks(),t=e.length;if(this.shakaPlayer_.isTextTrackVisible())for(var i=this.getSelectedTechTextLanguage();t--;){var n=e[t];n.language===i&&"showing"!==n.mode?n.mode="showing":n.language!==i&&"disabled"!==n.mode&&(n.mode="disabled")}else for(;t--;){var r=e[t];"showing"===r.mode&&(r.mode="hidden")}this.stopBlockLocalTrackChange("syncVideojsTexttrackVisibility")},t.deferredSelectTextTrack=function(e){Fa("deferredSelectTextTrack enter",e),this.deferredTextTrackChangeTimeOut&&clearTimeout(this.deferredTextTrackChangeTimeOut),this.deferredTextTrackChangeTimeOut=setTimeout(function(){Fa("update texttrack"),clearTimeout(this.deferredTextTrackChangeTimeOut),this.deferredTextTrackChangeTimeOut=null,this.isDispose_||(this.blockLocalTrackChange=!0,this.selectTechTextLanguage(e),this.stopBlockLocalTrackChange("deferredSelectTextTrack exit"))}.bind(this),2e3)},t.selectVideojsTextLanguage=function(e){Fa("selectVideojsTextLanguage",e);for(var t=this.textTracks(),i=t.length;i--;){var n=t[i];e===n.language&&"showing"!==n.mode?(this.blockLocalTrackChange=!0,n.mode="showing"):e!==n.language&&"showing"===n.mode&&(this.blockLocalTrackChange=!0,n.mode="disabled")}this.stopBlockLocalTrackChange("selectVideojsAudioLanguage")},t.baseTextTrackChange=function(){if(this.blockLocalTrackChange)Fa("blockLocalTrackChange","baseTextTrackChange");else{Fa("ontextTrackChange");for(var e=this.textTracks(),t=e.length;t--;){var i=e[t];if("showing"===i.mode)return void this.deferredSelectTextTrack(i.language)}this.deferredSelectTextTrack(null)}},t.isTechAudioTrackSynchronized=function(e){e=e.sort();for(var t=this.audioTracks(),i=[],n=0;n<t.length;n++)i.push(t[n].language);i=i.sort();var r=e.join()===i.join();return Fa("isAudioTrackSynchronized",r),r},t.baseAudioTrackChange=function(){if(this.blockLocalTrackChange)Fa("blockLocalTrackChange","baseAudioTrackChange");else{Fa("onAudioTrackChange");for(var e=this.audioTracks(),t=e.length;t--;){var i=e[t];if(i.enabled)return void this.selectTechAudioLanguage(i.language)}}},t.selectVideojsAudioLanguage=function(e){if(Fa("selectVideojsAudioLanguage",e),e){for(var t=this.audioTracks(),i=t.length;i--;){var n=t[i];if(n.language===e&&!n.enabled){this.blockLocalTrackChange=!0,n.enabled=!0;break}}this.stopBlockLocalTrackChange("selectVideojsAudioLanguage")}},t.addAudioTrack=function(e,t,i,n){void 0===n&&(n=!1);var r=new ga.AudioTrack({enabled:n,kind:e||"main",label:t,language:i});return this.audioTracks().addTrack(r),r},t.stopBlockLocalTrackChange=function(e){this.blockLocalTrackChange&&(this.blockLocalTrackChangeTimeOut&&clearTimeout(this.blockLocalTrackChangeTimeOut),this.blockLocalTrackChangeTimeOut=setTimeout(function(){try{clearTimeout(this.blockLocalTrackChangeTimeOut),this.blockLocalTrackChangeTimeOut=null,Fa(e,"stopBlockLocalTrackChange"," TRACK_CHANGE"),this.trigger(va.TRACK_CHANGE),this.blockLocalTrackChange=!1}catch(e){}}.bind(this),2e3))},e}();function Al(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Il(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Il)}var xl=new(function(e,t,i){return t&&Al(e.prototype,t),i&&Al(e,i),e}(Il,[{key:"init",value:function(e,t,i){if(this.mixins=e,this.context=t,this.opt={warn:!0,mergeDuplicates:!0},this.contextMethods=Object.getOwnPropertyNames(this.context.constructor.prototype),this.reactMethods=["componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","componentWillUnmount"],i&&(this.opt.warn=void 0!==i.warn?i.warn:this.opt.warn,this.opt.mergeDuplicates=void 0!==i.mergeDuplicates?i.mergeDuplicates:this.opt.mergeDuplicates),this.mixins.constructor===Array)e.map(function(e){this.grabMethods(e)},this);else{if("function"!=typeof e&&"object"!=typeof e)throw"mixins expects a function, an array, or an object. Please and thank you";this.grabMethods(e)}}},{key:"addNewMethod",value:function(e,t){this.mixins.prototype?this.context.constructor.prototype[e]=this.mixins.prototype[e]:this.context.constructor.prototype[e]="object"==typeof t?t[e]:t.prototype[e],this.contextMethods=Object.getOwnPropertyNames(this.context.constructor.prototype)}},{key:"extendMethod",value:function(e,t,i){var n=this.context[t],r="object"==typeof i?i[e]:i.prototype[e];this.context[e]=function(){r.call(this,arguments),n.call(this,arguments)}}},{key:"grabMethods",value:function(e){var t=this,i=e;("object"==typeof e?Object.getOwnPropertyNames(e):Object.getOwnPropertyNames(e.prototype)).map(function(e){"constructor"!==e&&"render"!==e&&t.checkForMatch(e,i)},this)}},{key:"checkForMatch",value:function(t,i){var n=this;this.contextMethods.map(function(e){t===e&&(-1<n.reactMethods.indexOf(t)?n.extendMethod(t,e,i):(n.opt.warn&&console.warn(t+" method already exists within the "+n.context.constructor.name+" component."),n.opt.mergeDuplicates&&n.extendMethod(t,e,i)))}),this.addNewMethod(t,i)}}]),Il),Pl=xl.init.bind(xl);function Ll(){this.aar={"ISO_639-1":"aa","ISO_639-3":"aar"},this.abk={"ISO_639-1":"ab","ISO_639-3":"abk"},this.ave={"ISO_639-1":"ae","ISO_639-3":"ave"},this.afr={"ISO_639-1":"af","ISO_639-3":"afr"},this.aka={"ISO_639-1":"ak","ISO_639-3":"aka"},this.amh={"ISO_639-1":"am","ISO_639-3":"amh"},this.arg={"ISO_639-1":"an","ISO_639-3":"arg"},this.ara={"ISO_639-1":"ar","ISO_639-3":"ara"},this.asm={"ISO_639-1":"as","ISO_639-3":"asm"},this.ava={"ISO_639-1":"av","ISO_639-3":"ava"},this.aym={"ISO_639-1":"ay","ISO_639-3":"aym"},this.aze={"ISO_639-1":"az","ISO_639-3":"aze"},this.bak={"ISO_639-1":"ba","ISO_639-3":"bak"},this.bel={"ISO_639-1":"be","ISO_639-3":"bel"},this.bul={"ISO_639-1":"bg","ISO_639-3":"bul"},this.bis={"ISO_639-1":"bi","ISO_639-3":"bis"},this.bam={"ISO_639-1":"bm","ISO_639-3":"bam"},this.ben={"ISO_639-1":"bn","ISO_639-3":"ben"},this.bod={"ISO_639-1":"bo","ISO_639-3":"bod"},this.bre={"ISO_639-1":"br","ISO_639-3":"bre"},this.bos={"ISO_639-1":"bs","ISO_639-3":"bos"},this.cat={"ISO_639-1":"ca","ISO_639-3":"cat"},this.che={"ISO_639-1":"ce","ISO_639-3":"che"},this.cha={"ISO_639-1":"ch","ISO_639-3":"cha"},this.cos={"ISO_639-1":"co","ISO_639-3":"cos"},this.cre={"ISO_639-1":"cr","ISO_639-3":"cre"},this.ces={"ISO_639-1":"cs","ISO_639-3":"ces"},this.chu={"ISO_639-1":"cu","ISO_639-3":"chu"},this.chv={"ISO_639-1":"cv","ISO_639-3":"chv"},this.cym={"ISO_639-1":"cy","ISO_639-3":"cym"},this.dan={"ISO_639-1":"da","ISO_639-3":"dan"},this.deu={"ISO_639-1":"de","ISO_639-3":"deu"},this.div={"ISO_639-1":"dv","ISO_639-3":"div"},this.dzo={"ISO_639-1":"dz","ISO_639-3":"dzo"},this.ewe={"ISO_639-1":"ee","ISO_639-3":"ewe"},this.ell={"ISO_639-1":"el","ISO_639-3":"ell"},this.eng={"ISO_639-1":"en","ISO_639-3":"eng"},this.epo={"ISO_639-1":"eo","ISO_639-3":"epo"},this.spa={"ISO_639-1":"es","ISO_639-3":"spa"},this.est={"ISO_639-1":"et","ISO_639-3":"est"},this.eus={"ISO_639-1":"eu","ISO_639-3":"eus"},this.fas={"ISO_639-1":"fa","ISO_639-3":"fas"},this.ful={"ISO_639-1":"ff","ISO_639-3":"ful"},this.fin={"ISO_639-1":"fi","ISO_639-3":"fin"},this.fij={"ISO_639-1":"fj","ISO_639-3":"fij"},this.fao={"ISO_639-1":"fo","ISO_639-3":"fao"},this.fra={"ISO_639-1":"fr","ISO_639-3":"fra"},this.fry={"ISO_639-1":"fy","ISO_639-3":"fry"},this.ger={"ISO_639-1":"de","ISO_639-3":"deu"},this.gle={"ISO_639-1":"ga","ISO_639-3":"gle"},this.gla={"ISO_639-1":"gd","ISO_639-3":"gla"},this.glg={"ISO_639-1":"gl","ISO_639-3":"glg"},this.grn={"ISO_639-1":"gn","ISO_639-3":"grn"},this.guj={"ISO_639-1":"gu","ISO_639-3":"guj"},this.glv={"ISO_639-1":"gv","ISO_639-3":"glv"},this.hau={"ISO_639-1":"ha","ISO_639-3":"hau"},this.heb={"ISO_639-1":"he","ISO_639-3":"heb"},this.hin={"ISO_639-1":"hi","ISO_639-3":"hin"},this.hmo={"ISO_639-1":"ho","ISO_639-3":"hmo"},this.hrv={"ISO_639-1":"hr","ISO_639-3":"hrv"},this.hat={"ISO_639-1":"ht","ISO_639-3":"hat"},this.hun={"ISO_639-1":"hu","ISO_639-3":"hun"},this.hye={"ISO_639-1":"hy","ISO_639-3":"hye"},this.her={"ISO_639-1":"hz","ISO_639-3":"her"},this.ina={"ISO_639-1":"ia","ISO_639-3":"ina"},this.ind={"ISO_639-1":"id","ISO_639-3":"ind"},this.ile={"ISO_639-1":"ie","ISO_639-3":"ile"},this.ibo={"ISO_639-1":"ig","ISO_639-3":"ibo"},this.iii={"ISO_639-1":"ii","ISO_639-3":"iii"},this.ipk={"ISO_639-1":"ik","ISO_639-3":"ipk"},this.ido={"ISO_639-1":"io","ISO_639-3":"ido"},this.isl={"ISO_639-1":"is","ISO_639-3":"isl"},this.ita={"ISO_639-1":"it","ISO_639-3":"ita"},this.iku={"ISO_639-1":"iu","ISO_639-3":"iku"},this.jpn={"ISO_639-1":"ja","ISO_639-3":"jpn"},this.jav={"ISO_639-1":"jv","ISO_639-3":"jav"},this.kat={"ISO_639-1":"ka","ISO_639-3":"kat"},this.kon={"ISO_639-1":"kg","ISO_639-3":"kon"},this.kik={"ISO_639-1":"ki","ISO_639-3":"kik"},this.kua={"ISO_639-1":"kj","ISO_639-3":"kua"},this.kaz={"ISO_639-1":"kk","ISO_639-3":"kaz"},this.kal={"ISO_639-1":"kl","ISO_639-3":"kal"},this.khm={"ISO_639-1":"km","ISO_639-3":"khm"},this.kan={"ISO_639-1":"kn","ISO_639-3":"kan"},this.kor={"ISO_639-1":"ko","ISO_639-3":"kor"},this.kau={"ISO_639-1":"kr","ISO_639-3":"kau"},this.kas={"ISO_639-1":"ks","ISO_639-3":"kas"},this.kur={"ISO_639-1":"ku","ISO_639-3":"kur"},this.kom={"ISO_639-1":"kv","ISO_639-3":"kom"},this.cor={"ISO_639-1":"kw","ISO_639-3":"cor"},this.kir={"ISO_639-1":"ky","ISO_639-3":"kir"},this.lat={"ISO_639-1":"la","ISO_639-3":"lat"},this.ltz={"ISO_639-1":"lb","ISO_639-3":"ltz"},this.lug={"ISO_639-1":"lg","ISO_639-3":"lug"},this.lim={"ISO_639-1":"li","ISO_639-3":"lim"},this.lin={"ISO_639-1":"ln","ISO_639-3":"lin"},this.lao={"ISO_639-1":"lo","ISO_639-3":"lao"},this.lit={"ISO_639-1":"lt","ISO_639-3":"lit"},this.lub={"ISO_639-1":"lu","ISO_639-3":"lub"},this.lav={"ISO_639-1":"lv","ISO_639-3":"lav"},this.mlg={"ISO_639-1":"mg","ISO_639-3":"mlg"},this.mah={"ISO_639-1":"mh","ISO_639-3":"mah"},this.mri={"ISO_639-1":"mi","ISO_639-3":"mri"},this.mkd={"ISO_639-1":"mk","ISO_639-3":"mkd"},this.mal={"ISO_639-1":"ml","ISO_639-3":"mal"},this.mon={"ISO_639-1":"mn","ISO_639-3":"mon"},this.mar={"ISO_639-1":"mr","ISO_639-3":"mar"},this.msa={"ISO_639-1":"ms","ISO_639-3":"msa"},this.mlt={"ISO_639-1":"mt","ISO_639-3":"mlt"},this.mya={"ISO_639-1":"my","ISO_639-3":"mya"},this.nau={"ISO_639-1":"na","ISO_639-3":"nau"},this.nob={"ISO_639-1":"nb","ISO_639-3":"nob"},this.nde={"ISO_639-1":"nd","ISO_639-3":"nde"},this.nep={"ISO_639-1":"ne","ISO_639-3":"nep"},this.ndo={"ISO_639-1":"ng","ISO_639-3":"ndo"},this.nld={"ISO_639-1":"nl","ISO_639-3":"nld"},this.nno={"ISO_639-1":"nn","ISO_639-3":"nno"},this.nor={"ISO_639-1":"no","ISO_639-3":"nor"},this.nbl={"ISO_639-1":"nr","ISO_639-3":"nbl"},this.nav={"ISO_639-1":"nv","ISO_639-3":"nav"},this.nya={"ISO_639-1":"ny","ISO_639-3":"nya"},this.oci={"ISO_639-1":"oc","ISO_639-3":"oci"},this.oji={"ISO_639-1":"oj","ISO_639-3":"oji"},this.orm={"ISO_639-1":"om","ISO_639-3":"orm"},this.ori={"ISO_639-1":"or","ISO_639-3":"ori"},this.oss={"ISO_639-1":"os","ISO_639-3":"oss"},this.pan={"ISO_639-1":"pa","ISO_639-3":"pan"},this.pli={"ISO_639-1":"pi","ISO_639-3":"pli"},this.pol={"ISO_639-1":"pl","ISO_639-3":"pol"},this.pus={"ISO_639-1":"ps","ISO_639-3":"pus"},this.por={"ISO_639-1":"pt","ISO_639-3":"por"},this.que={"ISO_639-1":"qu","ISO_639-3":"que"},this.roh={"ISO_639-1":"rm","ISO_639-3":"roh"},this.run={"ISO_639-1":"rn","ISO_639-3":"run"},this.ron={"ISO_639-1":"ro","ISO_639-3":"ron"},this.rus={"ISO_639-1":"ru","ISO_639-3":"rus"},this.kin={"ISO_639-1":"rw","ISO_639-3":"kin"},this.san={"ISO_639-1":"sa","ISO_639-3":"san"},this.srd={"ISO_639-1":"sc","ISO_639-3":"srd"},this.snd={"ISO_639-1":"sd","ISO_639-3":"snd"},this.sme={"ISO_639-1":"se","ISO_639-3":"sme"},this.sag={"ISO_639-1":"sg","ISO_639-3":"sag"},this.hbs={"ISO_639-1":"sh (deprecated)","ISO_639-3":"hbs"},this.sin={"ISO_639-1":"si","ISO_639-3":"sin"},this.slk={"ISO_639-1":"sk","ISO_639-3":"slk"},this.slv={"ISO_639-1":"sl","ISO_639-3":"slv"},this.smo={"ISO_639-1":"sm","ISO_639-3":"smo"},this.sna={"ISO_639-1":"sn","ISO_639-3":"sna"},this.som={"ISO_639-1":"so","ISO_639-3":"som"},this.sqi={"ISO_639-1":"sq","ISO_639-3":"sqi"},this.srp={"ISO_639-1":"sr","ISO_639-3":"srp"},this.ssw={"ISO_639-1":"ss","ISO_639-3":"ssw"},this.sot={"ISO_639-1":"st","ISO_639-3":"sot"},this.sun={"ISO_639-1":"su","ISO_639-3":"sun"},this.swe={"ISO_639-1":"sv","ISO_639-3":"swe"},this.swa={"ISO_639-1":"sw","ISO_639-3":"swa"},this.tam={"ISO_639-1":"ta","ISO_639-3":"tam"},this.tel={"ISO_639-1":"te","ISO_639-3":"tel"},this.tgk={"ISO_639-1":"tg","ISO_639-3":"tgk"},this.tha={"ISO_639-1":"th","ISO_639-3":"tha"},this.tir={"ISO_639-1":"ti","ISO_639-3":"tir"},this.tuk={"ISO_639-1":"tk","ISO_639-3":"tuk"},this.tgl={"ISO_639-1":"tl","ISO_639-3":"tgl"},this.tsn={"ISO_639-1":"tn","ISO_639-3":"tsn"},this.ton={"ISO_639-1":"to","ISO_639-3":"ton"},this.tur={"ISO_639-1":"tr","ISO_639-3":"tur"},this.tso={"ISO_639-1":"ts","ISO_639-3":"tso"},this.tat={"ISO_639-1":"tt","ISO_639-3":"tat"},this.twi={"ISO_639-1":"tw","ISO_639-3":"twi"},this.tah={"ISO_639-1":"ty","ISO_639-3":"tah"},this.uig={"ISO_639-1":"ug","ISO_639-3":"uig"},this.ukr={"ISO_639-1":"uk","ISO_639-3":"ukr"},this.urd={"ISO_639-1":"ur","ISO_639-3":"urd"},this.uzb={"ISO_639-1":"uz","ISO_639-3":"uzb"},this.ven={"ISO_639-1":"ve","ISO_639-3":"ven"},this.vie={"ISO_639-1":"vi","ISO_639-3":"vie"},this.vol={"ISO_639-1":"vo","ISO_639-3":"vol"},this.wln={"ISO_639-1":"wa","ISO_639-3":"wln"},this.wol={"ISO_639-1":"wo","ISO_639-3":"wol"},this.xho={"ISO_639-1":"xh","ISO_639-3":"xho"},this.yid={"ISO_639-1":"yi","ISO_639-3":"yid"},this.yor={"ISO_639-1":"yo","ISO_639-3":"yor"},this.zha={"ISO_639-1":"za","ISO_639-3":"zha"},this.zho={"ISO_639-1":"zh","ISO_639-3":"zho"},this.zul={"ISO_639-1":"zu","ISO_639-3":"zul"}}Ll.prototype.from3to1=function(e){return this.hasOwnProperty(e)?this[e]["ISO_639-1"]:null},T.iso639Converter=new Ll;var Rl={ab:{name:"Abkhaz",nativeName:"аҧсуа"},aa:{name:"Afar",nativeName:"Afaraf"},af:{name:"Afrikaans",nativeName:"Afrikaans"},ak:{name:"Akan",nativeName:"Akan"},sq:{name:"Albanian",nativeName:"Shqip"},am:{name:"Amharic",nativeName:"አማርኛ"},ar:{name:"Arabic",nativeName:"العربية"},an:{name:"Aragonese",nativeName:"Aragonés"},hy:{name:"Armenian",nativeName:"Հայերեն"},as:{name:"Assamese",nativeName:"অসমীয়া"},av:{name:"Avaric",nativeName:"авар мацӀ, магӀарул мацӀ"},ae:{name:"Avestan",nativeName:"avesta"},ay:{name:"Aymara",nativeName:"aymar aru"},az:{name:"Azerbaijani",nativeName:"azərbaycan dili"},bm:{name:"Bambara",nativeName:"bamanankan"},ba:{name:"Bashkir",nativeName:"башҡорт теле"},eu:{name:"Basque",nativeName:"euskara, euskera"},be:{name:"Belarusian",nativeName:"Беларуская"},bn:{name:"Bengali",nativeName:"বাংলা"},bh:{name:"Bihari",nativeName:"भोजपुरी"},bi:{name:"Bislama",nativeName:"Bislama"},bs:{name:"Bosnian",nativeName:"bosanski jezik"},br:{name:"Breton",nativeName:"brezhoneg"},bg:{name:"Bulgarian",nativeName:"български език"},my:{name:"Burmese",nativeName:"ဗမာစာ"},ca:{name:"Catalan; Valencian",nativeName:"Català"},ch:{name:"Chamorro",nativeName:"Chamoru"},ce:{name:"Chechen",nativeName:"нохчийн мотт"},ny:{name:"Chichewa; Chewa; Nyanja",nativeName:"chiCheŵa, chinyanja"},zh:{name:"Chinese",nativeName:"中文 (Zhōngwén), 汉语, 漢語"},cv:{name:"Chuvash",nativeName:"чӑваш чӗлхи"},kw:{name:"Cornish",nativeName:"Kernewek"},co:{name:"Corsican",nativeName:"corsu, lingua corsa"},cr:{name:"Cree",nativeName:"ᓀᐦᐃᔭᐍᐏᐣ"},hr:{name:"Croatian",nativeName:"hrvatski"},cs:{name:"Czech",nativeName:"česky, čeština"},da:{name:"Danish",nativeName:"dansk"},dv:{name:"Divehi; Dhivehi; Maldivian;",nativeName:"ދިވެހި"},nl:{name:"Dutch",nativeName:"Nederlands, Vlaams"},en:{name:"English",nativeName:"English"},eo:{name:"Esperanto",nativeName:"Esperanto"},et:{name:"Estonian",nativeName:"eesti, eesti keel"},ee:{name:"Ewe",nativeName:"Eʋegbe"},fo:{name:"Faroese",nativeName:"føroyskt"},fj:{name:"Fijian",nativeName:"vosa Vakaviti"},fi:{name:"Finnish",nativeName:"suomi, suomen kieli"},fr:{name:"French",nativeName:"français, langue française"},ff:{name:"Fula; Fulah; Pulaar; Pular",nativeName:"Fulfulde, Pulaar, Pular"},gl:{name:"Galician",nativeName:"Galego"},ka:{name:"Georgian",nativeName:"ქართული"},de:{name:"German",nativeName:"Deutsch"},el:{name:"Greek, Modern",nativeName:"Ελληνικά"},gn:{name:"Guaraní",nativeName:"Avañeẽ"},gu:{name:"Gujarati",nativeName:"ગુજરાતી"},ht:{name:"Haitian; Haitian Creole",nativeName:"Kreyòl ayisyen"},ha:{name:"Hausa",nativeName:"Hausa, هَوُسَ"},he:{name:"Hebrew (modern)",nativeName:"עברית"},hz:{name:"Herero",nativeName:"Otjiherero"},hi:{name:"Hindi",nativeName:"हिन्दी, हिंदी"},ho:{name:"Hiri Motu",nativeName:"Hiri Motu"},hu:{name:"Hungarian",nativeName:"Magyar"},ia:{name:"Interlingua",nativeName:"Interlingua"},id:{name:"Indonesian",nativeName:"Bahasa Indonesia"},ie:{name:"Interlingue",nativeName:"Originally called Occidental; then Interlingue after WWII"},ga:{name:"Irish",nativeName:"Gaeilge"},ig:{name:"Igbo",nativeName:"Asụsụ Igbo"},ik:{name:"Inupiaq",nativeName:"Iñupiaq, Iñupiatun"},io:{name:"Ido",nativeName:"Ido"},is:{name:"Icelandic",nativeName:"Íslenska"},it:{name:"Italian",nativeName:"Italiano"},iu:{name:"Inuktitut",nativeName:"ᐃᓄᒃᑎᑐᑦ"},ja:{name:"Japanese",nativeName:"日本語 (にほんご／にっぽんご)"},jv:{name:"Javanese",nativeName:"basa Jawa"},kl:{name:"Kalaallisut, Greenlandic",nativeName:"kalaallisut, kalaallit oqaasii"},kn:{name:"Kannada",nativeName:"ಕನ್ನಡ"},kr:{name:"Kanuri",nativeName:"Kanuri"},ks:{name:"Kashmiri",nativeName:"कश्मीरी, كشميري‎"},kk:{name:"Kazakh",nativeName:"Қазақ тілі"},km:{name:"Khmer",nativeName:"ភាសាខ្មែរ"},ki:{name:"Kikuyu, Gikuyu",nativeName:"Gĩkũyũ"},rw:{name:"Kinyarwanda",nativeName:"Ikinyarwanda"},ky:{name:"Kirghiz, Kyrgyz",nativeName:"кыргыз тили"},kv:{name:"Komi",nativeName:"коми кыв"},kg:{name:"Kongo",nativeName:"KiKongo"},ko:{name:"Korean",nativeName:"한국어 (韓國語), 조선말 (朝鮮語)"},ku:{name:"Kurdish",nativeName:"Kurdî, كوردی‎"},kj:{name:"Kwanyama, Kuanyama",nativeName:"Kuanyama"},la:{name:"Latin",nativeName:"latine, lingua latina"},lb:{name:"Luxembourgish, Letzeburgesch",nativeName:"Lëtzebuergesch"},lg:{name:"Luganda",nativeName:"Luganda"},li:{name:"Limburgish, Limburgan, Limburger",nativeName:"Limburgs"},ln:{name:"Lingala",nativeName:"Lingála"},lo:{name:"Lao",nativeName:"ພາສາລາວ"},lt:{name:"Lithuanian",nativeName:"lietuvių kalba"},lu:{name:"Luba-Katanga",nativeName:""},lv:{name:"Latvian",nativeName:"latviešu valoda"},gv:{name:"Manx",nativeName:"Gaelg, Gailck"},mk:{name:"Macedonian",nativeName:"македонски јазик"},mg:{name:"Malagasy",nativeName:"Malagasy fiteny"},ms:{name:"Malay",nativeName:"bahasa Melayu, بهاس ملايو‎"},ml:{name:"Malayalam",nativeName:"മലയാളം"},mt:{name:"Maltese",nativeName:"Malti"},mi:{name:"Māori",nativeName:"te reo Māori"},mr:{name:"Marathi (Marāṭhī)",nativeName:"मराठी"},mh:{name:"Marshallese",nativeName:"Kajin M̧ajeļ"},mn:{name:"Mongolian",nativeName:"монгол"},na:{name:"Nauru",nativeName:"Ekakairũ Naoero"},nv:{name:"Navajo, Navaho",nativeName:"Diné bizaad, Dinékʼehǰí"},nb:{name:"Norwegian Bokmål",nativeName:"Norsk bokmål"},nd:{name:"North Ndebele",nativeName:"isiNdebele"},ne:{name:"Nepali",nativeName:"नेपाली"},ng:{name:"Ndonga",nativeName:"Owambo"},nn:{name:"Norwegian Nynorsk",nativeName:"Norsk nynorsk"},no:{name:"Norwegian",nativeName:"Norsk"},ii:{name:"Nuosu",nativeName:"ꆈꌠ꒿ Nuosuhxop"},nr:{name:"South Ndebele",nativeName:"isiNdebele"},oc:{name:"Occitan",nativeName:"Occitan"},oj:{name:"Ojibwe, Ojibwa",nativeName:"ᐊᓂᔑᓈᐯᒧᐎᓐ"},cu:{name:"Old Church Slavonic, Church Slavic, Church Slavonic, Old Bulgarian, Old Slavonic",nativeName:"ѩзыкъ словѣньскъ"},om:{name:"Oromo",nativeName:"Afaan Oromoo"},or:{name:"Oriya",nativeName:"ଓଡ଼ିଆ"},os:{name:"Ossetian, Ossetic",nativeName:"ирон æвзаг"},pa:{name:"Panjabi, Punjabi",nativeName:"ਪੰਜਾਬੀ, پنجابی‎"},pi:{name:"Pāli",nativeName:"पाऴि"},fa:{name:"Persian",nativeName:"فارسی"},pl:{name:"Polish",nativeName:"polski"},ps:{name:"Pashto, Pushto",nativeName:"پښتو"},pt:{name:"Portuguese",nativeName:"Português"},qu:{name:"Quechua",nativeName:"Runa Simi, Kichwa"},rm:{name:"Romansh",nativeName:"rumantsch grischun"},rn:{name:"Kirundi",nativeName:"kiRundi"},ro:{name:"Romanian, Moldavian, Moldovan",nativeName:"română"},ru:{name:"Russian",nativeName:"русский язык"},sa:{name:"Sanskrit (Saṁskṛta)",nativeName:"संस्कृतम्"},sc:{name:"Sardinian",nativeName:"sardu"},sd:{name:"Sindhi",nativeName:"सिन्धी, سنڌي، سندھی‎"},se:{name:"Northern Sami",nativeName:"Davvisámegiella"},sm:{name:"Samoan",nativeName:"gagana faa Samoa"},sg:{name:"Sango",nativeName:"yângâ tî sängö"},sr:{name:"Serbian",nativeName:"српски језик"},gd:{name:"Scottish Gaelic; Gaelic",nativeName:"Gàidhlig"},sn:{name:"Shona",nativeName:"chiShona"},si:{name:"Sinhala, Sinhalese",nativeName:"සිංහල"},sk:{name:"Slovak",nativeName:"slovenčina"},sl:{name:"Slovene",nativeName:"slovenščina"},so:{name:"Somali",nativeName:"Soomaaliga, af Soomaali"},st:{name:"Southern Sotho",nativeName:"Sesotho"},es:{name:"Spanish; Castilian",nativeName:"español, castellano"},su:{name:"Sundanese",nativeName:"Basa Sunda"},sw:{name:"Swahili",nativeName:"Kiswahili"},ss:{name:"Swati",nativeName:"SiSwati"},sv:{name:"Swedish",nativeName:"svenska"},ta:{name:"Tamil",nativeName:"தமிழ்"},te:{name:"Telugu",nativeName:"తెలుగు"},tg:{name:"Tajik",nativeName:"тоҷикӣ, toğikī, تاجیکی‎"},th:{name:"Thai",nativeName:"ไทย"},ti:{name:"Tigrinya",nativeName:"ትግርኛ"},bo:{name:"Tibetan Standard, Tibetan, Central",nativeName:"བོད་ཡིག"},tk:{name:"Turkmen",nativeName:"Türkmen, Түркмен"},tl:{name:"Tagalog",nativeName:"Wikang Tagalog, ᜏᜒᜃᜅ᜔ ᜆᜄᜎᜓᜄ᜔"},tn:{name:"Tswana",nativeName:"Setswana"},to:{name:"Tonga (Tonga Islands)",nativeName:"faka Tonga"},tr:{name:"Turkish",nativeName:"Türkçe"},ts:{name:"Tsonga",nativeName:"Xitsonga"},tt:{name:"Tatar",nativeName:"татарча, tatarça, تاتارچا‎"},tw:{name:"Twi",nativeName:"Twi"},ty:{name:"Tahitian",nativeName:"Reo Tahiti"},ug:{name:"Uighur, Uyghur",nativeName:"Uyƣurqə, ئۇيغۇرچە‎"},uk:{name:"Ukrainian",nativeName:"українська"},ur:{name:"Urdu",nativeName:"اردو"},uz:{name:"Uzbek",nativeName:"zbek, Ўзбек, أۇزبېك‎"},ve:{name:"Venda",nativeName:"Tshivenḓa"},vi:{name:"Vietnamese",nativeName:"Tiếng Việt"},vo:{name:"Volapük",nativeName:"Volapük"},wa:{name:"Walloon",nativeName:"Walon"},cy:{name:"Welsh",nativeName:"Cymraeg"},wo:{name:"Wolof",nativeName:"Wollof"},fy:{name:"Western Frisian",nativeName:"Frysk"},xh:{name:"Xhosa",nativeName:"isiXhosa"},yi:{name:"Yiddish",nativeName:"ייִדיש"},yo:{name:"Yoruba",nativeName:"Yorùbá"},za:{name:"Zhuang, Chuang",nativeName:"Saɯ cueŋƅ, Saw cuengh"}};function Ol(e){var t;t=3===e.length?T.iso639Converter.from3to1(e):e.slice(0,2);var i=Rl[t];return i?i.name:e}var Dl=ga.getPlugin("plugin"),Nl=ga.getComponent("Tech"),Ml=function(n){function e(e,t){var i;return i=n.call(this,e,t)||this,Fa("DownloadService","create"),i.options_=t||{},i.offlineOperationInProgress_=!1,i}ca(e,n);var t=e.prototype;return t.deleteAll=function(){return Cl.offline.Storage.deleteAll(this.player.tech_.shakaPlayer_)},t.startDownload=function(a,s,o,l,u){var e,t,c=this;if(this.offlineOperationInProgress_)return e="Offline Operation In Progress",Fa.error(e),Promise.reject(e);if(!a&&!s&&!o)return e="assetId or channelId or programId is undefined",Fa.error(e),Promise.reject(e);this.offlineOperationInProgress_=!0;var i={assetId:a||null,programId:o||null,channelId:s||null};if(!this.player.programService)return e="No programService",Fa.error(e),Promise.reject(e);t=this.player.programService().exposure;var h=Nl.getTech("EmpShaka").entitlementPlayRequest;return new Promise(function(n,r){t.getEntitlement(i,h,function(t,e){if(e){if(e.fatal){c.offlineOperationInProgress_=!1;var i=new Ma(e,Na.ENTITLEMENT);c.player.analytics&&c.player.analytics().onError({code:i.code,message:i.message,stack:i.stack}),r(i)}}else(l=l||{}).name||(l.name=t.assetId?t.assetId:t.channelId),l.assetId=a,l.programId=o,l.channelId=s,c.player.programService().getAssetMetadata(l.assetId,function(e){e&&(l.title=e.title,l.subtitle=e.subtitle,l.images=e.images),c.startDownloadEntitlement_(t,l,u,n,r)})})})},t.startDownloadEntitlement_=function(e,t,i,n,r){var a=this;this.startDownloadSource(e,t,i).then(function(e){a.offlineOperationInProgress_=!1,n(e)}).catch(function(e){this.cancelInProgress_?n(null):(this.offlineOperationInProgress_=!1,this.player.analytics&&this.player.analytics().onError({code:e.code,message:e.message,stack:e.stack}),Fa.error(e.message),r(e))})},t.startDownloadSource=function(e,t,i){var n;if(this.cancelInProgress_=!1,void 0===e)return n="source is undefined",Fa.error(n),Promise.reject(n);var r=Pa(e);if(!r.length)return n="source is undefined",Fa.error(n),Promise.reject(n);this.destroy(),this.storage_||this.initStorage_(),this.offlineOperationInProgress_=!0;var a={};-1===T.navigator.userAgent.indexOf("Android")?a.drm={advanced:{"com.widevine.alpha":{videoRobustness:"SW_SECURE_DECODE",audioRobustness:"SW_SECURE_CRYPTO"}}}:a.drm={advanced:{"com.widevine.alpha":{videoRobustness:"SW_SECURE_CRYPTO",audioRobustness:"SW_SECURE_CRYPTO"}}};var s=e.licenseServer||e.licenseserver,o=e.keySystems||e.keysystems;return s?a.drm.servers={"com.widevine.alpha":s,"com.microsoft.playready":s,"com.adobe.primetime":s}:o&&(a.drm.servers=o),a.offline={progressCallback:this.setDownloadProgress_.bind(this),usePersistentLicense:i},this.player.tech_.shakaPlayer_.configure(a),t&&(t.downloaded=new Date),this.storage_.store(r[0].src,t)},t.selectTracks_=function(e){var t=e.filter(function(e){return"variant"===e.type}).sort(function(e,t){return e.bandwidth>t.bandwidth}).pop();return Fa("Offline Track: "+t),[t]},t.initStorage_=function(){this.storage_&&(this.storage_.destroy(),this.storage_=null),"EmpShaka"===this.player.techName_&&this.player.tech_||this.player.loadTech_("EmpShaka"),this.player.tech_.shakaPlayer_||this.player.tech_.createPlayer_(!0),this.storage_=new Cl.offline.Storage(this.player.tech_.shakaPlayer_)},t.setDownloadProgress_=function(e,t){this.trigger(va.DOWNLOAD_PROGRESS,{content:e,progress:t})},t.list=function(){return this.storage_||this.initStorage_(),this.storage_.list()},t.remove=function(e){return this.storage_||this.initStorage_(),this.storage_.remove(e)},t.load=function(e,t){void 0===t&&(t={autoplay:!0}),e?(t&&(this.player.options(t),t.autoplay&&this.player.autoplay(t.autoplay)),this.player.src({type:"application/dash+xml",src:e})):Fa.error("offlineUri is undefined")},t.cancel=function(){this.offlineOperationInProgress_&&(this.cancelInProgress_=!0,this.destroy())},t.destroy=function(){this.storage_&&(this.storage_.destroy(),this.storage_=null),this.offlineOperationInProgress_=!1},t.dispose=function(){Fa("DownloadService is being disposed"),this.storage_&&(this.storage_.destroy(),this.storage_=null),this.offlineOperationInProgress_=!1,n.prototype.dispose.call(this)},ua(e,[{key:"isSupported",get:function(){return!!Cl.offline.Storage&&Cl.offline.Storage.support()}},{key:"offlineOperationInProgress",get:function(){return this.offlineOperationInProgress_}}]),e}(Dl);Ml.VERSION="2.2.124-498",ga.getPlugin("DownloadService")?ga.log.warn('A plugin named "DownloadService" already exists.'):ga.registerPlugin("download",Ml);var Bl=ga.getTech("Html5"),Ul=ga.getComponent("Tech"),Fl="EmpShaka",jl=function(h){function i(e,t){var i;return void 0===e&&(e={}),void 0===t&&(t=function(){}),e.constructing_=!0,(i=h.call(this,e,t)||this).base||Pl(kl,ma(i),{mergeDuplicates:!1}),i.isDispose_=!1,i.loading_=!1,i.certificate_=null,Cl.polyfill.installAll(),i.textTrackChangeBind=i.baseTextTrackChange.bind(ma(i)),i.textTracks().on("selectedlanguagechange",i.textTrackChangeBind),i.audioTrackChangeBind=i.baseAudioTrackChange.bind(ma(i)),i.audioTracks().on(va.CHANGE,i.audioTrackChangeBind),i.onEndedBind=i.onEnded.bind(ma(i)),i.el_.addEventListener(va.ENDED,i.onEndedBind),i.preActiveVariantTrack=null,i.preActiveTextTrack=null,i.onLoadStartBind=i.onLoadStart.bind(ma(i)),i.on(ma(i),va.LOAD_START,i.onLoadStartBind),ws&&(T.VTTRegion=null),i.options_.constructing_=e.constructing_=void 0,i.options_.source&&i.options_.source.src&&i.setSource(i.options_.source),i}ca(i,h);var e=i.prototype;return e.onLoadStart=function(e){this.hasMetadata_=!0,Fa("onLoadStart"),this.stopped_&&(e.stopImmediatePropagation(),this.trigger(va.ENDED))},e.disableTimeShift=function(e){this.options_?this.options_.timeShiftDisabled=e:this.options_={timeShiftDisabled:e},this.trigger(va.DURATION_CHANGE)},e.handleSource=function(e,t){var i=this;if(!t.options_.constructing_&&this.baseHandleSource(e,t)){this.preActiveVariantTrack=null,this.preActiveTextTrack=null,!this.loading_&&e.src||(Fa.warn("handleSource shaka is loading"),this.shakaPlayer_&&(this.shakaPlayer_.destroy(),this.shakaPlayer_=null,this.streamrootWrapper_=null)),this.shakaPlayer_?this.el_.paused||this.el_.pause():this.createPlayer_(this.options_.autoplay),this.shakaPlayer_.resetConfiguration();var n=this.options_.audioLanguage||this.options_.language,r=this.options_.subtitleLanguage||this.options_.language;r="None"!==r?r:"",Fa("preferredAudioLanguage",n),Fa("preferredTextLanguage",r);var a={streaming:{},abr:{},restrictions:{},preferredAudioLanguage:n,preferredTextLanguage:r};a.abr.enabled=!0,e.minBitrate&&(a.restrictions.minBandwidth=1e3*e.minBitrate),e.maxBitrate&&(a.restrictions.maxBandwidth=1e3*e.maxBitrate),e.maxResWidth&&(a.restrictions.maxWidth=e.maxResWidth),e.maxResHeight&&(a.restrictions.maxHeight=e.maxResHeight),this.options_.maxBitrate&&(a.restrictions.maxBandwidth=1e3*this.options_.maxBitrate),a.manifest={dash:{}},this.options_.clockSyncUri&&(a.manifest.dash.clockSyncUri=this.options_.clockSyncUri),void 0!==this.options_.liveDelay&&(a.manifest.dash.defaultPresentationDelay=this.options_.liveDelay,a.manifest.dash.ignoreMinBufferTime=!0),this.options_.abr&&(this.options_.abr.defaultBandwidthEstimate&&(a.abr.defaultBandwidthEstimate=this.options_.abr.defaultBandwidthEstimate),this.options_.abr.bandwidth_upgrade_target&&(a.abr.bandwidthUpgradeTarget=this.options_.abr.bandwidth_upgrade_target),this.options_.abr.bandwidth_downgrade_target&&(a.abr.bandwidthDowngradeTarget=this.options_.abr.bandwidth_downgrade_target),this.options_.abr.switch_interval_ms&&(a.abr.switchInterval=this.options_.abr.switch_interval_ms/1e3)),a.streaming={retryParameters:{maxAttempts:6,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},failureCallback:this.streamingFailureCallback.bind(this),ignoreTextStreamFailures:!0,jumpLargeGaps:!0,alwaysStreamText:!0},a.drm=Ts||Ls?{advanced:{"com.widevine.alpha":{videoRobustness:"SW_SECURE_CRYPTO",audioRobustness:"SW_SECURE_CRYPTO"}}}:{advanced:{"com.widevine.alpha":{videoRobustness:"SW_SECURE_DECODE",audioRobustness:"SW_SECURE_CRYPTO"}}};var s=e.licenseServer||e.licenseserver,o=e.keySystems||e.keysystems;s?a.drm.servers={"com.widevine.alpha":s,"com.microsoft.playready":s,"com.adobe.primetime":s}:o&&(a.drm.servers=o),(Ls||vs)&&a.drm.servers&&a.drm.servers["com.microsoft.playready"]&&a.drm.servers["com.widevine.alpha"]&&delete a.drm.servers["com.microsoft.playready"],this.certificate_&&a.drm.advanced&&a.drm.advanced["com.widevine.alpha"]&&(a.drm.advanced["com.widevine.alpha"].serverCertificate=this.certificate_),this.shakaPlayer_.configure(a),this.shakaPlayer_.setTextTrackVisibility(""!==r);var l,u=this.shakaPlayer_.getNetworkingEngine();if(this.playToken){var c={Authorization:"Bearer "+this.playToken};this.requestFilter&&u.unregisterRequestFilter(this.requestFilter),this.requestFilter=this.addLicenseRequestHeaders.bind(null,c),u.registerRequestFilter(this.requestFilter)}0<this.options_.startTime&&(l=this.options_.startTime),Fa("before load stream",e.src),this.loading_=!0,T.ShakaPlayerDnaWrapper&&this.options_.streamrootkey&&!this.streamrootWrapper_&&this.createStreamrootWrapper_(this.options_.streamrootkey),this.options_.autoplay?this.el_.autoplay=!0:this.el_.autoplay=!1,this.shakaPlayer_.load(e.src,l).then(function(){Fa("after load stream",i.options_.startTime),0<i.options_.startTime&&!i.shakaPlayer_.isLive()&&0<h.prototype.duration.call(i)&&h.prototype.duration.call(i)<1/0&&i.options_.startTime+30>h.prototype.duration.call(i)&&h.prototype.setCurrentTime.call(i,.1),i.loading_=!1,i.hasMetadata_=!0,i.trackDuration()}).catch(function(e){i.loading_=!1,e.code===Cl.util.Error.Code.LOAD_INTERRUPTED?Fa("Shaka load() interrupted"):i.checkForRecoverableErrors(e)})}},e.createStreamrootWrapper_=function(e){var t={shakaNamespace:Cl};return this.streamrootWrapper_=new ShakaPlayerDnaWrapper(this.shakaPlayer_,e,{},t),this.streamrootWrapper_},e.streamingFailureCallback=function(e){Fa(Fl,"Streaming Failure",e)},e.techVersion=function(){return Cl&&Cl.Player&&Cl.Player.version||"N/A"},e.createPlayer_=function(e){var r=this;return Fa("createPlayer Shaka"),e&&(this.el_.autoplay=!0),this.shakaPlayer_=new Cl.Player(this.el_),this.shakaPlayer_.addEventListener("texttrackvisibility",function(e){Fa("texttrackvisibility",r.hasMetadata_,r.shakaPlayer_.isTextTrackVisible()),r.hasMetadata_&&!r.blockLocalTrackChange&&r.syncVideojsTexttrackVisibility()}),this.shakaPlayer_.addEventListener("drmsessionbeforeupdate",function(e){r.drmsessionbeforeupdate_(e)}),this.shakaPlayer_.addEventListener("drmsessionupdate",function(e){var t;Fa("drmsessionupdate",e),r.drmsessionbeforeupdate_(e),r.shakaPlayer_.drmInfo()&&(t="com.microsoft.playready"===r.shakaPlayer_.drmInfo().keySystem?{messageType:"PLAYREADY_LICENSE_RESPONSE",code:void 0,info:"drmsessionupdate"}:"com.widevine.alpha"===r.shakaPlayer_.drmInfo().keySystem?e.isCertificateRequest?{messageType:"WIDEVINE_CERTIFICATE_RESPONSE",code:void 0,info:"drmsessionupdate"}:{messageType:"WIDEVINE_LICENSE_RESPONSE",code:void 0,info:"drmsessionupdate"}:{messageType:"FAIRPLAY_LICENSE_RESPONSE",code:void 0,info:"drmsessionupdate"},r.trigger({type:va.DRM_SESSION_UPDATE,bubbles:!0},t))}),this.shakaPlayer_.addEventListener("adaptation",function(e){if(Fa("Shaka adaptationchanged"),r.hasMetadata_){var t=r.getActiveVariantTrack(),i=r.getActiveTextTrack();if(t){if(null!==r.preActiveVariantTrack&&t.language===r.preActiveVariantTrack.language||(r.blockLocalTrackChange=!0,r.configureVideojsAudioTracks()),(null===r.preActiveTextTrack||i&&i.language!==r.preActiveTextTrack.language)&&(null===r.preActiveTextTrack&&""===r.shakaPlayer_.getConfiguration().preferredTextLanguage&&r.shakaPlayer_.isTextTrackVisible()&&r.shakaPlayer_.setTextTrackVisibility(!1),(r.filterUniqueTexttracks_(r.shakaPlayer_.getTextTracks()).length||r.textTracks().length)&&(r.blockLocalTrackChange=!0,r.configureVideojsTextTracks())),!r.preActiveVariantTrack||t&&t.videoBandwidth!==r.preActiveVariantTrack.videoBandwidth){Fa("BITRATE_CHANGED",t.videoBandwidth);var n=!1;r.shakaPlayer_.getConfiguration().abr.enabled&&(n=!0),r.trigger({type:va.BITRATE_CHANGED,bubbles:!0},{bitrate:t.videoBandwidth,auto:n})}r.stopBlockLocalTrackChange("adaptationchanged"),r.preActiveVariantTrack=t,r.preActiveTextTrack=i}}}),this.shakaPlayer_.addEventListener("trackschanged",function(e){Fa("Shaka trackschanged",e)}),this.shakaPlayer_.addEventListener("error",function(e){r.checkForRecoverableErrors(e.detail)}),this.shakaPlayer_.addEventListener("buffering",function(e){r.stopped_||r.ended_||(Fa("buffering",e,e?e.buffering:null),e.buffering?r.trigger(va.WAITING):r.el_&&r.el_.paused&&(r.paused()?r.trigger({type:va.PAUSE,bubbles:!0}):r.trigger({type:va.PLAYING,bubbles:!0})))}),this.shakaPlayer_},e.drmsessionbeforeupdate_=function(e){var t;Fa("drmsessionbeforeupdate",e),this.shakaPlayer_.drmInfo()&&(t="com.microsoft.playready"===this.shakaPlayer_.drmInfo().keySystem?{messageType:"PLAYREADY_LICENSE_REQUEST",code:void 0,info:this.shakaPlayer_.drmInfo().licenseServerUri}:"com.widevine.alpha"===this.shakaPlayer_.drmInfo().keySystem?e.isCertificateRequest?{messageType:"WIDEVINE_CERTIFICATE_REQUEST",code:void 0,info:this.shakaPlayer_.drmInfo().licenseServerUri}:{messageType:"WIDEVINE_LICENSE_REQUEST",code:void 0,info:this.shakaPlayer_.drmInfo().licenseServerUri}:{messageType:"FAIRPLAY_LICENSE_REQUES",code:void 0,info:this.shakaPlayer_.drmInfo().licenseServerUri},this.trigger({type:va.DRM_SESSION_UPDATE,bubbles:!0},t))},e.addErrorMessage=function(e){if(!e.message){var t="UNKNOWN",i="UNKNOWN";for(var n in Cl.util.Error.Category)Cl.util.Error.Category[n]===e.category&&(t=n);for(var r in Cl.util.Error.Code)Cl.util.Error.Code[r]===e.code&&(i=r);e.message=t+" "+i}},e.checkForRecoverableErrors=function(e){switch(this.addErrorMessage(e),e&&e.data&&0<e.data.length&&Fa.error(Fl,e.code,e.data,e.message),e.category){case 1:if(1002===e.code)return void Fa.warn("An HTTP network request failed with an error, but not from the server.");if(1003===e.code)return void Fa.warn("A network request timed out.");case 3:if(3015===e.code)return;this.triggerRecoverableError(e);break;case 4:this.triggerRecoverableError(e);break;case 6:var t="WIDEVINE_LICENSE_ERROR";if(this.shakaPlayer_.drmInfo()){var i=this.shakaPlayer_.drmInfo().keySystem;t="com.microsoft.playready"===i?"PLAYREADY_LICENSE_ERROR":"com.widevine.alpha"===i?"WIDEVINE_LICENSE_ERROR":"FAIRPLAY_LICENSE_ERROR"}this.trigger({type:va.DRM_SESSION_UPDATE,bubbles:!0},{messageType:t,code:e.code,info:e.message}),this.triggerRecoverableError(e);break;default:this.triggerRecoverableError(e)}},e.stop=function(e){var t=this;this.stopped_=!0,this.loading_=!1,this.stopTrackingDuration(),this.shakaPlayer_&&(this.hasMetadata_=!1,this.shakaPlayer_.unload().then(function(){t.clearTracks(["text"]),t.clearTracks(["audio"]),t.trigger({type:va.PAUSE,bubbles:!0}),t.trigger({type:va.ABORT,bubbles:!0}),t.trigger({type:va.STOPPED,bubbles:!0}),e&&e()}))},e.onEnded=function(){this.ended_=!0,this.stopTrackingDuration(),this.shakaPlayer_&&this.reset()},e.reset=function(){this.loading_=!1,this.hasMetadata_=!1,this.clearTracks(["text"]),this.clearTracks(["audio"]),h.prototype.reset.call(this)},e.addLicenseRequestHeaders=function(e,t,i){if(t===Cl.net.NetworkingEngine.RequestType.LICENSE)for(var n in e)i.headers[n]=e[n]},e.live=function(){return this.shakaPlayer_&&!this.loading_?this.shakaPlayer_.isLive():!(!this.options_||!this.options_.source)&&this.options_.source.live},e.duration=function(){if(this.live()){if(!this.shakaPlayer_)return 0;var e=this.shakaPlayer_.seekRange().end;return e}return h.prototype.duration.call(this)},e.currentTime=function(){if(!this.shakaPlayer_)return 0;var e=h.prototype.currentTime.call(this);return e},e.baseCurrentTime=function(){return h.prototype.currentTime.call(this)},e.setAbsoluteTime=function(e){Fa("setAbsoluteTime",e.date);try{if(this.live()){var t=(e.date-this.startTimeLive())/1e3;Fa("setAbsoluteTime setCurrentTime",t),this.setCurrentTime(t)}else this.setCurrentTime(e.date/1e3)}catch(e){Fa.error(e)}},e.getAbsoluteTime=function(){if(!this.el_)return 0;if(this.live()){var e=this.startTimeLive()/1e3+h.prototype.currentTime.call(this);return new Date(1e3*e)}return new Date(1e3*h.prototype.currentTime.call(this))},e.timeBehindLive=function(){if(!this.shakaPlayer_||!this.live())return 0;var e=this.shakaPlayer_.seekRange(),t=h.prototype.currentTime.call(this);return Math.floor(e.end-t)},e.startTimeLive=function(){var e=0;return this.live()&&(e=this.options_.source&&this.options_.source.streamInfo?this.options_.source.streamInfo.referenceTime:this.getPresentationStartTime()),e},e.getPresentationStartTime=function(){return this.shakaPlayer_&&!this.loading_&&this.live()&&this.shakaPlayer_.getPresentationStartTimeAsDate()?this.shakaPlayer_.getPresentationStartTimeAsDate().getTime():0},e.allowJump_=function(e){return e>this.shakaPlayer_.seekRange().end-2||e<2},e.setCurrentTime=function(e){if(this.options_.source){if(!1===this.options_.source.ffEnabled&&!this.allowJump_(e)&&this.currentTime()<=e)return;if(!1===this.options_.source.rwEnabled&&!this.allowJump_(e)&&this.currentTime()>=e)return}var t=this.shakaPlayer_.seekRange();t&&(e=(e=e>t.start?e:Oa(t.start,3))<t.end?e:t.end),h.prototype.setCurrentTime.call(this,e)},e.timeShiftEnabled=function(){return!1===this.options_.timeShiftDisabled},e.bitrates=function(){if(!this.shakaPlayer_)return[];var t=this.getActiveVariantTrack(),e=this.getVariantTracks(),i=[];return e.forEach(function(e){e.language===t.language&&-1===i.indexOf(e.videoBandwidth)&&i.push(e.videoBandwidth)}),i.sort(function(e,t){return t-e}),i},e.bitrate=function(e){void 0===e&&(e=null);var t=this.getActiveVariantTrack();if(null===e)return!this.shakaPlayer_.getConfiguration().abr.enabled&&t?t.videoBandwidth:0;if(0===e)return this.shakaPlayer_.configure({abr:{enabled:!0}}),this.trigger({type:va.BITRATE_CHANGED,bubbles:!0},{bitrate:e,auto:!0}),void(this.preActiveVariantTrack=null);for(var i=this.getVariantTracks(),n=null,r=0;r<i.length;r++){var a=i[r];if(a.videoBandwidth===e&&a.language===t.language){n=a;break}}if(null===n)throw new TypeError("Invalid bitrate specified.");this.shakaPlayer_.configure({abr:{enabled:!1}}),this.shakaPlayer_.selectVariantTrack(n,!0),this.trigger({type:va.BITRATE_CHANGED,bubbles:!0},{bitrate:e,auto:!1})},e.getBitrate=function(){var e=this.getActiveVariantTrack();return e?e.videoBandwidth:0},i.isSupported=function(){return!!ga.getTech("Html5").isSupported()&&("WebKitMediaSource"in T||"MediaSource"in T)},e.setMaxBitrate=function(e){if(this.shakaPlayer_){isNaN(e)?e=Number.POSITIVE_INFINITY:e*=1e3;var t={restrictions:{maxBandwidth:e}};this.shakaPlayer_.configure(t),this.trigger(va.LOADED_DATA)}else this.options_.maxBitrate=e},e.getMaxBitrate=function(){if(this.shakaPlayer_){var e=this.shakaPlayer_.getConfiguration();return e.restrictions.maxBandwidth?e.restrictions.maxBandwidth/1e3:e.restrictions.maxBandwidth}return this.options_.maxBitrate},e.canRestart=function(){return!this.live()||this.timeShiftEnabled()},e.getActiveVariantTrack=function(){for(var e=this.getVariantTracks(),t=0;t<e.length;t++){var i=e[t];if(i.active)return i}return null},e.getVariantTracks=function(){return this.shakaPlayer_.getVariantTracks()},e.isAudioTrackSynchronized=function(){var e=this.shakaPlayer_.getVariantTracks().map(function(e){return e.language}).filter(function(e,t,i){return i.indexOf(e)===t});return this.isTechAudioTrackSynchronized(e)},e.configureVideojsAudioTracks=function(){var i=this;if(this.isAudioTrackSynchronized())this.selectVideojsAudioLanguage(this.getSelectedTechAudioLanguage());else{Fa("configureVideojsAudioTracks");var e=this.getVariantTracks();this.clearTracks(["audio"]);var n={};e.forEach(function(e){var t=e.language;if(n.hasOwnProperty(t)){var i=n[t];e.audioBandwidth>i.audioBandwidth&&(n[t]=e)}else n[t]=e});var r=this.getActiveVariantTrack();Object.keys(n).forEach(function(e){var t=n[e];i.addAudioTrack(t.kind,Ol(t.language).split(";")[0],t.language,t.language===r.language)})}},e.selectTechAudioLanguage=function(e){e&&(this.options_?this.options_.audioLanguage=e:this.options_={audioLanguage:e},e!==this.getSelectedTechAudioLanguage()&&(Fa("selectTechAudioLanguage",e),this.shakaPlayer_.selectAudioLanguage(e)))},e.getSelectedTechAudioLanguage=function(){if(!this.shakaPlayer_)return null;var e=this.getActiveVariantTrack();return e?e.language:null},e.getActiveTextTrack=function(){var e=this.filterUniqueTexttracks_(this.shakaPlayer_.getTextTracks()).filter(function(e){return e.active});return 0<e.length?e[0]:null},e.getSelectedTechTextLanguage=function(){if(!this.shakaPlayer_)return null;var e=this.getActiveTextTrack();return e&&this.shakaPlayer_.isTextTrackVisible()?e.language:null},e.isTextTrackSynchronized=function(){var e=this.filterUniqueTexttracks_(this.shakaPlayer_.getTextTracks()).map(function(e){return e.language});return this.isTechTextTrackSynchronized(e)},e.configureVideojsTextTracks=function(){var i=this;if(this.isTextTrackSynchronized())this.selectVideojsTextLanguage(this.getSelectedTechTextLanguage());else{this.blockLocalTrackChange=!0,Fa("configureVideojsTextTracks"),this.clearTracks(["text"]);var n,e=this.filterUniqueTexttracks_(this.shakaPlayer_.getTextTracks()),r=this.getSelectedTechTextLanguage();e.forEach(function(e){var t=i.addTextTrack(e.kind?e.kind:"subtitles",Ol(e.language).split(";")[0],e.language);r===e.language&&(n=t)}),n?(n.mode="showing",this.shakaPlayer_.isTextTrackVisible()||this.shakaPlayer_.setTextTrackVisibility(!0)):this.shakaPlayer_.setTextTrackVisibility(!1),this.stopBlockLocalTrackChange("configureVideojsTextTracks")}},e.filterUniqueTexttracks_=function(e){var n=[];return e.forEach(function(t){var e=n.find(function(e){return e.language===t.language});if(e){if("application/mp4"===t.mimeType&&"application/mp4"!==e.mimeType){var i=n.indexOf(e);n[i]=t}}else n.push(t)}),n},e.selectTechTextLanguage=function(e){e?(this.shakaPlayer_.isTextTrackVisible()||(Fa("Shaka texttrack","show",this.getSelectedTechTextLanguage()),this.shakaPlayer_.setTextTrackVisibility(!0)),this.getSelectedTechTextLanguage()!==e&&(Fa("select Shaka texttrack",e),this.shakaPlayer_.selectTextLanguage(e))):this.shakaPlayer_.isTextTrackVisible()&&(Fa("Shaka texttrack","hide"),this.shakaPlayer_.setTextTrackVisibility(!1)),e=e||"None",this.options_?this.options_.subtitleLanguage=e:this.options_={subtitleLanguage:e}},e.play=function(){var e=this;if(this.stopped_||this.ended_)this.trigger({type:va.REPLAY,bubbles:!0});else if(this.loading_)Fa("Call play when loading, wait..."),setTimeout(function(){e.play()},1e3);else if(this.el()&&this.hasMetadata_&&this.el_.networkState>=this.el_.HAVE_METADATA)return h.prototype.play.call(this)},e.pause=function(){this.live()&&this.options_.timeShiftDisabled||(h.prototype.pause.call(this),this.trigger({type:va.PAUSE,bubbles:!0}))},e.dispose=function(){if(!this.isDispose_){if(Fa("dispose "+Fl),this.stopTrackingDuration(),this.textTracks().off("selectedlanguagechange",this.textTrackChangeBind),this.audioTracks().off("change",this.audioTrackChangeBind),this.el_.removeEventListener("ended",this.onEndedBind),this.off(va.LOAD_START,this.onLoadStartBind),this.shakaPlayer_)try{this.shakaPlayer_.destroy()}catch(e){}this.shakaPlayer_=null,this.streamrootWrapper_=null,this.certificate_=null,h.prototype.dispose.call(this),this.isDispose_=!0}},e.seekable=function(){if(this.shakaPlayer_){var e=this.shakaPlayer_.seekRange(),t=Oa(e.start,3);return this.options_.source&&this.options_.source.isDynamicCachupAsLive&&(t=this.options_.source.streamInfo.startTime/1e3),Co(t,e.end)}return Co(0,0)},e.triggerRecoverableError=function(e){this.triggerRecoverableTechError(e,Fl)},ua(i,[{key:"streamType",get:function(){return this.options_&&"HLS"===this.options_.streamType?"HLS":"DASH"}}],[{key:"nativeSourceHandler",get:function(){return{canHandleSource:function(e,t){return i.nativeSourceHandler.canPlayType(e.type,t)?"probably":/\.mpd/i.test(e.src)?"maybe":""},handleSource:function(e,t){t.handleSource(e,t)},canPlayType:function(e,t){if(/^application\/dash\+xml/i.test(e)&&Cl.Player.isBrowserSupported())return"probably";if(T.muxjs&&t&&"HLS"===t.streamType){if(/^application\/x-mpegurl/i.test(e)||/^application\/x-vnd.apple.mpegurl/i.test(e))return"probably"}return""}}}},{key:"entitlementPlayRequest",get:function(){return{drm:"CENC",format:"DASH",type:"application/dash+xml"}}},{key:"entitlementPlayRequests",get:function(){return{DASH:{drm:"CENC",format:"DASH",type:"application/dash+xml"},HLS:{drm:"UNENCRYPTED",format:"HLS",type:"application/x-mpegurl"}}}},{key:"log",get:function(){return Fa}}]),i}(Bl);jl.prototype.featuresNativeTextTracks=!1,jl.prototype.featuresNativeAudioTracks=!1,Ul.withSourceHandlers(jl),jl.VERSION="2.2.124-498",jl.sourceHandlers=[],jl.registerSourceHandler(jl.nativeSourceHandler),Ul.getTech(Fl)?(ga.log.warn("Not using "+Fl+" as it appears to already be registered"),ga.log.warn(Fl+" should only be used with emp-player@2 and above")):Ul.registerTech(Fl,jl);var Hl,Gl=ga.getTech("Html5"),Vl=ga.getComponent("Tech"),Kl="EmpHLS",Wl=function(a){function l(e,t){var i;return void 0===e&&(e={}),void 0===t&&(t=function(){}),e.constructing_=!0,(i=a.call(this,e,t)||this).base||Pl(kl,ma(i),{mergeDuplicates:!1}),i.timeShiftDisabled_=e.timeShiftDisabled,i.autoLevelEnabled=!0,i.onCertificateError=i.onCertificateError.bind(ma(i)),i.onCertificateLoad=i.onCertificateLoad.bind(ma(i)),i.onCertificateLoadXml=i.onCertificateLoadXml.bind(ma(i)),i.onKeySessionWebkitKeyAdded=i.onKeySessionWebkitKeyAdded.bind(ma(i)),i.onKeySessionWebkitKeyError=i.onKeySessionWebkitKeyError.bind(ma(i)),i.onKeySessionWebkitKeyMessage=i.onKeySessionWebkitKeyMessage.bind(ma(i)),i.onLicenseError=i.onLicenseError.bind(ma(i)),i.onLicenseLoad=i.onLicenseLoad.bind(ma(i)),i.onLicenseLoadXml=i.onLicenseLoadXml.bind(ma(i)),i.onLicenseLoadBin=i.onLicenseLoadBin.bind(ma(i)),i.textTrackAddedBind=i.textTrackAdded.bind(ma(i)),i.textTracks().on("addtrack",i.textTrackAddedBind),i.textTrackChangeBind=i.textTrackChange.bind(ma(i)),i.textTracks().on("change",i.textTrackChangeBind),i.audioTrackChangeBind=i.audioTrackChange.bind(ma(i)),i.el_.audioTracks?i.el_.audioTracks.addEventListener("change",i.audioTrackChangeBind):Fa.warn("no audioTracks on video element"),i.audioTrackAddedBind=i.audioTrackAdded.bind(ma(i)),i.audioTracks().on("addtrack",i.audioTrackAddedBind),i.onPlayingBind=i.onPlaying.bind(ma(i)),i.on("playing",i.onPlayingBind),i.videoWebkitNeedKeyBind=i.videoWebkitNeedKey.bind(ma(i)),i.onEndedBind=i.onEnded.bind(ma(i)),i.el_.addEventListener("ended",i.onEndedBind),i.loadedmetadataBind=i.loadedmetadata.bind(ma(i)),i.el_.addEventListener("loadedmetadata",i.loadedmetadataBind),i.loadeddataBind=i.loadeddata.bind(ma(i)),i.el_.addEventListener("loadeddata",i.loadeddataBind),i.onErrorBind=i.onError.bind(ma(i)),i.el_.addEventListener("error",i.onErrorBind),i.onResizeBind=i.onResize.bind(ma(i)),i.el_.addEventListener("resize",i.onResizeBind),i.onWaitingBind=i.onWaiting.bind(ma(i)),i.el_.addEventListener("waiting",i.onWaitingBind),i.stopped_=!1,i.firstPlay_=!0,i.options_.constructing_=e.constructing_=void 0,i.options_.source&&i.options_.source.src&&i.setSource(i.options_.source),i}ca(l,a),l.getKeySystem=function(){return"com.apple.fps.1_0"};var e=l.prototype;return e.createKeySession=function(e,t){Fa("createKeySession()",e),this.el_.webkitKeys||(WebKitMediaKeys.isTypeSupported(e,"video/mp4")?this.el_.webkitSetMediaKeys(new WebKitMediaKeys(e)):this.checkForRecoverableErrors(new Ma("Key System not supported",Na.HLS))),this.el_.webkitKeys||this.checkForRecoverableErrors(new Ma("Could not create MediaKeys",Na.HLS));var i=this.el_.webkitKeys.createSession("video/mp4",t);return i||this.checkForRecoverableErrors(new Ma("Could not create key session",Na.HLS)),i},e.fetchCertificate=function(e){var t=this,i=e.callback;Fa("fetchCertificate()");var n=this.protection_.certificateUrl;this.trigger({type:va.DRM_SESSION_UPDATE,bubbles:!0},{messageType:"FAIRPLAY_CERTIFICATE_REQUEST",code:void 0,info:n});var r=new XMLHttpRequest;r.addEventListener("error",this.onCertificateError,!1),this.protection_.version&&"mrr"===this.protection_.version?(r.responseType="text/xml",r.addEventListener("load",function(e){t.onCertificateLoadXml(e,{callback:i})},!1)):(r.responseType="arraybuffer",r.addEventListener("load",function(e){t.onCertificateLoad(e,{callback:i})},!1)),r.open("GET",n,!0),r.send()},e.fetchLicense=function(e){var t=e.target,i=e.message;Fa("fetchLicense()",t,i);var n=this.protection_.licenseUrl;this.trigger({type:va.DRM_SESSION_UPDATE,bubbles:!0},{messageType:"FAIRPLAY_LICENSE_REQUEST",code:void 0,info:n});var r=new XMLHttpRequest;if(r.session=t,r.addEventListener("error",this.onLicenseError,!1),r.open("POST",n,!0),this.protection_.version&&"irdeto"===this.protection_.version)this.playToken_&&r.setRequestHeader("Authorization","Bearer "+this.playToken_),r.responseType="arraybuffer",r.addEventListener("load",this.onLicenseLoadBin,!1),r.setRequestHeader("Content-type","application/octet-stream"),r.send(i);else if(this.protection_.version&&"mrr"===this.protection_.version)this.playToken_&&r.setRequestHeader("AzukiApp",this.playToken_),r.responseType="text/xml",r.addEventListener("load",this.onLicenseLoadXml,!1),r.setRequestHeader("Content-type","application/octet-stream"),r.send(Aa(i));else{this.playToken_&&r.setRequestHeader("Authorization","Bearer "+this.playToken_),r.responseType="text",r.addEventListener("load",this.onLicenseLoad,!1);var a="spc="+Aa(i)+"&assetId="+encodeURIComponent(t.contentId);r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.send(a)}},e.pause=function(){Fa("pause"),this.live()&&this.timeShiftDisabled_||(a.prototype.pause.call(this),this.trigger({type:va.PAUSE,bubbles:!0}))},e.play=function(){if(Fa("play"),!this.el_||!this.stopped_&&!this.el_.ended)return a.prototype.play.call(this);this.trigger({type:va.REPLAY,bubbles:!0})},e.disableTimeShift=function(e){this.timeShiftDisabled_=e,this.trigger(va.DURATION_CHANGE)},e.hasProtection=function(e){return(void 0===e?{}:e).certificateUrl},e.onCertificateError=function(e){Fa.error("onCertificateError",e),this.trigger({type:va.DRM_SESSION_UPDATE,bubbles:!0},{messageType:"FAIRPLAY_CERTIFICATE_ERROR",code:e?e.code:0,info:e.message?e.message:"onLicenseError"}),this.checkForRecoverableErrors(new Ma("Failed to retrieve the server certificate.",Na.HLS))},e.onCertificateLoad=function(e,t){var i=t.callback;Fa("onCertificateLoad()");var n=e.target;if(n.status<300&&4===n.readyState)Hl=new Uint8Array(e.target.response),this.trigger({type:va.DRM_SESSION_UPDATE,bubbles:!0},{messageType:"FAIRPLAY_CERTIFICATE_RESPONSE",code:void 0,info:"onCertificateLoad"}),i();else{var r={message:"onLicensonCertificateLoadeLoadBin",code:n.status};if("arraybuffer"===n.responseType){var a=new TextDecoder("utf-8");r.message=a.decode(n.response)}this.onCertificateError(r)}},e.onCertificateLoadXml=function(e,t){var i=t.callback;Fa("onCertificateLoadXml()");var n=e.target;if(n.status<300&&4===n.readyState){var r=e.target.responseXML.firstChild.lastElementChild.innerHTML;Hl=ka(r),this.trigger({type:va.DRM_SESSION_UPDATE,bubbles:!0},{messageType:"FAIRPLAY_CERTIFICATE_RESPONSE",code:void 0,info:"onCertificateLoadXml"}),i()}else Fa.error("FairPlay Error",n.responseText),this.onCertificateError({message:n.responseText,code:n.status})},e.onKeySessionWebkitKeyAdded=function(){Fa("onKeySessionWebkitKeyAdded()"),Fa("Decryption key was added to the session.")},e.onKeySessionWebkitKeyError=function(){this.checkForRecoverableErrors(new Ma("FairPlay decryption key error was encountered.",Na.HLS))},e.onKeySessionWebkitKeyMessage=function(e){Fa("onKeySessionWebkitKeyMessage()");var t=e.target,i=e.message;this.fetchLicense({target:t,message:i})},e.onLicenseError=function(e){Fa.error("onlicenseError",e),this.trigger({type:va.DRM_SESSION_UPDATE,bubbles:!0},{messageType:"FAIRPLAY_LICENSE_ERROR",code:e?e.code:0,info:e.message?e.message:"onLicenseError"}),this.checkForRecoverableErrors(new Ma("FairPlay license request failed.",Na.HLS))},e.concatInitDataIdAndCertificate=function(e,t,i){"string"==typeof t&&(t=function(e){for(var t=e.length,i=new ArrayBuffer(2*t),n=new Uint16Array(i),r=0;r<t;r++)n[r]=e.charCodeAt(r);return n}(t));var n=0,r=new ArrayBuffer(e.byteLength+4+t.byteLength+4+i.byteLength),a=new DataView(r);new Uint8Array(r,n,e.byteLength).set(e),n+=e.byteLength,a.setUint32(n,t.byteLength,!0),n+=4;var s=new Uint16Array(r,n,t.length);return s.set(t),n+=s.byteLength,a.setUint32(n,i.byteLength,!0),n+=4,new Uint8Array(r,n,i.byteLength).set(i),new Uint8Array(r,0,r.byteLength)},e.onLicenseLoadBin=function(e){Fa("onLicenseLoadBin()");var t=e.target,i=t.session;if(t.status<300&&4===t.readyState){var n=new Uint8Array(t.response);i.update(n),this.trigger({type:va.DRM_SESSION_UPDATE,bubbles:!0},{messageType:"FAIRPLAY_LICENSE_RESPONSE",code:void 0,info:"onLicenseLoadBin"})}else{var r={message:"onLicenseLoadBin",code:t.status};if("arraybuffer"===t.responseType){var a=new TextDecoder("utf-8");r.message=a.decode(t.response)}this.onLicenseError(r)}},e.onLicenseLoad=function(e){Fa("onLicenseLoad()");var t=e.target,i=t.session;try{var n=t.responseText.trim();"<ckc>"===n.substr(0,5)&&"</ckc>"===n.substr(-6)&&(n=n.slice(5,-6)),i.update(ka(n)),this.trigger({type:va.DRM_SESSION_UPDATE,bubbles:!0},{messageType:"FAIRPLAY_LICENSE_RESPONSE",code:void 0,info:"onLicenseLoad"})}catch(e){Fa.error("FairPlay Error",t.responseText),this.onLicenseError({message:t.responseText,code:t.status})}},e.onLicenseLoadXml=function(e){Fa("onLicenseLoadXml()");var t=e.target,i=t.session;try{var n=t.responseXML.firstChild.lastElementChild.innerHTML;i.update(ka(n)),this.trigger({type:va.DRM_SESSION_UPDATE,bubbles:!0},{messageType:"FAIRPLAY_LICENSE_RESPONSE",code:void 0,info:"onLicenseLoadXml"})}catch(e){Fa.error("FairPlay Error",t.responseText),this.onLicenseError({message:t.responseText,code:t.status})}},e.videoWebkitNeedKey=function(e){var t,i=(t=e.initData,String.fromCharCode.apply(null,new Uint16Array(t.buffer)));Fa("onVideoWebkitNeedKey()",i),this.protection_.licenseUrl||(this.protection_.licenseUrl=i.substring(1).replace("skd://","https://"));var n,r,a="";a=-1!==i.indexOf("KID=")?i.substring(i.indexOf("KID=")+4):(n=i.substring(1).replace("skd://","http://"),(r=document.createElement("a")).href=n,r.hostname);var s=this.concatInitDataIdAndCertificate(e.initData,a,Hl),o=this.createKeySession(l.getKeySystem(),s);o.contentId=a,o.addEventListener("webkitkeyadded",this.onKeySessionWebkitKeyAdded,!1),o.addEventListener("webkitkeyerror",this.onKeySessionWebkitKeyError,!1),o.addEventListener("webkitkeymessage",this.onKeySessionWebkitKeyMessage,!1)},e.handleSource=function(e,t){if(!t.options_.constructing_&&e.src){this.firstPlay_=!0,this.stopped_=!1,this.metadataLoaded=!1,this.options_.source=e;var i=this.options_.audioLanguage,n=this.options_.subtitleLanguage;if(this.options_=Ta(this.options_,e.options),i&&(this.options_.audioLanguage=i),n&&(this.options_.subtitleLanguage=n),this.currentProgram_=null,this.currentVOD_=null,this.protection_=e&&e.protection,!this.protection_){var r=e.licenseServer||e.licenseserver,a=e.certificateServer||e.certificateserver;r&&a&&(this.protection_={},this.protection_.certificateUrl=a||"",this.protection_.licenseUrl=r||"")}this.protection_&&Fa("FairPlay",this.protection_),this.playToken_=e.playToken||e.playtoken,(this.tech_=t).isReady_=!1,this.autoLevelEnabled=!0,this.clearTracks(["text"]),this.getQualityList(e.src),this.reset(),this.loadSrc(e),this.trackDuration()}},e.loadSrc=function(e){var t=this,i=e.src;return this.hasProtection(this.protection_)?T.WebKitMediaKeys&&T.WebKitMediaKeys.isTypeSupported(l.getKeySystem(),"video/mp4")?(this.el_.addEventListener("webkitneedkey",this.videoWebkitNeedKeyBind,!1),Hl?(this.tech_.src(i),void this.triggerReady()):void this.fetchCertificate({callback:function(){t.tech_.src(i),t.triggerReady()}})):(Fa.warn("Fairplay Key System not supported",l.getKeySystem()),this.tech_.src(i),void this.triggerReady()):(this.tech_.src(i),void this.triggerReady())},e.getQualityList=function(e){var t=this;this.qualityList_=null,this.masterPlaylist=e;var i=new XMLHttpRequest;i.open("GET",e,!0),i.onreadystatechange=function(){4===i.readyState&&200===i.status&&(t.qualityList_=t.parseMasterPlaylist(i.responseText))},i.send()},e.parseMasterPlaylist=function(e){var t=[],i=e.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim().split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(i[0]))return Fa.error("HLS_PLAYLIST_HEADER_MISSING"),[];for(var n=1;n<i.length;)if(/^#(?!EXT)/m.test(i[n]))n+=1;else{if(-1!==i[n].indexOf("#EXT-X-STREAM-INF")){for(var r=i[n].slice("#EXT-X-STREAM-INF:".length,i[n].length).split(","),a=void 0,s=void 0,o=null,l=0,u=0;u<r.length;u++)if(-1!==r[u].indexOf("BANDWIDTH")&&-1===r[u].indexOf("AVERAGE-BANDWIDTH")?l=r[u].slice("BANDWIDTH=".length,r[u].length):-1!==r[u].indexOf("RESOLUTION")&&(o=r[u].slice("RESOLUTION=".length,r[u].length)),o){var c=o.split("x");a=c[0],s=c[1]}else s=a="0";t.push({bandwidth:Number(l),width:Number(a),height:Number(s)})}else 0===i[n].indexOf("http")?t[t.length-1].url=i[n]:-1!==i[n].indexOf("m3u8")&&0!==i[n].indexOf("#")&&(t[t.length-1].url=Ra(this.masterPlaylist)+i[n]);n++}for(n=t.length;n--;)t[n].width||t.splice(n,1);return t},e.onEnded=function(){this.stopTrackingDuration(),this.el_&&this.el_.removeEventListener&&this.el_.removeEventListener("webkitneedkey",this.videoWebkitNeedKeyBind),this.reset()},e.reset=function(){this.clearTracks(["text"]),this.clearTracks(["audio"]),a.prototype.reset.call(this)},e.loadedmetadata=function(){this.metadataLoaded=!0,Fa("loadedmetadata"),this.trigger(va.TRACK_CHANGE)},e.loadeddata=function(){var e=this.options_.startTime;0<e&&(e<=.1&&(e=.1),this.live()||(e=this.duration()-1>this.options_.startTime?this.options_.startTime:this.duration()-1),Fa("loadeddata, HLS use startTime",e),a.prototype.setCurrentTime.call(this,e))},e.onResize=function(){if(Fa("Video Resize"),this.metadataLoaded){var e=this.getBitrate();this.trigger({type:va.BITRATE_CHANGED,bubbles:!0},{bitrate:e,auto:this.autoLevelEnabled})}},e.onWaiting=function(){this.stopped_||this.el_.ended||(Fa("Video Waiting"),this.trigger(va.WAITING))},e.onPlaying=function(){this.firstPlay_&&(this.setTextTrack_(this.options_.subtitleLanguage),Cs&&this.trigger(va.TRACK_CHANGE)),this.firstPlay_=!1},e.setTextTrack_=function(e){Fa("setTextTrack",e);for(var t=this.el_.textTracks,i=0;i<t.length;i++){var n=t[i];e&&n.language===e&&"subtitles"===n.kind?(n.mode="showing",Fa("setTextTrack",n.language)):n.mode="disabled"}},e.textTrackAdded=function(e){Fa("textTrackAdded",e);var t=e.track;""!==t.language||(t.mode="disabled")},e.textTrackChange=function(e){if(Fa("textTrackChange",e),this.el_&&4===this.el_.readyState){this.options_||(this.options_={});for(var t=this.textTracks(),i=t.length;i--;){var n=t[i];if("showing"===n.mode)return this.options_.subtitleLanguage=n.language,void Fa("textTrackChange",n.language)}this.options_.subtitleLanguage="None"}},e.audioTrackAdded=function(e){var t=e.track,i=this.options_.audioLanguage||this.options_.language;t.language===i&&(t.enabled=!0)},e.audioTrackChange=function(){this.options_||(this.options_={});for(var e=this.audioTracks(),t=e.length;t--;){var i=e[t];if(i.enabled)return void(this.options_.audioLanguage=i.language)}},e.hasMutiTracks_=function(){return 0<this.textTracks().length||1<this.audioTracks().length},e.bitrate=function(e){if(void 0===e&&(e=null),null===e)return this.getBitrate();Fa.warn("Select bitrate not supported with native hls.")},e.getBitrate=function(){if(this.el_&&this.qualityList_)for(var e=this.qualityList_.length-1;-1<e;e--)if(this.el_.videoWidth===this.qualityList_[e].width&&this.el_.videoHeight===this.qualityList_[e].height)return this.qualityList_[e].bandwidth;return 0},e.bitrates=function(){if(!this.qualityList_)return[];var e=this.qualityList_.map(function(e){return e.bandwidth});return e.sort(function(e,t){return t-e}),e},e.techVersion=function(){return l.VERSION},e.stop=function(e){this.stopped_=!0,this.stopTrackingDuration(),this.el_.removeEventListener("webkitneedkey",this.videoWebkitNeedKeyBind),this.reset(),this.trigger({type:va.PAUSE,bubbles:!0}),this.trigger({type:va.ABORT,bubbles:!0}),this.trigger({type:va.STOPPED,bubbles:!0}),this.trigger(va.ENDED),e&&e()},l.isSupported=function(){var e=M.createElement("video");if(!ga.getTech("Html5").isSupported())return!1;var t=e.canPlayType("application/x-mpegURL"),i=e.canPlayType("application/vnd.apple.mpegURL");return/probably|maybe/.test(t)||/probably|maybe/.test(i)},e.setAbsoluteTime=function(e){Fa("setAbsoluteTime",e.date);try{if(this.live()){var t=(e.nowDate?e.nowDate:Date.now())-e.date,i=this.seekable();if(0===i.length)return;var n=i.end(0);0<t?(Fa("setAbsoluteTime timeBeforeLive",t/=1e3),(n=i.end(0)-t)<0&&(n=0,Fa.warn("setAbsoluteTime before live stream start"))):t<0&&Fa.warn("setAbsoluteTime after live point"),Fa("setAbsoluteTime setCurrentTime",n),this.setCurrentTime(n)}else this.setCurrentTime(e.date/1e3)}catch(e){Fa.error(e)}},e.getAbsoluteTime=function(e){if(!this.el_)return 0;if(this.live()){var t=this.seekable();if(0===t.length)return 0;var i=t.end(t.length-1),n=(e=e||Date.now())/1e3-i+a.prototype.currentTime.call(this);return new Date(1e3*n)}return new Date(1e3*a.prototype.currentTime.call(this))},e.seekable=function(){if(this.live()){var e=a.prototype.seekable.call(this);if(0<e.length){var t=e.end(e.length-1);return t=a.prototype.currentTime.call(this)>t?a.prototype.currentTime.call(this):t,e=Co(e.start(e.length-1),t)}}return a.prototype.seekable.call(this)},e.buffered=function(){var e=a.prototype.buffered.call(this),t=0,i=0;if(0<e.length&&(t=e.start(e.length-1)<0?0:e.start(e.length-1),i=e.end(e.length-1)),this.live()){var n=this.seekable();if(0<n.length&&0<e.length){var r=n.end(n.length-1);i=r<i?r:i}}return e=Co(t,i)},e.timeBehindLive=function(){if(!this.live())return 0;var e=a.prototype.currentTime.call(this),t=this.seekable();return 0===t.length?0:Math.floor(t.end(0)-e)},e.startTimeLive=function(e){if(this.el_){e=e||Date.now();var t=this.seekable();if(0===t.length)return 0;if(this.live())return e-1e3*t.end(0)}return 0},e.duration=function(){if(this.live()){var e=0,t=this.seekable();return 0<t.length&&(e=t.end(t.length-1)),e}return a.prototype.duration.call(this)},e.live=function(){return!(!this.el_||!this.el_.duration)&&this.el_.duration===1/0},e.currentTime=function(){var e=a.prototype.currentTime.call(this);if(this.live()&&this.duration()!==1/0){var t=this.seekable();if(0<t.length){var i=Math.floor(t.end(t.length-1)-e),n=this.duration();e=Math.max(0,n-i)}}return e},e.baseCurrentTime=function(){return a.prototype.currentTime.call(this)},e.allowJump_=function(e){var t=this.seekable();return 0<t.length&&e>t.end(t.length-1)-2||e<2},e.setCurrentTime=function(e){if(this.options_.source){if(!1===this.options_.source.ffEnabled&&this.currentTime()<=e&&!this.allowJump_(e))return;if(!1===this.options_.source.rwEnabled&&this.currentTime()>=e&&!this.allowJump_(e))return}if(this.live()){var t=this.seekable();0<t.length&&(e=(e=e>t.start(0)?e:t.start(0))<t.end(0)?e:t.end(0))}else e>this.duration()-1&&(e-=5);a.prototype.setCurrentTime.call(this,e)},e.canRestart=function(){return!this.live()||this.timeShiftEnabled()},e.timeShiftEnabled=function(){return!this.timeShiftDisabled_},e.dispose=function(){Fa("dispose "+Kl),this.textTracks().off("addtrack",this.textTrackAddedBind),this.audioTracks().off("addtrack",this.audioTrackAddedBind),this.textTracks().off("change",this.textTrackChangeBind),this.el_.audioTracks&&this.el_.audioTracks.removeEventListener("change",this.audioTrackChangeBind),this.el_&&this.el_.removeEventListener&&(this.el_.removeEventListener("webkitneedkey",this.videoWebkitNeedKeyBind),this.el_.removeEventListener("ended",this.onEndedBind),this.el_.removeEventListener("loadedmetadata",this.loadedmetadataBind),this.el_.removeEventListener("loadeddata",this.loadeddataBind),this.el_.removeEventListener("error",this.onErrorBind),this.el_.removeEventListener("resize",this.onResizeBind),this.el_.removeEventListener("waiting",this.onWaitingBind)),this.off("playing",this.onPlayingBind),this.stopTrackingDuration(),this.audioTracks().tracks_=[],a.prototype.dispose.call(this)},e.checkForRecoverableErrors=function(e){this.triggerRecoverableError(e)},e.onError=function(){var e=this.error();e.message||(e.message={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."}[e.code]||""),this.triggerRecoverableError(e)},e.triggerRecoverableError=function(e){this.triggerRecoverableTechError(e,Kl)},ua(l,[{key:"streamType",get:function(){return"HLS"}}],[{key:"entitlementPlayRequest",get:function(){return T.WebKitMediaKeys&&T.WebKitMediaKeys.isTypeSupported("com.apple.fps.1_0","video/mp4")?{drm:"FAIRPLAY",format:"HLS",type:"application/x-mpegurl"}:{drm:"UNENCRYPTED",format:"HLS",type:"application/x-mpegurl"}}},{key:"nativeSourceHandler",get:function(){return{canHandleSource:function(e,t){return l.nativeSourceHandler.canPlayType(e.type,t)?"probably":/\.m3u8/i.test(e.src)?"maybe":""},handleSource:function(e,t){t.handleSource(e,t)},canPlayType:function(e){return/^application\/x-mpegurl/i.test(e)?"probably":""}}}},{key:"log",get:function(){return Fa}}]),l}(Gl);Rs||(Wl.prototype.featuresNativeTextTracks=!0),Vl.withSourceHandlers(Wl),Wl.VERSION="2.2.124-498",Wl.sourceHandlers=[],Wl.registerSourceHandler(Wl.nativeSourceHandler),Vl.getTech(Kl)?(ga.log.warn("Not using EmpHLS as it appears to already be registered"),ga.log.warn(Kl+" should only be used with emp-player@2 and above")):Vl.registerTech(Kl,Wl);var ql=e(t(function(e,t){var i;"undefined"!=typeof window&&(i=function(){return r={},n.m=i=[function(e,t,i){i.d(t,"a",function(){return c}),i.d(t,"b",function(){return h});var n=i(4),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(){}var a={trace:o,debug:o,log:o,warn:o,info:o,error:o},s=a;var l=Object(n.a)();function u(a){var s=l.console[a];return s?function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n,r;t[0]&&(t[0]=(n=a,r=t[0],r="["+n+"] > "+r)),s.apply(l.console,t)}:o}var c=function(e){if(!0===e||"object"===(void 0===e?"undefined":r(e))){!function(t){for(var e=arguments.length,i=Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];i.forEach(function(e){s[e]=t[e]?t[e].bind(t):u(e)})}(e,"debug","log","info","warn","error");try{s.log()}catch(e){s=a}}else s=a},h=s},function(e,t,i){t.a={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},function(e,t,i){i.d(t,"b",function(){return n}),i.d(t,"a",function(){return r});var n={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},r={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},function(e,t,i){i.d(t,"a",function(){return n});var n=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)}},function(e,t,i){t.a=function(){return"undefined"==typeof window?self:window}},function(e,t,i){var n,c,r,a,h;n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,c=/^([^\/;?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,h={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var n=this.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");return n.path=h.normalizePath(n.path),h.buildURLFromParts(n)}var r=this.parseURL(t);if(!r)throw new Error("Error trying to parse relative URL.");if(r.scheme)return i.alwaysNormalize?(r.path=h.normalizePath(r.path),h.buildURLFromParts(r)):t;var a=this.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&"/"!==a.path[0]){var s=c.exec(a.path);a.netLoc=s[1],a.path=s[2]}a.netLoc&&!a.path&&(a.path="/");var o={scheme:a.scheme,netLoc:r.netLoc,path:null,params:r.params,query:r.query,fragment:r.fragment};if(!r.netLoc&&(o.netLoc=a.netLoc,"/"!==r.path[0]))if(r.path){var l=a.path,u=l.substring(0,l.lastIndexOf("/")+1)+r.path;o.path=h.normalizePath(u)}else o.path=a.path,r.params||(o.params=a.params,r.query||(o.query=a.query));return null===o.path&&(o.path=i.alwaysNormalize?h.normalizePath(r.path):r.path),h.buildURLFromParts(o)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(r,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=h},function(e,t,i){i.d(t,"b",function(){return r});var n=(o.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},o.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},o.getID3Data=function(e,t){for(var i=t,n=0;o.isHeader(e,t);)n+=10,n+=o._readSize(e,t+6),o.isFooter(e,t+10)&&(n+=10),t+=n;if(0<n)return e.subarray(i,i+n)},o._readSize=function(e,t){var i=0;return i=(127&e[t])<<21,i|=(127&e[t+1])<<14,i|=(127&e[t+2])<<7,i|=127&e[t+3]},o.getTimeStamp=function(e){for(var t=o.getID3Frames(e),i=0;i<t.length;i++){var n=t[i];if(o.isTimeStampFrame(n))return o._readTimeStamp(n)}},o.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},o._getFrameData=function(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),i=o._readSize(e,4);return{type:t,size:i,data:e.subarray(10,10+i)}},o.getID3Frames=function(e){for(var t=0,i=[];o.isHeader(e,t);){for(var n=o._readSize(e,t+6),r=(t+=10)+n;t+8<r;){var a=o._getFrameData(e.subarray(t)),s=o._decodeFrame(a);s&&i.push(s),t+=a.size+10}o.isFooter(e,t)&&(t+=10)}return i},o._decodeFrame=function(e){return"PRIV"===e.type?o._decodePrivFrame(e):"T"===e.type[0]?o._decodeTextFrame(e):"W"===e.type[0]?o._decodeURLFrame(e):void 0},o._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),i=1&t[3],n=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return n/=45,i&&(n+=47721858.84),Math.round(n)}},o._decodePrivFrame=function(e){if(!(e.size<2)){var t=o._utf8ArrayToStr(e.data,!0),i=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:i.buffer}}},o._decodeTextFrame=function(e){if(!(e.size<2)){if("TXXX"===e.type){var t=1,i=o._utf8ArrayToStr(e.data.subarray(t));t+=i.length+1;var n=o._utf8ArrayToStr(e.data.subarray(t));return{key:e.type,info:i,data:n}}var r=o._utf8ArrayToStr(e.data.subarray(1));return{key:e.type,data:r}}},o._decodeURLFrame=function(e){if("WXXX"===e.type){if(e.size<2)return;var t=1,i=o._utf8ArrayToStr(e.data.subarray(t));t+=i.length+1;var n=o._utf8ArrayToStr(e.data.subarray(t));return{key:e.type,info:i,data:n}}var r=o._utf8ArrayToStr(e.data);return{key:e.type,data:r}},o._utf8ArrayToStr=function(e,t){for(var i=1<arguments.length&&void 0!==t&&t,n=e.length,r=void 0,a=void 0,s=void 0,o="",l=0;l<n;){if(0===(r=e[l++])&&i)return o;if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(r);break;case 12:case 13:a=e[l++],o+=String.fromCharCode((31&r)<<6|63&a);break;case 14:a=e[l++],s=e[l++],o+=String.fromCharCode((15&r)<<12|(63&a)<<6|(63&s)<<0)}}return o},o);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o)}var r=n._utf8ArrayToStr;t.a=n},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function l(e){return"function"==typeof e}function u(e){return"object"==typeof e&&null!==e}function c(e){return void 0===e}((e.exports=n).EventEmitter=n).prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,i,n,r,a,s;if(this._events||(this._events={}),"error"===e&&(!this._events.error||u(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var o=new Error('Uncaught, unspecified "error" event. ('+t+")");throw o.context=t,o}if(c(i=this._events[e]))return!1;if(l(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),i.apply(this,r)}else if(u(i))for(r=Array.prototype.slice.call(arguments,1),n=(s=i.slice()).length,a=0;a<n;a++)s[a].apply(this,r);return!0},n.prototype.on=n.prototype.addListener=function(e,t){var i;if(!l(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,l(t.listener)?t.listener:t),this._events[e]?u(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,u(this._events[e])&&!this._events[e].warned&&(i=c(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&0<i&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.once=function(e,t){if(!l(t))throw TypeError("listener must be a function");var i=!1;function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var i,n,r,a;if(!l(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=(i=this._events[e]).length,n=-1,i===t||l(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(u(i)){for(a=r;0<a--;)if(i[a]===t||i[a].listener&&i[a].listener===t){n=a;break}if(n<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(l(i=this._events[e]))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?l(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(l(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,i){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.subtle=e,this.aesIV=t}var o=(n.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},n);function r(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.subtle=e,this.key=t}var l=(r.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},r);function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var u=(a.prototype.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),i=new Uint32Array(4),n=0;n<4;n++)i[n]=t.getUint32(4*n);return i},a.prototype.initTable=function(){var e=this.sBox,t=this.invSBox,i=this.subMix,n=i[0],r=i[1],a=i[2],s=i[3],o=this.invSubMix,l=o[0],u=o[1],c=o[2],h=o[3],d=new Uint32Array(256),f=0,p=0,m=0;for(m=0;m<256;m++)d[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){var g=p^p<<1^p<<2^p<<3^p<<4;g=g>>>8^255&g^99;var v=d[t[e[f]=g]=f],y=d[v],b=d[y],_=257*d[g]^16843008*g;n[f]=_<<24|_>>>8,r[f]=_<<16|_>>>16,a[f]=_<<8|_>>>24,s[f]=_,_=16843009*b^65537*y^257*v^16843008*f,l[g]=_<<24|_>>>8,u[g]=_<<16|_>>>16,c[g]=_<<8|_>>>24,h[g]=_,f?(f=v^d[d[d[b^v]]],p^=d[d[p]]):f=p=1}},a.prototype.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),i=!0,n=0;n<t.length&&i;)i=t[n]===this.key[n],n++;if(!i){this.key=t;var r=this.keySize=t.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);var a=this.ksRows=4*(r+6+1),s=void 0,o=void 0,l=this.keySchedule=new Uint32Array(a),u=this.invKeySchedule=new Uint32Array(a),c=this.sBox,h=this.rcon,d=this.invSubMix,f=d[0],p=d[1],m=d[2],g=d[3],v=void 0,y=void 0;for(s=0;s<a;s++)s<r?v=l[s]=t[s]:(y=v,s%r==0?(y=c[(y=y<<8|y>>>24)>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y],y^=h[s/r|0]<<24):6<r&&s%r==4&&(y=c[y>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y]),l[s]=v=(l[s-r]^y)>>>0);for(o=0;o<a;o++)s=a-o,y=3&o?l[s]:l[s-4],u[o]=o<4||s<=4?y:f[c[y>>>24]]^p[c[y>>>16&255]]^m[c[y>>>8&255]]^g[c[255&y]],u[o]=u[o]>>>0}},a.prototype.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},a.prototype.decrypt=function(e,t,i,n){for(var r,a,s,o=this.keySize+6,l=this.invKeySchedule,u=this.invSBox,c=this.invSubMix,h=c[0],d=c[1],f=c[2],p=c[3],m=this.uint8ArrayToUint32Array_(i),g=m[0],v=m[1],y=m[2],b=m[3],_=new Int32Array(e),T=new Int32Array(_.length),S=void 0,E=void 0,w=void 0,C=void 0,k=void 0,A=void 0,I=void 0,x=void 0,P=void 0,L=void 0,R=void 0,O=void 0,D=void 0,N=void 0,M=this.networkToHostOrderSwap;t<_.length;){for(P=M(_[t]),L=M(_[t+1]),R=M(_[t+2]),O=M(_[t+3]),k=P^l[0],A=O^l[1],I=R^l[2],x=L^l[3],D=4,N=1;N<o;N++)S=h[k>>>24]^d[A>>16&255]^f[I>>8&255]^p[255&x]^l[D],E=h[A>>>24]^d[I>>16&255]^f[x>>8&255]^p[255&k]^l[D+1],w=h[I>>>24]^d[x>>16&255]^f[k>>8&255]^p[255&A]^l[D+2],C=h[x>>>24]^d[k>>16&255]^f[A>>8&255]^p[255&I]^l[D+3],k=S,A=E,I=w,x=C,D+=4;S=u[k>>>24]<<24^u[A>>16&255]<<16^u[I>>8&255]<<8^u[255&x]^l[D],E=u[A>>>24]<<24^u[I>>16&255]<<16^u[x>>8&255]<<8^u[255&k]^l[D+1],w=u[I>>>24]<<24^u[x>>16&255]<<16^u[k>>8&255]<<8^u[255&A]^l[D+2],C=u[x>>>24]<<24^u[k>>16&255]<<16^u[A>>8&255]<<8^u[255&I]^l[D+3],D+=3,T[t]=M(S^g),T[t+1]=M(C^v),T[t+2]=M(w^y),T[t+3]=M(E^b),g=P,v=L,y=R,b=O,t+=4}return n?(r=T.buffer,a=r.byteLength,(s=a&&new DataView(r).getUint8(a-1))?r.slice(0,a-s):r):T.buffer},a.prototype.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},a),s=i(2),c=i(0),h=i(1),d=i(4);var f=Object(d.a)(),p=(m.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},m.prototype.decrypt=function(t,i,n,r){var a=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(c.b.log("JS AES decrypt"),this.logEnabled=!1);var e=this.decryptor;e||(this.decryptor=e=new u),e.expandKey(i),r(e.decrypt(t,0,n,this.removePKCS7Padding))}else{this.logEnabled&&(c.b.log("WebCrypto AES decrypt"),this.logEnabled=!1);var s=this.subtle;this.key!==i&&(this.key=i,this.fastAesKey=new l(s,i)),this.fastAesKey.expandKey().then(function(e){new o(s,n).decrypt(t,e).catch(function(e){a.onWebCryptoError(e,t,i,n,r)}).then(function(e){r(e)})}).catch(function(e){a.onWebCryptoError(e,t,i,n,r)})}},m.prototype.onWebCryptoError=function(e,t,i,n,r){this.config.enableSoftwareAES?(c.b.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,i,n,r)):(c.b.error("decrypting error : "+e.message),this.observer.trigger(h.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},m.prototype.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},m);function m(e,t){var i=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).removePKCS7Padding,n=void 0===i||i;if(!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=n)try{var r=f.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch(e){}this.disableWebCrypto=!this.subtle}t.a=p},function(e,t,i){var d=i(0),l=i(1);var o=Math.pow(2,32)-1,n=(m.prototype.resetTimeStamp=function(e){this.initPTS=e},m.prototype.resetInitSegment=function(e,t,i,n){if(e&&e.byteLength){var r=this.initData=m.parseInitSegment(e);null==t&&(t="mp4a.40.5"),null==i&&(i="avc1.42e01e");var a={};r.audio&&r.video?a.audiovideo={container:"video/mp4",codec:t+","+i,initSegment:n?e:null}:(r.audio&&(a.audio={container:"audio/mp4",codec:t,initSegment:n?e:null}),r.video&&(a.video={container:"video/mp4",codec:i,initSegment:n?e:null})),this.observer.trigger(l.a.FRAG_PARSING_INIT_SEGMENT,{tracks:a})}else t&&(this.audioCodec=t),i&&(this.videoCodec=i)},m.probe=function(e){return 0<m.findBox({data:e,start:0,end:Math.min(e.length,16384)},["moof"]).length},m.bin2str=function(e){return String.fromCharCode.apply(null,e)},m.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var i=e[t]<<8|e[t+1];return i<0?65536+i:i},m.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var i=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return i<0?4294967296+i:i},m.writeUint32=function(e,t,i){e.data&&(t+=e.start,e=e.data),e[t]=i>>24,e[t+1]=i>>16&255,e[t+2]=i>>8&255,e[t+3]=255&i},m.findBox=function(e,t){var i=[],n=void 0,r=void 0,a=void 0,s=void 0,o=void 0,l=void 0;if(e.data?(o=e.start,a=e.end,e=e.data):(o=0,a=e.byteLength),!t.length)return null;for(n=o;n<a;)l=1<(r=m.readUint32(e,n))?n+r:a,m.bin2str(e.subarray(n+4,n+8))===t[0]&&(1===t.length?i.push({data:e,start:n+8,end:l}):(s=m.findBox({data:e,start:n+8,end:l},t.slice(1))).length&&(i=i.concat(s))),n=l;return i},m.parseSegmentIndex=function(e){var t=m.findBox(e,["moov"])[0],i=t?t.end:null,n=0,r=m.findBox(e,["sidx"]),a=void 0;if(!r||!r[0])return null;a=[];var s=(r=r[0]).data[0],o=m.readUint32(r,n=0===s?8:16);n+=4,n+=0===s?8:16,n+=2;var l=r.end+0,u=m.readUint16(r,n);n+=2;for(var c=0;c<u;c++){var h=n,d=m.readUint32(r,h);h+=4;var f=2147483647&d;if(1==(2147483648&d)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var p=m.readUint32(r,h);h+=4,a.push({referenceSize:f,subsegmentDuration:p,info:{duration:p/o,start:l,end:l+f-1}}),l+=f,n=h+=4}return{earliestPresentationTime:0,timescale:o,version:s,referencesCount:u,references:a,moovEndOffset:i}},m.parseInitSegment=function(e){var h=[];return m.findBox(e,["moov","trak"]).forEach(function(e){var t=m.findBox(e,["tkhd"])[0];if(t){var i=t.data[t.start],n=0===i?12:20,r=m.readUint32(t,n),a=m.findBox(e,["mdia","mdhd"])[0];if(a){i=a.data[a.start];var s=m.readUint32(a,n=0===i?12:20),o=m.findBox(e,["mdia","hdlr"])[0];if(o){var l={soun:"audio",vide:"video"}[m.bin2str(o.data.subarray(o.start+8,o.start+12))];if(l){var u=m.findBox(e,["mdia","minf","stbl","stsd"]);if(u.length){u=u[0];var c=m.bin2str(u.data.subarray(u.start+12,u.start+16));d.b.log("MP4Demuxer:"+l+":"+c+" found")}h[r]={timescale:s,type:l},h[l]={timescale:s,id:r}}}}}}),h},m.getStartDTS=function(r,e){var t,i,n=void 0;return n=m.findBox(e,["moof","traf"]),t=[].concat.apply([],n.map(function(n){return m.findBox(n,["tfhd"]).map(function(e){var t,i;return t=m.readUint32(e,4),i=r[t].timescale||9e4,m.findBox(n,["tfdt"]).map(function(e){var t,i=void 0;return t=e.data[e.start],i=m.readUint32(e,4),1===t&&(i*=Math.pow(2,32),i+=m.readUint32(e,8)),i})[0]/i})})),i=Math.min.apply(null,t),isFinite(i)?i:0},m.offsetStartDTS=function(n,e,s){m.findBox(e,["moof","traf"]).map(function(i){return m.findBox(i,["tfhd"]).map(function(e){var t=m.readUint32(e,4),a=n[t].timescale||9e4;m.findBox(i,["tfdt"]).map(function(e){var t=e.data[e.start],i=m.readUint32(e,4);if(0===t)m.writeUint32(e,4,i-s*a);else{i*=Math.pow(2,32),i+=m.readUint32(e,8),i-=s*a,i=Math.max(i,0);var n=Math.floor(i/(1+o)),r=Math.floor(i%(1+o));m.writeUint32(e,4,n),m.writeUint32(e,8,r)}})})})},m.prototype.append=function(e,t,i,n){var r=this.initData;r||(this.resetInitSegment(e,this.audioCodec,this.videoCodec,!1),r=this.initData);var a,s=this.initPTS;if(void 0===s){var o=m.getStartDTS(r,e);this.initPTS=s=o-t,this.observer.trigger(l.a.INIT_PTS_FOUND,{initPTS:s})}m.offsetStartDTS(r,e,s),a=m.getStartDTS(r,e),this.remuxer.remux(r.audio,r.video,null,null,a,i,n,e)},m.prototype.destroy=function(){},m);function m(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),this.observer=e,this.remuxer=t}t.a=n},function(e,t,i){var Z=i(1),ee=i(2),m=i(8),p=i(3),te=i(0),n=i(4);function r(e,t){return 255===e[t]&&240==(246&e[t+1])}function c(e,t){return 1&e[t+1]?7:9}function h(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function g(e,t){return!!(t+1<e.length&&r(e,t))}function a(e,t){if(t+1<e.length&&r(e,t)){var i=c(e,t);t+5<e.length&&(i=h(e,t));var n=t+i;if(n===e.length||n+1<e.length&&r(e,n))return 1}}function v(e,t,i,n,r){if(!e.samplerate){var a=function(e,t,i,n){var r,a=void 0,s=void 0,o=void 0,l=void 0,u=navigator.userAgent.toLowerCase(),c=n,h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(a=1+((192&t[i+2])>>>6),r=(60&t[i+2])>>>2,!(h.length-1<r))return o=(1&t[i+2])<<2,o|=(192&t[i+3])>>>6,te.b.log("manifest codec:"+n+",ADTS data:type:"+a+",sampleingIndex:"+r+"["+h[r]+"Hz],channelConfig:"+o),s=/firefox/i.test(u)?6<=r?(a=5,l=new Array(4),r-3):(a=2,l=new Array(2),r):-1!==u.indexOf("android")?(a=2,l=new Array(2),r):(a=5,l=new Array(4),n&&(-1!==n.indexOf("mp4a.40.29")||-1!==n.indexOf("mp4a.40.5"))||!n&&6<=r?r-3:((n&&-1!==n.indexOf("mp4a.40.2")&&(6<=r&&1==o||/vivaldi/i.test(u))||!n&&1==o)&&(a=2,l=new Array(2)),r)),l[0]=a<<3,l[0]|=(14&r)>>1,l[1]|=(1&r)<<7,l[1]|=o<<3,5===a&&(l[1]|=(14&s)>>1,l[2]=(1&s)<<7,l[2]|=8,l[3]=0),{config:l,samplerate:h[r],channelCount:o,codec:"mp4a.40."+a,manifestCodec:c};e.trigger(Z.a.ERROR,{type:ee.b.MEDIA_ERROR,details:ee.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+r})}(t,i,n,r);e.config=a.config,e.samplerate=a.samplerate,e.channelCount=a.channelCount,e.codec=a.codec,e.manifestCodec=a.manifestCodec,te.b.log("parsed codec:"+e.codec+",rate:"+a.samplerate+",nb channel:"+a.channelCount)}}function y(e){return 9216e4/e}function b(e,t,i,n,r){var a=function(e,t,i,n,r){var a,s=void 0,o=e.length;if(a=c(e,t),s=h(e,t),0<(s-=a)&&t+a+s<=o)return{headerLength:a,frameLength:s,stamp:i+n*r}}(t,i,n,r,y(e.samplerate));if(a){var s=a.stamp,o=a.headerLength,l=a.frameLength,u={unit:t.subarray(i+o,i+o+l),pts:s,dts:s};return e.samples.push(u),e.len+=l,{sample:u,length:l+o}}}var _=i(6);function s(e,t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this.observer=e,this.config=i,this.remuxer=t}var E=(s.prototype.resetInitSegment=function(e,t,i,n){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}},s.prototype.resetTimeStamp=function(){},s.probe=function(e){if(!e)return!1;for(var t=(_.a.getID3Data(e,0)||[]).length,i=e.length;t<i;t++)if(a(e,t))return te.b.log("ADTS sync word found !"),!0;return!1},s.prototype.append=function(e,t,i,n){for(var r=this._audioTrack,a=_.a.getID3Data(e,0)||[],s=_.a.getTimeStamp(a),o=Object(p.a)(s)?90*s:9e4*t,l=0,u=o,c=e.length,h=a.length,d=[{pts:u,dts:u,data:a}];h<c-1;)if(g(e,h)&&h+5<c){v(r,this.observer,e,h,r.manifestCodec);var f=b(r,e,h,o,l);if(!f){te.b.log("Unable to parse AAC frame");break}h+=f.length,u=f.sample.pts,l++}else _.a.isHeader(e,h)?(a=_.a.getID3Data(e,h),d.push({pts:u,dts:u,data:a}),h+=a.length):h++;this.remuxer.remux(r,{samples:[]},{samples:d,inputTimeScale:9e4},{samples:[]},t,i,n)},s.prototype.destroy=function(){},s),w=i(9),T={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,i,n,r){if(!(i+24>t.length)){var a=this.parseHeader(t,i);if(a&&i+a.frameLength<=t.length){var s=n+r*(9e4*a.samplesPerFrame/a.sampleRate),o={unit:t.subarray(i,i+a.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(o),e.len+=a.frameLength,{sample:o,length:a.frameLength}}}},parseHeader:function(e,t){var i=e[t+1]>>3&3,n=e[t+1]>>1&3,r=e[t+2]>>4&15,a=e[t+2]>>2&3,s=e[t+2]>>1&1;if(1!=i&&0!=r&&15!=r&&3!=a){var o=3==i?3-n:3==n?3:4,l=1e3*T.BitratesMap[14*o+r-1],u=3==i?0:2==i?1:2,c=T.SamplingRateMap[3*u+a],h=e[t+3]>>6==3?1:2,d=T.SamplesCoefficients[i][n],f=T.BytesInSlot[n],p=8*d*f;return{sampleRate:c,channelCount:h,frameLength:parseInt(d*l/c+s,10)*f,samplesPerFrame:p}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var i=this.parseHeader(e,t),n=4;i&&i.frameLength&&(n=i.frameLength);var r=t+n;if(r===e.length||r+1<e.length&&this.isHeaderPattern(e,r))return!0}return!1}},S=T;function o(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var C=(o.prototype.loadWord=function(){var e=this.data,t=this.bytesAvailable,i=e.byteLength-t,n=new Uint8Array(4),r=Math.min(4,t);if(0===r)throw new Error("no bytes available");n.set(e.subarray(i,i+r)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r},o.prototype.skipBits=function(e){var t=void 0;this.bitsAvailable>e||(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord()),this.word<<=e,this.bitsAvailable-=e},o.prototype.readBits=function(e){var t=Math.min(this.bitsAvailable,e),i=this.word>>>32-t;return 32<e&&te.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,0<this.bitsAvailable?this.word<<=t:0<this.bytesAvailable&&this.loadWord(),0<(t=e-t)&&this.bitsAvailable?i<<t|this.readBits(t):i},o.prototype.skipLZ=function(){var e=void 0;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},o.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},o.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},o.prototype.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},o.prototype.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},o.prototype.readBoolean=function(){return 1===this.readBits(1)},o.prototype.readUByte=function(){return this.readBits(8)},o.prototype.readUShort=function(){return this.readBits(16)},o.prototype.readUInt=function(){return this.readBits(32)},o.prototype.skipScalingList=function(e){var t=8,i=8,n=void 0;for(n=0;n<e;n++)0!==i&&(i=(t+this.readEG()+256)%256),t=0===i?t:i},o.prototype.readSPS=function(){var e,t,i,n,r=0,a=0,s=0,o=0,l=void 0,u=void 0,c=void 0,h=this.readUByte.bind(this),d=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),m=this.skipBits.bind(this),g=this.skipEG.bind(this),v=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(h(),e=h(),d(5),m(3),h(),v(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var b=f();if(3===b&&m(1),v(),v(),m(1),p())for(u=3!==b?8:12,c=0;c<u;c++)p()&&y(c<6?16:64)}v();var _=f();if(0===_)f();else if(1===_)for(m(1),g(),g(),l=f(),c=0;c<l;c++)g();v(),m(1),t=f(),i=f(),0===(n=d(1))&&m(1),m(1),p()&&(r=f(),a=f(),s=f(),o=f());var T=[1,1];if(p()&&p())switch(h()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[h()<<8|h(),h()<<8|h()]}return{width:Math.ceil(16*(t+1)-2*r-2*a),height:(2-n)*(i+1)*16-(n?2:4)*(s+o),pixelRatio:T}},o.prototype.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},o);function l(e,t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),this.decryptdata=i,this.discardEPB=n,this.decrypter=new m.a(e,t,{removePKCS7Padding:!1})}var u=(l.prototype.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},l.prototype.decryptAacSample=function(t,i,n,r){var a=t[i].unit,e=a.subarray(16,a.length-a.length%16),s=e.buffer.slice(e.byteOffset,e.byteOffset+e.length),o=this;this.decryptBuffer(s,function(e){e=new Uint8Array(e),a.set(e,16),r||o.decryptAacSamples(t,i+1,n)})},l.prototype.decryptAacSamples=function(e,t,i){for(;;t++){if(t>=e.length)return void i();if(!(e[t].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(e,t,i,n),!n)return}}},l.prototype.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,i=new Int8Array(t),n=0,r=32;r<=e.length-16;r+=160,n+=16)i.set(e.subarray(r,r+16),n);return i},l.prototype.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var i=0,n=32;n<=e.length-16;n+=160,i+=16)e.set(t.subarray(i,i+16),n);return e},l.prototype.decryptAvcSample=function(t,i,n,r,a,s){var o=this.discardEPB(a.data),e=this.getAvcEncryptedData(o),l=this;this.decryptBuffer(e.buffer,function(e){a.data=l.getAvcDecryptedUnit(o,e),s||l.decryptAvcSamples(t,i,n+1,r)})},l.prototype.decryptAvcSamples=function(e,t,i,n){for(;;t++,i=0){if(t>=e.length)return void n();for(var r=e[t].units;!(i>=r.length);i++){var a=r[i];if(!(a.length<=48||1!==a.type&&5!==a.type)){var s=this.decrypter.isSync();if(this.decryptAvcSample(e,t,i,n,a,s),!s)return}}}},l);var d={video:1,audio:2,id3:3,text:4};function L(e,t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,L),this.observer=e,this.config=i,this.typeSupported=n,this.remuxer=t,this.sampleAes=null}var k=(L.prototype.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new u(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},L.probe=function(e){var t=L._syncOffset(e);return!(t<0||(t&&te.b.warn("MPEG2-TS detected but first sync word found @ offset "+t+", junk ahead ?"),0))},L._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),i=0;i<t;){if(71===e[i]&&71===e[i+188]&&71===e[i+376])return i;i++}return-1},L.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:d[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},L.prototype.resetInitSegment=function(e,t,i,n){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=L.createTrack("video",n),this._audioTrack=L.createTrack("audio",n),this._id3Track=L.createTrack("id3",n),this._txtTrack=L.createTrack("text",n),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=t,this.videoCodec=i,this._duration=n},L.prototype.resetTimeStamp=function(){},L.prototype.append=function(e,t,i,n){var r=void 0,a=e.length,s=void 0,o=void 0,l=void 0,u=void 0,c=!1;this.contiguous=i;var h=this.pmtParsed,d=this._avcTrack,f=this._audioTrack,p=this._id3Track,m=d.pid,g=f.pid,v=p.pid,y=this._pmtId,b=d.pesData,_=f.pesData,T=p.pesData,S=this._parsePAT,E=this._parsePMT,w=this._parsePES,C=this._parseAVCPES.bind(this),k=this._parseAACPES.bind(this),A=this._parseMPEGPES.bind(this),I=this._parseID3PES.bind(this),x=L._syncOffset(e);for(a-=(a+x)%188,r=x;r<a;r+=188)if(71===e[r]){if(s=!!(64&e[r+1]),o=((31&e[r+1])<<8)+e[r+2],1<(48&e[r+3])>>4){if((l=r+5+e[r+4])===r+188)continue}else l=r+4;switch(o){case m:s&&(b&&(u=w(b))&&void 0!==u.pts&&C(u,!1),b={data:[],size:0}),b&&(b.data.push(e.subarray(l,r+188)),b.size+=r+188-l);break;case g:s&&(_&&(u=w(_))&&void 0!==u.pts&&(f.isAAC?k:A)(u),_={data:[],size:0}),_&&(_.data.push(e.subarray(l,r+188)),_.size+=r+188-l);break;case v:s&&(T&&(u=w(T))&&void 0!==u.pts&&I(u),T={data:[],size:0}),T&&(T.data.push(e.subarray(l,r+188)),T.size+=r+188-l);break;case 0:s&&(l+=e[l]+1),y=this._pmtId=S(e,l);break;case y:s&&(l+=e[l]+1);var P=E(e,l,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);0<(m=P.avc)&&(d.pid=m),0<(g=P.audio)&&(f.pid=g,f.isAAC=P.isAAC),0<(v=P.id3)&&(p.pid=v),c&&!h&&(te.b.log("reparse from beginning"),c=!1,r=x-188),h=this.pmtParsed=!0;break;case 17:case 8191:break;default:c=!0}}else this.observer.trigger(Z.a.ERROR,{type:ee.b.MEDIA_ERROR,details:ee.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});b&&(u=w(b))&&void 0!==u.pts?(C(u,!0),d.pesData=null):d.pesData=b,_&&(u=w(_))&&void 0!==u.pts?((f.isAAC?k:A)(u),f.pesData=null):(_&&_.size&&te.b.log("last AAC PES packet truncated,might overlap between fragments"),f.pesData=_),T&&(u=w(T))&&void 0!==u.pts?(I(u),p.pesData=null):p.pesData=T,null==this.sampleAes?this.remuxer.remux(f,d,p,this._txtTrack,t,i,n):this.decryptAndRemux(f,d,p,this._txtTrack,t,i,n)},L.prototype.decryptAndRemux=function(e,t,i,n,r,a,s){if(e.samples&&e.isAAC){var o=this;this.sampleAes.decryptAacSamples(e.samples,0,function(){o.decryptAndRemuxAvc(e,t,i,n,r,a,s)})}else this.decryptAndRemuxAvc(e,t,i,n,r,a,s)},L.prototype.decryptAndRemuxAvc=function(e,t,i,n,r,a,s){if(t.samples){var o=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,function(){o.remuxer.remux(e,t,i,n,r,a,s)})}else this.remuxer.remux(e,t,i,n,r,a,s)},L.prototype.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},L.prototype._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},L.prototype._parsePMT=function(e,t,i,n){var r,a=void 0,s={audio:-1,avc:-1,id3:-1,isAAC:!0};for(r=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<r;){switch(a=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!n){te.b.log("unkown stream type:"+e[t]);break}case 15:-1===s.audio&&(s.audio=a);break;case 21:-1===s.id3&&(s.id3=a);break;case 219:if(!n){te.b.log("unkown stream type:"+e[t]);break}case 27:-1===s.avc&&(s.avc=a);break;case 3:case 4:i?-1===s.audio&&(s.audio=a,s.isAAC=!1):te.b.log("MPEG audio found, not supported in this browser for now");break;case 36:te.b.warn("HEVC stream type found, not supported for now");break;default:te.b.log("unkown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return s},L.prototype._parsePES=function(e){var t=0,i=void 0,n=void 0,r=void 0,a=void 0,s=void 0,o=void 0,l=void 0,u=void 0,c=e.data;if(!e||0===e.size)return null;for(;c[0].length<19&&1<c.length;){var h=new Uint8Array(c[0].length+c[1].length);h.set(c[0]),h.set(c[1],c[0].length),c[0]=h,c.splice(1,1)}if(1!==((i=c[0])[0]<<16)+(i[1]<<8)+i[2])return null;if((r=(i[4]<<8)+i[5])&&r>e.size-6)return null;192&(n=i[7])&&(4294967295<(o=536870912*(14&i[9])+4194304*(255&i[10])+16384*(254&i[11])+128*(255&i[12])+(254&i[13])/2)&&(o-=8589934592),64&n?(4294967295<(l=536870912*(14&i[14])+4194304*(255&i[15])+16384*(254&i[16])+128*(255&i[17])+(254&i[18])/2)&&(l-=8589934592),54e5<o-l&&(te.b.warn(Math.round((o-l)/9e4)+"s delta between PTS and DTS, align them"),o=l)):l=o),u=(a=i[8])+9,e.size-=u,s=new Uint8Array(e.size);for(var d=0,f=c.length;d<f;d++){var p=(i=c[d]).byteLength;if(u){if(p<u){u-=p;continue}i=i.subarray(u),p-=u,u=0}s.set(i,t),t+=p}return r&&(r-=a+3),{data:s,pts:o,dts:l,len:r}},L.prototype.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var i=t.samples,n=i.length;!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(n||this.contiguous)?(e.id=n,i.push(e)):t.dropped++}e.debug.length&&te.b.log(e.pts+"/"+e.dts+":"+e.debug)},L.prototype._parseAVCPES=function(p,e){function m(e,t,i,n){return{key:e,pts:t,dts:i,units:[],debug:n}}var g=this,v=this._avcTrack,t=this._parseAVCNALu(p.data),y=void 0,b=this.avcSample,_=void 0,T=!1,S=void 0,E=this.pushAccesUnit.bind(this);p.data=null,b&&t.length&&!v.audFound&&(E(b,v),b=this.avcSample=m(!1,p.pts,p.dts,"")),t.forEach(function(e){switch(e.type){case 1:_=!0,(b=b||(g.avcSample=m(!0,p.pts,p.dts,""))).frame=!0;var t=e.data;if(T&&4<t.length){var i=new C(t).readSliceType();2!==i&&4!==i&&7!==i&&9!==i||(b.key=!0)}break;case 5:_=!0,(b=b||(g.avcSample=m(!0,p.pts,p.dts,""))).key=!0,b.frame=!0;break;case 6:_=!0,(y=new C(g.discardEPB(e.data))).readUByte();for(var n=0,r=0,a=!1,s=0;!a&&1<y.bytesAvailable;){for(n=0;n+=s=y.readUByte(),255===s;);for(r=0;r+=s=y.readUByte(),255===s;);if(4===n&&0!==y.bytesAvailable){if(a=!0,181===y.readUByte()&&49===y.readUShort()&&1195456820===y.readUInt()&&3===y.readUByte()){var o=y.readUByte(),l=31&o,u=[o,y.readUByte()];for(S=0;S<l;S++)u.push(y.readUByte()),u.push(y.readUByte()),u.push(y.readUByte());g._insertSampleInOrder(g._txtTrack.samples,{type:3,pts:p.pts,bytes:u})}}else if(r<y.bytesAvailable)for(S=0;S<r;S++)y.readUByte()}break;case 7:if(T=_=!0,!v.sps){var c=(y=new C(e.data)).readSPS();v.width=c.width,v.height=c.height,v.pixelRatio=c.pixelRatio,v.sps=[e.data],v.duration=g._duration;var h=e.data.subarray(1,4),d="avc1.";for(S=0;S<3;S++){var f=h[S].toString(16);f.length<2&&(f="0"+f),d+=f}v.codec=d}break;case 8:_=!0,v.pps||(v.pps=[e.data]);break;case 9:_=!1,v.audFound=!0,b&&E(b,v),b=g.avcSample=m(!1,p.pts,p.dts,"");break;case 12:_=!1;break;default:_=!1,b&&(b.debug+="unknown NAL "+e.type+" ")}b&&_&&b.units.push(e)}),e&&b&&(E(b,v),this.avcSample=null)},L.prototype._insertSampleInOrder=function(e,t){var i=e.length;if(0<i){if(t.pts>=e[i-1].pts)e.push(t);else for(var n=i-1;0<=n;n--)if(t.pts<e[n].pts){e.splice(n,0,t);break}}else e.push(t)},L.prototype._getLastNalUnit=function(){var e=this.avcSample,t=void 0;if(!e||0===e.units.length){var i=this._avcTrack.samples;e=i[i.length-1]}if(e){var n=e.units;t=n[n.length-1]}return t},L.prototype._parseAVCNALu=function(e){var t=0,i=e.byteLength,n=void 0,r=void 0,a=this._avcTrack,s=a.naluState||0,o=s,l=[],u=void 0,c=-1,h=void 0;for(-1===s&&(h=31&e[c=0],s=0,t=1);t<i;)if(n=e[t++],s)if(1!==s)if(n)if(1===n){if(0<=c)u={data:e.subarray(c,t-s-1),type:h},l.push(u);else{var d=this._getLastNalUnit();if(d&&(o&&t<=4-o&&d.state&&(d.data=d.data.subarray(0,d.data.byteLength-o)),0<(r=t-s-1))){var f=new Uint8Array(d.data.byteLength+r);f.set(d.data,0),f.set(e.subarray(0,r),d.data.byteLength),d.data=f}}s=t<i?(h=31&e[c=t],0):-1}else s=0;else s=3;else s=n?0:2;else s=n?0:1;if(0<=c&&0<=s&&(u={data:e.subarray(c,i),type:h,state:s},l.push(u)),0===l.length){var p=this._getLastNalUnit();if(p){var m=new Uint8Array(p.data.byteLength+e.byteLength);m.set(p.data,0),m.set(e,p.data.byteLength),p.data=m}}return a.naluState=s,l},L.prototype.discardEPB=function(e){for(var t,i=e.byteLength,n=[],r=1,a=void 0;r<i-2;)0===e[r]&&0===e[r+1]&&3===e[r+2]?(n.push(r+2),r+=2):r++;if(0===n.length)return e;t=i-n.length,a=new Uint8Array(t);var s=0;for(r=0;r<t;s++,r++)s===n[0]&&(s++,n.shift()),a[r]=e[s];return a},L.prototype._parseAACPES=function(e){var t,i,n=this._audioTrack,r=e.data,a=e.pts,s=this.aacOverFlow,o=this.aacLastPTS,l=void 0,u=void 0,c=void 0;if(s){var h=new Uint8Array(s.byteLength+r.byteLength);h.set(s,0),h.set(r,s.byteLength),r=h}for(u=0,i=r.length;u<i-1&&!g(r,u);u++);if(u){var d=void 0,f=void 0;if(f=u<i-1?(d="AAC PES did not start with ADTS header,offset:"+u,!1):(d="no ADTS header found in AAC PES",!0),te.b.warn("parsing error:"+d),this.observer.trigger(Z.a.ERROR,{type:ee.b.MEDIA_ERROR,details:ee.a.FRAG_PARSING_ERROR,fatal:f,reason:d}),f)return}if(v(n,this.observer,r,u,this.audioCodec),l=0,t=y(n.samplerate),s&&o){var p=o+t;1<Math.abs(p-a)&&(te.b.log("AAC: align PTS for overlapping frames by "+Math.round((p-a)/90)),a=p)}for(;u<i;)if(g(r,u)&&u+5<i){var m=b(n,r,u,a,l);if(!m)break;u+=m.length,c=m.sample.pts,l++}else u++;s=u<i?r.subarray(u,i):null,this.aacOverFlow=s,this.aacLastPTS=c},L.prototype._parseMPEGPES=function(e){for(var t=e.data,i=t.length,n=0,r=0,a=e.pts;r<i;)if(S.isHeader(t,r)){var s=S.appendFrame(this._audioTrack,t,r,a,n);if(!s)break;r+=s.length,n++}else r++},L.prototype._parseID3PES=function(e){this._id3Track.samples.push(e)},L);function f(e,t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),this.observer=e,this.config=i,this.remuxer=t}var A=(f.prototype.resetInitSegment=function(e,t,i,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}},f.prototype.resetTimeStamp=function(){},f.probe=function(e){var t=void 0,i=void 0,n=_.a.getID3Data(e,0);if(n&&void 0!==_.a.getTimeStamp(n))for(t=n.length,i=Math.min(e.length-1,t+100);t<i;t++)if(S.probe(e,t))return te.b.log("MPEG Audio sync word found !"),!0;return!1},f.prototype.append=function(e,t,i,n){for(var r=_.a.getID3Data(e,0),a=_.a.getTimeStamp(r),s=a?90*a:9e4*t,o=r.length,l=e.length,u=0,c=0,h=this._audioTrack,d=[{pts:s,dts:s,data:r}];o<l;)if(S.isHeader(e,o)){var f=S.appendFrame(h,e,o,s,u);if(!f)break;o+=f.length,c=f.sample.pts,u++}else _.a.isHeader(e,o)?(r=_.a.getID3Data(e,o),d.push({pts:c,dts:c,data:r}),o+=r.length):o++;this.remuxer.remux(h,{samples:[]},{samples:d,inputTimeScale:9e4},{samples:[]},t,i,n)},f.prototype.destroy=function(){},f);function I(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,I)}var W=(I.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},I);var x=Math.pow(2,32)-1;function P(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,P)}var ie=(P.init=function(){P.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var e=void 0;for(e in P.types)P.types.hasOwnProperty(e)&&(P.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);P.HDLR_TYPES={video:t,audio:i};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);P.STTS=P.STSC=P.STCO=r,P.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),P.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),P.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),P.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var a=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);P.FTYP=P.box(P.types.ftyp,a,o,a,s),P.DINF=P.box(P.types.dinf,P.box(P.types.dref,n))},P.box=function(e){for(var t=Array.prototype.slice.call(arguments,1),i=8,n=t.length,r=n,a=void 0;n--;)i+=t[n].byteLength;for((a=new Uint8Array(i))[0]=i>>24&255,a[1]=i>>16&255,a[2]=i>>8&255,a[3]=255&i,a.set(e,4),n=0,i=8;n<r;n++)a.set(t[n],i),i+=t[n].byteLength;return a},P.hdlr=function(e){return P.box(P.types.hdlr,P.HDLR_TYPES[e])},P.mdat=function(e){return P.box(P.types.mdat,e)},P.mdhd=function(e,t){t*=e;var i=Math.floor(t/(1+x)),n=Math.floor(t%(1+x));return P.box(P.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))},P.mdia=function(e){return P.box(P.types.mdia,P.mdhd(e.timescale,e.duration),P.hdlr(e.type),P.minf(e))},P.mfhd=function(e){return P.box(P.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))},P.minf=function(e){return"audio"===e.type?P.box(P.types.minf,P.box(P.types.smhd,P.SMHD),P.DINF,P.stbl(e)):P.box(P.types.minf,P.box(P.types.vmhd,P.VMHD),P.DINF,P.stbl(e))},P.moof=function(e,t,i){return P.box(P.types.moof,P.mfhd(e),P.traf(i,t))},P.moov=function(e){for(var t=e.length,i=[];t--;)i[t]=P.trak(e[t]);return P.box.apply(null,[P.types.moov,P.mvhd(e[0].timescale,e[0].duration)].concat(i).concat(P.mvex(e)))},P.mvex=function(e){for(var t=e.length,i=[];t--;)i[t]=P.trex(e[t]);return P.box.apply(null,[P.types.mvex].concat(i))},P.mvhd=function(e,t){t*=e;var i=Math.floor(t/(1+x)),n=Math.floor(t%(1+x)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return P.box(P.types.mvhd,r)},P.sdtp=function(e){var t=e.samples||[],i=new Uint8Array(4+t.length),n=void 0,r=void 0;for(r=0;r<t.length;r++)n=t[r].flags,i[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return P.box(P.types.sdtp,i)},P.stbl=function(e){return P.box(P.types.stbl,P.stsd(e),P.box(P.types.stts,P.STTS),P.box(P.types.stsc,P.STSC),P.box(P.types.stsz,P.STSZ),P.box(P.types.stco,P.STCO))},P.avc1=function(e){var t=[],i=[],n=void 0,r=void 0,a=void 0;for(n=0;n<e.sps.length;n++)a=(r=e.sps[n]).byteLength,t.push(a>>>8&255),t.push(255&a),t=t.concat(Array.prototype.slice.call(r));for(n=0;n<e.pps.length;n++)a=(r=e.pps[n]).byteLength,i.push(a>>>8&255),i.push(255&a),i=i.concat(Array.prototype.slice.call(r));var s=P.box(P.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(i))),o=e.width,l=e.height,u=e.pixelRatio[0],c=e.pixelRatio[1];return P.box(P.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,P.box(P.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),P.box(P.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))},P.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},P.mp4a=function(e){var t=e.samplerate;return P.box(P.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]),P.box(P.types.esds,P.esds(e)))},P.mp3=function(e){var t=e.samplerate;return P.box(P.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]))},P.stsd=function(e){return"audio"===e.type?e.isAAC||"mp3"!==e.codec?P.box(P.types.stsd,P.STSD,P.mp4a(e)):P.box(P.types.stsd,P.STSD,P.mp3(e)):P.box(P.types.stsd,P.STSD,P.avc1(e))},P.tkhd=function(e){var t=e.id,i=e.duration*e.timescale,n=e.width,r=e.height,a=Math.floor(i/(1+x)),s=Math.floor(i%(1+x));return P.box(P.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,r>>8&255,255&r,0,0]))},P.traf=function(e,t){var i=P.sdtp(e),n=e.id,r=Math.floor(t/(1+x)),a=Math.floor(t%(1+x));return P.box(P.types.traf,P.box(P.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),P.box(P.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,a>>24,a>>16&255,a>>8&255,255&a])),P.trun(e,i.length+16+20+8+16+8+8),i)},P.trak=function(e){return e.duration=e.duration||4294967295,P.box(P.types.trak,P.tkhd(e),P.mdia(e))},P.trex=function(e){var t=e.id;return P.box(P.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},P.trun=function(e,t){var i=e.samples||[],n=i.length,r=12+16*n,a=new Uint8Array(r),s=void 0,o=void 0,l=void 0,u=void 0,c=void 0,h=void 0;for(t+=8+r,a.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),s=0;s<n;s++)l=(o=i[s]).duration,u=o.size,c=o.flags,h=o.cts,a.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,u>>>24&255,u>>>16&255,u>>>8&255,255&u,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|c.isNonSync,61440&c.degradPrio,15&c.degradPrio,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*s);return P.box(P.types.trun,a)},P.initSegment=function(e){P.types||P.init();var t=P.moov(e),i=void 0;return(i=new Uint8Array(P.FTYP.byteLength+t.byteLength)).set(P.FTYP),i.set(t,P.FTYP.byteLength),i},P);function R(e,t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,R),this.observer=e,this.config=t,this.typeSupported=i;var r=navigator.userAgent;this.isSafari=n&&-1<n.indexOf("Apple")&&r&&!r.match("CriOS"),this.ISGenerated=!1}var O=(R.prototype.destroy=function(){},R.prototype.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},R.prototype.resetInitSegment=function(){this.ISGenerated=!1},R.prototype.remux=function(e,t,i,n,r,a,s){if(this.ISGenerated||this.generateIS(e,t,r),this.ISGenerated){var o=e.samples.length,l=t.samples.length,u=r,c=r;if(o&&l){var h=(e.samples[0].dts-t.samples[0].dts)/t.inputTimeScale;u+=Math.max(0,h),c+=Math.max(0,-h)}if(o){e.timescale||(te.b.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,r));var d=this.remuxAudio(e,u,a,s);if(l){var f=void 0;d&&(f=d.endPTS-d.startPTS),t.timescale||(te.b.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,r)),this.remuxVideo(t,c,a,f,s)}}else if(l){var p=this.remuxVideo(t,c,a,0,s);p&&e.codec&&this.remuxEmptyAudio(e,u,a,p)}}i.samples.length&&this.remuxID3(i,r),n.samples.length&&this.remuxText(n,r),this.observer.trigger(Z.a.FRAG_PARSED)},R.prototype.generateIS=function(e,t,i){var n=this.observer,r=e.samples,a=t.samples,s=this.typeSupported,o="audio/mp4",l={},u={tracks:l},c=void 0===this._initPTS,h=void 0,d=void 0;if(c&&(h=d=1/0),e.config&&r.length&&(e.timescale=e.samplerate,te.b.log("audio sampling rate : "+e.samplerate),e.isAAC||(s.mpeg?(o="audio/mpeg",e.codec=""):s.mp3&&(e.codec="mp3")),l.audio={container:o,codec:e.codec,initSegment:!e.isAAC&&s.mpeg?new Uint8Array:ie.initSegment([e]),metadata:{channelCount:e.channelCount}},c&&(h=d=r[0].pts-e.inputTimeScale*i)),t.sps&&t.pps&&a.length){var f=t.inputTimeScale;t.timescale=f,l.video={container:"video/mp4",codec:t.codec,initSegment:ie.initSegment([t]),metadata:{width:t.width,height:t.height}},c&&(h=Math.min(h,a[0].pts-f*i),d=Math.min(d,a[0].dts-f*i),this.observer.trigger(Z.a.INIT_PTS_FOUND,{initPTS:h}))}Object.keys(l).length?(n.trigger(Z.a.FRAG_PARSING_INIT_SEGMENT,u),this.ISGenerated=!0,c&&(this._initPTS=h,this._initDTS=d)):n.trigger(Z.a.ERROR,{type:ee.b.MEDIA_ERROR,details:ee.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},R.prototype.remuxVideo=function(e,t,i,n,r){var a,s,o,l=8,u=e.timescale,c=void 0,h=void 0,d=void 0,f=void 0,p=e.samples,m=[],g=p.length,v=this._PTSNormalize,y=this._initDTS,b=this.nextAvcDts,_=this.isSafari;if(0!==g){_&&(i|=p.length&&b&&(r&&Math.abs(t-b/u)<.1||Math.abs(p[0].pts-b-y)<u/5)),i||(b=t*u),p.forEach(function(e){e.pts=v(e.pts-y,b),e.dts=v(e.dts-y,b)}),p.sort(function(e,t){var i=e.dts-t.dts,n=e.pts-t.pts;return i||n||e.id-t.id});var T=p.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(T<0){te.b.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(T/90)+" ms to overcome this issue");for(var S=0;S<p.length;S++)p[S].dts+=T}var E=p[0];f=Math.max(E.dts,0),d=Math.max(E.pts,0);var w=Math.round((f-b)/90);i&&w&&(1<w?te.b.log("AVC:"+w+" ms hole between fragments detected,filling it"):w<-1&&te.b.log("AVC:"+-w+" ms overlapping between fragments detected"),f=b,p[0].dts=f,d=Math.max(d-w,b),p[0].pts=d,te.b.log("Video/PTS/DTS adjusted: "+Math.round(d/90)+"/"+Math.round(f/90)+",delta:"+w+" ms")),E=p[p.length-1],o=Math.max(E.dts,0),s=Math.max(E.pts,0,o),_&&(c=Math.round((o-f)/(p.length-1)));for(var C=0,k=0,A=0;A<g;A++){for(var I=p[A],x=I.units,P=x.length,L=0,R=0;R<P;R++)L+=x[R].data.length;k+=L,C+=P,I.length=L,I.dts=_?f+A*c:Math.max(I.dts,f),I.pts=Math.max(I.pts,I.dts)}var O=k+4*C+8;try{h=new Uint8Array(O)}catch(e){return void this.observer.trigger(Z.a.ERROR,{type:ee.b.MUX_ERROR,details:ee.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:O,reason:"fail allocating video mdat "+O})}var D=new DataView(h.buffer);D.setUint32(0,O),h.set(ie.types.mdat,4);for(var N=0;N<g;N++){for(var M=p[N],B=M.units,U=0,F=void 0,j=0,H=B.length;j<H;j++){var G=B[j],V=G.data,K=G.data.byteLength;D.setUint32(l,K),l+=4,h.set(V,l),l+=K,U+=4+K}if(_)F=Math.max(0,c*Math.round((M.pts-M.dts)/c));else{if(N<g-1)c=p[N+1].dts-M.dts;else{var W=this.config,q=M.dts-p[0<N?N-1:N].dts;if(W.stretchShortVideoTrack){var z=W.maxBufferHole,Y=Math.floor(z*u),X=(n?d+n*u:this.nextAudioPts)-M.pts;Y<X?((c=X-q)<0&&(c=q),te.b.log("It is approximately "+X/90+" ms to the next segment; using duration "+c/90+" ms for the last video frame.")):c=q}else c=q}F=Math.round(M.pts-M.dts)}m.push({size:U,duration:c,cts:F,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:M.key?2:1,isNonSync:M.key?0:1}})}this.nextAvcDts=o+c;var $=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,m.length&&-1<navigator.userAgent.toLowerCase().indexOf("chrome")){var J=m[0].flags;J.dependsOn=2,J.isNonSync=0}e.samples=m,a=ie.moof(e.sequenceNumber++,f,e),e.samples=[];var Q={data1:a,data2:h,startPTS:d/u,endPTS:(s+c)/u,startDTS:f/u,endDTS:this.nextAvcDts/u,type:"video",hasAudio:!1,hasVideo:!0,nb:m.length,dropped:$};return this.observer.trigger(Z.a.FRAG_PARSING_DATA,Q),Q}},R.prototype.remuxAudio=function(e,t,i,n){var r=e.inputTimeScale,a=e.timescale,s=r/a,o=(e.isAAC?1024:1152)*s,l=this._PTSNormalize,u=this._initDTS,c=!e.isAAC&&this.typeSupported.mpeg,h=void 0,d=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=e.samples,b=[],_=this.nextAudioPts;if(i|=y.length&&_&&(n&&Math.abs(t-_/r)<.1||Math.abs(y[0].pts-_-u)<20*o),y.forEach(function(e){e.pts=e.dts=l(e.pts-u,t*r)}),0!==(y=y.filter(function(e){return 0<=e.pts})).length){if(i||(_=n?t*r:y[0].pts),e.isAAC)for(var T=this.config.maxAudioFramesDrift,S=0,E=_;S<y.length;){var w,C=y[S];w=C.pts-E;var k=Math.abs(1e3*w/r);if(w<=-T*o)te.b.warn("Dropping 1 audio frame @ "+(E/r).toFixed(3)+"s due to "+Math.round(k)+" ms overlap."),y.splice(S,1),e.len-=C.unit.length;else if(T*o<=w&&k<1e4&&E){var A=Math.round(w/o);te.b.warn("Injecting "+A+" audio frame @ "+(E/r).toFixed(3)+"s due to "+Math.round(1e3*w/r)+" ms gap.");for(var I=0;I<A;I++){var x=Math.max(E,0);(f=W.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(te.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),f=C.unit.subarray()),y.splice(S,0,{unit:f,pts:x,dts:x}),e.len+=f.length,E+=o,S++}C.pts=C.dts=E,E+=o,S++}else C.pts=C.dts=E,E+=o,S++}for(var P=0,L=y.length;P<L;P++){var R=y[P],O=R.unit,D=R.pts;if(void 0!==v)d.duration=Math.round((D-v)/s);else{var N=Math.round(1e3*(D-_)/r),M=0;if(i&&e.isAAC&&N){if(0<N&&N<1e4)M=Math.round((D-_)/o),te.b.log(N+" ms hole between AAC samples detected,filling it"),0<M&&(f=(f=W.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||O.subarray(),e.len+=M*f.length);else if(N<-12){te.b.log("drop overlapping AAC sample, expected/parsed/delta:"+(_/r).toFixed(3)+"s/"+(D/r).toFixed(3)+"s/"+-N+"ms"),e.len-=O.byteLength;continue}D=_}if(g=D,!(0<e.len))return;var B=c?e.len:e.len+8;h=c?0:8;try{p=new Uint8Array(B)}catch(e){return void this.observer.trigger(Z.a.ERROR,{type:ee.b.MUX_ERROR,details:ee.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:B,reason:"fail allocating audio mdat "+B})}c||(new DataView(p.buffer).setUint32(0,B),p.set(ie.types.mdat,4));for(var U=0;U<M;U++)(f=W.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(te.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),f=O.subarray()),p.set(f,h),h+=f.byteLength,d={size:f.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},b.push(d)}p.set(O,h);var F=O.byteLength;h+=F,d={size:F,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},b.push(d),v=D}var j=0,H=b.length;if(2<=H&&(j=b[H-2].duration,d.duration=j),H){this.nextAudioPts=_=v+s*j,e.len=0,e.samples=b,m=c?new Uint8Array:ie.moof(e.sequenceNumber++,g/s,e),e.samples=[];var G=g/r,V=_/r,K={data1:m,data2:p,startPTS:G,endPTS:V,startDTS:G,endDTS:V,type:"audio",hasAudio:!0,hasVideo:!1,nb:H};return this.observer.trigger(Z.a.FRAG_PARSING_DATA,K),K}return null}},R.prototype.remuxEmptyAudio=function(e,t,i,n){var r=e.inputTimeScale,a=r/(e.samplerate?e.samplerate:r),s=this.nextAudioPts,o=(void 0!==s?s:n.startDTS*r)+this._initDTS,l=n.endDTS*r+this._initDTS,u=1024*a,c=Math.ceil((l-o)/u),h=W.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(te.b.warn("remux empty Audio"),h){for(var d=[],f=0;f<c;f++){var p=o+f*u;d.push({unit:h,pts:p,dts:p}),e.len+=h.length}e.samples=d,this.remuxAudio(e,t,i)}else te.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},R.prototype.remuxID3=function(e){var t=e.samples.length,i=void 0,n=e.inputTimeScale,r=this._initPTS,a=this._initDTS;if(t){for(var s=0;s<t;s++)(i=e.samples[s]).pts=(i.pts-r)/n,i.dts=(i.dts-a)/n;this.observer.trigger(Z.a.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[]},R.prototype.remuxText=function(e){e.samples.sort(function(e,t){return e.pts-t.pts});var t=e.samples.length,i=void 0,n=e.inputTimeScale,r=this._initPTS;if(t){for(var a=0;a<t;a++)(i=e.samples[a]).pts=(i.pts-r)/n;this.observer.trigger(Z.a.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},R.prototype._PTSNormalize=function(e,t){var i=void 0;if(void 0===t)return e;for(i=t<e?-8589934592:8589934592;4294967296<Math.abs(e-t);)e+=i;return e},R);function D(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,D),this.observer=e}var N=(D.prototype.destroy=function(){},D.prototype.resetTimeStamp=function(){},D.prototype.resetInitSegment=function(){},D.prototype.remux=function(e,t,i,n,r,a,s,o){var l=this.observer,u="";e&&(u+="audio"),t&&(u+="video"),l.trigger(Z.a.FRAG_PARSING_DATA,{data1:o,startPTS:r,startDTS:r,type:u,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),l.trigger(Z.a.FRAG_PARSED)},D);var M=Object(n.a)().performance,B=(U.prototype.destroy=function(){var e=this.demuxer;e&&e.destroy()},U.prototype.push=function(e,i,n,r,a,s,o,l,u,c,h,d){if(0<e.byteLength&&null!=i&&null!=i.key&&"AES-128"===i.method){var t=this.decrypter;null==t&&(t=this.decrypter=new m.a(this.observer,this.config));var f=this,p=void 0;try{p=M.now()}catch(e){p=Date.now()}t.decrypt(e,i.key.buffer,i.iv.buffer,function(e){var t=void 0;try{t=M.now()}catch(e){t=Date.now()}f.observer.trigger(Z.a.FRAG_DECRYPTED,{stats:{tstart:p,tdecrypt:t}}),f.pushDecrypted(new Uint8Array(e),i,new Uint8Array(n),r,a,s,o,l,u,c,h,d)})}else this.pushDecrypted(new Uint8Array(e),i,new Uint8Array(n),r,a,s,o,l,u,c,h,d)},U.prototype.pushDecrypted=function(e,t,i,n,r,a,s,o,l,u,c,h){var d=this.demuxer;if(!d||(s||o)&&!this.probe(e)){for(var f=this.observer,p=this.typeSupported,m=this.config,g=[{demux:k,remux:O},{demux:w.a,remux:N},{demux:E,remux:O},{demux:A,remux:O}],v=0,y=g.length;v<y;v++){var b=g[v],_=b.demux.probe;if(_(e)){var T=this.remuxer=new b.remux(f,m,p,this.vendor);d=new b.demux(f,T,m,p),this.probe=_;break}}if(!d)return void f.trigger(Z.a.ERROR,{type:ee.b.MEDIA_ERROR,details:ee.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=d}var S=this.remuxer;(s||o)&&(d.resetInitSegment(i,n,r,u),S.resetInitSegment()),s&&(d.resetTimeStamp(h),S.resetTimeStamp(h)),"function"==typeof d.setDecryptData&&d.setDecryptData(t),d.append(e,a,l,c)},U);function U(e,t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,U),this.observer=e,this.typeSupported=t,this.config=i,this.vendor=n}t.a=B},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n={};i.d(n,"newCue",function(){return Si});var r=i(5),a=i.n(r),d=i(2),N=i(3),M=i(1),B=i(0),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var o=new Set(["hlsEventGeneric","hlsHandlerDestroying","hlsHandlerDestroyed"]);function l(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),this.hls=e,this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];this.handledEvents=i,this.useGenericHandler=!0,this.registerListeners()}var u=(l.prototype.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},l.prototype.onHandlerDestroying=function(){},l.prototype.onHandlerDestroyed=function(){},l.prototype.isEventHandler=function(){return"object"===s(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent},l.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if(o.has(e))throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)},this)},l.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)},l.prototype.onEvent=function(e,t){this.onEventGeneric(e,t)},l.prototype.onEventGeneric=function(t,e){try{(function(e,t){var i="on"+e.replace("hls","");if("function"!=typeof this[i])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+i+")");return this[i].bind(this,t)}).call(this,t,e).call()}catch(e){B.b.error("An internal error happened while handling event "+t+'. Error message: "'+e.message+'". Here is a stacktrace:',e),this.hls.trigger(M.a.ERROR,{type:d.b.OTHER_ERROR,details:d.a.INTERNAL_EXCEPTION,fatal:!1,event:t,err:e})}},l),c=i(9);function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),this.method=null,this.key=null,this.iv=null,this._uri=null}var A=(function(e,t,i){return t&&h(e.prototype,t),i&&h(e,i),e}(f,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=a.a.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),f),p=function(e,t,i){return t&&m(e.prototype,t),i&&m(e,i),e};function m(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[],this.programDateTime=null,this.rawProgramDateTime=null,this._elementaryStreams=((e={})[g.ElementaryStreamTypes.AUDIO]=!1,e[g.ElementaryStreamTypes.VIDEO]=!1,e)}var I=(g.prototype.addElementaryStream=function(e){this._elementaryStreams[e]=!0},g.prototype.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},g.prototype.createInitializationVector=function(e){for(var t=new Uint8Array(16),i=12;i<16;i++)t[i]=e>>8*(15-i)&255;return t},g.prototype.fragmentDecryptdataFromLevelkey=function(e,t){var i=e;return e&&e.method&&e.uri&&!e.iv&&((i=new A).method=e.method,i.baseuri=e.baseuri,i.reluri=e.reluri,i.iv=this.createInitializationVector(t)),i},p(g,[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=a.a.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"byteRange",get:function(){if(!this._byteRange&&!this.rawByteRange)return[];if(this._byteRange)return this._byteRange;var e=[];if(this.rawByteRange){var t=this.rawByteRange.split("@",2);if(1===t.length){var i=this.lastByteRangeEndOffset;e[0]=i||0}else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0],this._byteRange=e}return e}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}},{key:"endProgramDateTime",get:function(){if(!Object(N.a)(this.programDateTime))return null;var e=Object(N.a)(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}],[{key:"ElementaryStreamTypes",get:function(){return{AUDIO:"audio",VIDEO:"video"}}}]),g);function v(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}var x=(function(e,t,i){return t&&v(e.prototype,t),i&&v(e,i),e}(y,[{key:"hasProgramDateTime",get:function(){return!(!this.fragments[0]||!Object(N.a)(this.fragments[0].programDateTime))}}]),y);var b=/^(\d+)x(\d+)$/,_=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g;function T(e){for(var t in!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,T),"string"==typeof e&&(e=T.parseAttrList(e)),e)e.hasOwnProperty(t)&&(this[t]=e[t])}var P=(T.prototype.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},T.prototype.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var i=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)i[n]=parseInt(t.slice(2*n,2*n+2),16);return i}return null},T.prototype.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},T.prototype.decimalFloatingPoint=function(e){return parseFloat(this[e])},T.prototype.enumeratedString=function(e){return this[e]},T.prototype.decimalResolution=function(e){var t=b.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},T.parseAttrList=function(e){var t=void 0,i={};for(_.lastIndex=0;null!==(t=_.exec(e));){var n=t[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),i[t[1]]=n}return i},T),S={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function E(e,t){return window.MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}var w=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,C=/#EXT-X-MEDIA:(.*)/g,L=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),R=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,O=/\.(mp4|m4s|m4v|m4a)$/i;function k(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,k)}var D=(k.findGroup=function(e,t){if(!e)return null;for(var i=null,n=0;n<e.length;n++){var r=e[n];r.id===t&&(i=r)}return i},k.convertAVC1ToAVCOTI=function(e){var t=void 0,i=e.split(".");return 2<i.length?(t=i.shift()+".",t+=parseInt(i.shift()).toString(16),t+=("000"+parseInt(i.shift()).toString(16)).substr(-4)):t=e,t},k.resolve=function(e,t){return a.a.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},k.parseMasterPlaylist=function(e,t){var i=[],n=void 0;function r(i,r){["video","audio"].forEach(function(n){var t=i.filter(function(e){return t=e,!!(i=S[n])&&!0===i[t.slice(0,4)];var t,i});if(t.length){var e=t.filter(function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)});r[n+"Codec"]=0<e.length?e[0]:t[0],i=i.filter(function(e){return-1===t.indexOf(e)})}}),r.unknownCodecs=i}for(w.lastIndex=0;null!=(n=w.exec(e));){var a={},s=a.attrs=new P(n[1]);a.url=k.resolve(n[2],t);var o=s.decimalResolution("RESOLUTION");o&&(a.width=o.width,a.height=o.height),a.bitrate=s.decimalInteger("AVERAGE-BANDWIDTH")||s.decimalInteger("BANDWIDTH"),a.name=s.NAME,r([].concat((s.CODECS||"").split(/[ ,]+/)),a),a.videoCodec&&-1!==a.videoCodec.indexOf("avc1")&&(a.videoCodec=k.convertAVC1ToAVCOTI(a.videoCodec)),i.push(a)}return i},k.parseMasterPlaylistMedia=function(e,t,i,n){var r=3<arguments.length&&void 0!==n?n:[],a=void 0,s=[],o=0;for(C.lastIndex=0;null!==(a=C.exec(e));){var l={},u=new P(a[1]);if(u.TYPE===i){if(l.groupId=u["GROUP-ID"],l.name=u.NAME,l.type=i,l.default="YES"===u.DEFAULT,l.autoselect="YES"===u.AUTOSELECT,l.forced="YES"===u.FORCED,u.URI&&(l.url=k.resolve(u.URI,t)),l.lang=u.LANGUAGE,l.name||(l.name=l.lang),r.length){var c=k.findGroup(r,l.groupId);l.audioCodec=c?c.codec:r[0].codec}l.id=o++,s.push(l)}}return s},k.parseLevelPlaylist=function(e,t,i,n,r){var a=0,s=0,o=new x(t),l=new A,u=0,c=null,h=new I,d=void 0,f=void 0,p=null;for(L.lastIndex=0;null!==(d=L.exec(e));){var m=d[1];if(m){h.duration=parseFloat(m);var g=(" "+d[2]).slice(1);h.title=g||null,h.tagList.push(g?["INF",m,g]:["INF",m])}else if(d[3]){if(Object(N.a)(h.duration)){var v=a++;h.type=n,h.start=s,h.levelkey=l,h.sn=v,h.level=i,h.cc=u,h.urlId=r,h.baseurl=t,h.relurl=(" "+d[3]).slice(1),U(h,c),o.fragments.push(h),s+=(c=h).duration,h=new I}}else if(d[4]){if(h.rawByteRange=(" "+d[4]).slice(1),c){var y=c.byteRangeEndOffset;y&&(h.lastByteRangeEndOffset=y)}}else if(d[5])h.rawProgramDateTime=(" "+d[5]).slice(1),h.tagList.push(["PROGRAM-DATE-TIME",h.rawProgramDateTime]),null===p&&(p=o.fragments.length);else{for(d=d[0].match(R),f=1;f<d.length&&void 0===d[f];f++);var b=(" "+d[f+1]).slice(1),_=(" "+d[f+2]).slice(1);switch(d[f]){case"#":h.tagList.push(_?[b,_]:[b]);break;case"PLAYLIST-TYPE":o.type=b.toUpperCase();break;case"MEDIA-SEQUENCE":a=o.startSN=parseInt(b);break;case"TARGETDURATION":o.targetduration=parseFloat(b);break;case"VERSION":o.version=parseInt(b);break;case"EXTM3U":break;case"ENDLIST":o.live=!1;break;case"DIS":u++,h.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":u=parseInt(b);break;case"KEY":var T=new P(b),S=T.enumeratedString("METHOD"),E=T.URI,w=T.hexadecimalInteger("IV");S&&(l=new A,E&&0<=["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(S)&&(l.method=S,l.baseuri=t,l.reluri=E,l.key=null,l.iv=w));break;case"START":var C=new P(b).decimalFloatingPoint("TIME-OFFSET");Object(N.a)(C)&&(o.startTimeOffset=C);break;case"MAP":var k=new P(b);h.relurl=k.URI,h.rawByteRange=k.BYTERANGE,h.baseurl=t,h.level=i,h.type=n,h.sn="initSegment",o.initSegment=h,(h=new I).rawProgramDateTime=o.initSegment.rawProgramDateTime;break;default:B.b.warn("line parsed but not handled: "+d)}}}return(h=c)&&!h.relurl&&(o.fragments.pop(),s-=h.duration),o.totalduration=s,o.averagetargetduration=s/o.fragments.length,o.endSN=a-1,o.startCC=o.fragments[0]?o.fragments[0].cc:0,o.endCC=u,!o.initSegment&&o.fragments.length&&o.fragments.every(function(e){return O.test(e.relurl)})&&(B.b.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(h=new I).relurl=o.fragments[0].relurl,h.baseurl=t,h.level=i,h.type=n,h.sn="initSegment",o.initSegment=h,o.needSidxRanges=!0),p&&function(e,t){for(var i=e[t],n=t-1;0<=n;n--){var r=e[n];r.programDateTime=i.programDateTime-1e3*r.duration,i=r}}(o.fragments,p),o},k);function U(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),Object(N.a)(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}var F=function(e,t,i){return t&&j(e.prototype,t),i&&j(e,i),e};function j(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var H,G=window.performance,V={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},K={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function W(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,W);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,H.call(this,e,M.a.MANIFEST_LOADING,M.a.LEVEL_LOADING,M.a.AUDIO_TRACK_LOADING,M.a.SUBTITLE_TRACK_LOADING));return t.loaders={},t}var q,z=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(W,H=u),W.canHaveQualityLevels=function(e){return e!==V.AUDIO_TRACK&&e!==V.SUBTITLE_TRACK},W.mapContextToLevelType=function(e){switch(e.type){case V.AUDIO_TRACK:return K.AUDIO;case V.SUBTITLE_TRACK:return K.SUBTITLE;default:return K.MAIN}},W.getResponseUrl=function(e,t){var i=e.url;return void 0!==i&&0!==i.indexOf("data:")||(i=t.url),i},W.prototype.createInternalLoader=function(e){var t=this.hls.config,i=t.pLoader,n=t.loader,r=new(i||n)(t);return e.loader=r,this.loaders[e.type]=r},W.prototype.getInternalLoader=function(e){return this.loaders[e.type]},W.prototype.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},W.prototype.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},W.prototype.destroy=function(){this.destroyInternalLoaders(),H.prototype.destroy.call(this)},W.prototype.onManifestLoading=function(e){this.load(e.url,{type:V.MANIFEST,level:0,id:null})},W.prototype.onLevelLoading=function(e){this.load(e.url,{type:V.LEVEL,level:e.level,id:e.id})},W.prototype.onAudioTrackLoading=function(e){this.load(e.url,{type:V.AUDIO_TRACK,level:null,id:e.id})},W.prototype.onSubtitleTrackLoading=function(e){this.load(e.url,{type:V.SUBTITLE_TRACK,level:null,id:e.id})},W.prototype.load=function(e,t){var i=this.hls.config;B.b.debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id);var n=this.getInternalLoader(t);if(n){var r=n.context;if(r&&r.url===e)return B.b.trace("playlist request ongoing"),!1;B.b.warn("aborting previous loader for type: "+t.type),n.abort()}var a=void 0,s=void 0,o=void 0,l=void 0;switch(t.type){case V.MANIFEST:a=i.manifestLoadingMaxRetry,s=i.manifestLoadingTimeOut,o=i.manifestLoadingRetryDelay,l=i.manifestLoadingMaxRetryTimeout;break;case V.LEVEL:a=0,s=i.levelLoadingTimeOut;break;default:a=i.levelLoadingMaxRetry,s=i.levelLoadingTimeOut,o=i.levelLoadingRetryDelay,l=i.levelLoadingMaxRetryTimeout}n=this.createInternalLoader(t),t.url=e,t.responseType=t.responseType||"";var u={timeout:s,maxRetry:a,retryDelay:o,maxRetryDelay:l},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return B.b.debug("Calling internal loader delegate for URL: "+e),n.load(t,u,c),!0},W.prototype.loadsuccess=function(e,t,i,n){var r=3<arguments.length&&void 0!==n?n:null;if(i.isSidxRequest)return this._handleSidxRequest(e,i),void this._handlePlaylistLoaded(e,t,i,r);this.resetInternalLoader(i.type);var a=e.data;t.tload=G.now(),0===a.indexOf("#EXTM3U")?0<a.indexOf("#EXTINF:")||0<a.indexOf("#EXT-X-TARGETDURATION:")?this._handleTrackOrLevelPlaylist(e,t,i,r):this._handleMasterPlaylist(e,t,i,r):this._handleManifestParsingError(e,i,"no EXTM3U delimiter",r)},W.prototype.loaderror=function(e,t,i){var n=2<arguments.length&&void 0!==i?i:null;this._handleNetworkError(t,n)},W.prototype.loadtimeout=function(e,t,i){var n=2<arguments.length&&void 0!==i?i:null;this._handleNetworkError(t,n,!0)},W.prototype._handleMasterPlaylist=function(e,t,i,n){var r=this.hls,a=e.data,s=W.getResponseUrl(e,i),o=D.parseMasterPlaylist(a,s);if(o.length){var l=o.map(function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}}),u=D.parseMasterPlaylistMedia(a,s,"AUDIO",l),c=D.parseMasterPlaylistMedia(a,s,"SUBTITLES");if(u.length){var h=!1;u.forEach(function(e){e.url||(h=!0)}),!1===h&&o[0].audioCodec&&!o[0].attrs.AUDIO&&(B.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),u.unshift({type:"main",name:"main"}))}r.trigger(M.a.MANIFEST_LOADED,{levels:o,audioTracks:u,subtitles:c,url:s,stats:t,networkDetails:n})}else this._handleManifestParsingError(e,i,"no level found in manifest",n)},W.prototype._handleTrackOrLevelPlaylist=function(e,t,i,n){var r=this.hls,a=i.id,s=i.level,o=i.type,l=W.getResponseUrl(e,i),u=Object(N.a)(a)?a:0,c=Object(N.a)(s)?s:u,h=W.mapContextToLevelType(i),d=D.parseLevelPlaylist(e.data,l,c,h,u);if(d.tload=t.tload,o===V.MANIFEST){var f={url:l,details:d};r.trigger(M.a.MANIFEST_LOADED,{levels:[f],audioTracks:[],url:l,stats:t,networkDetails:n})}if(t.tparsed=G.now(),d.needSidxRanges){var p=d.initSegment.url;this.load(p,{isSidxRequest:!0,type:o,level:s,levelDetails:d,id:a,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else i.levelDetails=d,this._handlePlaylistLoaded(e,t,i,n)},W.prototype._handleSidxRequest=function(e,r){var t=c.a.parseSegmentIndex(new Uint8Array(e.data));t.references.forEach(function(e,t){var i=e.info,n=r.levelDetails.fragments[t];0===n.byteRange.length&&(n.rawByteRange=String(1+i.end-i.start)+"@"+String(i.start))}),r.levelDetails.initSegment.rawByteRange=String(t.moovEndOffset)+"@0"},W.prototype._handleManifestParsingError=function(e,t,i,n){this.hls.trigger(M.a.ERROR,{type:d.b.NETWORK_ERROR,details:d.a.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:i,networkDetails:n})},W.prototype._handleNetworkError=function(e,t,i){var n=2<arguments.length&&void 0!==i&&i;B.b.info("A network error occured while loading a "+e.type+"-type playlist");var r=void 0,a=void 0,s=this.getInternalLoader(e);switch(e.type){case V.MANIFEST:r=n?d.a.MANIFEST_LOAD_TIMEOUT:d.a.MANIFEST_LOAD_ERROR,a=!0;break;case V.LEVEL:r=n?d.a.LEVEL_LOAD_TIMEOUT:d.a.LEVEL_LOAD_ERROR,a=!1;break;case V.AUDIO_TRACK:r=n?d.a.AUDIO_TRACK_LOAD_TIMEOUT:d.a.AUDIO_TRACK_LOAD_ERROR,a=!1;break;default:a=!1}s&&(s.abort(),this.resetInternalLoader(e.type)),this.hls.trigger(M.a.ERROR,{type:d.b.NETWORK_ERROR,details:r,fatal:a,url:s.url,loader:s,context:e,networkDetails:t})},W.prototype._handlePlaylistLoaded=function(e,t,i,n){var r=i.type,a=i.level,s=i.id,o=i.levelDetails;if(o.targetduration)if(W.canHaveQualityLevels(i.type))this.hls.trigger(M.a.LEVEL_LOADED,{details:o,level:a||0,id:s||0,stats:t,networkDetails:n});else switch(r){case V.AUDIO_TRACK:this.hls.trigger(M.a.AUDIO_TRACK_LOADED,{details:o,id:s,stats:t,networkDetails:n});break;case V.SUBTITLE_TRACK:this.hls.trigger(M.a.SUBTITLE_TRACK_LOADED,{details:o,id:s,stats:t,networkDetails:n})}else this._handleManifestParsingError(e,i,"invalid target duration",n)},F(W,null,[{key:"ContextType",get:function(){return V}},{key:"LevelType",get:function(){return K}}]),W);function Y(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Y);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,q.call(this,e,M.a.FRAG_LOADING));return t.loaders={},t}var X,$=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Y,q=u),Y.prototype.destroy=function(){var e=this.loaders;for(var t in e){var i=e[t];i&&i.destroy()}this.loaders={},q.prototype.destroy.call(this)},Y.prototype.onFragLoading=function(e){var t=e.frag,i=t.type,n=this.loaders,r=this.hls.config,a=r.fLoader,s=r.loader;t.loaded=0;var o=n[i];o&&(B.b.warn("abort previous fragment loader for type: "+i),o.abort()),o=n[i]=t.loader=new(r.fLoader?a:s)(r);var l,u,c=void 0;c={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var h=t.byteRangeStartOffset,d=t.byteRangeEndOffset;Object(N.a)(h)&&Object(N.a)(d)&&(c.rangeStart=h,c.rangeEnd=d),l={timeout:r.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:r.fragLoadingMaxRetryTimeout},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},o.load(c,l,u)},Y.prototype.loadsuccess=function(e,t,i,n){var r=3<arguments.length&&void 0!==n?n:null,a=e.data,s=i.frag;s.loader=void 0,this.loaders[s.type]=void 0,this.hls.trigger(M.a.FRAG_LOADED,{payload:a,frag:s,stats:t,networkDetails:r})},Y.prototype.loaderror=function(e,t,i){var n=2<arguments.length&&void 0!==i?i:null,r=t.frag,a=r.loader;a&&a.abort(),this.loaders[r.type]=void 0,this.hls.trigger(M.a.ERROR,{type:d.b.NETWORK_ERROR,details:d.a.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:n})},Y.prototype.loadtimeout=function(e,t,i){var n=2<arguments.length&&void 0!==i?i:null,r=t.frag,a=r.loader;a&&a.abort(),this.loaders[r.type]=void 0,this.hls.trigger(M.a.ERROR,{type:d.b.NETWORK_ERROR,details:d.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:n})},Y.prototype.loadprogress=function(e,t,i,n){var r=3<arguments.length&&void 0!==n?n:null,a=t.frag;a.loaded=e.loaded,this.hls.trigger(M.a.FRAG_LOAD_PROGRESS,{frag:a,stats:e,networkDetails:r})},Y);function J(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,J);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,X.call(this,e,M.a.KEY_LOADING));return t.loaders={},t.decryptkey=null,t.decrypturl=null,t}var Q=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(J,X=u),J.prototype.destroy=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},u.prototype.destroy.call(this)},J.prototype.onKeyLoading=function(e){var t=e.frag,i=t.type,n=this.loaders[i],r=t.decryptdata,a=r.uri;if(a!==this.decrypturl||null===this.decryptkey){var s,o,l,u=this.hls.config;n&&(B.b.warn("abort previous key loader for type:"+i),n.abort()),t.loader=this.loaders[i]=new u.loader(u),this.decrypturl=a,this.decryptkey=null,s={url:a,frag:t,responseType:"arraybuffer"},o={timeout:u.fragLoadingTimeOut,maxRetry:u.fragLoadingMaxRetry,retryDelay:u.fragLoadingRetryDelay,maxRetryDelay:u.fragLoadingMaxRetryTimeout},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(s,o,l)}else this.decryptkey&&(r.key=this.decryptkey,this.hls.trigger(M.a.KEY_LOADED,{frag:t}))},J.prototype.loadsuccess=function(e,t,i){var n=i.frag;this.decryptkey=n.decryptdata.key=new Uint8Array(e.data),n.loader=void 0,this.loaders[n.type]=void 0,this.hls.trigger(M.a.KEY_LOADED,{frag:n})},J.prototype.loaderror=function(e,t){var i=t.frag,n=i.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(M.a.ERROR,{type:d.b.NETWORK_ERROR,details:d.a.KEY_LOAD_ERROR,fatal:!1,frag:i,response:e})},J.prototype.loadtimeout=function(e,t){var i=t.frag,n=i.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(M.a.ERROR,{type:d.b.NETWORK_ERROR,details:d.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:i})},J);var Z,ee="NOT_LOADED",te="APPENDING",ie="PARTIAL",ne="OK",re=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(ae,Z=u),ae.prototype.destroy=function(){this.fragments=null,this.timeRanges=null,this.config=null,u.prototype.destroy.call(this),Z.prototype.destroy.call(this)},ae.prototype.getBufferedFrag=function(n,r){var a=this.fragments,e=Object.keys(a).filter(function(e){var t=a[e];if(t.body.type!==r)return!1;if(!t.buffered)return!1;var i=t.body;return i.startPTS<=n&&n<=i.endPTS});if(0===e.length)return null;var t=e.pop();return a[t].body},ae.prototype.detectEvictedFragments=function(r,a){var s=this,o=void 0,l=void 0;Object.keys(this.fragments).forEach(function(e){var t=s.fragments[e];if(!0===t.buffered){var i=t.range[r];if(i){o=i.time;for(var n=0;n<o.length;n++)if(l=o[n],!1===s.isTimeBuffered(l.startPTS,l.endPTS,a)){s.removeFragment(t.body);break}}}})},ae.prototype.detectPartialFragments=function(i){var n=this,e=this.getFragmentKey(i),r=this.fragments[e];r&&(r.buffered=!0,Object.keys(this.timeRanges).forEach(function(e){if(i.hasElementaryStream(e)){var t=n.timeRanges[e];r.range[e]=n.getBufferedTimes(i.startPTS,i.endPTS,t)}}))},ae.prototype.getBufferedTimes=function(e,t,i){for(var n=[],r=void 0,a=void 0,s=!1,o=0;o<i.length;o++){if(r=i.start(o)-this.bufferPadding,a=i.end(o)+this.bufferPadding,r<=e&&t<=a){n.push({startPTS:Math.max(e,i.start(o)),endPTS:Math.min(t,i.end(o))});break}if(e<a&&r<t)n.push({startPTS:Math.max(e,i.start(o)),endPTS:Math.min(t,i.end(o))}),s=!0;else if(t<=r)break}return{time:n,partial:s}},ae.prototype.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},ae.prototype.getPartialFragment=function(i){var n=this,r=void 0,a=void 0,s=void 0,o=null,l=0;return Object.keys(this.fragments).forEach(function(e){var t=n.fragments[e];n.isPartial(t)&&(a=t.body.startPTS-n.bufferPadding,s=t.body.endPTS+n.bufferPadding,a<=i&&i<=s&&(r=Math.min(i-a,s-i),l<=r&&(o=t.body,l=r)))}),o},ae.prototype.getState=function(e){var t=this.getFragmentKey(e),i=this.fragments[t],n=ee;return void 0!==i&&(n=i.buffered?!0===this.isPartial(i)?ie:ne:te),n},ae.prototype.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},ae.prototype.isTimeBuffered=function(e,t,i){for(var n=void 0,r=void 0,a=0;a<i.length;a++){if(n=i.start(a)-this.bufferPadding,r=i.end(a)+this.bufferPadding,n<=e&&t<=r)return!0;if(t<=n)return!1}return!1},ae.prototype.onFragLoaded=function(e){var t=e.frag;Object(N.a)(t.sn)&&!t.bitrateTest&&(this.fragments[this.getFragmentKey(t)]={body:t,range:Object.create(null),buffered:!1})},ae.prototype.onBufferAppended=function(e){var i=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach(function(e){var t=i.timeRanges[e];i.detectEvictedFragments(e,t)})},ae.prototype.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},ae.prototype.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},ae.prototype.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},ae.prototype.removeAllFragments=function(){this.fragments=Object.create(null)},ae);function ae(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ae);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,Z.call(this,e,M.a.BUFFER_APPENDED,M.a.FRAG_BUFFERED,M.a.FRAG_LOADED));return t.bufferPadding=.2,t.fragments=Object.create(null),t.timeRanges=Object.create(null),t.config=e.config,t}var se={search:function(e,t){for(var i=0,n=e.length-1,r=null,a=null;i<=n;){var s=t(a=e[r=(i+n)/2|0]);if(0<s)i=r+1;else{if(!(s<0))return a;n=r-1}}return null}};var oe=(le.isBuffered=function(e,t){try{if(e)for(var i=e.buffered,n=0;n<i.length;n++)if(t>=i.start(n)&&t<=i.end(n))return!0}catch(e){}return!1},le.bufferInfo=function(e,t,i){try{if(e){var n=e.buffered,r=[],a=void 0;for(a=0;a<n.length;a++)r.push({start:n.start(a),end:n.end(a)});return this.bufferedInfo(r,t,i)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},le.bufferedInfo=function(e,t,i){var n=[],r=void 0,a=void 0,s=void 0,o=void 0,l=void 0;for(e.sort(function(e,t){var i=e.start-t.start;return i||t.end-e.end}),l=0;l<e.length;l++){var u=n.length;if(u){var c=n[u-1].end;e[l].start-c<i?e[l].end>c&&(n[u-1].end=e[l].end):n.push(e[l])}else n.push(e[l])}for(r=l=0,a=s=t;l<n.length;l++){var h=n[l].start,d=n[l].end;if(h<=t+i&&t<d)a=h,r=(s=d)-t;else if(t+i<h){o=h;break}}return{len:r,start:a,end:s,nextStart:o}},le);function le(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,le)}var ue=i(7),ce=i.n(ue),he=i(12),de=i.n(he),fe=i(10);function pe(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}var me=i(4);var ge=Object(me.a)(),ve=pe();function ye(i,e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ye),this.hls=i,this.id=e;var r=this.observer=new ce.a,t=i.config;r.trigger=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];r.emit.apply(r,[e,e].concat(i))},r.off=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];r.removeListener.apply(r,[e].concat(i))};var n=function(e,t){(t=t||{}).frag=this.frag,t.id=this.id,i.trigger(e,t)}.bind(this);r.on(M.a.FRAG_DECRYPTED,n),r.on(M.a.FRAG_PARSING_INIT_SEGMENT,n),r.on(M.a.FRAG_PARSING_DATA,n),r.on(M.a.FRAG_PARSED,n),r.on(M.a.ERROR,n),r.on(M.a.FRAG_PARSING_METADATA,n),r.on(M.a.FRAG_PARSING_USERDATA,n),r.on(M.a.INIT_PTS_FOUND,n);var a={mp4:ve.isTypeSupported("video/mp4"),mpeg:ve.isTypeSupported("audio/mpeg"),mp3:ve.isTypeSupported('audio/mp4; codecs="mp3"')},s=navigator.vendor;if(t.enableWorker&&"undefined"!=typeof Worker){B.b.log("demuxing in webworker");var o=void 0;try{o=this.w=de()(13),this.onwmsg=this.onWorkerMessage.bind(this),o.addEventListener("message",this.onwmsg),o.onerror=function(e){i.trigger(M.a.ERROR,{type:d.b.OTHER_ERROR,details:d.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},o.postMessage({cmd:"init",typeSupported:a,vendor:s,id:e,config:JSON.stringify(t)})}catch(e){B.b.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),o&&ge.URL.revokeObjectURL(o.objectURL),this.demuxer=new fe.a(r,a,t,s),this.w=void 0}}else this.demuxer=new fe.a(r,a,t,s)}var be=(ye.prototype.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var i=this.observer;i&&(i.removeAllListeners(),this.observer=null)},ye.prototype.push=function(e,t,i,n,r,a,s,o){var l=this.w,u=Object(N.a)(r.startDTS)?r.startDTS:r.start,c=r.decryptdata,h=this.frag,d=!(h&&r.cc===h.cc),f=!(h&&r.level===h.level),p=h&&r.sn===h.sn+1,m=!f&&p;if(d&&B.b.log(this.id+":discontinuity detected"),f&&B.b.log(this.id+":switch detected"),this.frag=r,l)l.postMessage({cmd:"demux",data:e,decryptdata:c,initSegment:t,audioCodec:i,videoCodec:n,timeOffset:u,discontinuity:d,trackSwitch:f,contiguous:m,duration:a,accurateTimeOffset:s,defaultInitPTS:o},e instanceof ArrayBuffer?[e]:[]);else{var g=this.demuxer;g&&g.push(e,c,t,i,n,u,d,f,m,a,s,o)}},ye.prototype.onWorkerMessage=function(e){var t=e.data,i=this.hls;switch(t.event){case"init":ge.URL.revokeObjectURL(this.w.objectURL);break;case M.a.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,i.trigger(t.event,t.data)}},ye);function _e(e,t,i){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(i);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(i)}}function Te(e,t,i){var n=e[t],r=e[i],a=r.startPTS;Object(N.a)(a)?t<i?(n.duration=a-n.start,n.duration<0&&B.b.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):(r.duration=n.start-a,r.duration<0&&B.b.warn("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!")):r.start=t<i?n.start+n.duration:Math.max(n.start-r.duration,0)}function Se(e,t,i,n,r,a){var s=i;if(Object(N.a)(t.startPTS)){var o=Math.abs(t.startPTS-i);Object(N.a)(t.deltaPTS)?t.deltaPTS=Math.max(o,t.deltaPTS):t.deltaPTS=o,s=Math.max(i,t.startPTS),i=Math.min(i,t.startPTS),n=Math.max(n,t.endPTS),r=Math.min(r,t.startDTS),a=Math.max(a,t.endDTS)}var l=i-t.start;t.start=t.startPTS=i,t.maxStartPTS=s,t.endPTS=n,t.startDTS=r,t.endDTS=a,t.duration=n-i;var u=t.sn;if(!e||u<e.startSN||u>e.endSN)return 0;var c,h=void 0,d=void 0;for(c=u-e.startSN,(h=e.fragments)[c]=t,d=c;0<d;d--)Te(h,d,d-1);for(d=c;d<h.length-1;d++)Te(h,d,d+1);return e.PTSKnown=!0,l}function Ee(e,t){var i=Math.max(e.startSN,t.startSN)-t.startSN,n=Math.min(e.endSN,t.endSN)-t.startSN,r=t.startSN-e.startSN,a=e.fragments,s=t.fragments,o=0,l=void 0;if(t.initSegment&&e.initSegment&&(t.initSegment=e.initSegment),n<i)t.PTSKnown=!1;else{for(var u=i;u<=n;u++){var c=a[r+u],h=s[u];h&&c&&(o=c.cc-h.cc,Object(N.a)(c.startPTS)&&(h.start=h.startPTS=c.startPTS,h.endPTS=c.endPTS,h.duration=c.duration,h.backtracked=c.backtracked,h.dropped=c.dropped,l=h))}if(o)for(B.b.log("discontinuity sliding from playlist, take drift into account"),u=0;u<s.length;u++)s[u].cc+=o;if(l)Se(t,l,l.startPTS,l.endPTS,l.startDTS,l.endDTS);else if(0<=r&&r<a.length){var d=a[r].start;for(u=0;u<s.length;u++)s[u].start+=d}t.PTSKnown=e.PTSKnown}}var we,Ce,ke,Ae={toString:function(e){for(var t="",i=e.length,n=0;n<i;n++)t+="["+e.start(n).toFixed(3)+","+e.end(n).toFixed(3)+"]";return t}};function Ie(e,t){var i=e.fragments,n=t.fragments;if(n.length&&i.length){var r=function(e,t){for(var i=null,n=0;n<e.length;n+=1){var r=e[n];if(r&&r.cc===t){i=r;break}}return i}(i,n[0].cc);if(r&&(!r||r.startPTS))return r;B.b.log("No frag in previous level to align on")}else B.b.log("No fragments to align")}function xe(i,e){e.fragments.forEach(function(e){if(e){var t=e.start+i;e.start=e.startPTS=t,e.endPTS=t+e.duration}}),e.PTSKnown=!0}function Pe(e,t,i){!function(e,t,i){if(function(e,t,i){var n=!1;return t&&t.details&&i&&(i.endCC>i.startCC||e&&e.cc<i.startCC)&&(n=!0),n}(e,i,t)){var n=Ie(i.details,t);n&&(B.b.log("Adjusting PTS using last level due to CC increase within current level"),xe(n.start,t))}}(e,i,t),!i.PTSKnown&&t&&function(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;var i=t.fragments[0].programDateTime,n=(e.fragments[0].programDateTime-i)/1e3+t.fragments[0].start;Object(N.a)(n)&&(B.b.log("adjusting PTS using programDateTime delta, sliding:"+n.toFixed(3)),xe(n,e))}}(i,t.details)}function Le(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Le);for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,we.call.apply(we,[this,e].concat(i)));return r._tickInterval=null,r._tickTimer=null,r._tickCallCount=0,r._boundTick=r.tick.bind(r),r}function Re(e){return Ce.apply(this,arguments)}function Oe(){return ke.apply(this,arguments)}var De=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Le,we=u),Le.prototype.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},Le.prototype.hasInterval=function(){return!!this._tickInterval},Le.prototype.hasNextTick=function(){return!!this._tickTimer},Le.prototype.setInterval=(Ce=function(e){return!this._tickInterval&&(this._tickInterval=setInterval(this._boundTick,e),!0)},Re.toString=function(){return Ce.toString()},Re),Le.prototype.clearInterval=(ke=function(){return!(!this._tickInterval||(clearInterval(this._tickInterval),this._tickInterval=null))},Oe.toString=function(){return ke.toString()},Oe),Le.prototype.clearNextTick=function(){return!(!this._tickTimer||(clearTimeout(this._tickTimer),this._tickTimer=null))},Le.prototype.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),1<this._tickCallCount&&(this.clearNextTick(),this._tickTimer=setTimeout(this._boundTick,0)),this._tickCallCount=0)},Le.prototype.doTick=function(){},Le);function Ne(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=arguments[2],n=Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-n<=e?1:i.start-n>e&&i.start?-1:0}function Me(e,t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Me),this.config=e,this.media=t,this.fragmentTracker=i,this.hls=n,this.stallReported=!1}var Be=(Me.prototype.poll=function(e){var t=this.config,i=this.media,n=i.currentTime,r=window.performance.now();if(n!==e)return this.stallReported&&(B.b.warn("playback not stuck anymore @"+n+", after "+Math.round(r-this.stalled)+"ms"),this.stallReported=!1),this.stalled=null,void(this.nudgeRetry=0);if(!(i.ended||!i.buffered.length||2<i.readyState||i.seeking&&oe.isBuffered(i,n))){var a=r-this.stalled,s=oe.bufferInfo(i,n,t.maxBufferHole);this.stalled?(1e3<=a&&this._reportStall(s.len),this._tryFixBufferStall(s,a)):this.stalled=r}},Me.prototype._tryFixBufferStall=function(e,t){var i=this.config,n=this.fragmentTracker,r=this.media.currentTime,a=n.getPartialFragment(r);a&&this._trySkipBufferHole(a),.5<e.len&&t>1e3*i.highBufferWatchdogPeriod&&(this.stalled=null,this._tryNudgeBuffer())},Me.prototype._reportStall=function(e){var t=this.hls,i=this.media;this.stallReported||(this.stallReported=!0,B.b.warn("Playback stalling at @"+i.currentTime+" due to low buffer"),t.trigger(M.a.ERROR,{type:d.b.MEDIA_ERROR,details:d.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},Me.prototype._trySkipBufferHole=function(e){for(var t=this.hls,i=this.media,n=i.currentTime,r=0,a=0;a<i.buffered.length;a++){var s=i.buffered.start(a);if(r<=n&&n<s)return i.currentTime=Math.max(s,i.currentTime+.1),B.b.warn("skipping hole, adjusting currentTime from "+n+" to "+i.currentTime),this.stalled=null,void t.trigger(M.a.ERROR,{type:d.b.MEDIA_ERROR,details:d.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+n+" to "+i.currentTime,frag:e});r=i.buffered.end(a)}},Me.prototype._tryNudgeBuffer=function(){var e=this.config,t=this.hls,i=this.media,n=i.currentTime,r=(this.nudgeRetry||0)+1;if((this.nudgeRetry=r)<e.nudgeMaxRetry){var a=n+r*e.nudgeOffset;B.b.log("adjust currentTime from "+n+" to "+a),i.currentTime=a,t.trigger(M.a.ERROR,{type:d.b.MEDIA_ERROR,details:d.a.BUFFER_NUDGE_ON_STALL,fatal:!1})}else B.b.error("still stuck in high buffer @"+n+" after "+e.nudgeMaxRetry+", raise fatal error"),t.trigger(M.a.ERROR,{type:d.b.MEDIA_ERROR,details:d.a.BUFFER_STALLED_ERROR,fatal:!0})},Me),Ue=function(e,t,i){return t&&Fe(e.prototype,t),i&&Fe(e,i),e};function Fe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var je,He="STOPPED",Ge="IDLE",Ve="KEY_LOADING",Ke="FRAG_LOADING",We="FRAG_LOADING_WAITING_RETRY",qe="WAITING_LEVEL",ze="PARSING",Ye="PARSED",Xe="BUFFER_FLUSHING",$e="ENDED",Je="ERROR";function Qe(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Qe);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,je.call(this,e,M.a.MEDIA_ATTACHED,M.a.MEDIA_DETACHING,M.a.MANIFEST_LOADING,M.a.MANIFEST_PARSED,M.a.LEVEL_LOADED,M.a.KEY_LOADED,M.a.FRAG_LOADED,M.a.FRAG_LOAD_EMERGENCY_ABORTED,M.a.FRAG_PARSING_INIT_SEGMENT,M.a.FRAG_PARSING_DATA,M.a.FRAG_PARSED,M.a.ERROR,M.a.AUDIO_TRACK_SWITCHING,M.a.AUDIO_TRACK_SWITCHED,M.a.BUFFER_CREATED,M.a.BUFFER_APPENDED,M.a.BUFFER_FLUSHED));return i.fragmentTracker=t,i.config=e.config,i.audioCodecSwap=!1,i._state=He,i.stallReported=!1,i.gapController=null,i}var Ze=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Qe,je=De),Qe.prototype.onHandlerDestroying=function(){this.stopLoad(),je.prototype.onHandlerDestroying.call(this)},Qe.prototype.onHandlerDestroyed=function(){this.state=He,this.fragmentTracker=null,je.prototype.onHandlerDestroyed.call(this)},Qe.prototype.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,i=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=i.startLevel;-1===n&&(n=0,this.bitrateTest=!0),this.level=i.nextLoadLevel=n,this.loadedmetadata=!1}0<t&&-1===e&&(B.b.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=Ge,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=He},Qe.prototype.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.clearInterval(),this.state=He,this.forceStartLoad=!1},Qe.prototype.doTick=function(){switch(this.state){case Xe:this.fragLoadError=0;break;case Ge:this._doTickIdle();break;case qe:var e=this.levels[this.level];e&&e.details&&(this.state=Ge);break;case We:var t=window.performance.now(),i=this.retryDate;(!i||i<=t||this.media&&this.media.seeking)&&(B.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=Ge)}this._checkBuffer(),this._checkFragmentChanged()},Qe.prototype._doTickIdle=function(){var e=this.hls,t=e.config,i=this.media;if(void 0!==this.levelLastLoaded&&(i||!this.startFragRequested&&t.startFragPrefetch)){var n=void 0;n=this.loadedmetadata?i.currentTime:this.nextLoadPosition;var r=e.nextLoadLevel,a=this.levels[r];if(a){var s=a.bitrate,o=void 0;o=s?Math.max(8*t.maxBufferSize/s,t.maxBufferLength):t.maxBufferLength,o=Math.min(o,t.maxMaxBufferLength);var l=oe.bufferInfo(this.mediaBuffer?this.mediaBuffer:i,n,t.maxBufferHole),u=l.len;if(!(o<=u)){B.b.trace("buffer length of "+u.toFixed(3)+" is below max of "+o.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=r;var c=a.details;if(!c||c.live&&this.levelLastLoaded!==r)this.state=qe;else{var h=this.fragPrevious;if(!c.live&&h&&!h.backtracked&&h.sn===c.endSN&&!l.nextStart&&Math.min(i.duration,h.start+h.duration)-Math.max(l.end,h.start)<=Math.max(.2,h.duration)){var d={};return this.altAudio&&(d.type="video"),this.hls.trigger(M.a.BUFFER_EOS,d),void(this.state=$e)}this._fetchPayloadOrEos(n,l,c)}}}}},Qe.prototype._fetchPayloadOrEos=function(e,t,i){var n=this.fragPrevious,r=this.level,a=i.fragments,s=a.length;if(0!==s){var o=a[0].start,l=a[s-1].start+a[s-1].duration,u=t.end,c=void 0;if(i.initSegment&&!i.initSegment.data)c=i.initSegment;else if(i.live){var h=this.config.initialLiveManifestSize;if(s<h)return void B.b.warn("Can not start playback of a level, reason: not enough fragments "+s+" < "+h);if(null===(c=this._ensureFragmentAtLivePoint(i,u,o,l,n,a,s)))return}else u<o&&(c=a[0]);(c=c||this._findFragment(o,n,s,a,u,l,i))&&(c.encrypted?(B.b.log("Loading key for "+c.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+r),this._loadKey(c)):(B.b.log("Loading "+c.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+r+", currentTime:"+e.toFixed(3)+",bufferEnd:"+u.toFixed(3)),this._loadFragment(c)))}},Qe.prototype._ensureFragmentAtLivePoint=function(e,t,i,n,r,a,s){var o=this.hls.config,l=this.media,u=void 0,c=void 0!==o.liveMaxLatencyDuration?o.liveMaxLatencyDuration:o.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(i-o.maxFragLookUpTolerance,n-c)){var h=this.liveSyncPosition=this.computeLivePosition(i,e);B.b.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3)),t=h,l&&l.readyState&&l.duration>h&&(l.currentTime=h),this.nextLoadPosition=h}if(e.PTSKnown&&n<t&&l&&l.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(r)if(e.hasProgramDateTime)B.b.log("live playlist, switching playlist, load frag with same PDT: "+r.programDateTime),u=function(e,t,i){if(!Array.isArray(e)||!e.length||!Object(N.a)(t))return null;if(t<e[0].programDateTime)return null;if(t>=e[e.length-1].endProgramDateTime)return null;i=i||0;for(var n=0;n<e.length;++n){var r=e[n];if(a=t,s=i,o=r,l=1e3*Math.min(s,o.duration+(o.deltaPTS?o.deltaPTS:0)),o.endProgramDateTime-l>a)return r}var a,s,o,l;return null}(a,r.endProgramDateTime,o.maxFragLookUpTolerance);else{var d=r.sn+1;if(d>=e.startSN&&d<=e.endSN){var f=a[d-e.startSN];r.cc===f.cc&&(u=f,B.b.log("live playlist, switching playlist, load frag with next SN: "+u.sn))}u||(u=se.search(a,function(e){return r.cc-e.cc}))&&B.b.log("live playlist, switching playlist, load frag with same CC: "+u.sn)}u||(u=a[Math.min(s-1,Math.round(s/2))],B.b.log("live playlist, switching playlist, unknown, load middle frag : "+u.sn))}return u},Qe.prototype._findFragment=function(e,t,i,n,r,a,s){var o=this.hls.config,l=void 0;if(l=r<a?function(e,t,i,n){var r=2<arguments.length&&void 0!==i?i:0,a=3<arguments.length&&void 0!==n?n:0,s=e?t[e.sn-t[0].sn+1]:null;return s&&!Ne(r,a,s)?s:se.search(t,Ne.bind(null,r,a))}(t,n,r,r>a-o.maxFragLookUpTolerance?0:o.maxFragLookUpTolerance):n[i-1]){var u=l.sn-s.startSN,c=t&&l.level===t.level,h=n[u-1],d=n[1+u];if(t&&l.sn===t.sn)if(c&&!l.backtracked)if(l.sn<s.endSN){var f=t.deltaPTS;f&&f>o.maxBufferHole&&t.dropped&&u?(l=h,B.b.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this")):(l=d,B.b.log("SN just loaded, load next one: "+l.sn,l))}else l=null;else l.backtracked&&(d&&d.backtracked?(B.b.warn("Already backtracked from fragment "+d.sn+", will not backtrack to fragment "+l.sn+". Loading fragment "+d.sn),l=d):(B.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),l.dropped=0,h?(l=h).backtracked=!0:u&&(l=null)))}return l},Qe.prototype._loadKey=function(e){this.state=Ve,this.hls.trigger(M.a.KEY_LOADING,{frag:e})},Qe.prototype._loadFragment=function(e){var t=this.fragmentTracker.getState(e);this.fragCurrent=e,this.startFragRequested=!0,Object(N.a)(e.sn)&&!e.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),e.backtracked||t===ee||t===ie?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,this.hls.trigger(M.a.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new be(this.hls,"main")),this.state=Ke):t===te&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)},Qe.prototype.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,z.LevelType.MAIN)},Qe.prototype.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},Qe.prototype._checkFragmentChanged=function(){var e=void 0,t=void 0,i=this.media;if(i&&i.readyState&&!1===i.seeking&&((t=i.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=t),oe.isBuffered(i,t)?e=this.getBufferedFrag(t):oe.isBuffered(i,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var n=e;if(n!==this.fragPlaying){this.hls.trigger(M.a.FRAG_CHANGED,{frag:n});var r=n.level;this.fragPlaying&&this.fragPlaying.level===r||this.hls.trigger(M.a.LEVEL_SWITCHED,{level:r}),this.fragPlaying=n}}},Qe.prototype.immediateLevelSwitch=function(){if(B.b.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,t=void 0;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var i=this.fragCurrent;i&&i.loader&&i.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},Qe.prototype.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,oe.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},Qe.prototype.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var t,i=void 0,n=void 0;if((t=this.getBufferedFrag(e.currentTime))&&1<t.startPTS&&this.flushMainBuffer(0,t.startPTS-1),e.paused)i=0;else{var r=this.hls.nextLoadLevel,a=this.levels[r],s=this.fragLastKbps;i=s&&this.fragCurrent?this.fragCurrent.duration*a.bitrate/(1e3*s)+1:0}if(n=(n=this.getBufferedFrag(e.currentTime+i))&&this.followingBufferedFrag(n)){var o=this.fragCurrent;o&&o.loader&&o.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(n.maxStartPTS,Number.POSITIVE_INFINITY)}}},Qe.prototype.flushMainBuffer=function(e,t){this.state=Xe;var i={startOffset:e,endOffset:t};this.altAudio&&(i.type="video"),this.hls.trigger(M.a.BUFFER_FLUSHING,i)},Qe.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var i=this.config;this.levels&&i.autoStartLoad&&this.hls.startLoad(i.startPosition),this.gapController=new Be(i,t,this.fragmentTracker,this.hls)},Qe.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(B.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.backtracked=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},Qe.prototype.onMediaSeeking=function(){var e=this.media,t=e?e.currentTime:void 0,i=this.config;Object(N.a)(t)&&B.b.log("media seeking to "+t.toFixed(3));var n=this.mediaBuffer?this.mediaBuffer:e,r=oe.bufferInfo(n,t,this.config.maxBufferHole);if(this.state===Ke){var a=this.fragCurrent;if(0===r.len&&a){var s=i.maxFragLookUpTolerance,o=a.start-s,l=a.start+a.duration+s;t<o||l<t?(a.loader&&(B.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=Ge):B.b.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===$e&&(0===r.len&&(this.fragPrevious=0),this.state=Ge);e&&(this.lastCurrentTime=t),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=t),this.tick()},Qe.prototype.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:void 0;Object(N.a)(t)&&B.b.log("media seeked to "+t.toFixed(3)),this.tick()},Qe.prototype.onMediaEnded=function(){B.b.log("media ended"),this.startPosition=this.lastCurrentTime=0},Qe.prototype.onManifestLoading=function(){B.b.log("trigger BUFFER_RESET"),this.hls.trigger(M.a.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},Qe.prototype.onManifestParsed=function(e){var t=!1,i=!1,n=void 0;e.levels.forEach(function(e){(n=e.audioCodec)&&(-1!==n.indexOf("mp4a.40.2")&&(t=!0),-1!==n.indexOf("mp4a.40.5")&&(i=!0))}),this.audioCodecSwitch=t&&i,this.audioCodecSwitch&&B.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1;var r=this.config;(r.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(r.startPosition)},Qe.prototype.onLevelLoaded=function(e){var t=e.details,i=e.level,n=this.levels[this.levelLastLoaded],r=this.levels[i],a=t.totalduration,s=0;if(B.b.log("level "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+a),t.live){var o=r.details;o&&0<t.fragments.length?(Ee(o,t),s=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(s,o),t.PTSKnown&&Object(N.a)(s)?B.b.log("live playlist sliding:"+s.toFixed(3)):(B.b.log("live playlist - outdated PTS, unknown sliding"),Pe(this.fragPrevious,n,t))):(B.b.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,Pe(this.fragPrevious,n,t))}else t.PTSKnown=!1;if(r.details=t,this.levelLastLoaded=i,this.hls.trigger(M.a.LEVEL_UPDATED,{details:t,level:i}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var l=t.startTimeOffset;Object(N.a)(l)?(l<0&&(B.b.log("negative start time offset "+l+", count from end of last fragment"),l=s+a+l),B.b.log("start time offset found in playlist, adjust startPosition to "+l),this.startPosition=l):t.live?(this.startPosition=this.computeLivePosition(s,t),B.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===qe&&(this.state=Ge),this.tick()},Qe.prototype.onKeyLoaded=function(){this.state===Ve&&(this.state=Ge,this.tick())},Qe.prototype.onFragLoaded=function(e){var t=this.fragCurrent,i=this.hls,n=this.levels,r=this.media,a=e.frag;if(this.state===Ke&&t&&"main"===a.type&&a.level===t.level&&a.sn===t.sn){var s=e.stats,o=n[t.level],l=o.details;if(this.bitrateTest=!1,this.stats=s,B.b.log("Loaded "+t.sn+" of ["+l.startSN+" ,"+l.endSN+"],level "+t.level),a.bitrateTest&&i.nextLoadLevel)this.state=Ge,this.startFragRequested=!1,s.tparsed=s.tbuffered=window.performance.now(),i.trigger(M.a.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else if("initSegment"===a.sn)this.state=Ge,s.tparsed=s.tbuffered=window.performance.now(),l.initSegment.data=e.payload,i.trigger(M.a.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else{B.b.log("Parsing "+t.sn+" of ["+l.startSN+" ,"+l.endSN+"],level "+t.level+", cc "+t.cc),this.state=ze,this.pendingBuffering=!0,this.appended=!1,a.bitrateTest&&(a.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:a}));var u=!(r&&r.seeking)&&(l.PTSKnown||!l.live),c=l.initSegment?l.initSegment.data:[],h=this._getAudioCodec(o);(this.demuxer=this.demuxer||new be(this.hls,"main")).push(e.payload,c,h,o.videoCodec,t,l.totalduration,u)}}this.fragLoadError=0},Qe.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,i=e.frag;if(t&&"main"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===ze){var n=e.tracks,r=void 0,a=void 0;if(n.audio&&this.altAudio&&delete n.audio,a=n.audio){var s=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();s&&this.audioCodecSwap&&(B.b.log("swapping playlist audio codec"),s=-1!==s.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==a.metadata.channelCount&&-1===o.indexOf("firefox")&&(s="mp4a.40.5"),-1!==o.indexOf("android")&&"audio/mpeg"!==a.container&&(s="mp4a.40.2",B.b.log("Android: force audio codec to "+s)),a.levelCodec=s,a.id=e.id}for(r in(a=n.video)&&(a.levelCodec=this.levels[this.level].videoCodec,a.id=e.id),this.hls.trigger(M.a.BUFFER_CODECS,n),n){a=n[r],B.b.log("main track:"+r+",container:"+a.container+",codecs[level/parsed]=["+a.levelCodec+"/"+a.codec+"]");var l=a.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(M.a.BUFFER_APPENDING,{type:r,data:l,parent:"main",content:"initSegment"}))}this.tick()}},Qe.prototype.onFragParsingData=function(t){var i=this,e=this.fragCurrent,n=t.frag;if(e&&"main"===t.id&&n.sn===e.sn&&n.level===e.level&&("audio"!==t.type||!this.altAudio)&&this.state===ze){var r=this.levels[this.level],a=e;if(Object(N.a)(t.endPTS)||(t.endPTS=t.startPTS+e.duration,t.endDTS=t.startDTS+e.duration),!0===t.hasAudio&&a.addElementaryStream(I.ElementaryStreamTypes.AUDIO),!0===t.hasVideo&&a.addElementaryStream(I.ElementaryStreamTypes.VIDEO),B.b.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),"video"===t.type)if(a.dropped=t.dropped,a.dropped)if(a.backtracked)B.b.warn("Already backtracked on this fragment, appending with the gap",a.sn);else{var s=r.details;if(!s||a.sn!==s.startSN)return B.b.warn("missing video frame(s), backtracking fragment",a.sn),this.fragmentTracker.removeFragment(a),a.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=Ge,this.fragPrevious=a,void this.tick();B.b.warn("missing video frame(s) on first frag, appending with gap",a.sn)}else a.backtracked=!1;var o=Se(r.details,a,t.startPTS,t.endPTS,t.startDTS,t.endDTS),l=this.hls;l.trigger(M.a.LEVEL_PTS_UPDATED,{details:r.details,level:this.level,drift:o,type:t.type,start:t.startPTS,end:t.endPTS}),[t.data1,t.data2].forEach(function(e){e&&e.length&&i.state===ze&&(i.appended=!0,i.pendingBuffering=!0,l.trigger(M.a.BUFFER_APPENDING,{type:t.type,data:e,parent:"main",content:"data"}))}),this.tick()}},Qe.prototype.onFragParsed=function(e){var t=this.fragCurrent,i=e.frag;t&&"main"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===ze&&(this.stats.tparsed=window.performance.now(),this.state=Ye,this._checkAppendedParsed())},Qe.prototype.onAudioTrackSwitching=function(e){var t=!!e.url,i=e.id;if(!t){if(this.mediaBuffer!==this.media){B.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n.loader&&(B.b.log("switching to main audio track, cancel main fragment load"),n.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=Ge}var r=this.hls;r.trigger(M.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),r.trigger(M.a.AUDIO_TRACK_SWITCHED,{id:i}),this.altAudio=!1}},Qe.prototype.onAudioTrackSwitched=function(e){var t=e.id,i=!!this.hls.audioTracks[t].url;if(i){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(B.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=i,this.tick()},Qe.prototype.onBufferCreated=function(e){var t=e.tracks,i=void 0,n=void 0,r=!1;for(var a in t){var s=t[a];"main"===s.id?(i=s,"video"===(n=a)&&(this.videoBuffer=t[a].buffer)):r=!0}r&&i?(B.b.log("alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media},Qe.prototype.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==ze&&t!==Ye||(this.pendingBuffering=0<e.pending,this._checkAppendedParsed())}},Qe.prototype._checkAppendedParsed=function(){if(!(this.state!==Ye||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;B.b.log("main buffered : "+Ae.toString(t.buffered)),this.fragPrevious=e;var i=this.stats;i.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*i.total/(i.tbuffered-i.tfirst)),this.hls.trigger(M.a.FRAG_BUFFERED,{stats:i,frag:e,id:"main"}),this.state=Ge}this.tick()}},Qe.prototype.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var i=!!this.media&&oe.isBuffered(this.media,this.media.currentTime)&&oe.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case d.a.FRAG_LOAD_ERROR:case d.a.FRAG_LOAD_TIMEOUT:case d.a.KEY_LOAD_ERROR:case d.a.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var n=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);B.b.warn("mediaController: frag loading failed, retry in "+n+" ms"),this.retryDate=window.performance.now()+n,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=We}else B.b.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=Je;break;case d.a.LEVEL_LOAD_ERROR:case d.a.LEVEL_LOAD_TIMEOUT:this.state!==Je&&(e.fatal?(this.state=Je,B.b.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==qe||(this.state=Ge));break;case d.a.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==ze&&this.state!==Ye||(i?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=Ge):(B.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},Qe.prototype._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,B.b.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},Qe.prototype._checkBuffer=function(){var e=this.media;if(e&&0!==e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t)}},Qe.prototype.onFragLoadEmergencyAborted=function(){this.state=Ge,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},Qe.prototype.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;e&&this.fragmentTracker.detectEvictedFragments(I.ElementaryStreamTypes.VIDEO,e.buffered),this.state=Ge,this.fragPrevious=null},Qe.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},Qe.prototype.computeLivePosition=function(e,t){var i=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-i)},Qe.prototype._seekToStartPos=function(){var e=this.media,t=e.currentTime,i=e.seeking?t:this.startPosition;t!==i&&(B.b.log("target start position not buffered, seek to buffered.start(0) "+i+" from current time "+t+" "),e.currentTime=i)},Qe.prototype._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(B.b.log("swapping playlist audio codec"),t=t&&(-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),t},Ue(Qe,[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,B.b.log("main stream:"+t+"->"+e),this.hls.trigger(M.a.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),Qe),et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt=function(e,t,i){return t&&it(e.prototype,t),i&&it(e,i),e};function it(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var nt,rt=window.performance;function at(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,at);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,nt.call(this,e,M.a.MANIFEST_LOADED,M.a.LEVEL_LOADED,M.a.AUDIO_TRACK_SWITCHED,M.a.FRAG_LOADED,M.a.ERROR));return t.canload=!1,t.currentLevelIndex=null,t.manualLevelIndex=-1,t.timer=null,t}var st,ot=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(at,nt=u),at.prototype.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},at.prototype.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},at.prototype.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),null!==this.timer&&this.loadLevel()},at.prototype.stopLoad=function(){this.canload=!1},at.prototype.onManifestLoaded=function(e){var t=[],i=void 0,n={},r=null,a=!1,s=!1,o=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),l=[];if(e.levels.forEach(function(e){e.loadError=0,e.fragmentError=!1,a=a||!!e.videoCodec,s=s||!!e.audioCodec||!(!e.attrs||!e.attrs.AUDIO),o&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(r=n[e.bitrate])?r.url.push(e.url):(e.url=[e.url],e.urlId=0,n[e.bitrate]=e,t.push(e)),e.attrs&&e.attrs.AUDIO&&_e(r||e,"audio",e.attrs.AUDIO),e.attrs&&e.attrs.SUBTITLES&&_e(r||e,"text",e.attrs.SUBTITLES)}),a&&s&&(t=t.filter(function(e){return!!e.videoCodec})),t=t.filter(function(e){var t=e.audioCodec,i=e.videoCodec;return(!t||E(t))&&(!i||E(i))}),e.audioTracks&&(l=e.audioTracks.filter(function(e){return!e.audioCodec||E(e.audioCodec,"audio")})).forEach(function(e,t){e.id=t}),0<t.length){i=t[0].bitrate,t.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=t;for(var u=0;u<t.length;u++)if(t[u].bitrate===i){this._firstLevel=u,B.b.log("manifest loaded,"+t.length+" level(s) found, first bitrate:"+i);break}this.hls.trigger(M.a.MANIFEST_PARSED,{levels:t,audioTracks:l,firstLevel:this._firstLevel,stats:e.stats,audio:s,video:a,altAudio:0<l.length&&a})}else this.hls.trigger(M.a.ERROR,{type:d.b.MEDIA_ERROR,details:d.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},at.prototype.setLevelInternal=function(e){var t=this._levels,i=this.hls;if(0<=e&&e<t.length){if(this.clearTimer(),this.currentLevelIndex!==e){B.b.log("switching to level "+e);var n=t[this.currentLevelIndex=e];n.level=e,i.trigger(M.a.LEVEL_SWITCHING,n)}var r=t[e],a=r.details;if(!a||a.live){var s=r.urlId;i.trigger(M.a.LEVEL_LOADING,{url:r.url[s],level:e,id:s})}}else i.trigger(M.a.ERROR,{type:d.b.OTHER_ERROR,details:d.a.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},at.prototype.onError=function(e){if(e.fatal)e.type===d.b.NETWORK_ERROR&&this.clearTimer();else{var t=!1,i=!1,n=void 0;switch(e.details){case d.a.FRAG_LOAD_ERROR:case d.a.FRAG_LOAD_TIMEOUT:case d.a.KEY_LOAD_ERROR:case d.a.KEY_LOAD_TIMEOUT:n=e.frag.level,i=!0;break;case d.a.LEVEL_LOAD_ERROR:case d.a.LEVEL_LOAD_TIMEOUT:n=e.context.level,t=!0;break;case d.a.REMUX_ALLOC_ERROR:n=e.level,t=!0}void 0!==n&&this.recoverLevel(e,n,t,i)}},at.prototype.recoverLevel=function(e,t,i,n){var r=this,a=this.hls.config,s=e.details,o=this._levels[t],l=void 0,u=void 0,c=void 0;if(o.loadError++,o.fragmentError=n,i){if(!(this.levelRetryCount+1<=a.levelLoadingMaxRetry))return B.b.error("level controller, cannot recover from "+s+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);u=Math.min(Math.pow(2,this.levelRetryCount)*a.levelLoadingRetryDelay,a.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return r.loadLevel()},u),e.levelRetry=!0,this.levelRetryCount++,B.b.warn("level controller, "+s+", retry in "+u+" ms, current retry count is "+this.levelRetryCount)}(i||n)&&(1<(l=o.url.length)&&o.loadError<l?(o.urlId=(o.urlId+1)%l,o.details=void 0,B.b.warn("level controller, "+s+" for level "+t+": switching to redundant URL-id "+o.urlId)):-1===this.manualLevelIndex?(c=0===t?this._levels.length-1:t-1,B.b.warn("level controller, "+s+": switch to "+c),this.hls.nextAutoLevel=this.currentLevelIndex=c):n&&(B.b.warn("level controller, "+s+": reload a fragment"),this.currentLevelIndex=null))},at.prototype.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var i=this._levels[t.level];void 0!==i&&(i.fragmentError=!1,i.loadError=0,this.levelRetryCount=0)}},at.prototype.onLevelLoaded=function(e){var t=this,i=e.level;if(i===this.currentLevelIndex){var n=this._levels[i];n.fragmentError||(n.loadError=0,this.levelRetryCount=0);var r=e.details;if(r.live){var a=1e3*(r.averagetargetduration?r.averagetargetduration:r.targetduration),s=a,o=n.details;o&&r.endSN===o.endSN&&(s/=2,B.b.log("same live playlist, reload twice faster")),s-=rt.now()-e.stats.trequest,s=Math.max(a/2,Math.round(s)),B.b.log("live playlist, reload in "+Math.round(s)+" ms"),this.timer=setTimeout(function(){return t.loadLevel()},s)}else this.clearTimer()}},at.prototype.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,i=this.hls.levels[this.currentLevelIndex];if(i&&i.audioGroupIds){var n=i.audioGroupIds.findIndex(function(e){return e===t});n!==i.urlId&&(i.urlId=n,this.startLoad())}},at.prototype.loadLevel=function(){if(B.b.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var e=this._levels[this.currentLevelIndex];if("object"===(void 0===e?"undefined":et(e))&&0<e.url.length){var t=this.currentLevelIndex,i=e.urlId,n=e.url[i];B.b.log("Attempt loading level index "+t+" with URL-id "+i),this.hls.trigger(M.a.LEVEL_LOADING,{url:n,level:t,id:i})}}},tt(at,[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0!==this._startLevel)return this._startLevel;var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}]),at),lt=i(6);function ut(e,t){var i=null;try{i=new window.Event("addtrack")}catch(e){(i=document.createEvent("Event")).initEvent("addtrack",!1,!1)}i.track=e,t.dispatchEvent(i)}function ct(e){if(e&&e.cues)for(;0<e.cues.length;)e.removeCue(e.cues[0])}function ht(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ht);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,st.call(this,e,M.a.MEDIA_ATTACHED,M.a.MEDIA_DETACHING,M.a.FRAG_PARSING_METADATA));return t.id3Track=void 0,t.media=void 0,t}var dt=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(ht,st=u),ht.prototype.destroy=function(){u.prototype.destroy.call(this)},ht.prototype.onMediaAttached=function(e){this.media=e.media,this.media},ht.prototype.onMediaDetaching=function(){ct(this.id3Track),this.id3Track=void 0,this.media=void 0},ht.prototype.getID3Track=function(e){for(var t=0;t<e.length;t++){var i=e[t];if("metadata"===i.kind&&"id3"===i.label)return ut(i,this.media),i}return this.media.addTextTrack("metadata","id3")},ht.prototype.onFragParsingMetadata=function(e){var t=e.frag,i=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,r=0;r<i.length;r++){var a=lt.a.getID3Frames(i[r].data);if(a){var s=i[r].pts,o=r<i.length-1?i[r+1].pts:t.endPTS;s===o&&(o+=1e-4);for(var l=0;l<a.length;l++){var u=a[l];if(!lt.a.isTimeStampFrame(u)){var c=new n(s,o,"");c.value=u,this.id3Track.addCue(c)}}}}},ht);function ft(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ft),this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}var pt=(ft.prototype.sample=function(e,t){var i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e},ft.prototype.getTotalWeight=function(){return this.totalWeight_},ft.prototype.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},ft);function mt(e,t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,mt),this.hls=e,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new pt(t),this.fast_=new pt(i)}var gt=(mt.prototype.sample=function(e,t){var i=8e3*t/(e=Math.max(e,this.minDelayMs_)),n=e/1e3;this.fast_.sample(n,i),this.slow_.sample(n,i)},mt.prototype.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},mt.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},mt.prototype.destroy=function(){},mt),vt=function(e,t,i){return t&&yt(e.prototype,t),i&&yt(e,i),e};function yt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var bt,_t=window.performance;function Tt(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Tt);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,bt.call(this,e,M.a.FRAG_LOADING,M.a.FRAG_LOADED,M.a.FRAG_BUFFERED,M.a.ERROR));return t.lastLoadedFragLevel=0,t._nextAutoLevel=-1,t.hls=e,t.timer=null,t._bwEstimator=null,t.onCheck=t._abandonRulesCheck.bind(t),t}var St=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Tt,bt=u),Tt.prototype.destroy=function(){this.clearTimer(),u.prototype.destroy.call(this)},Tt.prototype.onFragLoading=function(e){var t=e.frag;if("main"===t.type&&(this.timer||(this.fragCurrent=t,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var i=this.hls,n=i.config,r=t.level,a=void 0,s=void 0;s=i.levels[r].details.live?(a=n.abrEwmaFastLive,n.abrEwmaSlowLive):(a=n.abrEwmaFastVoD,n.abrEwmaSlowVoD),this._bwEstimator=new gt(i,s,a,n.abrEwmaDefaultEstimate)}},Tt.prototype._abandonRulesCheck=function(){var e=this.hls,t=e.media,i=this.fragCurrent;if(i){var n=i.loader,r=e.minAutoLevel;if(!n||n.stats&&n.stats.aborted)return B.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var a=n.stats;if(t&&a&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&i.autoLevel&&i.level){var s=_t.now()-a.trequest,o=Math.abs(t.playbackRate);if(s>500*i.duration/o){var l=e.levels,u=Math.max(1,a.bw?a.bw/8:1e3*a.loaded/s),c=l[i.level],h=c.realBitrate?Math.max(c.realBitrate,c.bitrate):c.bitrate,d=a.total?a.total:Math.max(a.loaded,Math.round(i.duration*h/8)),f=t.currentTime,p=(d-a.loaded)/u,m=(oe.bufferInfo(t,f,e.config.maxBufferHole).end-f)/o;if(m<2*i.duration/o&&m<p){var g=void 0,v=void 0;for(v=i.level-1;r<v;v--){var y=l[v].realBitrate?Math.max(l[v].realBitrate,l[v].bitrate):l[v].bitrate;if((g=i.duration*y/(6.4*u))<m)break}g<p&&(B.b.warn("loading too slow, abort fragment loading and switch to level "+v+":fragLoadedDelay["+v+"]<fragLoadedDelay["+(i.level-1)+"];bufferStarvationDelay:"+g.toFixed(1)+"<"+p.toFixed(1)+":"+m.toFixed(1)),e.nextLoadLevel=v,this._bwEstimator.sample(s,a.loaded),n.abort(),this.clearTimer(),e.trigger(M.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,stats:a}))}}}}},Tt.prototype.onFragLoaded=function(e){var t=e.frag;if("main"===t.type&&Object(N.a)(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var i=this.hls.levels[t.level],n=(i.loaded?i.loaded.bytes:0)+e.stats.loaded,r=(i.loaded?i.loaded.duration:0)+e.frag.duration;i.loaded={bytes:n,duration:r},i.realBitrate=Math.round(8*n/r)}if(e.frag.bitrateTest){var a=e.stats;a.tparsed=a.tbuffered=a.tload,this.onFragBuffered(e)}}},Tt.prototype.onFragBuffered=function(e){var t=e.stats,i=e.frag;if(!0!==t.aborted&&"main"===i.type&&Object(N.a)(i.sn)&&(!i.bitrateTest||t.tload===t.tbuffered)){var n=t.tparsed-t.trequest;B.b.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(n,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}},Tt.prototype.onError=function(e){switch(e.details){case d.a.FRAG_LOAD_ERROR:case d.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},Tt.prototype.clearTimer=function(){clearInterval(this.timer),this.timer=null},Tt.prototype._findBestLevel=function(e,t,i,n,r,a,s,o,l){for(var u=r;n<=u;u--){var c=l[u];if(c){var h=c.details,d=h?h.totalduration/h.fragments.length:t,f=!!h&&h.live,p=void 0;p=u<=e?s*i:o*i;var m=l[u].realBitrate?Math.max(l[u].realBitrate,l[u].bitrate):l[u].bitrate,g=m*d/p;if(B.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(p)+"/"+m+"/"+d+"/"+a+"/"+g),m<p&&(!g||f&&!this.bitrateTestDelay||g<a))return u}}return-1},vt(Tt,[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var i=this._nextABRAutoLevel;return-1!==e&&(i=Math.min(e,i)),i},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,i=e.levels,n=e.config,r=e.minAutoLevel,a=e.media,s=this.lastLoadedFragLevel,o=this.fragCurrent?this.fragCurrent.duration:0,l=a?a.currentTime:0,u=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,c=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,h=(oe.bufferInfo(a,l,n.maxBufferHole).end-l)/u,d=this._findBestLevel(s,o,c,r,t,h,n.abrBandWidthFactor,n.abrBandWidthUpFactor,i);if(0<=d)return d;B.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var f=o?Math.min(o,n.maxStarvationDelay):n.maxStarvationDelay,p=n.abrBandWidthFactor,m=n.abrBandWidthUpFactor;if(0==h){var g=this.bitrateTestDelay;g&&(f=(o?Math.min(o,n.maxLoadingDelay):n.maxLoadingDelay)-g,B.b.trace("bitrate test took "+Math.round(1e3*g)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*f)+" ms"),p=m=1)}return d=this._findBestLevel(s,o,c,r,t,h+f,p,m,i),Math.max(d,0)}}]),Tt);var Et,wt=pe();function Ct(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Ct);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,Et.call(this,e,M.a.MEDIA_ATTACHING,M.a.MEDIA_DETACHING,M.a.MANIFEST_PARSED,M.a.BUFFER_RESET,M.a.BUFFER_APPENDING,M.a.BUFFER_CODECS,M.a.BUFFER_EOS,M.a.BUFFER_FLUSHING,M.a.LEVEL_PTS_UPDATED,M.a.LEVEL_UPDATED));return t._msDuration=null,t._levelDuration=null,t._live=null,t._objectUrl=null,t.onsbue=t.onSBUpdateEnd.bind(t),t.onsbe=t.onSBUpdateError.bind(t),t.pendingTracks={},t.tracks={},t}var kt,At=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Ct,Et=u),Ct.prototype.destroy=function(){u.prototype.destroy.call(this)},Ct.prototype.onLevelPtsUpdated=function(e){var t=e.type,i=this.tracks.audio;if("audio"===t&&i&&"audio/mpeg"===i.container){var n=this.sourceBuffer.audio;if(.1<Math.abs(n.timestampOffset-e.start)){var r=n.updating;try{n.abort()}catch(e){r=!0,B.b.warn("can not abort audio buffer: "+e)}r?this.audioTimestampOffset=e.start:(B.b.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+e.start),n.timestampOffset=e.start)}}},Ct.prototype.onManifestParsed=function(e){var t=e.audio,i=e.video||e.levels.length&&e.altAudio,n=0;e.altAudio&&(t||i)&&(n=(t?1:0)+(i?1:0),B.b.log(n+" sourceBuffer(s) expected")),this.sourceBufferNb=n},Ct.prototype.onMediaAttaching=function(e){var t=this.media=e.media;if(t){var i=this.mediaSource=new wt;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),i.addEventListener("sourceopen",this.onmso),i.addEventListener("sourceended",this.onmse),i.addEventListener("sourceclose",this.onmsc),t.src=window.URL.createObjectURL(i),this._objectUrl=t.src}},Ct.prototype.onMediaDetaching=function(){B.b.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){B.b.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):B.b.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(M.a.MEDIA_DETACHED)},Ct.prototype.onMediaSourceOpen=function(){B.b.log("media source opened"),this.hls.trigger(M.a.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()},Ct.prototype.checkPendingTracks=function(){var e=this.pendingTracks,t=Object.keys(e).length;t&&(this.sourceBufferNb<=t||0===this.sourceBufferNb)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())},Ct.prototype.onMediaSourceClose=function(){B.b.log("media source closed")},Ct.prototype.onMediaSourceEnded=function(){B.b.log("media source ended")},Ct.prototype.onSBUpdateEnd=function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;B.b.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var i=this.parent,t=this.segments.reduce(function(e,t){return t.parent===i?e+1:e},0),n={},r=this.sourceBuffer;for(var a in r)n[a]=r[a].buffered;this.hls.trigger(M.a.BUFFER_APPENDED,{parent:i,pending:t,timeRanges:n}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()},Ct.prototype.onSBUpdateError=function(e){B.b.error("sourceBuffer error:",e),this.hls.trigger(M.a.ERROR,{type:d.b.MEDIA_ERROR,details:d.a.BUFFER_APPENDING_ERROR,fatal:!1})},Ct.prototype.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var i=e[t];try{this.mediaSource.removeSourceBuffer(i),i.removeEventListener("updateend",this.onsbue),i.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},Ct.prototype.onBufferCodecs=function(e){if(0===Object.keys(this.sourceBuffer).length){for(var t in e)this.pendingTracks[t]=e[t];var i=this.mediaSource;i&&"open"===i.readyState&&this.checkPendingTracks()}},Ct.prototype.createSourceBuffers=function(e){var t=this.sourceBuffer,i=this.mediaSource;for(var n in e)if(!t[n]){var r=e[n],a=r.levelCodec||r.codec,s=r.container+";codecs="+a;B.b.log("creating sourceBuffer("+s+")");try{var o=t[n]=i.addSourceBuffer(s);o.addEventListener("updateend",this.onsbue),o.addEventListener("error",this.onsbe),this.tracks[n]={codec:a,container:r.container},r.buffer=o}catch(e){B.b.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(M.a.ERROR,{type:d.b.MEDIA_ERROR,details:d.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:s})}}this.hls.trigger(M.a.BUFFER_CREATED,{tracks:e})},Ct.prototype.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},Ct.prototype.onBufferAppendFail=function(e){B.b.error("sourceBuffer error:",e.event),this.hls.trigger(M.a.ERROR,{type:d.b.MEDIA_ERROR,details:d.a.BUFFER_APPENDING_ERROR,fatal:!1})},Ct.prototype.onBufferEos=function(e){var t=this.sourceBuffer,i=e.type;for(var n in t)i&&n!==i||t[n].ended||(t[n].ended=!0,B.b.log(n+" sourceBuffer now EOS"));this.checkEos()},Ct.prototype.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var i in e){var n=e[i];if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}B.b.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){B.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},Ct.prototype.onBufferFlushing=function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()},Ct.prototype.onLevelUpdated=function(e){var t=e.details;0<t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._live=t.live,this.updateMediaElementDuration())},Ct.prototype.updateMediaElementDuration=function(){var e,t=this.hls.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var i in this.sourceBuffer)if(!0===this.sourceBuffer[i].updating)return;e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(B.b.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>e||!Object(N.a)(e))&&(B.b.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},Ct.prototype.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,i=this.sourceBuffer;try{for(var n in i)t+=i[n].buffered.length}catch(e){B.b.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(M.a.BUFFER_FLUSHED)}},Ct.prototype.doAppending=function(){var t=this.hls,e=this.sourceBuffer,i=this.segments;if(Object.keys(e).length){if(this.media.error)return this.segments=[],void B.b.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(i&&i.length){var n=i.shift();try{var r=e[n.type];r?r.updating?i.unshift(n):(r.ended=!1,this.parent=n.parent,r.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(e){B.b.error("error while trying to append buffer:"+e.message),i.unshift(n);var a={type:d.b.MEDIA_ERROR,parent:n.parent};22!==e.code?(this.appendError?this.appendError++:this.appendError=1,a.details=d.a.BUFFER_APPEND_ERROR,this.appendError>t.config.appendErrorMaxRetry?(B.b.log("fail "+t.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),i=[],a.fatal=!0):a.fatal=!1):(this.segments=[],a.details=d.a.BUFFER_FULL_ERROR,a.fatal=!1),t.trigger(M.a.ERROR,a)}}}},Ct.prototype.flushBuffer=function(e,t,i){var n=void 0,r=void 0,a=void 0,s=void 0,o=void 0,l=void 0,u=this.sourceBuffer;if(Object.keys(u).length){if(B.b.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var c in u)if(!i||c===i){if((n=u[c]).ended=!1,n.updating)return B.b.warn("cannot flush, sb updating in progress"),!1;try{for(r=0;r<n.buffered.length;r++)if(a=n.buffered.start(r),s=n.buffered.end(r),l=-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&t===Number.POSITIVE_INFINITY?(o=e,t):(o=Math.max(a,e),Math.min(s,t)),.5<Math.min(l,s)-o)return this.flushBufferCounter++,B.b.log("flush "+c+" ["+o+","+l+"], of ["+a+","+s+"], pos:"+this.media.currentTime),n.remove(o,l),!1}catch(e){B.b.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else B.b.warn("abort flushing too many retries");B.b.log("buffer flushed")}return!0},Ct),It=function(e,t,i){return t&&xt(e.prototype,t),i&&xt(e,i),e};function xt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pt(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Pt);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,kt.call(this,e,M.a.FPS_DROP_LEVEL_CAPPING,M.a.MEDIA_ATTACHING,M.a.MANIFEST_PARSED,M.a.BUFFER_CODECS,M.a.MEDIA_DETACHING));return t.autoLevelCapping=Number.POSITIVE_INFINITY,t.firstLevel=null,t.levels=[],t.media=null,t.restrictedLevels=[],t.timer=null,t}var Lt=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Pt,kt=u),Pt.prototype.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this._stopCapping())},Pt.prototype.onFpsDropLevelCapping=function(e){Pt.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},Pt.prototype.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},Pt.prototype.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&(e.video||e.levels.length&&e.altAudio)&&this._startCapping()},Pt.prototype.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this._startCapping()},Pt.prototype.onLevelsUpdated=function(e){this.levels=e.levels},Pt.prototype.onMediaDetaching=function(){this._stopCapping()},Pt.prototype.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},Pt.prototype.getMaxLevel=function(i){var n=this;if(!this.levels)return-1;var e=this.levels.filter(function(e,t){return Pt.isLevelAllowed(t,n.restrictedLevels)&&t<=i});return Pt.getMaxLevelByMediaSize(e,this.mediaWidth,this.mediaHeight)},Pt.prototype._startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},Pt.prototype._stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},Pt.isLevelAllowed=function(e,t){return-1===(1<arguments.length&&void 0!==t?t:[]).indexOf(e)},Pt.getMaxLevelByMediaSize=function(e,t,i){if(!e||e&&!e.length)return-1;for(var n,r,a=e.length-1,s=0;s<e.length;s+=1){var o=e[s];if((o.width>=t||o.height>=i)&&(n=o,!(r=e[s+1])||n.width!==r.width||n.height!==r.height)){a=s;break}}return a},It(Pt,[{key:"mediaWidth",get:function(){var e=void 0,t=this.media;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=Pt.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e=void 0,t=this.media;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=Pt.contentScaleFactor),e}}],[{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}]),Pt);var Rt,Ot=window.performance;function Dt(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Dt),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,Rt.call(this,e,M.a.MEDIA_ATTACHING))}var Nt=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Dt,Rt=u),Dt.prototype.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},Dt.prototype.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},Dt.prototype.checkFPS=function(e,t,i){var n=Ot.now();if(t){if(this.lastTime){var r=n-this.lastTime,a=i-this.lastDroppedFrames,s=t-this.lastDecodedFrames,o=1e3*a/r,l=this.hls;if(l.trigger(M.a.FPS_DROP,{currentDropped:a,currentDecoded:s,totalDroppedFrames:i}),0<o&&a>l.config.fpsDroppedMonitoringThreshold*s){var u=l.currentLevel;B.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),0<u&&(-1===l.autoLevelCapping||l.autoLevelCapping>=u)&&(--u,l.trigger(M.a.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:l.currentLevel}),l.autoLevelCapping=u,l.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=i,this.lastDecodedFrames=t}},Dt.prototype.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},Dt);var Mt=window,Bt=Mt.performance,Ut=Mt.XMLHttpRequest;function Ft(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Ft),e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}var jt,Ht=(Ft.prototype.destroy=function(){this.abort(),this.loader=null},Ft.prototype.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},Ft.prototype.load=function(e,t,i){this.context=e,this.config=t,this.callbacks=i,this.stats={trequest:Bt.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},Ft.prototype.loadInternal=function(){var t=void 0,i=this.context;t=this.loader=new Ut;var e=this.stats;e.tfirst=0,e.loaded=0;var n=this.xhrSetup;try{if(n)try{n(t,i.url)}catch(e){t.open("GET",i.url,!0),n(t,i.url)}t.readyState||t.open("GET",i.url,!0)}catch(e){return void this.callbacks.onError({code:t.status,text:e.message},i,t)}i.rangeEnd&&t.setRequestHeader("Range","bytes="+i.rangeStart+"-"+(i.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=i.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),t.send()},Ft.prototype.readystatechange=function(e){var t=e.currentTarget,i=t.readyState,n=this.stats,r=this.context,a=this.config;if(!n.aborted&&2<=i)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(Bt.now(),n.trequest)),4===i){var s=t.status;if(200<=s&&s<300){n.tload=Math.max(n.tfirst,Bt.now());var o=void 0,l=void 0;l="arraybuffer"===r.responseType?(o=t.response).byteLength:(o=t.responseText).length,n.loaded=n.total=l;var u={url:t.responseURL,data:o};this.callbacks.onSuccess(u,n,r,t)}else n.retry>=a.maxRetry||400<=s&&s<499?(B.b.error(s+" while loading "+r.url),this.callbacks.onError({code:s,text:t.statusText},r,t)):(B.b.warn(s+" while loading "+r.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),a.timeout)},Ft.prototype.loadtimeout=function(){B.b.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},Ft.prototype.loadprogress=function(e){var t=e.currentTarget,i=this.stats;i.loaded=e.loaded,e.lengthComputable&&(i.total=e.total);var n=this.callbacks.onProgress;n&&n(i,this.context,null,t)},Ft),Gt=function(e,t,i){return t&&Vt(e.prototype,t),i&&Vt(e,i),e};function Vt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Kt(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Kt);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,jt.call(this,e,M.a.MANIFEST_LOADING,M.a.MANIFEST_PARSED,M.a.AUDIO_TRACK_LOADED,M.a.AUDIO_TRACK_SWITCHED,M.a.LEVEL_LOADED,M.a.ERROR));return t._trackId=-1,t._selectDefaultTrack=!0,t.tracks=[],t.trackIdBlacklist=Object.create(null),t.audioGroupId=null,t}var Wt=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Kt,jt=De),Kt.prototype.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},Kt.prototype.onManifestParsed=function(e){var t=this.tracks=e.audioTracks||[];this.hls.trigger(M.a.AUDIO_TRACKS_UPDATED,{audioTracks:t})},Kt.prototype.onAudioTrackLoaded=function(e){if(e.id>=this.tracks.length)B.b.warn("Invalid audio track id:",e.id);else{if(B.b.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval()){var t=1e3*e.details.targetduration;this.setInterval(t)}!e.details.live&&this.hasInterval()&&this.clearInterval()}},Kt.prototype.onAudioTrackSwitched=function(e){var t=this.tracks[e.id].groupId;t&&this.audioGroupId!==t&&(this.audioGroupId=t)},Kt.prototype.onLevelLoaded=function(e){var t=this.hls.levels[e.level];if(t.audioGroupIds){var i=t.audioGroupIds[t.urlId];this.audioGroupId!==i&&(this.audioGroupId=i,this._selectInitialAudioTrack())}},Kt.prototype.onError=function(e){e.type===d.b.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===d.a.AUDIO_TRACK_LOAD_ERROR&&(B.b.warn("Network failure on audio-track id:",e.context.id),this._handleLoadError()))},Kt.prototype._setAudioTrack=function(e){if(this._trackId===e&&this.tracks[this._trackId].details)B.b.debug("Same id as current audio-track passed, and track details available -> no-op");else if(e<0||e>=this.tracks.length)B.b.warn("Invalid id passed to audio-track controller");else{var t=this.tracks[e];B.b.log("Now switching to audio-track index "+e),this.clearInterval(),this._trackId=e;var i=t.url,n=t.type,r=t.id;this.hls.trigger(M.a.AUDIO_TRACK_SWITCHING,{id:r,type:n,url:i}),this._loadTrackDetailsIfNeeded(t)}},Kt.prototype.doTick=function(){this._updateTrack(this._trackId)},Kt.prototype._selectInitialAudioTrack=function(){var t=this,e=this.tracks;if(e.length){var i=this.tracks[this._trackId],n=null;if(i&&(n=i.name),this._selectDefaultTrack){var r=e.filter(function(e){return e.default});r.length?e=r:B.b.warn("No default audio tracks defined")}var a=!1,s=function(){e.forEach(function(e){a||t.audioGroupId&&e.groupId!==t.audioGroupId||n&&n!==e.name||(t._setAudioTrack(e.id),a=!0)})};s(),a||(n=null,s()),a||(B.b.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(M.a.ERROR,{type:d.b.MEDIA_ERROR,details:d.a.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},Kt.prototype._needsTrackLoading=function(e){var t=e.details;return!t||!!t.live||void 0},Kt.prototype._loadTrackDetailsIfNeeded=function(e){if(this._needsTrackLoading(e)){var t=e.url,i=e.id;B.b.log("loading audio-track playlist for id: "+i),this.hls.trigger(M.a.AUDIO_TRACK_LOADING,{url:t,id:i})}},Kt.prototype._updateTrack=function(e){if(!(e<0||e>=this.tracks.length)){this.clearInterval(),this._trackId=e,B.b.log("trying to update audio-track "+e);var t=this.tracks[e];this._loadTrackDetailsIfNeeded(t)}},Kt.prototype._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,t=this.tracks[e],i=t.name,n=t.language,r=t.groupId;B.b.warn("Loading failed on audio track id: "+e+", group-id: "+r+', name/language: "'+i+'" / "'+n+'"');for(var a=e,s=0;s<this.tracks.length;s++)if(!this.trackIdBlacklist[s]&&this.tracks[s].name===i){a=s;break}a!==e?(B.b.log("Attempting audio-track fallback id:",a,"group-id:",this.tracks[a].groupId),this._setAudioTrack(a)):B.b.warn('No fallback audio-track found for name/language: "'+i+'" / "'+n+'"')},Gt(Kt,[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1}}]),Kt),qt=function(e,t,i){return t&&zt(e.prototype,t),i&&zt(e,i),e};function zt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Yt,Xt=window.performance,$t="STOPPED",Jt="STARTING",Qt="IDLE",Zt="PAUSED",ei="KEY_LOADING",ti="FRAG_LOADING",ii="FRAG_LOADING_WAITING_RETRY",ni="WAITING_TRACK",ri="PARSING",ai="PARSED",si="BUFFER_FLUSHING",oi="ENDED",li="ERROR",ui="WAITING_INIT_PTS";function ci(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ci);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,Yt.call(this,e,M.a.MEDIA_ATTACHED,M.a.MEDIA_DETACHING,M.a.AUDIO_TRACKS_UPDATED,M.a.AUDIO_TRACK_SWITCHING,M.a.AUDIO_TRACK_LOADED,M.a.KEY_LOADED,M.a.FRAG_LOADED,M.a.FRAG_PARSING_INIT_SEGMENT,M.a.FRAG_PARSING_DATA,M.a.FRAG_PARSED,M.a.ERROR,M.a.BUFFER_RESET,M.a.BUFFER_CREATED,M.a.BUFFER_APPENDED,M.a.BUFFER_FLUSHED,M.a.INIT_PTS_FOUND));return i.fragmentTracker=t,i.config=e.config,i.audioCodecSwap=!1,i._state=$t,i.initPTS=[],i.waitingFragment=null,i.videoTrackCC=null,i}function hi(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}}var di=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(ci,Yt=De),ci.prototype.onHandlerDestroying=function(){this.stopLoad(),Yt.prototype.onHandlerDestroying.call(this)},ci.prototype.onHandlerDestroyed=function(){this.state=$t,this.fragmentTracker=null,Yt.prototype.onHandlerDestroyed.call(this)},ci.prototype.onInitPtsFound=function(e){var t=e.id,i=e.frag.cc,n=e.initPTS;"main"===t&&(this.initPTS[i]=n,this.videoTrackCC=i,B.b.log("InitPTS for cc: "+i+" found from video track: "+n),this.state===ui&&this.tick())},ci.prototype.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),(this.fragLoadError=0)<t&&-1===e?(B.b.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=Qt):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=Jt),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=$t},ci.prototype.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=$t},ci.prototype.doTick=function(){var e,t,i=void 0,n=void 0,r=void 0,a=this.hls,s=a.config;switch(this.state){case li:case Zt:case si:break;case Jt:this.state=ni,this.loadedmetadata=!1;break;case Qt:var o=this.tracks;if(!o)break;if(!this.media&&(this.startFragRequested||!s.startFragPrefetch))break;if(this.loadedmetadata)i=this.media.currentTime;else if(void 0===(i=this.nextLoadPosition))break;var l=this.mediaBuffer?this.mediaBuffer:this.media,u=this.videoBuffer?this.videoBuffer:this.media,c=oe.bufferInfo(l,i,s.maxBufferHole),h=oe.bufferInfo(u,i,s.maxBufferHole),d=c.len,f=c.end,p=this.fragPrevious,m=Math.min(s.maxBufferLength,s.maxMaxBufferLength),g=Math.max(m,h.len),v=this.audioSwitch,y=this.trackId;if((d<g||v)&&y<o.length){if(void 0===(r=o[y].details)){this.state=ni;break}if(!v&&!r.live&&p&&p.sn===r.endSN&&!c.nextStart&&(!this.media.seeking||this.media.duration-f<p.duration/2)){this.hls.trigger(M.a.BUFFER_EOS,{type:"audio"}),this.state=oi;break}var b=r.fragments,_=b.length,T=b[0].start,S=b[_-1].start+b[_-1].duration,E=void 0;if(v)if(r.live&&!r.PTSKnown)B.b.log("switching audiotrack, live stream, unknown PTS,load first fragment"),f=0;else if(f=i,r.PTSKnown&&i<T){if(!(c.end>T||c.nextStart))return;B.b.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=T+.05}if(r.initSegment&&!r.initSegment.data)E=r.initSegment;else if(f<=T){if(E=b[0],null!==this.videoTrackCC&&E.cc!==this.videoTrackCC&&(e=b,t=this.videoTrackCC,E=se.search(e,function(e){return e.cc<t?1:e.cc>t?-1:0})),r.live&&E.loadIdx&&E.loadIdx===this.fragLoadIdx){var w=c.nextStart?c.nextStart:T;return B.b.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(w+.05)),void(this.media.currentTime=w+.05)}}else{var C=void 0,k=s.maxFragLookUpTolerance,A=p?b[p.sn-b[0].sn+1]:void 0,I=function(e){var t=Math.min(k,e.duration);return e.start+e.duration-t<=f?1:e.start-t>f&&e.start?-1:0};(C=f<S?(S-k<f&&(k=0),A&&!I(A)?A:se.search(b,I)):b[_-1])&&(T=(E=C).start,p&&E.level===p.level&&E.sn===p.sn&&(E.sn<r.endSN?(E=b[E.sn+1-r.startSN],B.b.log("SN just loaded, load next one: "+E.sn)):E=null))}E&&(E.encrypted?(B.b.log("Loading key for "+E.sn+" of ["+r.startSN+" ,"+r.endSN+"],track "+y),this.state=ei,a.trigger(M.a.KEY_LOADING,{frag:E})):(B.b.log("Loading "+E.sn+", cc: "+E.cc+" of ["+r.startSN+" ,"+r.endSN+"],track "+y+", currentTime:"+i+",bufferEnd:"+f.toFixed(3)),!v&&this.fragmentTracker.getState(E)!==ee||(this.fragCurrent=E,this.startFragRequested=!0,Object(N.a)(E.sn)&&(this.nextLoadPosition=E.start+E.duration),a.trigger(M.a.FRAG_LOADING,{frag:E}),this.state=ti)))}break;case ni:(n=this.tracks[this.trackId])&&n.details&&(this.state=Qt);break;case ii:var x=Xt.now(),P=this.retryDate,L=(l=this.media)&&l.seeking;(!P||P<=x||L)&&(B.b.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=Qt);break;case ui:var R=this.videoTrackCC;if(void 0===this.initPTS[R])break;var O=this.waitingFragment;if(O){var D=O.frag.cc;R!==D?(n=this.tracks[this.trackId]).details&&n.details.live&&(B.b.warn("Waiting fragment CC ("+D+") does not match video track CC ("+R+")"),this.waitingFragment=null,this.state=Qt):(this.state=ti,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=Qt}},ci.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var i=this.config;this.tracks&&i.autoStartLoad&&this.startLoad(i.startPosition)},ci.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(B.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.stopLoad()},ci.prototype.onMediaSeeking=function(){this.state===oi&&(this.state=Qt),this.media&&(this.lastCurrentTime=this.media.currentTime),this.tick()},ci.prototype.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},ci.prototype.onAudioTracksUpdated=function(e){B.b.log("audio tracks updated"),this.tracks=e.audioTracks},ci.prototype.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.state=Zt,this.waitingFragment=null,t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=Qt),this.tick()},ci.prototype.onAudioTrackLoaded=function(e){var t=e.details,i=e.id,n=this.tracks[i],r=t.totalduration,a=0;if(B.b.log("track "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+r),t.live){var s=n.details;s&&0<t.fragments.length?(Ee(s,t),a=t.fragments[0].start,t.PTSKnown?B.b.log("live audio playlist sliding:"+a.toFixed(3)):B.b.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,B.b.log("live audio playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(n.details=t,!this.startFragRequested){if(-1===this.startPosition){var o=t.startTimeOffset;Object(N.a)(o)?(B.b.log("start time offset found in playlist, adjust startPosition to "+o),this.startPosition=o):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===ni&&(this.state=Qt),this.tick()},ci.prototype.onKeyLoaded=function(){this.state===ei&&(this.state=Qt,this.tick())},ci.prototype.onFragLoaded=function(e){var t=this.fragCurrent,i=e.frag;if(this.state===ti&&t&&"audio"===i.type&&i.level===t.level&&i.sn===t.sn){var n=this.tracks[this.trackId],r=n.details,a=r.totalduration,s=t.level,o=t.sn,l=t.cc,u=this.config.defaultAudioCodec||n.audioCodec||"mp4a.40.2",c=this.stats=e.stats;if("initSegment"===o)this.state=Qt,c.tparsed=c.tbuffered=Xt.now(),r.initSegment.data=e.payload,this.hls.trigger(M.a.FRAG_BUFFERED,{stats:c,frag:t,id:"audio"}),this.tick();else{this.state=ri,this.appended=!1,this.demuxer||(this.demuxer=new be(this.hls,"audio"));var h=this.initPTS[l],d=r.initSegment?r.initSegment.data:[];r.initSegment||void 0!==h?(this.pendingBuffering=!0,B.b.log("Demuxing "+o+" of ["+r.startSN+" ,"+r.endSN+"],track "+s),this.demuxer.push(e.payload,d,u,null,t,a,!1,h)):(B.b.log("unknown video PTS for continuity counter "+l+", waiting for video PTS before demuxing audio frag "+o+" of ["+r.startSN+" ,"+r.endSN+"],track "+s),this.waitingFragment=e,this.state=ui)}}this.fragLoadError=0},ci.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,i=e.frag;if(t&&"audio"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===ri){var n=e.tracks,r=void 0;if(n.video&&delete n.video,r=n.audio){r.levelCodec=r.codec,r.id=e.id,this.hls.trigger(M.a.BUFFER_CODECS,n),B.b.log("audio track:audio,container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var a=r.initSegment;if(a){var s={type:"audio",data:a,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[s]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(M.a.BUFFER_APPENDING,s))}this.tick()}}},ci.prototype.onFragParsingData=function(t){var i=this,e=this.fragCurrent,n=t.frag;if(e&&"audio"===t.id&&"audio"===t.type&&n.sn===e.sn&&n.level===e.level&&this.state===ri){var r=this.trackId,a=this.tracks[r],s=this.hls;Object(N.a)(t.endPTS)||(t.endPTS=t.startPTS+e.duration,t.endDTS=t.startDTS+e.duration),e.addElementaryStream(I.ElementaryStreamTypes.AUDIO),B.b.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb),Se(a.details,e,t.startPTS,t.endPTS);var o=this.audioSwitch,l=this.media,u=!1;if(o&&l)if(l.readyState){var c=l.currentTime;B.b.log("switching audio track : currentTime:"+c),c>=t.startPTS&&(B.b.log("switching audio track : flushing all audio"),this.state=si,s.trigger(M.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),u=!0,this.audioSwitch=!1,s.trigger(M.a.AUDIO_TRACK_SWITCHED,{id:r}))}else this.audioSwitch=!1,s.trigger(M.a.AUDIO_TRACK_SWITCHED,{id:r});var h=this.pendingData;if(!h)return B.b.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void s.trigger(M.a.ERROR,{type:d.b.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([t.data1,t.data2].forEach(function(e){e&&e.length&&h.push({type:t.type,data:e,parent:"audio",content:"data"})}),!u&&h.length&&(h.forEach(function(e){i.state===ri&&(i.pendingBuffering=!0,i.hls.trigger(M.a.BUFFER_APPENDING,e))}),this.pendingData=[],this.appended=!0)),this.tick()}},ci.prototype.onFragParsed=function(e){var t=this.fragCurrent,i=e.frag;t&&"audio"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===ri&&(this.stats.tparsed=Xt.now(),this.state=ai,this._checkAppendedParsed())},ci.prototype.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},ci.prototype.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},ci.prototype.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==ri&&t!==ai||(this.pendingBuffering=0<e.pending,this._checkAppendedParsed())}},ci.prototype._checkAppendedParsed=function(){if(!(this.state!==ai||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,i=this.hls;if(e){this.fragPrevious=e,t.tbuffered=Xt.now(),i.trigger(M.a.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var n=this.mediaBuffer?this.mediaBuffer:this.media;B.b.log("audio buffered : "+Ae.toString(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,i.trigger(M.a.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=Qt}this.tick()}},ci.prototype.onError=function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case d.a.FRAG_LOAD_ERROR:case d.a.FRAG_LOAD_TIMEOUT:var i=e.frag;if(i&&"audio"!==i.type)break;if(!e.fatal){var n=this.fragLoadError;n?n++:n=1;var r=this.config;if(n<=r.fragLoadingMaxRetry){this.fragLoadError=n;var a=Math.min(Math.pow(2,n-1)*r.fragLoadingRetryDelay,r.fragLoadingMaxRetryTimeout);B.b.warn("AudioStreamController: frag loading failed, retry in "+a+" ms"),this.retryDate=Xt.now()+a,this.state=ii}else B.b.error("AudioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=li}break;case d.a.AUDIO_TRACK_LOAD_ERROR:case d.a.AUDIO_TRACK_LOAD_TIMEOUT:case d.a.KEY_LOAD_ERROR:case d.a.KEY_LOAD_TIMEOUT:this.state!==li&&(this.state=e.fatal?li:Qt,B.b.warn("AudioStreamController: "+e.details+" while loading frag, now switching to "+this.state+" state ..."));break;case d.a.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===ri||this.state===ai)){var s=this.mediaBuffer,o=this.media.currentTime;if(s&&oe.isBuffered(s,o)&&oe.isBuffered(s,o+.5)){var l=this.config;l.maxMaxBufferLength>=l.maxBufferLength&&(l.maxMaxBufferLength/=2,B.b.warn("AudioStreamController: reduce max buffer length to "+l.maxMaxBufferLength+"s")),this.state=Qt}else B.b.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=si,this.hls.trigger(M.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},ci.prototype.onBufferFlushed=function(){var t=this,e=this.pendingData;e&&e.length?(B.b.log("AudioStreamController: appending pending audio data after buffer flushed"),e.forEach(function(e){t.hls.trigger(M.a.BUFFER_APPENDING,e)}),this.appended=!0,this.pendingData=[],this.state=ai):(this.state=Qt,this.fragPrevious=null,this.tick())},qt(ci,[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,B.b.log("audio stream:"+t+"->"+e)}},get:function(){return this._state}}]),ci),fi=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var _={"":!0,lr:!0,rl:!0},t={start:!0,middle:!0,end:!0,left:!0,right:!0};function T(e){return"string"==typeof e&&(!!t[e.toLowerCase()]&&e.toLowerCase())}function S(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}function e(e,t,i){var n=this,r=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),a={};r?n=document.createElement("custom"):a.enumerable=!0,n.hasBeenReset=!1;var s="",o=!1,l=e,u=t,c=i,h=null,d="",f=!0,p="auto",m="start",g=50,v="middle",y=50,b="middle";if(Object.defineProperty(n,"id",S({},a,{get:function(){return s},set:function(e){s=""+e}})),Object.defineProperty(n,"pauseOnExit",S({},a,{get:function(){return o},set:function(e){o=!!e}})),Object.defineProperty(n,"startTime",S({},a,{get:function(){return l},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");l=e,this.hasBeenReset=!0}})),Object.defineProperty(n,"endTime",S({},a,{get:function(){return u},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");u=e,this.hasBeenReset=!0}})),Object.defineProperty(n,"text",S({},a,{get:function(){return c},set:function(e){c=""+e,this.hasBeenReset=!0}})),Object.defineProperty(n,"region",S({},a,{get:function(){return h},set:function(e){h=e,this.hasBeenReset=!0}})),Object.defineProperty(n,"vertical",S({},a,{get:function(){return d},set:function(e){var t,i="string"==typeof(t=e)&&!!_[t.toLowerCase()]&&t.toLowerCase();if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");d=i,this.hasBeenReset=!0}})),Object.defineProperty(n,"snapToLines",S({},a,{get:function(){return f},set:function(e){f=!!e,this.hasBeenReset=!0}})),Object.defineProperty(n,"line",S({},a,{get:function(){return p},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");p=e,this.hasBeenReset=!0}})),Object.defineProperty(n,"lineAlign",S({},a,{get:function(){return m},set:function(e){var t=T(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");m=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"position",S({},a,{get:function(){return g},set:function(e){if(e<0||100<e)throw new Error("Position must be between 0 and 100.");g=e,this.hasBeenReset=!0}})),Object.defineProperty(n,"positionAlign",S({},a,{get:function(){return v},set:function(e){var t=T(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"size",S({},a,{get:function(){return y},set:function(e){if(e<0||100<e)throw new Error("Size must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(n,"align",S({},a,{get:function(){return b},set:function(e){var t=T(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),n.displayState=void 0,r)return n}return e.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},e}();function pi(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new hi,this.regionList=[]}function mi(){this.values=Object.create(null)}function gi(e,t,i,n){var r=n?e.split(n):[e];for(var a in r)if("string"==typeof r[a]){var s=r[a].split(i);if(2===s.length)t(s[0],s[1])}}mi.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,i){for(var n=0;n<i.length;++n)if(t===i[n]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var vi=new fi(0,0,0),yi="middle"===vi.align?"middle":"center";function bi(n,e,s){var r=n;function t(){var e,t=(e=n.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/))?e[3]?i(e[1],e[2],e[3].replace(":",""),e[4]):59<e[1]?i(e[1],e[2],0,e[4]):i(0,e[1],e[2],e[4]):null;function i(e,t,i,n){return 3600*(0|e)+60*(0|t)+(0|i)+(0|n)/1e3}if(null===t)throw new Error("Malformed timestamp: "+r);return n=n.replace(/^[^\sa-zA-Z-]+/,""),t}function i(){n=n.replace(/^\s+/,"")}if(i(),e.startTime=t(),i(),"--\x3e"!==n.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);n=n.substr(3),i(),e.endTime=t(),i(),function(e,t){var a=new mi;gi(e,function(e,t){switch(e){case"region":for(var i=s.length-1;0<=i;i--)if(s[i].id===t){a.set(e,s[i].region);break}break;case"vertical":a.alt(e,t,["rl","lr"]);break;case"line":var n=t.split(","),r=n[0];a.integer(e,r),a.percent(e,r)&&a.set("snapToLines",!1),a.alt(e,r,["auto"]),2===n.length&&a.alt("lineAlign",n[1],["start",yi,"end"]);break;case"position":n=t.split(","),a.percent(e,n[0]),2===n.length&&a.alt("positionAlign",n[1],["start",yi,"end","line-left","line-right","auto"]);break;case"size":a.percent(e,t);break;case"align":a.alt(e,t,["start",yi,"end","left","right"])}},/:/,/\s/),t.region=a.get("region",null),t.vertical=a.get("vertical","");var i=a.get("line","auto");"auto"===i&&-1===vi.line&&(i=-1),t.line=i,t.lineAlign=a.get("lineAlign","start"),t.snapToLines=a.get("snapToLines",!0),t.size=a.get("size",100),t.align=a.get("align",yi);var n=a.get("position","auto");"auto"===n&&50===vi.position&&(n="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=n}(n,e)}function _i(e){return e.replace(/<br(?: \/)?>/gi,"\n")}pi.prototype={parse:function(e){var n=this;function t(){var e=n.buffer,t=0;for(e=_i(e);t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var i=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,n.buffer=e.substr(t),i}e&&(n.buffer+=n.decoder.decode(e,{stream:!0}));try{var i=void 0;if("INITIAL"===n.state){if(!/\r\n|\n/.test(n.buffer))return this;var r=(i=t()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!r||!r[0])throw new Error("Malformed WebVTT signature.");n.state="HEADER"}for(var a=!1;n.buffer;){if(!/\r\n|\n/.test(n.buffer))return this;switch(a?a=!1:i=t(),n.state){case"HEADER":/:/.test(i)?gi(i,function(e,t){},/:/):i||(n.state="ID");continue;case"NOTE":i||(n.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){n.state="NOTE";break}if(!i)continue;if(n.cue=new fi(0,0,""),n.state="CUE",-1===i.indexOf("--\x3e")){n.cue.id=i;continue}case"CUE":try{bi(i,n.cue,n.regionList)}catch(e){n.cue=null,n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":var s=-1!==i.indexOf("--\x3e");if(!i||s&&(a=!0)){n.oncue&&n.oncue(n.cue),n.cue=null,n.state="ID";continue}n.cue.text&&(n.cue.text+="\n"),n.cue.text+=i;continue;case"BADCUE":i||(n.state="ID");continue}}}catch(e){"CUETEXT"===n.state&&n.cue&&n.oncue&&n.oncue(n.cue),n.cue=null,n.state="INITIAL"===n.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),!this.cue&&"HEADER"!==this.state||(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return this.onflush&&this.onflush(),this}};var Ti=pi;function Si(e,t,i,n){for(var r=void 0,a=void 0,s=void 0,o=void 0,l=void 0,u=window.VTTCue||window.TextTrackCue,c=0;c<n.rows.length;c++)if(s=!0,o=0,l="",!(r=n.rows[c]).isEmpty()){for(var h=0;h<r.chars.length;h++)r.chars[h].uchar.match(/\s/)&&s?o++:(l+=r.chars[h].uchar,s=!1);(r.cueStartTime=t)===i&&(i+=1e-4),a=new u(t,i,_i(l.trim())),16<=o?o--:o++,navigator.userAgent.match(/Firefox\//)?a.line=c+1:a.line=7<c?c-2:c+1,a.align="left",a.position=Math.max(0,Math.min(100,o/32*100+(navigator.userAgent.match(/Firefox\//)?50:0))),e.addCue(a)}}function Ei(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wi(e){var t=e;return ki.hasOwnProperty(e)&&(t=ki[e]),String.fromCharCode(t)}function Ci(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].toString(16));return t}var ki={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Ai={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Ii={17:2,18:4,21:6,22:8,23:10,19:13,20:15},xi={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Pi={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Li=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],Ri={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e){this.verboseFilter[e];this.verboseLevel}},Oi=(Di.prototype.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},Di.prototype.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],i=0;i<t.length;i++){var n=t[i];e.hasOwnProperty(n)&&(this[n]=e[n])}},Di.prototype.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},Di.prototype.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},Di.prototype.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},Di.prototype.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},Di);function Di(e,t,i,n,r){Ei(this,Di),this.foreground=e||"white",this.underline=t||!1,this.italics=i||!1,this.background=n||"black",this.flash=r||!1}var Ni=(Mi.prototype.reset=function(){this.uchar=" ",this.penState.reset()},Mi.prototype.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},Mi.prototype.setPenState=function(e){this.penState.copy(e)},Mi.prototype.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},Mi.prototype.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},Mi.prototype.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},Mi);function Mi(e,t,i,n,r,a){Ei(this,Mi),this.uchar=e||" ",this.penState=new Oi(t,i,n,r,a)}var Bi=(Ui.prototype.equals=function(e){for(var t=!0,i=0;i<100;i++)if(!this.chars[i].equals(e.chars[i])){t=!1;break}return t},Ui.prototype.copy=function(e){for(var t=0;t<100;t++)this.chars[t].copy(e.chars[t])},Ui.prototype.isEmpty=function(){for(var e=!0,t=0;t<100;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},Ui.prototype.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(Ri.log("ERROR","Negative cursor position "+this.pos),this.pos=0):100<this.pos&&(Ri.log("ERROR","Too large cursor position "+this.pos),this.pos=100)},Ui.prototype.moveCursor=function(e){var t=this.pos+e;if(1<e)for(var i=this.pos+1;i<t+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(t)},Ui.prototype.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},Ui.prototype.insertChar=function(e){144<=e&&this.backSpace();var t=wi(e);100<=this.pos?Ri.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},Ui.prototype.clearFromPos=function(e){var t=void 0;for(t=e;t<100;t++)this.chars[t].reset()},Ui.prototype.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},Ui.prototype.clearToEndOfRow=function(){this.clearFromPos(this.pos)},Ui.prototype.getTextString=function(){for(var e=[],t=!0,i=0;i<100;i++){var n=this.chars[i].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")},Ui.prototype.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},Ui);function Ui(){Ei(this,Ui),this.chars=[];for(var e=0;e<100;e++)this.chars.push(new Ni);this.pos=0,this.currPenState=new Oi}var Fi=(ji.prototype.reset=function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},ji.prototype.equals=function(e){for(var t=!0,i=0;i<15;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t},ji.prototype.copy=function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},ji.prototype.isEmpty=function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},ji.prototype.backSpace=function(){this.rows[this.currRow].backSpace()},ji.prototype.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},ji.prototype.insertChar=function(e){this.rows[this.currRow].insertChar(e)},ji.prototype.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},ji.prototype.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},ji.prototype.setCursor=function(e){Ri.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},ji.prototype.setPAC=function(e){Ri.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var i=0;i<15;i++)this.rows[i].clear();var n=this.currRow+1-this.nrRollUpRows,r=this.lastOutputScreen;if(r){var a=r.rows[n].cueStartTime;if(a&&a<Ri.time)for(var s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(r.rows[n+s])}}this.currRow=t;var o=this.rows[this.currRow];if(null!==e.indent){var l=e.indent,u=Math.max(l-1,0);o.setCursor(e.indent),e.color=o.chars[u].penState.foreground}var c={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(c)},ji.prototype.setBkgData=function(e){Ri.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},ji.prototype.setRollUpRows=function(e){this.nrRollUpRows=e},ji.prototype.rollUp=function(){if(null!==this.nrRollUpRows){Ri.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),Ri.log("INFO","Rolling up")}else Ri.log("DEBUG","roll_up but nrRollUpRows not set yet")},ji.prototype.getDisplayText=function(e){e=e||!1;for(var t=[],i="",n=-1,r=0;r<15;r++){var a=this.rows[r].getTextString();a&&(n=r+1,e?t.push("Row "+n+": '"+a+"'"):t.push(a.trim()))}return 0<t.length&&(i=e?"["+t.join(" | ")+"]":t.join("\n")),i},ji.prototype.getTextAndFormat=function(){return this.rows},ji);function ji(){Ei(this,ji),this.rows=[];for(var e=0;e<15;e++)this.rows.push(new Bi);this.currRow=14,this.nrRollUpRows=null,this.reset()}var Hi=(Gi.prototype.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},Gi.prototype.getHandler=function(){return this.outputFilter},Gi.prototype.setHandler=function(e){this.outputFilter=e},Gi.prototype.setPAC=function(e){this.writeScreen.setPAC(e)},Gi.prototype.setBkgData=function(e){this.writeScreen.setBkgData(e)},Gi.prototype.setMode=function(e){e!==this.mode&&(this.mode=e,Ri.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},Gi.prototype.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";Ri.log("INFO",i+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(Ri.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},Gi.prototype.ccRCL=function(){Ri.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},Gi.prototype.ccBS=function(){Ri.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},Gi.prototype.ccAOF=function(){},Gi.prototype.ccAON=function(){},Gi.prototype.ccDER=function(){Ri.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},Gi.prototype.ccRU=function(e){Ri.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},Gi.prototype.ccFON=function(){Ri.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},Gi.prototype.ccRDC=function(){Ri.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},Gi.prototype.ccTR=function(){Ri.log("INFO","TR"),this.setMode("MODE_TEXT")},Gi.prototype.ccRTD=function(){Ri.log("INFO","RTD"),this.setMode("MODE_TEXT")},Gi.prototype.ccEDM=function(){Ri.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},Gi.prototype.ccCR=function(){Ri.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},Gi.prototype.ccENM=function(){Ri.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},Gi.prototype.ccEOC=function(){if(Ri.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,Ri.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},Gi.prototype.ccTO=function(e){Ri.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},Gi.prototype.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=46<=e,t.italics)t.foreground="white";else{var i=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][i]}Ri.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},Gi.prototype.outputDataUpdate=function(e){Ri.time},Gi.prototype.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},Gi);function Gi(e,t){Ei(this,Gi),this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Fi,this.nonDisplayedMemory=new Fi,this.lastOutputScreen=new Fi,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}function Vi(e,t,i){Ei(this,Vi),this.field=e||1,this.outputs=[t,i],this.channels=[new Hi(1,t),new Hi(2,i)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}var Ki=(Vi.prototype.getHandler=function(e){return this.channels[e].getHandler()},Vi.prototype.setHandler=function(e,t){this.channels[e].setHandler(t)},Vi.prototype.addData=function(e,t){var i=void 0,n=void 0,r=void 0,a=!1;this.lastTime=e,Ri.setTime(e);for(var s=0;s<t.length;s+=2)n=127&t[s],r=127&t[s+1],0!==n||0!==r?(Ri.log("DATA","["+Ci([t[s],t[s+1]])+"] -> ("+Ci([n,r])+")"),(i=(i=(i=(i=this.parseCmd(n,r))||this.parseMidrow(n,r))||this.parsePAC(n,r))||this.parseBackgroundAttributes(n,r))||(a=this.parseChars(n,r))&&(this.currChNr&&0<=this.currChNr?this.channels[this.currChNr-1].insertChars(a):Ri.log("WARNING","No channel found yet. TEXT-MODE?")),i?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,Ri.log("WARNING","Couldn't parse cleaned data "+Ci([n,r])+" orig: "+Ci([t[s],t[s+1]])))):this.dataCounters.padding+=2},Vi.prototype.parseCmd=function(e,t){var i=null;if(!((20===e||28===e)&&32<=t&&t<=47||(23===e||31===e)&&33<=t&&t<=35))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,Ri.log("DEBUG","Repeated command ("+Ci([e,t])+") is dropped"),!0;i=20===e||23===e?1:2;var n=this.channels[i-1];return 20===e||28===e?32===t?n.ccRCL():33===t?n.ccBS():34===t?n.ccAOF():35===t?n.ccAON():36===t?n.ccDER():37===t?n.ccRU(2):38===t?n.ccRU(3):39===t?n.ccRU(4):40===t?n.ccFON():41===t?n.ccRDC():42===t?n.ccTR():43===t?n.ccRTD():44===t?n.ccEDM():45===t?n.ccCR():46===t?n.ccENM():47===t&&n.ccEOC():n.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=i,!0},Vi.prototype.parseMidrow=function(e,t){var i=null;return(17===e||25===e)&&32<=t&&t<=47&&((i=17===e?1:2)!==this.currChNr?(Ri.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[i-1].ccMIDROW(t),Ri.log("DEBUG","MIDROW ("+Ci([e,t])+")"),!0))},Vi.prototype.parsePAC=function(e,t){var i,n=null;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127||(16===e||24===e)&&64<=t&&t<=95))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,!(this.lastCmdB=null);i=e<=23?1:2,n=64<=t&&t<=95?1==i?Ai[e]:xi[e]:1==i?Ii[e]:Pi[e];var r=this.interpretPAC(n,t);return this.channels[i-1].setPAC(r),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=i,!0},Vi.prototype.interpretPAC=function(e,t){var i=t,n={color:null,italics:!1,indent:null,underline:!1,row:e};return i=95<t?t-96:t-64,n.underline=1==(1&i),i<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((i-16)/2),n},Vi.prototype.parseChars=function(e,t){var i=null,n=null,r=null;if(17<=(r=25<=e?(i=2,e-8):(i=1,e))&&r<=19){var a=t;a=17===r?t+80:18===r?t+112:t+144,Ri.log("INFO","Special char '"+wi(a)+"' in channel "+i),n=[a]}else 32<=e&&e<=127&&(n=0===t?[e]:[e,t]);if(n){var s=Ci(n);Ri.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return n},Vi.prototype.parseBackgroundAttributes=function(e,t){var i,n=void 0,r=void 0;return((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47)&&(n={},16===e||24===e?(r=Math.floor((t-32)/2),n.background=Li[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),i=e<24?1:2,this.channels[i-1].setBkgData(n),this.lastCmdA=null,!(this.lastCmdB=null))},Vi.prototype.reset=function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},Vi.prototype.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)},Vi);function Wi(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Wi),this.timelineController=e,this.trackName=t,this.startTime=null,this.endTime=null,this.screen=null}function qi(e,t,i){return e.substr(i||0,t.length)===t}function zi(e){for(var t=5381,i=e.length;i;)t=33*t^e.charCodeAt(--i);return(t>>>0).toString()}var Yi,Xi=(Wi.prototype.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen),this.startTime=null)},Wi.prototype.newCue=function(e,t,i){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)},Wi),$i={parse:function(e,s,n,r,t,i){var a=Object(lt.b)(new Uint8Array(e)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),o="00:00.000",l=0,u=0,c=0,h=[],d=void 0,f=!0,p=new Ti;p.oncue=function(e){var t=n[r],i=n.ccOffset;t&&t.new&&(void 0!==u?i=n.ccOffset=t.start:function(e,t,i){var n=e[t],r=e[n.prevCC];if(!r||!r.new&&n.new)return e.ccOffset=e.presentationOffset=n.start,n.new=!1;for(;r&&r.new;)e.ccOffset+=n.start-r.start,n.new=!1,r=e[(n=r).prevCC];e.presentationOffset=i}(n,r,c)),c&&(i=c+n.ccOffset-n.presentationOffset),e.startTime+=i-u,e.endTime+=i-u,e.id=zi(e.startTime.toString())+zi(e.endTime.toString())+zi(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),0<e.endTime&&h.push(e)},p.onparsingerror=function(e){d=e},p.onflush=function(){d&&i?i(d):t(h)},a.forEach(function(t){if(f){if(qi(t,"X-TIMESTAMP-MAP=")){f=!1,t.substr(16).split(",").forEach(function(e){qi(e,"LOCAL:")?o=e.substr(6):qi(e,"MPEGTS:")&&(l=parseInt(e.substr(7)))});try{l-=s=s<0?s+8589934592:s,e=o,i=parseInt(e.substr(-3)),n=parseInt(e.substr(-6,2)),r=parseInt(e.substr(-9,2)),a=9<e.length?parseInt(e.substr(0,e.indexOf(":"))):0,u=(Object(N.a)(i)&&Object(N.a)(n)&&Object(N.a)(r)&&Object(N.a)(a)?(i+=1e3*n,i+=6e4*r,i+=36e5*a):-1)/1e3,c=l/9e4,-1===u&&(d=new Error("Malformed X-TIMESTAMP-MAP: "+t))}catch(e){d=new Error("Malformed X-TIMESTAMP-MAP: "+t)}return}""===t&&(f=!1)}var e,i,n,r,a;p.parse(t+"\n")}),p.flush()}};function Ji(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Ji);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,Yi.call(this,e,M.a.MEDIA_ATTACHING,M.a.MEDIA_DETACHING,M.a.FRAG_PARSING_USERDATA,M.a.FRAG_DECRYPTED,M.a.MANIFEST_LOADING,M.a.MANIFEST_LOADED,M.a.FRAG_LOADED,M.a.LEVEL_SWITCHING,M.a.INIT_PTS_FOUND));if(t.hls=e,t.config=e.config,t.enabled=!0,t.Cues=e.config.cueHandler,t.textTracks=[],t.tracks=[],t.unparsedVttFrags=[],t.initPTS=void 0,t.cueRanges=[],t.captionsTracks={},t.captionsProperties={textTrack1:{label:t.config.captionsTextTrack1Label,languageCode:t.config.captionsTextTrack1LanguageCode},textTrack2:{label:t.config.captionsTextTrack2Label,languageCode:t.config.captionsTextTrack2LanguageCode}},t.config.enableCEA708Captions){var i=new Xi(t,"textTrack1"),n=new Xi(t,"textTrack2");t.cea608Parser=new Ki(0,i,n)}return t}var Qi,Zi=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Ji,Yi=u),Ji.prototype.addCues=function(e,t,i,n){for(var r,a,s,o,l=this.cueRanges,u=!1,c=l.length;c--;){var h=l[c],d=(r=h[0],a=h[1],s=t,o=i,Math.min(a,o)-Math.max(r,s));if(0<=d&&(h[0]=Math.min(h[0],t),h[1]=Math.max(h[1],i),u=!0,.5<d/(i-t)))return}u||l.push([t,i]),this.Cues.newCue(this.captionsTracks[e],t,i,n)},Ji.prototype.onInitPtsFound=function(e){var t=this;void 0===this.initPTS&&(this.initPTS=e.initPTS),this.unparsedVttFrags.length&&(this.unparsedVttFrags.forEach(function(e){t.onFragLoaded(e)}),this.unparsedVttFrags=[])},Ji.prototype.getExistingTrack=function(e){var t=this.media;if(t)for(var i=0;i<t.textTracks.length;i++){var n=t.textTracks[i];if(n[e])return n}return null},Ji.prototype.createCaptionsTrack=function(e){var t=this.captionsProperties[e],i=t.label,n=t.languageCode,r=this.captionsTracks;if(!r[e]){var a=this.getExistingTrack(e);if(a)r[e]=a,ct(r[e]),ut(r[e],this.media);else{var s=this.createTextTrack("captions",i,n);s&&(s[e]=!0,r[e]=s)}}},Ji.prototype.createTextTrack=function(e,t,i){var n=this.media;if(n)return n.addTextTrack(e,t,i)},Ji.prototype.destroy=function(){u.prototype.destroy.call(this)},Ji.prototype.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},Ji.prototype.onMediaDetaching=function(){var t=this.captionsTracks;Object.keys(t).forEach(function(e){ct(t[e]),delete t[e]})},Ji.prototype.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0},this._cleanTracks()},Ji.prototype._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var i=0;i<t.length;i++)ct(t[i])}},Ji.prototype.onManifestLoaded=function(e){var s=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=void 0,this.cueRanges=[],this.config.enableWebVTT){this.tracks=e.subtitles||[];var o=this.media?this.media.textTracks:[];this.tracks.forEach(function(e,t){var i,n,r=void 0;if(t<o.length){var a=o[t];n=e,!(i=a)||i.label!==n.name||i.textTrack1||i.textTrack2||(r=a)}r=r||s.createTextTrack("subtitles",e.name,e.lang),e.default?r.mode=s.hls.subtitleDisplay?"showing":"hidden":r.mode="disabled",s.textTracks.push(r)})}},Ji.prototype.onLevelSwitching=function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions},Ji.prototype.onFragLoaded=function(e){var t=e.frag,i=e.payload;if("main"===t.type){var n=t.sn;if(n!==this.lastSn+1){var r=this.cea608Parser;r&&r.reset()}this.lastSn=n}else if("subtitle"===t.type)if(i.byteLength){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(e);var a=t.decryptdata;null!=a&&null!=a.key&&"AES-128"===a.method||this._parseVTTs(t,i)}else this.hls.trigger(M.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},Ji.prototype._parseVTTs=function(t,e){var i=this.vttCCs;i[t.cc]||(i[t.cc]={start:t.start,prevCC:this.prevCC,new:!0},this.prevCC=t.cc);var r=this.textTracks,a=this.hls;$i.parse(e,this.initPTS,i,t.cc,function(e){var n=r[t.trackId];"disabled"!==n.mode?(e.forEach(function(t){if(!n.cues.getCueById(t.id))try{n.addCue(t)}catch(e){var i=new window.TextTrackCue(t.startTime,t.endTime,t.text);i.id=t.id,n.addCue(i)}}),a.trigger(M.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})):a.trigger(M.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},function(e){B.b.log("Failed to parse VTT cue: "+e),a.trigger(M.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})})},Ji.prototype.onFragDecrypted=function(e){var t=e.payload,i=e.frag;if("subtitle"===i.type){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(e);this._parseVTTs(i,t)}},Ji.prototype.onFragParsingUserdata=function(e){if(this.enabled&&this.config.enableCEA708Captions)for(var t=0;t<e.samples.length;t++){var i=this.extractCea608Data(e.samples[t].bytes);this.cea608Parser.addData(e.samples[t].pts,i)}},Ji.prototype.extractCea608Data=function(e){for(var t=31&e[0],i=2,n=void 0,r=void 0,a=void 0,s=[],o=0;o<t;o++)n=e[i++],r=127&e[i++],a=127&e[i++],0===r&&0===a||0!=(4&n)&&0==(3&n)&&(s.push(r),s.push(a));return s},Ji),en=function(e,t,i){return t&&tn(e.prototype,t),i&&tn(e,i),e};function tn(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nn(e){for(var t=[],i=0;i<e.length;i++)"subtitles"===e[i].kind&&t.push(e[i]);return t}function rn(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,rn);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,Qi.call(this,e,M.a.MEDIA_ATTACHED,M.a.MEDIA_DETACHING,M.a.MANIFEST_LOADING,M.a.MANIFEST_LOADED,M.a.SUBTITLE_TRACK_LOADED));return t.tracks=[],t.trackId=-1,t.media=null,t.subtitleDisplay=!0,t}var an=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(rn,Qi=u),rn.prototype._onTextTracksChanged=function(){if(this.media){for(var e=-1,t=nn(this.media.textTracks),i=0;i<t.length;i++)if("hidden"===t[i].mode)e=i;else if("showing"===t[i].mode){e=i;break}this.subtitleTrack=e}},rn.prototype.destroy=function(){u.prototype.destroy.call(this)},rn.prototype.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,delete this.queuedDefaultTrack),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){t.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},rn.prototype.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=null)},rn.prototype.onManifestLoading=function(){this.tracks=[],this.trackId=-1},rn.prototype.onManifestLoaded=function(e){var t=this,i=e.subtitles||[];this.tracks=i,this.trackId=-1,this.hls.trigger(M.a.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:i}),i.forEach(function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)})},rn.prototype.onTick=function(){var e=this.trackId,t=this.tracks[e];if(t){var i=t.details;i&&!i.live||(B.b.log("(re)loading playlist for subtitle track "+e),this.hls.trigger(M.a.SUBTITLE_TRACK_LOADING,{url:t.url,id:e}))}},rn.prototype.onSubtitleTrackLoaded=function(e){var t=this;e.id<this.tracks.length&&(B.b.log("subtitle track "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.timer&&(this.timer=setInterval(function(){t.onTick()},1e3*e.details.targetduration,this)),!e.details.live&&this.timer&&this._stopTimer())},rn.prototype.setSubtitleTrackInternal=function(e){var t=this.hls,i=this.tracks;if(!("number"!=typeof e||e<-1||e>=i.length)&&(this._stopTimer(),this.trackId=e,B.b.log("switching to subtitle track "+e),t.trigger(M.a.SUBTITLE_TRACK_SWITCH,{id:e}),-1!==e)){var n=i[e],r=n.details;r&&!r.live||(B.b.log("(re)loading playlist for subtitle track "+e),t.trigger(M.a.SUBTITLE_TRACK_LOADING,{url:n.url,id:e}))}},rn.prototype._stopTimer=function(){this.timer&&(clearInterval(this.timer),this.timer=null)},rn.prototype._toggleTrackModes=function(e){var t=this.media,i=this.subtitleDisplay,n=this.trackId;if(t){var r=nn(t.textTracks);if(-1===e)[].slice.call(r).forEach(function(e){e.mode="disabled"});else{var a=r[n];a&&(a.mode="disabled")}var s=r[e];s&&(s.mode=i?"showing":"hidden")}},en(rn,[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this.setSubtitleTrackInternal(e))}}]),rn),sn=i(8);var on,ln=window.performance,un="STOPPED",cn="IDLE",hn="KEY_LOADING",dn="FRAG_LOADING";function fn(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,fn);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,on.call(this,e,M.a.MEDIA_ATTACHED,M.a.ERROR,M.a.KEY_LOADED,M.a.FRAG_LOADED,M.a.SUBTITLE_TRACKS_UPDATED,M.a.SUBTITLE_TRACK_SWITCH,M.a.SUBTITLE_TRACK_LOADED,M.a.SUBTITLE_FRAG_PROCESSED));return t.config=e.config,t.vttFragSNsProcessed={},t.vttFragQueues=void 0,t.currentlyProcessing=null,t.state=un,t.currentTrackId=-1,t.decrypter=new sn.a(e.observer,e.config),t}var pn=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(fn,on=De),fn.prototype.onHandlerDestroyed=function(){this.state=un},fn.prototype.clearVttFragQueues=function(){var t=this;this.vttFragQueues={},this.tracks.forEach(function(e){t.vttFragQueues[e.id]=[]})},fn.prototype.nextFrag=function(){if(null===this.currentlyProcessing&&-1<this.currentTrackId&&this.vttFragQueues[this.currentTrackId].length){var e=this.currentlyProcessing=this.vttFragQueues[this.currentTrackId].shift();this.fragCurrent=e,this.hls.trigger(M.a.FRAG_LOADING,{frag:e}),this.state=dn}},fn.prototype.onSubtitleFragProcessed=function(e){e.success&&this.vttFragSNsProcessed[e.frag.trackId].push(e.frag.sn),this.currentlyProcessing=null,this.state=cn,this.nextFrag()},fn.prototype.onMediaAttached=function(){this.state=cn},fn.prototype.onError=function(e){var t=e.frag;t&&"subtitle"!==t.type||this.currentlyProcessing&&(this.currentlyProcessing=null,this.nextFrag())},fn.prototype.doTick=function(){var n=this;switch(this.state){case cn:var e,t=this.tracks,r=this.currentTrackId,a=this.vttFragSNsProcessed[r],s=this.vttFragQueues[r],o=this.currentlyProcessing?this.currentlyProcessing.sn:-1;if(!t)break;if(r<t.length&&(e=t[r].details),void 0===e)break;e.fragments.forEach(function(e){var t,i;i=e,-1<a.indexOf(i.sn)||e.sn===o||(t=e,s.some(function(e){return e.sn===t.sn}))||(e.encrypted?(B.b.log("Loading key for "+e.sn),n.state=hn,n.hls.trigger(M.a.KEY_LOADING,{frag:e})):(e.trackId=r,s.push(e),n.nextFrag()))})}},fn.prototype.onSubtitleTracksUpdated=function(e){var t=this;B.b.log("subtitle tracks updated"),this.tracks=e.subtitleTracks,this.clearVttFragQueues(),this.vttFragSNsProcessed={},this.tracks.forEach(function(e){t.vttFragSNsProcessed[e.id]=[]})},fn.prototype.onSubtitleTrackSwitch=function(e){if(this.currentTrackId=e.id,this.tracks&&-1!==this.currentTrackId){var t=this.tracks[this.currentTrackId];t&&t.details&&this.tick()}},fn.prototype.onSubtitleTrackLoaded=function(){this.tick()},fn.prototype.onKeyLoaded=function(){this.state===hn&&(this.state=cn,this.tick())},fn.prototype.onFragLoaded=function(e){var t=this.fragCurrent,i=e.frag.decryptdata,n=e.frag,r=this.hls;if(this.state===dn&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&0<e.payload.byteLength&&null!=i&&null!=i.key&&"AES-128"===i.method){var a=void 0;try{a=ln.now()}catch(e){a=Date.now()}this.decrypter.decrypt(e.payload,i.key.buffer,i.iv.buffer,function(e){var t=void 0;try{t=ln.now()}catch(e){t=Date.now()}r.trigger(M.a.FRAG_DECRYPTED,{frag:n,payload:e,stats:{tstart:a,tdecrypt:t}})})}},fn),mn=function(e,t,i){return t&&gn(e.prototype,t),i&&gn(e,i),e};function gn(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vn(e,t,i){switch(e){case _n:return n={videoCapabilities:[]},i.forEach(function(e){n.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"'})}),[n];default:throw Error("Unknown key-system: "+e)}var n}var yn,bn=window.XMLHttpRequest,_n="com.widevine.alpha",Tn="com.microsoft.playready";function Sn(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Sn);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,yn.call(this,e,M.a.MEDIA_ATTACHED,M.a.MANIFEST_PARSED));return t._widevineLicenseUrl=e.config.widevineLicenseUrl,t._licenseXhrSetup=e.config.licenseXhrSetup,t._emeEnabled=e.config.emeEnabled,t._requestMediaKeySystemAccess=e.config.requestMediaKeySystemAccessFunc,t._mediaKeysList=[],t._media=null,t._hasSetMediaKeys=!1,t._isMediaEncrypted=!1,t._requestLicenseFailureCount=0,t}var En=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Sn,yn=u),Sn.prototype.getLicenseServerUrl=function(e){var t=void 0;switch(e){case _n:t=this._widevineLicenseUrl;break;default:t=null}return t||(B.b.error('No license server URL configured for key-system "'+e+'"'),this.hls.trigger(M.a.ERROR,{type:d.b.KEY_SYSTEM_ERROR,details:d.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})),t},Sn.prototype._attemptKeySystemAccess=function(t,e,i){var n=this,r=vn(t,0,i);r?(B.b.log("Requesting encrypted media key-system access"),this.requestMediaKeySystemAccess(t,r).then(function(e){n._onMediaKeySystemAccessObtained(t,e)}).catch(function(e){B.b.error('Failed to obtain key-system "'+t+'" access:',e)})):B.b.warn("Can not create config for key-system (maybe because platform is not supported):",t)},Sn.prototype._onMediaKeySystemAccessObtained=function(t,e){var i=this;B.b.log('Access for key-system "'+t+'" obtained');var n={mediaKeys:null,mediaKeysSession:null,mediaKeysSessionInitialized:!1,mediaKeySystemAccess:e,mediaKeySystemDomain:t};this._mediaKeysList.push(n),e.createMediaKeys().then(function(e){n.mediaKeys=e,B.b.log('Media-keys created for key-system "'+t+'"'),i._onMediaKeysCreated()}).catch(function(e){B.b.error("Failed to create media-keys:",e)})},Sn.prototype._onMediaKeysCreated=function(){var t=this;this._mediaKeysList.forEach(function(e){e.mediaKeysSession||(e.mediaKeysSession=e.mediaKeys.createSession(),t._onNewMediaKeySession(e.mediaKeysSession))})},Sn.prototype._onNewMediaKeySession=function(t){var i=this;B.b.log("New key-system session "+t.sessionId),t.addEventListener("message",function(e){i._onKeySessionMessage(t,e.message)},!1)},Sn.prototype._onKeySessionMessage=function(t,e){B.b.log("Got EME message event, creating license request"),this._requestLicense(e,function(e){B.b.log("Received license data, updating key-session"),t.update(e)})},Sn.prototype._onMediaEncrypted=function(e,t){B.b.log('Media is encrypted using "'+e+'" init data type'),this._isMediaEncrypted=!0,this._mediaEncryptionInitDataType=e,this._mediaEncryptionInitData=t,this._attemptSetMediaKeys(),this._generateRequestWithPreferredKeySession()},Sn.prototype._attemptSetMediaKeys=function(){if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys)return B.b.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(M.a.ERROR,{type:d.b.KEY_SYSTEM_ERROR,details:d.a.KEY_SYSTEM_NO_KEYS,fatal:!0});B.b.log("Setting keys for encrypted media"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},Sn.prototype._generateRequestWithPreferredKeySession=function(){var t=this,e=this._mediaKeysList[0];if(!e)return B.b.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(M.a.ERROR,{type:d.b.KEY_SYSTEM_ERROR,details:d.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(e.mediaKeysSessionInitialized)B.b.warn("Key-Session already initialized but requested again");else{var i=e.mediaKeysSession;i||(B.b.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(M.a.ERROR,{type:d.b.KEY_SYSTEM_ERROR,details:d.a.KEY_SYSTEM_NO_SESSION,fatal:!0}));var n=this._mediaEncryptionInitDataType,r=this._mediaEncryptionInitData;B.b.log('Generating key-session request for "'+n+'" init data type'),e.mediaKeysSessionInitialized=!0,i.generateRequest(n,r).then(function(){B.b.debug("Key-session generation succeeded")}).catch(function(e){B.b.error("Error generating key-session request:",e),t.hls.trigger(M.a.ERROR,{type:d.b.KEY_SYSTEM_ERROR,details:d.a.KEY_SYSTEM_NO_SESSION,fatal:!1})})}},Sn.prototype._createLicenseXhr=function(t,e,i){var n=new bn,r=this._licenseXhrSetup;try{if(r)try{r(n,t)}catch(e){n.open("POST",t,!0),r(n,t)}n.readyState||n.open("POST",t,!0)}catch(e){return B.b.error("Error setting up key-system license XHR",e),void this.hls.trigger(M.a.ERROR,{type:d.b.KEY_SYSTEM_ERROR,details:d.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}return n.responseType="arraybuffer",n.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,n,t,e,i),n},Sn.prototype._onLicenseRequestReadyStageChange=function(e,t,i,n){switch(e.readyState){case 4:if(200===e.status)this._requestLicenseFailureCount=0,B.b.log("License request succeeded"),n(e.response);else{if(B.b.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount<=3){var r=3-this._requestLicenseFailureCount+1;return B.b.warn("Retrying license request, "+r+" attempts left"),void this._requestLicense(i,n)}this.hls.trigger(M.a.ERROR,{type:d.b.KEY_SYSTEM_ERROR,details:d.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}}},Sn.prototype._generateLicenseRequestChallenge=function(e,t){var i=void 0;return e.mediaKeySystemDomain===Tn?B.b.error("PlayReady is not supported (yet)"):e.mediaKeySystemDomain===_n?i=t:B.b.error("Unsupported key-system:",e.mediaKeySystemDomain),i},Sn.prototype._requestLicense=function(e,t){B.b.log("Requesting content license for key-system");var i=this._mediaKeysList[0];if(!i)return B.b.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(M.a.ERROR,{type:d.b.KEY_SYSTEM_ERROR,details:d.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});var n=this.getLicenseServerUrl(i.mediaKeySystemDomain),r=this._createLicenseXhr(n,e,t);B.b.log("Sending license request to URL: "+n),r.send(this._generateLicenseRequestChallenge(i,e))},Sn.prototype.onMediaAttached=function(e){var t=this;if(this._emeEnabled){var i=e.media;(this._media=i).addEventListener("encrypted",function(e){t._onMediaEncrypted(e.initDataType,e.initData)})}},Sn.prototype.onManifestParsed=function(e){if(this._emeEnabled){var t=e.levels.map(function(e){return e.audioCodec}),i=e.levels.map(function(e){return e.videoCodec});this._attemptKeySystemAccess(_n,t,i)}},mn(Sn,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),Sn),wn={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Ht,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:St,bufferController:At,capLevelController:Lt,fpsController:Nt,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:"undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null};wn.subtitleStreamController=pn,wn.subtitleTrackController=an,wn.timelineController=Zi,wn.cueHandler=n,wn.enableCEA708Captions=!0,wn.enableWebVTT=!0,wn.captionsTextTrack1Label="English",wn.captionsTextTrack1LanguageCode="en",wn.captionsTextTrack2Label="Spanish",wn.captionsTextTrack2LanguageCode="es",wn.audioStreamController=di,wn.audioTrackController=Wt,wn.emeController=En;var Cn=function(e,t,i){return t&&kn(e.prototype,t),i&&kn(e,i),e};function kn(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i(14);var An=(In.isSupported=function(){return e=pe(),t=window.SourceBuffer||window.WebKitSourceBuffer,i=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove,!!i&&!!n;var e,t,i,n},Cn(In,null,[{key:"version",get:function(){return"0.11.0"}},{key:"Events",get:function(){return M.a}},{key:"ErrorTypes",get:function(){return d.b}},{key:"ErrorDetails",get:function(){return d.a}},{key:"DefaultConfig",get:function(){return In.defaultConfig?In.defaultConfig:wn},set:function(e){In.defaultConfig=e}}]),In.prototype.destroy=function(){B.b.log("destroy"),this.trigger(M.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.observer.removeAllListeners(),this._autoLevelCapping=-1},In.prototype.attachMedia=function(e){B.b.log("attachMedia"),this.media=e,this.trigger(M.a.MEDIA_ATTACHING,{media:e})},In.prototype.detachMedia=function(){B.b.log("detachMedia"),this.trigger(M.a.MEDIA_DETACHING),this.media=null},In.prototype.loadSource=function(e){e=a.a.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),B.b.log("loadSource:"+e),this.url=e,this.trigger(M.a.MANIFEST_LOADING,{url:e})},In.prototype.startLoad=function(e){var t=0<arguments.length&&void 0!==e?e:-1;B.b.log("startLoad("+t+")"),this.networkControllers.forEach(function(e){e.startLoad(t)})},In.prototype.stopLoad=function(){B.b.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})},In.prototype.swapAudioCodec=function(){B.b.log("swapAudioCodec"),this.streamController.swapAudioCodec()},In.prototype.recoverMediaError=function(){B.b.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)},Cn(In,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){B.b.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){B.b.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){B.b.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){B.b.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){B.b.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){B.b.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,i=e?e.length:0,n=0;n<i;n++)if(t<(e[n].realBitrate?Math.max(e[n].realBitrate,e[n].bitrate):e[n].bitrate))return n;return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}}]),In);function In(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,In);var i=In.DefaultConfig;if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var n in i)n in e||(e[n]=i[n]);if(void 0!==e.liveMaxLatencyDurationCount&&e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==e.liveMaxLatencyDuration&&(e.liveMaxLatencyDuration<=e.liveSyncDuration||void 0===e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(B.a)(e.debug),this.config=e,this._autoLevelCapping=-1;var r=this.observer=new ce.a;r.trigger=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];r.emit.apply(r,[e,e].concat(i))},r.off=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];r.removeListener.apply(r,[e].concat(i))},this.on=r.on.bind(r),this.off=r.off.bind(r),this.once=r.once.bind(r),this.trigger=r.trigger.bind(r);var a=this.abrController=new e.abrController(this),s=new e.bufferController(this),o=new e.capLevelController(this),l=new e.fpsController(this),u=new z(this),c=new $(this),h=new Q(this),d=new dt(this),f=this.levelController=new ot(this),p=new re(this),m=[f,this.streamController=new Ze(this,p)],g=e.audioStreamController;g&&m.push(new g(this,p)),this.networkControllers=m;var v=[u,c,h,a,s,o,l,d,p];if(g=e.audioTrackController){var y=new g(this);this.audioTrackController=y,v.push(y)}if(g=e.subtitleTrackController){var b=new g(this);this.subtitleTrackController=b,v.push(b)}if(g=e.emeController){var _=new g(this);this.emeController=_,v.push(_)}[e.subtitleStreamController,e.timelineController].forEach(function(e){e&&v.push(new e(t))}),this.coreComponents=v}t.default=An},function(e,t,u){function l(i){var n={};function r(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=i,r.c=n,r.i=function(e){return e},r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var e=r(r.s=ENTRY_MODULE);return e.default||e}var c="[\\.|\\-|\\+|\\w|/|@]+",h="\\((/\\*.*?\\*/)?s?.*?("+c+").*?\\)";function d(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function f(e,t,i){var n={};n[i]=[];var r=t.toString(),a=r.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!a)return n;for(var s,o=a[1],l=new RegExp("(\\\\n|\\W)"+d(o)+h,"g");s=l.exec(r);)"dll-reference"!==s[3]&&n[i].push(s[3]);for(l=new RegExp("\\("+d(o)+'\\("(dll-reference\\s('+c+'))"\\)\\)'+h,"g");s=l.exec(r);)e[s[2]]||(n[i].push(s[1]),e[s[2]]=u(s[1]).m),n[s[2]]=n[s[2]]||[],n[s[2]].push(s[4]);return n}function p(i){return Object.keys(i).reduce(function(e,t){return e||0<i[t].length},!1)}e.exports=function(e,t){t=t||{};var i={main:u.m},n=t.all?{main:Object.keys(i)}:function(e,t){for(var i={main:[t]},n={main:[]},r={main:{}};p(i);)for(var a=Object.keys(i),s=0;s<a.length;s++){var o=a[s],l=i[o].pop();if(r[o]=r[o]||{},!r[o][l]&&e[o][l]){r[o][l]=!0,n[o]=n[o]||[],n[o].push(l);for(var u=f(e,e[o][l],o),c=Object.keys(u),h=0;h<c.length;h++)i[c[h]]=i[c[h]]||[],i[c[h]]=i[c[h]].concat(u[c[h]])}}return n}(i,e),r="";Object.keys(n).filter(function(e){return"main"!==e}).forEach(function(t){for(var e=0;n[t][e];)e++;n[t].push(e),i[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",r=r+"var "+t+" = ("+l.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+n[t].map(function(e){return JSON.stringify(e)+": "+i[t][e].toString()}).join(",")+"});\n"}),r=r+"("+l.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+n.main.map(function(e){return JSON.stringify(e)+": "+i.main[e].toString()}).join(",")+"})(self);";var a=new window.Blob([r],{type:"text/javascript"});if(t.bare)return a;var s=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(a),o=new window.Worker(s);return o.objectURL=s,o}},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var s=i(10),o=i(1),l=i(0),n=i(7),u=i.n(n);t.default=function(r){var a=new u.a;a.trigger=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];a.emit.apply(a,[e,e].concat(i))},a.off=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];a.removeListener.apply(a,[e].concat(i))};function n(e,t){r.postMessage({event:e,data:t})}r.addEventListener("message",function(e){var t=e.data;switch(t.cmd){case"init":var i=JSON.parse(t.config);r.demuxer=new s.a(a,t.typeSupported,i,t.vendor);try{Object(l.a)(!0===i.debug)}catch(e){console.warn("demuxerWorker: unable to enable logs")}n("init",null);break;case"demux":r.demuxer.push(t.data,t.decryptdata,t.initSegment,t.audioCodec,t.videoCodec,t.timeOffset,t.discontinuity,t.trackSwitch,t.contiguous,t.duration,t.accurateTimeOffset,t.defaultInitPTS)}}),a.on(o.a.FRAG_DECRYPTED,n),a.on(o.a.FRAG_PARSING_INIT_SEGMENT,n),a.on(o.a.FRAG_PARSED,n),a.on(o.a.ERROR,n),a.on(o.a.FRAG_PARSING_METADATA,n),a.on(o.a.FRAG_PARSING_USERDATA,n),a.on(o.a.INIT_PTS_FOUND,n),a.on(o.a.FRAG_PARSING_DATA,function(e,t){var i=[],n={event:e,data:t};t.data1&&(n.data1=t.data1.buffer,i.push(t.data1.buffer),delete t.data1),t.data2&&(n.data2=t.data2.buffer,i.push(t.data2.buffer),delete t.data2),r.postMessage(n,i)})}},function(e,t){function i(e){if(null==this)throw TypeError();var t=String(this);if(e&&"[object RegExp]"==u.call(e))throw TypeError();var i=t.length,n=String(e),r=n.length,a=i;if(1<arguments.length){var s=arguments[1];void 0!==s&&(a=s?Number(s):0)!=a&&(a=0)}var o=Math.min(Math.max(a,0),i)-r;if(o<0)return!1;for(var l=-1;++l<r;)if(t.charCodeAt(o+l)!=n.charCodeAt(l))return!1;return!0}var n,u;String.prototype.endsWith||(n=function(){try{var e={},t=Object.defineProperty,i=t(e,e,e)&&t}catch(e){}return i}(),u={}.toString,n?n(String.prototype,"endsWith",{value:i,configurable:!0,writable:!0}):String.prototype.endsWith=i)}],n.c=r,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s=11).default;function n(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}var i,r},e.exports=i())})),zl=T.Hls?T.Hls:ql,Yl=ga.getTech("Html5"),Xl=ga.getComponent("Tech"),$l="EmpHLS-MSE",Jl=function(a){function i(e,t){var i;return void 0===e&&(e={}),void 0===t&&(t=function(){}),e.constructing_=!0,(i=a.call(this,e,t)||this).base||Pl(kl,ma(i),{mergeDuplicates:!1}),i.timeShiftDisabled_=e.timeShiftDisabled,i.audioTrackChangeBind=i.baseAudioTrackChange.bind(ma(i)),i.audioTracks().on(va.CHANGE,i.audioTrackChangeBind),i.textTrackChangeBind=i.baseTextTrackChange.bind(ma(i)),i.textTracks().on("selectedlanguagechange",i.textTrackChangeBind),i.onEndedBind=i.onEnded.bind(ma(i)),i.el_.addEventListener("ended",i.onEndedBind),i.loadedmetadataBind=i.loadedmetadata.bind(ma(i)),i.el_.addEventListener("loadedmetadata",i.loadedmetadataBind),i.loadeddataBind=i.loadeddata.bind(ma(i)),i.el_.addEventListener("loadeddata",i.loadeddataBind),i.onErrorBind=i.onError.bind(ma(i)),i.el_.addEventListener("error",i.onErrorBind),i.onWaitingBind=i.onWaiting.bind(ma(i)),i.el_.addEventListener("waiting",i.onWaitingBind),i.stopped_=!1,i.options_.constructing_=e.constructing_=void 0,i.options_.source&&i.options_.source.src&&i.setSource(i.options_.source),i}ca(i,a);var e=i.prototype;return e.getErrorCode=function(e){var t=0;for(var i in zl.ErrorTypes)if(t++,e.type===zl.ErrorTypes[i])break;var n=0;for(var r in zl.ErrorDetails)if(n++,e.details===zl.ErrorDetails[r])break;return Na.HLS_MSE_TECH+100*t+n},e.createPlayer_=function(){var r=this;Fa("createPlayer hls.js");var e=T.EMP_DEBUG_LOG_HLSMSE?{debug:!0}:{};e.enableWorker=!0,e.manifestLoadingMaxRetry=3,this.hlsPlayer_=new zl(e),this.hlsPlayer_.on(zl.Events.MEDIA_ATTACHED,function(){Fa("video and hls.js are now bound together !")}),this.hlsPlayer_.on(zl.Events.ERROR,function(e,t){if(t.fatal)switch(t.type){case zl.ErrorTypes.NETWORK_ERROR:r.checkForRecoverableErrors(t);break;case zl.ErrorTypes.MEDIA_ERROR:switch(r.mediaErrorCount){case 0:Fa.warn("first fatal media error encountered, try to recover"),r.hlsPlayer_.recoverMediaError();break;case 1:Fa.warn("secund fatal media error encountered, try to recover"),r.hlsPlayer_.swapAudioCodec(),r.hlsPlayer_.recoverMediaError();break;default:r.checkForRecoverableErrors(t)}r.mediaErrorCount+=1;break;default:r.checkForRecoverableErrors(t)}}),this.hlsPlayer_.on(zl.Events.MEDIA_DETACHED,function(e,t){Fa(e,t)}),this.hlsPlayer_.on(zl.Events.FRAG_PARSING_INIT_SEGMENT,function(e,t){}),this.hlsPlayer_.on(zl.Events.FRAG_PARSING_METADATA,function(e,t){}),this.hlsPlayer_.on(zl.Events.LEVEL_SWITCHING,function(e,t){Fa(e,t)}),this.hlsPlayer_.on(zl.Events.MANIFEST_PARSED,function(e,t){Fa("manifest loaded, found "+t.levels.length+" quality level")}),this.hlsPlayer_.on(zl.Events.AUDIO_TRACKS_UPDATED,function(e,t){Fa(e,t)}),this.hlsPlayer_.on(zl.Events.SUBTITLE_TRACK_LOADED,function(e,t){Fa(e,t),r.configureVideojsTextTracks()}),this.hlsPlayer_.on(zl.Events.SUBTITLE_TRACKS_UPDATED,function(e,t){Fa(e,t)}),this.hlsPlayer_.on(zl.Events.SUBTITLE_TRACK_SWITCH,function(e,t){Fa(e,t),r.configureVideojsTextTracks()}),this.hlsPlayer_.on(zl.Events.AUDIO_TRACK_SWITCHING,function(e,t){Fa(e,t)}),this.hlsPlayer_.on(zl.Events.AUDIO_TRACK_SWITCHED,function(e,t){Fa(e,t),r.configureVideojsAudioTracks(),r.trigger(va.TRACK_CHANGE)}),this.hlsPlayer_.on(zl.Events.LEVEL_LOADED,function(e,t){Fa(e,t),r.isLive_=t.details.live}),this.hlsPlayer_.on(zl.Events.AUDIO_TRACK_LOADED,function(e,t){Fa(e,t)}),this.hlsPlayer_.on(zl.Events.FRAG_BUFFERED,function(e,t){}),this.hlsPlayer_.on(zl.Events.LEVEL_SWITCHED,function(e,t){Fa(e,t);var i=r.bitrates();Fa("BITRATE_CHANGED",i[t.level]),r.trigger({type:va.BITRATE_CHANGED,bubbles:!0},{bitrate:i[t.level],auto:r.hlsPlayer_.autoLevelEnabled})}),this.hlsPlayer_.on(zl.Events.FRAG_CHANGED,function(e,t){}),this.hlsPlayer_.on(zl.Events.FRAG_LOAD_EMERGENCY_ABORTED,function(e,t){}),this.hlsPlayer_.on(zl.Events.FRAG_DECRYPTED,function(e,t){}),this.hlsPlayer_.on(zl.Events.BUFFER_CREATED,function(e,t){Fa(e,t)}),this.hlsPlayer_.on(zl.Events.BUFFER_APPENDING,function(e,t){}),this.hlsPlayer_.on(zl.Events.FPS_DROP,function(e,t){}),this.hlsPlayer_.on(zl.Events.MANIFEST_LOADED,function(e,t){Fa(e,t),r.options_.maxBitrate?r.setMaxBitrate(r.options_.maxBitrate):r.options_.source&&r.setMaxLevel(r.options_.source.maxBitrate,r.options_.source.maxResWidth,r.options_.source.maxResHeight);var i=r.options_.audioLanguage||r.options_.language,n=r.options_.subtitleLanguage||r.options_.language;r.selectTechAudioLanguage(i),r.selectTechTextLanguage(n),r.metadataLoaded=!0})},e.pause=function(){Fa("pause"),this.live()&&this.timeShiftDisabled_||a.prototype.pause.call(this)},e.play=function(){if(Fa("play"),!this.el_||!this.stopped_&&!this.el_.ended)return a.prototype.play.call(this);this.trigger({type:va.REPLAY,bubbles:!0})},e.disableTimeShift=function(e){this.timeShiftDisabled_=e,this.trigger(va.DURATION_CHANGE)},e.handleSource=function(e,t){if(!t.options_.constructing_&&e.src){Fa("handleSource",e,t),this.stopped_=!1,this.metadataLoaded=!1,this.options_.source=e;var i=this.options_.audioLanguage,n=this.options_.subtitleLanguage;this.options_=Ta(this.options_,e.options),i&&(this.options_.audioLanguage=i),n&&(this.options_.subtitleLanguage=n),this.currentProgram_=null,this.currentVOD_=null,this.isLive_=!1,(this.tech_=t).isReady_=!1,this.mediaErrorCount=0,this.clearTracks(["text"]),this.hlsPlayer_&&(this.hlsPlayer_.destroy(),this.hlsPlayer_.bufferTimer&&(clearInterval(this.hlsPlayer_.bufferTimer),this.hlsPlayer_.bufferTimer=void 0),this.hlsPlayer_=null),this.createPlayer_(),this.loadSrc(e),this.trackDuration()}},e.loadSrc=function(e){var t=e.src;Fa("hls.js loadSrc",t),this.hlsPlayer_.loadSource(t),this.hlsPlayer_.attachMedia(this.el_),this.triggerReady()},e.onEnded=function(){this.stopTrackingDuration()},e.reset=function(){this.clearTracks(["text"]),this.clearTracks(["audio"]),this.hlsPlayer_&&(this.hlsPlayer_.destroy(),this.hlsPlayer_.bufferTimer&&(clearInterval(this.hlsPlayer_.bufferTimer),this.hlsPlayer_.bufferTimer=void 0),this.hlsPlayer_=null),a.prototype.reset.call(this)},e.loadedmetadata=function(){this.metadataLoaded=!0,Fa("loadedmetadata")},e.loadeddata=function(){var e=this.options_.startTime;0<e&&(e<=.1&&(e=.1),this.live()||(e=this.duration()-1>this.options_.startTime?this.options_.startTime:this.duration()-1),Fa("loadeddata, HLS use startTime",e),a.prototype.setCurrentTime.call(this,e))},e.onWaiting=function(){this.stopped_||this.el_.ended||(Fa("Video Waiting"),this.trigger(va.WAITING))},e.setMaxLevel=function(e,t,i){if(e||t||i){e=e||Number.POSITIVE_INFINITY,t=t||Number.POSITIVE_INFINITY,i=i||Number.POSITIVE_INFINITY;for(var n=0,r=0;r<this.hlsPlayer_.levels.length;r++)this.hlsPlayer_.levels[r].bitrate<=1e3*e&&this.hlsPlayer_.levels[r].width<=t&&this.hlsPlayer_.levels[r].height<=i&&(n=r);Fa("setMaxLevel {maxBitrate, maxResWidth, maxResHeight}",e,t,i),this.hlsPlayer_.autoLevelCapping=n,Fa("autoLevelCapping",n),this.trigger(va.LOADED_DATA)}},e.setMaxBitrate=function(e){if(this.hlsPlayer_){if(isNaN(e))return this.hlsPlayer_.autoLevelCapping=-1,void Fa("autoLevelCapping",-1);for(var t=0,i=0;i<this.hlsPlayer_.levels.length;i++)this.hlsPlayer_.levels[i].bitrate<=1e3*e&&(t=i);Fa("setMaxBitrate",e),this.hlsPlayer_.autoLevelCapping=t,Fa("autoLevelCapping",t),this.trigger(va.LOADED_DATA)}else this.options_.maxBitrate=e},e.getMaxBitrate=function(){if(!this.hlsPlayer_)return this.options_.maxBitrate;if(-1<this.hlsPlayer_.autoLevelCapping){var e=this.hlsPlayer_.levels[this.hlsPlayer_.autoLevelCapping];if(e)return e.bitrate/1e3}},e.selectTechTextLanguage=function(e){if(this.hlsPlayer_){if(e&&"None"!==e){if(this.getSelectedTechTextLanguage()!==e){Fa("select Hls texttrack",e);for(var t=this.hlsPlayer_.subtitleTracks,i=t.length;i--;){var n=t[i];if(n.lang===e){this.hlsPlayer_.subtitleTrack=n.id;break}}}}else-1!==this.hlsPlayer_.subtitleTrack&&this.metadataLoaded&&(Fa("Hls texttrack","hide"),this.hlsPlayer_.subtitleTrack=-1);e=e||"None",this.options_?this.options_.subtitleLanguage=e:this.options_={subtitleLanguage:e}}},e.getSelectedTechTextLanguage=function(){if(!this.hlsPlayer_)return null;for(var e=this.hlsPlayer_.subtitleTracks,t=e.length;t--;){var i=e[t];if(i.id===this.hlsPlayer_.subtitleTrack)return i.lang}return null},e.isTextTrackSynchronized=function(){var e=this.hlsPlayer_.subtitleTracks.map(function(e){return e.lang});return e.sort(),this.isTechTextTrackSynchronized(e)},e.configureVideojsTextTracks=function(){var i=this;if(this.metadataLoaded)if(this.isTextTrackSynchronized())this.selectVideojsTextLanguage(this.getSelectedTechTextLanguage());else{this.blockLocalTrackChange=!0,Fa("configureVideojsTextTracks"),this.clearTracks(["text"]);var n,e=this.hlsPlayer_.subtitleTracks,r=this.getSelectedTechTextLanguage();e.forEach(function(e){var t=i.addTextTrack(e.type?e.type.toLowerCase():"subtitles",Ol(e.lang).split(";")[0],e.lang);r===e.lang&&(n=t)}),n&&this.options_.subtitleLanguage&&"None"!==this.options_.subtitleLanguage?n.mode="showing":this.hlsPlayer_.subtitleTrack=-1,this.stopBlockLocalTrackChange("configureVideojsTextTracks")}},e.selectTechAudioLanguage=function(e){if(this.hlsPlayer_&&e&&(this.options_?this.options_.audioLanguage=e:this.options_={audioLanguage:e},e!==this.getSelectedTechAudioLanguage())){Fa("selectTechAudioLanguage",e);for(var t=this.hlsPlayer_.audioTracks,i=t.length;i--;){var n=t[i];if(n.lang===e){this.hlsPlayer_.audioTrack=n.id;break}}}},e.getSelectedTechAudioLanguage=function(){if(!this.hlsPlayer_)return null;for(var e=this.hlsPlayer_.audioTracks,t=e.length;t--;){var i=e[t];if(i.id===this.hlsPlayer_.audioTrack)return i.lang}},e.configureVideojsAudioTracks=function(){if(this.isAudioTrackSynchronized())this.selectVideojsAudioLanguage(this.getSelectedTechAudioLanguage());else{Fa("configureVideojsAudioTracks");var e=this.hlsPlayer_.audioTracks;this.clearTracks(["audio"]);for(var t=this.getSelectedTechAudioLanguage(),i=0;i<e.length;i++){var n=e[i];this.addAudioTrack(null,Ol(n.lang).split(";")[0],n.lang,n.lang===t)}}},e.isAudioTrackSynchronized=function(){var e=this.hlsPlayer_.audioTracks.map(function(e){return e.lang});return this.isTechAudioTrackSynchronized(e)},e.bitrate=function(e){if(void 0===e&&(e=null),null===e)return this.getBitrate();if(0!==e){if(Fa("setBitrate",e),this.hlsPlayer_)for(var t=0;t<this.hlsPlayer_.levels.length;t++)if(this.hlsPlayer_.levels[t].bitrate===e)return this.hlsPlayer_.currentLevel=t,void this.trigger({type:va.BITRATE_CHANGED,bubbles:!0},{bitrate:e,auto:!1})}else this.hlsPlayer_&&(Fa("setBitrate","auto"),this.hlsPlayer_.currentLevel=-1,this.trigger({type:va.BITRATE_CHANGED,bubbles:!0},{bitrate:e,auto:!0}))},e.getBitrate=function(){if(this.hlsPlayer_)for(var e=0;e<this.hlsPlayer_.levels.length;e++)if(e===this.hlsPlayer_.currentLevel)return this.hlsPlayer_.levels[e].bitrate;return 0},e.bitrates=function(){var e=[];if(this.hlsPlayer_)for(var t=0;t<this.hlsPlayer_.levels.length;t++)this.hlsPlayer_.levels[t].bitrate&&e.push(this.hlsPlayer_.levels[t].bitrate);return e.sort(function(e,t){return t-e}),e},e.techVersion=function(){return i.VERSION},e.stop=function(e){this.stopped_=!0,this.stopTrackingDuration(),this.reset(),this.trigger({type:va.PAUSE,bubbles:!0}),this.trigger({type:va.ABORT,bubbles:!0}),this.trigger({type:va.STOPPED,bubbles:!0}),this.trigger(va.ENDED),e&&e()},i.isSupported=function(){return!!ga.getTech("Html5").isSupported()&&(!!zl.isSupported()&&(Fa("hls.js isSupported"),"WebKitMediaSource"in T||"MediaSource"in T))},e.setAbsoluteTime=function(e){Fa("setAbsoluteTime",e.date);try{if(this.live()){var t=(e.nowDate?e.nowDate:Date.now())-e.date,i=this.seekable();if(0===i.length)return;var n=i.end(0);0<t?(Fa("setAbsoluteTime timeBeforeLive",t/=1e3),(n=i.end(0)-t)<0&&(n=0,Fa.warn("setAbsoluteTime before live stream start"))):t<0&&Fa.warn("setAbsoluteTime after live point"),Fa("setAbsoluteTime setCurrentTime",n),this.setCurrentTime(n)}else this.setCurrentTime(e.date/1e3)}catch(e){Fa.error(e)}},e.getAbsoluteTime=function(e){if(!this.el_)return 0;if(this.live()){var t=this.seekable();if(0===t.length)return 0;var i=t.end(t.length-1),n=(e=e||Date.now())/1e3-i+a.prototype.currentTime.call(this);return new Date(1e3*n)}return new Date(1e3*a.prototype.currentTime.call(this))},e.seekable=function(){if(this.live()){var e=a.prototype.seekable.call(this);if(0<e.length){var t=e.end(0);return t=a.prototype.currentTime.call(this)>t?a.prototype.currentTime.call(this):t,e=Co(e.start(e.length-1),t)}}return a.prototype.seekable.call(this)},e.buffered=function(){var e=a.prototype.buffered.call(this),t=0,i=0;if(0<e.length&&(t=e.start(e.length-1)<0?0:e.start(e.length-1),i=e.end(e.length-1)),this.live()){var n=this.seekable();if(0<n.length&&0<e.length){var r=n.end(n.length-1);i=r<i?r:i}}return e=Co(t,i)},e.timeBehindLive=function(){if(!this.live())return 0;var e=a.prototype.currentTime.call(this),t=this.seekable();return 0===t.length?0:Math.floor(t.end(0)-e)},e.startTimeLive=function(e){if(this.el_){e=e||Date.now();var t=this.seekable();if(0===t.length)return 0;if(this.live())return e-1e3*t.end(0)}return 0},e.duration=function(){if(this.live()){var e=0,t=this.seekable();return 0<t.length&&(e=t.end(t.length-1)),e}return a.prototype.duration.call(this)},e.live=function(){return!(!this.el_||!this.el_.duration)&&(this.el_.duration!==1/0&&this.isLive_)},e.currentTime=function(){var e=a.prototype.currentTime.call(this);if(this.live()&&this.duration()!==1/0){var t=this.seekable();if(0<t.length){var i=Math.floor(t.end(t.length-1)-e),n=this.duration();e=Math.max(0,n-i)}}return e},e.baseCurrentTime=function(){return a.prototype.currentTime.call(this)},e.allowJump_=function(e){var t=this.seekable();return 0<t.length&&e>t.end(t.length-1)-2||e<2},e.setCurrentTime=function(e){if(this.options_.source){if(!1===this.options_.source.ffEnabled&&this.currentTime()<=e&&!this.allowJump_(e))return;if(!1===this.options_.source.rwEnabled&&this.currentTime()>=e&&!this.allowJump_(e))return}if(this.live()){var t=this.seekable();0<t.length&&(e=(e=e>t.start(0)?e:t.start(0))<t.end(0)?e:t.end(0))}else e>this.duration()-1&&(e-=5);a.prototype.setCurrentTime.call(this,e)},e.canRestart=function(){return!this.live()||this.timeShiftEnabled()},e.timeShiftEnabled=function(){return!this.timeShiftDisabled_},e.dispose=function(){Fa("dispose "+$l),this.audioTracks().off("change",this.audioTrackChangeBind),this.textTracks().off("selectedlanguagechange",this.textTrackChangeBind),this.el_&&this.el_.removeEventListener&&(this.el_.removeEventListener("ended",this.onEndedBind),this.el_.removeEventListener("loadedmetadata",this.loadedmetadataBind),this.el_.removeEventListener("loadeddata",this.loadeddataBind),this.el_.removeEventListener("error",this.onErrorBind),this.el_.removeEventListener("waiting",this.onWaitingBind)),this.stopTrackingDuration(),this.audioTracks().tracks_=[],this.hlsPlayer_&&(this.hlsPlayer_.detachMedia(),this.hlsPlayer_.destroy(),this.hlsPlayer_.bufferTimer&&(clearInterval(this.hlsPlayer_.bufferTimer),this.hlsPlayer_.bufferTimer=void 0),this.hlsPlayer_=null),a.prototype.dispose.call(this),this.isDispose_=!0},e.checkForRecoverableErrors=function(e){Fa.error($l,e.type,e.details,e.fatal);var t=new Ma(e.type+" - "+e.details+"  "+(e.context?e.context.url:"")+"  "+(e.frag?e.frag.relurl:""),this.getErrorCode(e));t.category=e.type,t.status=t.stack,this.triggerRecoverableError(t),this.hlsPlayer_&&this.hlsPlayer_.destroy()},e.onError=function(){var e=this.error();e.message||(e.message={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."}[e.code]||""),e.category="MediaError",this.triggerRecoverableError(e)},e.triggerRecoverableError=function(e){this.triggerRecoverableTechError(e,$l)},ua(i,[{key:"streamType",get:function(){return"HLS"}}],[{key:"entitlementPlayRequest",get:function(){return{drm:"UNENCRYPTED",format:"HLS",type:"application/x-mpegurl"}}},{key:"nativeSourceHandler",get:function(){return{canHandleSource:function(e,t){return i.nativeSourceHandler.canPlayType(e.type,t)?"probably":/\.m3u8/i.test(e.src)?"maybe":""},handleSource:function(e,t){t.handleSource(e,t)},canPlayType:function(e){return/^application\/x-mpegurl/i.test(e)?"probably":""}}}},{key:"log",get:function(){return Fa}}]),i}(Yl);Jl.prototype.featuresNativeTextTracks=!1,Jl.prototype.featuresNativeAudioTracks=!1,Xl.withSourceHandlers(Jl),Jl.VERSION="2.2.124-498",Jl.sourceHandlers=[],Jl.registerSourceHandler(Jl.nativeSourceHandler),Xl.getTech($l)?(ga.log.warn("Not using "+$l+" as it appears to already be registered"),ga.log.warn($l+" should only be used with emp-player@2 and above")):Xl.registerTech($l,Jl);var Ql=ga.getComponent("Tech"),Zl=function(n){function e(e,t){var i;return Fa("CC: constructor start"),(i=n.call(this,e,t)||this).base||Pl(kl,ma(i),{mergeDuplicates:!1}),i.liveDelay_=0,i.poster_=null,i.paused_=!e.autoplay,i.options_.source?(i.mediaSession=i.options_.source.mediaSession,i.castSession=i.options_.source.castSession,i.streamType=i.options_.source.streamType,i.timeShiftDisabled_=!0===i.options_.timeShiftDisabled):Fa.warn("Create Chromecast Tech No options.source"),i.receiver=i.castSession.receiver.friendlyName,i.hasTriggerQueChange=!1,i.startTimeLive_=0,i.id_=Math.random(),i.currentDuration_=0,i.entitlement_=null,i.currentProgram_=null,i.currentVOD_=null,i.textTrackChangeBind=i.onTextTrackChange.bind(ma(i)),i.textTracks().on(va.CHANGE,i.textTrackChangeBind),i.audioTrackChangeBind=i.onAudioTrackChange.bind(ma(i)),i.audioTracks().on(va.CHANGE,i.audioTrackChangeBind),i.supportsEpgProgramChange_=!0,i.mediaSession.volume&&(i.volume_=i.mediaSession.volume.level,i.muted_=i.mediaSession.muted),i.onMediaStatusUpdateBind=i.onMediaStatusUpdate.bind(ma(i)),i.onSessionUpdateBind=i.onSessionUpdate.bind(ma(i)),i.mediaSession.addUpdateListener(i.onMediaStatusUpdateBind),i.castSession.addUpdateListener(i.onSessionUpdateBind),i.update(),i.onMessageBind=i.onMessage.bind(ma(i)),i.castSession.addMessageListener(i.namespace,i.onMessageBind),i.pullUpdateFromCC(),!i.mediaSession.items&&i.mediaSession.queueData&&i.updatePlayList(),i.triggerReady(),Fa("CC: constructor end"),i}ca(e,n);var t=e.prototype;return t.updateMediaSession=function(e){Fa("CC: updateMediaSession new mediaSession",e.sessionId,e.mediaSessionId),this.mediaSession&&Fa("CC: updateMediaSession prev mediaSession",this.mediaSession.sessionId,this.mediaSession.mediaSessionId),this.liveDelay_=0,this.dropMediaSession(),this.mediaSession=e,this.options_.source.live=!!e.media&&"LIVE"===e.media.streamType,this.options_.source.mediaSession=e,this.mediaSession.addUpdateListener(this.onMediaStatusUpdateBind),this.entitlement_=null,this.currentProgram_=null,this.currentVOD_=null,this.hasTriggerQueChange=!1,this.pullUpdateFromCC(),this.updatePlayList()},t.createEl=function(){return ga.dom.createEl("div",{id:this.options_.techId,className:"vjs-tech vjs-tech-chromecast"})},t.update=function(){this.el_.innerHTML='<div class="casting-image" style="background-image: url(\''+this.options_.poster+'\')"></div>\n                          <div class="casting-overlay">\n                            <div class="casting-information">\n                              <div class="casting-icon"></div>\n                              <div class="casting-description">\n                                <small>'+this.localize("CASTING TO")+"</small>\n                                <br>"+this.receiver+"\n                              </div>\n                            </div>\n                          </div>"},t.onSessionUpdate=function(e){this.mediaSession&&(Fa("CC: onSessionUpdate"),e||(this.dropMediaSession(),this.currentDuration_=0,this.onEnded(),T.chrome.cast.empManager&&T.chrome.cast.empManager.onStopCasting()))},t.setPoster=function(e){this.options_.poster=e||"",this.update()},t.poster=function(){return this.options_.poster},t.dropMediaSession=function(){Fa("CC: dropMediaSession"),this.mediaSession&&this.mediaSession.removeUpdateListener(this.onMediaStatusUpdateBind),this.mediaSession=null},t.stop=function(e){this.mediaSession&&(this.mediaSession.stop(),this.paused_=!0,this.onEnded()),e&&e()},t.disconnectChromecast=function(){this.castSession&&(this.castSession.leave(),this.dropMediaSession(),this.currentDuration_=0,this.onEnded())},t.onMediaStatusUpdate=function(){if(this.mediaSession){if(Fa("CC: onMediaStatusUpdate",this.mediaSession.playerState,this.mediaSession.idleReason,this.id_),this.mediaSession.media&&(this.currentDuration_=null!==this.mediaSession.media.duration&&void 0!==this.mediaSession.media.duration?this.mediaSession.media.duration:1/0,Fa("CC: currentDuration",this.currentDuration_),this.onDurationUpdate(),this.currentSource_=this.mediaSession.media.empPayload?this.mediaSession.media.empPayload.source:void 0),!this.hasTriggerQueChange&&this.mediaSession.items)if(Fa("CC: items",this.mediaSession.currentItemId,this.mediaSession.items),this.hasTriggerQueChange=!0,1<this.mediaSession.items.length){var e=Da(this.mediaSession.currentItemId,this.mediaSession.items);this.trigger({type:va.CC_QUE_CHANGE,bubbles:!0},{sources:e})}else this.trigger({type:va.CC_QUE_CHANGE,bubbles:!0});switch(this.mediaSession.extendedStatus&&Fa("CC: extendedStatus",this.mediaSession.extendedStatus),this.mediaSession.playerState){case chrome.cast.media.PlayerState.IDLE:if(this.mediaSession.idleReason!==chrome.cast.media.IdleReason.FINISHED&&this.mediaSession.idleReason!==chrome.cast.media.IdleReason.INTERRUPTED||!this.mediaSession.extendedStatus||"LOADING"!==this.mediaSession.extendedStatus.playerState){if(this.mediaSession.idleReason===chrome.cast.media.IdleReason.FINISHED||this.mediaSession.idleReason===chrome.cast.media.IdleReason.CANCELLED)return this.dropMediaSession(),this.currentDuration_=0,void this.onEnded();if(this.mediaSession.idleReason===chrome.cast.media.IdleReason.ERROR){var t=this.mediaSession.customData?this.mediaSession.customData:{code:0,message:"Unknown Chromecast error"};this.castError(t)}}else{Fa("CC: load next item in playlist",this.mediaSession.extendedStatus,this.mediaSession.currentItemId,this.mediaSession.items),"video/emp"!==this.mediaSession.extendedStatus.media.contentType&&this.trigger({src:{src:this.mediaSession.extendedStatus.media.contentId,type:this.mediaSession.extendedStatus.media.contentType},type:"sourceset"});var i=this.mediaSession.extendedStatus.media.contentId;this.trigger({type:va.CC_QUE_CHANGE,bubbles:!0},{contentId:i})}this.el_&&this.trigger("timeupdate");break;case chrome.cast.media.PlayerState.PAUSED:this.prePlayerState!==chrome.cast.media.PlayerState.PAUSED&&this.trigger({type:va.PAUSE,bubbles:!0}),this.paused_=!0,this.el_&&this.trigger("timeupdate");break;case chrome.cast.media.PlayerState.PLAYING:this.prePlayerState!==chrome.cast.media.PlayerState.PLAYING&&(this.trigger("play"),Fa("CC: play")),this.paused_=!1,this.trigger(va.PLAYING),Fa("CC: PLAYING")}this.prePlayerState=this.mediaSession.playerState}},t.pullUpdateFromCC=function(){this.deferredSendMessage({type:"pull",data:{}},2e3)},t.updatePlayList=function(){this.hasTriggerQueChange||!this.mediaSession||this.mediaSession.items?Fa("CC: Block updatePlayList"):this.deferredGetStatus()},t.deferredGetStatus=function(){this.deferredGetStatusTimeOut&&clearTimeout(this.deferredGetStatusTimeOut),this.deferredGetStatusTimeOut=setTimeout(function(){var t=this;clearTimeout(this.deferredGetStatusTimeOut),this.deferredGetStatusTimeOut=null,this.mediaSession&&!this.hasTriggerQueChange&&this.mediaSession.getStatus(null,function(){if(t.mediaSession.items)if(t.hasTriggerQueChange=!0,Fa("CC: updatePlayList",t.mediaSession.currentItemId,t.mediaSession.items),1<t.mediaSession.items.length){var e=Da(t.mediaSession.currentItemId,t.mediaSession.items);t.trigger({type:va.CC_QUE_CHANGE,bubbles:!0},{sources:e})}else t.trigger({type:va.CC_QUE_CHANGE,bubbles:!0})},function(e){Fa("CC: Error updatePlayList",e)})}.bind(this),1e3)},t.loadPrevSource=function(){this.mediaSession&&this.mediaSession.items&&1<this.mediaSession.items.length?this.mediaSession.queuePrev(function(){Fa("CC: loadPrevSource")},function(e){Fa.error("CC: loadPrevSource",e)}):Fa.error("CC: loadPrevSource No playlist")},t.jumpToItem=function(e){if(this.mediaSession&&this.mediaSession.items&&1<this.mediaSession.items.length){var t=this.mediaSession.items.length>e?this.mediaSession.items[e]:null;t?this.mediaSession.queueJumpToItem(t.itemId,function(){Fa("CC: queueJumpToItem",t.itemId)},function(e){Fa.error("CC: queueJumpToItem",e)}):Fa.error("CC: jumpToItem No item at index: ",e)}else Fa.error("CC: jumpToItem No playlist")},t.loadNextSource=function(){if(this.mediaSession&&this.mediaSession.items&&1<this.mediaSession.items.length)this.mediaSession.queueNext(function(){Fa("CC: loadNextSource")},function(e){Fa.error("CC: loadNextSource",e)});else{this.sendMessage({type:"loadnextsource",data:{}})}},t.lineupSource=function(e){var t={type:"lineupsource",data:e};this.sendMessage(t)},t.sendTextTrackStyle=function(e){var t={type:"texttrackstyle",data:e};this.sendMessage(t)},t.sendShowTextTrack=function(e){Fa("sendShowTextTrack",e.language,e.kind),this.options_.subtitleLanguage=e.language;var t={type:"showtexttrack",data:{language:e.language,kind:e.kind}};this.deferredSendMessage(t,1e3)},t.sendHideTextTrack=function(){this.options_.subtitleLanguage="None";this.deferredSendMessage({type:"hidetexttrack"})},t.deferredSendMessage=function(e,t){this.deferredSendMessageTimeOut&&clearTimeout(this.deferredSendMessageTimeOut),this.deferredSendMessageTimeOut=setTimeout(function(){clearTimeout(this.deferredSendMessageTimeOut),this.deferredSendMessageTimeOut=null,this.sendMessage(e)}.bind(this),t)},t.sendMessage=function(e){Fa("CC: Sending message",e),this.castSession.sendMessage(this.namespace,e,function(){},function(e){Fa("CC: Error sending message",e)})},t.onMessage=function(e,t){if(e===this.namespace){var i=JSON.parse(t),n=i.type,r=i.data;switch(Fa("CC: Receiving message",n,r,this.id_),n){case"error":this.castError(r);break;case"tracksupdated":this.updateTracks(r.tracksInfo);break;case"isLive":this.options_.source?this.options_.source.live=r:this.options_.source={live:r},this.trigger(va.DURATION_CHANGE);break;case"startTimeLive":this.startTimeLive_=r;break;case"liveDelay":this.liveDelay_=r;break;case"timeShiftEnabled":this.disableTimeShift(!r),this.trigger({type:va.TIMESHIFT_CHANGE,bubbles:!0},{timeShiftDisabled:!r});break;case"autoplay":this.options_.autoplay=r;break;case va.PROGRAM_CHANGED:var a=r&&r.program;a&&(a.startTime&&(a.start=new Date(a.startTime)),a.endTime&&(a.end=new Date(a.endTime)),Fa("PROGRAM_CHANGED","CC"),this.currentProgram_=a,this.currentVOD_=null,this.trigger(va.PROGRAM_CHANGED,{program:a}));break;case va.ASSET_CHANGED:var s=r&&r.asset;s&&(Fa("ASSET_CHANGED","CC"),this.currentVOD_=s,this.currentProgram_=null,this.trigger(va.ASSET_CHANGED,{asset:s}));break;case va.ENTITLEMENT_CHANGE:var o=r&&r.entitlement;if(o){var l=Date.parse(o.licenseExpiration||null);!1===isNaN(l)&&(o.licenseExpiration=new Date(l)),o.streamInfo&&o.streamInfo.startTime&&(o.streamInfo.start=new Date(o.streamInfo.startTime),o.streamInfo.endTime&&(o.streamInfo.end=new Date(o.streamInfo.endTime))),this.entitlement_=o,this.trigger({type:va.ENTITLEMENT_CHANGE,bubbles:!0},{entitlement:o})}break;case va.VOLUME_CHANGE:r.senderId&&r.senderId===this.id_||(this.volume_=r.volume,this.muted_=r.muted,this.trigger(va.VOLUME_CHANGE))}}},t.updateTracks=function(e){var t=e.tracks,i=e.activeTrackIds;this.blockLocalTrackChange=!0,this.clearTracks(["audio"]),this.clearTracks(["text"]);for(var n=0;n<t.length;n++){var r=t[n];switch(r.type){case"text":var a=this.addTextTrack(r.kind?r.kind:"subtitles",Ol(r.language).split(";")[0],r.language);0<=i.indexOf(r.id)&&(a.mode="showing",this.options_.subtitleLanguage=r.language);break;case"audio":this.addAudioTrack(r.kind,Ol(r.language).split(";")[0],r.language,0<=i.indexOf(r.id)),0<=i.indexOf(r.id)&&(this.options_.audioLanguage=r.language)}}setTimeout(function(){this.isDispose_||(this.blockLocalTrackChange=!1,this.trigger(va.TRACK_CHANGE),this.trigger(va.DURATION_CHANGE))}.bind(this),500)},t.onTextTrackChange=function(){this.blockLocalTrackChange?Fa("CC: blockLocalTrackChange","text"):(Fa("CC: onTextTrackChange"),this.deferredTextTrackChange())},t.deferredTextTrackChange=function(){this.deferredTextTrackChangeTimeOut&&clearTimeout(this.deferredTextTrackChangeTimeOut),this.deferredTextTrackChangeTimeOut=setTimeout(function(){Fa("CC: update texttrack"),clearTimeout(this.deferredTextTrackChangeTimeOut),this.deferredTextTrackChangeTimeOut=null;for(var e=this.textTracks(),t=e.length;t--;){var i=e[t];if("showing"===i.mode)return void this.sendShowTextTrack(i)}this.sendHideTextTrack()}.bind(this),1e3)},t.onAudioTrackChange=function(e){if(this.blockLocalTrackChange)Fa("CC: blockLocalTrackChange","audio",e);else{Fa("onAudioTrackChange");for(var t=this.audioTracks(),i=t.length;i--;){var n=t[i];if(n.enabled)return void this.sendAudioLanguage(n.language,n.kind)}}},t.sendAudioLanguage=function(e,t){if(Fa("selectAudioTrack",e,t),e){this.options_?this.options_.audioLanguage=e:this.options_={audioLanguage:e};var i={type:"selectaudiotrack",data:{language:e,kind:t}};this.sendMessage(i,!0)}},t.src=function(e){Fa("CC src called",e)},t.playPreviousProgram=function(e){var t={type:"playpreviousprogram",data:{end:e}};this.sendMessage(t)},t.playNextProgram=function(){this.sendMessage({type:"playnextprogram"})},t.gotoLive=function(){this.sendMessage({type:"gotolive"})},t.live=function(){return this.entitlement_?this.entitlement_.live||this.entitlement_.isDynamicCachupAsLive:!(!this.options_||!this.options_.source)&&this.options_.source.live},t.setAbsoluteTime=function(e){if(this.mediaSession&&!this.paused_&&this.mediaSession.playerState!==chrome.cast.media.PlayerState.IDLE&&this.castSession&&this.castSession.status===chrome.cast.SessionStatus.CONNECTED){var t={type:"playheadtime",data:e.date.getTime?e.date.getTime():e.date};this.sendMessage(t)}},t.getAbsoluteTime=function(){return new Date(this.startTimeLive()+1e3*this.currentTime())},t.startTimeLive=function(){return this.startTimeLive_},t.currentSource=function(){return this.currentSource_},t.currentSrc=function(){if(this.mediaSession)return this.mediaSession.media.contentId},t.castError=function(e){if(e&&"session_error"===e.code)Fa.warn("CC: Cast Session Error:",e);else{Fa("CC: Cast Tech Error:",e),this.dropMediaSession();var t=((e=e||{}).message?e.message:"")+" "+(e.description?e.description:"");this.trigger(va.ERROR,"Cast error, can't recover code: "+e.code+" message: "+t)}},t.play=function(){if(this.mediaSession)return this.paused_&&this.castSession&&this.castSession.status===chrome.cast.SessionStatus.CONNECTED&&this.mediaSession.play(null,this.mediaCommandSuccessCallback.bind(this,"Playing: "+this.mediaSession.sessionId),this.castError.bind(this)),this.paused_=!1,this.paused_},t.pause=function(){if((!this.live()||!this.timeShiftDisabled_)&&this.mediaSession)return this.paused_||this.mediaSession.playerState===chrome.cast.media.PlayerState.IDLE?void 0:(this.castSession&&this.castSession.status===chrome.cast.SessionStatus.CONNECTED&&this.mediaSession.pause(null,this.mediaCommandSuccessCallback.bind(this,"Paused: "+this.mediaSession.sessionId),this.castError.bind(this)),this.paused_=!0,this.paused_)},t.paused=function(){return this.paused_},t.currentTime=function(){return!this.mediaSession||this.mediaSession.getEstimatedTime()<0?0:this.mediaSession.getEstimatedTime()},t.baseCurrentTime=function(){return this.currentTime()},t.buffered=function(){return Co(0,0)},t.seekable=function(){var e=this.startTimeLive()/1e3;return Co(e,e+this.currentTime()+this.timeBehindLive())},t.setCurrentTime=function(e){if(this.mediaSession){var t=new chrome.cast.media.SeekRequest;t.currentTime=e,this.mediaSession.seek(t,this.onSeekDone.bind(this),this.castError.bind(this))}},t.onSeekDone=function(){Fa("CC: seek respond ok")},t.volume=function(){return this.volume_},t.duration=function(){return this.live()&&this.timeShiftDisabled_?1/0:this.currentDuration_},t.controls=function(){return!1},t.canRestart=function(){return!this.live()||!this.timeShiftDisabled_},t.onEnded=function(){this.clearTracks(["audio"]),this.clearTracks(["text"]),this.trigger("ended"),this.currentProgram_=null,this.currentVOD_=null,this.currentSource_=null},t.ended=function(){var e=!this.mediaSession||this.mediaSession.playerState===chrome.cast.media.PlayerState.IDLE;return Fa("CC: ended",e),e},t.setVolume=function(e,t){if(void 0===t&&(t=!1),this.mediaSession&&(this.volume_.leave!==e||this.muted_!==t)){var i=new chrome.cast.Volume,n=new chrome.cast.media.VolumeRequest;i.level=e,i.muted=t,this.volume_=i.level,this.muted_=t,n.volume=i,n.customData={id:this.id_},Fa("CC: Send setVolume"),this.mediaSession.setVolume(n,this.mediaCommandSuccessCallback.bind(this,"Volume changed"),this.castError.bind(this)),this.trigger("volumechange")}},t.mediaCommandSuccessCallback=function(e){Fa(e)},t.muted=function(){return this.muted_},t.setMuted=function(e){this.setVolume(this.volume_,e)},t.supportsFullScreen=function(){return!1},t.resetSrc_=function(e){e()},t.reset=function(){this.clearTracks(["text"]),this.clearTracks(["audio"]),n.prototype.reset.call(this)},t.techVersion=function(){return e.VERSION},t.dispose=function(){this.textTracks().off(va.CHANGE,this.textTrackChangeBind),this.audioTracks().off(va.CHANGE,this.audioTrackChangeBind),this.resetSrc_(Function.prototype),this.mediaSession&&(this.mediaSession.removeUpdateListener(this.onMediaStatusUpdateBind),this.mediaSession=null),this.castSession&&(this.castSession.removeMessageListener(this.namespace,this.onMessageBind),this.castSession.removeUpdateListener(this.onSessionUpdateBind),this.castSession=null),n.prototype.dispose.call(this,this),this.isDispose_=!0},t.bitrates=function(){return[]},t.bitrate=function(){},t.getBitrate=function(){},t.setAutoplay=function(){},t.autoplay=function(){return this.options.autoplay},t.seeking=function(){return!1},t.liveDelay=function(){return this.liveDelay_},t.timeBehindLive=function(e){var t=0;return this.live()&&(e=e||Date.now(),t=this.currentProgram_&&this.currentProgram_.start?(e-1e3*this.liveDelay_-(this.currentProgram_.start.getTime()+1e3*this.currentTime()))/1e3:this.duration()-this.currentTime()),Math.round(t)},t.disableTimeShift=function(e){this.options_?this.options_.timeShiftDisabled=e:this.options_={timeShiftDisabled:e},this.timeShiftDisabled_=e,this.trigger(va.DURATION_CHANGE)},t.timeShiftEnabled=function(){return!this.timeShiftDisabled_},e.isSupported=function(){return chrome.cast&&chrome.cast.isAvailable},t.setPlaybackRate=function(){},t.playbackRate=function(){return 1},ua(e,[{key:"namespace",get:function(){return"urn:x-cast:com.ericsson.cast.receiver"}}]),e}(Ql);Ql.withSourceHandlers(Zl),Zl.nativeSourceHandler={},Zl.nativeSourceHandler.canPlayType=function(e){return!1},Zl.nativeSourceHandler.canHandleSource=function(e){return e.type?Zl.nativeSourceHandler.canPlayType(e.type):e.src?Zl.nativeSourceHandler.canPlayType(e.src):""},Zl.nativeSourceHandler.handleSource=function(e,t){Fa("CC handleSource called",e),t.src(e.src)},Zl.nativeSourceHandler.dispose=function(){},Zl.registerSourceHandler(Zl.nativeSourceHandler),Zl.prototype.featuresVolumeControl=!0,Zl.prototype.featuresMuteControl=!0,Zl.prototype.featuresPlaybackRate=!1,Zl.prototype.movingMediaElementInDOM=!1,Zl.prototype.featuresFullscreenResize=!1,Zl.prototype.featuresTimeupdateEvents=!1,Zl.prototype.featuresProgressEvents=!1,Zl.prototype.featuresNativeTextTracks=!1,Zl.prototype.featuresNativeAudioTracks=!1,Zl.prototype.featuresNativeVideoTracks=!1,ga.options.chromecast={},Zl.VERSION="2.2.124-498",Ql.registerTech("EmpCast",Zl);var eu=function(){function e(e,t){this.player_=e,this.INIT_MAX_ATTEMPTS=10,this.INIT_ATTEMPT_INTERVAL=1e3,this.VERY_BIG_DURATION=31536e3,this.CHROMECAST_APP_ID=t,this.isDispose_=!1,this.castSession_=null,this.ccButton_=null,this.casting_=!1,this.stopTime_=null,this.absoluteStopTime_=0,this.absoluteStartTime_=0,this.currentProgram_=null,this.initAttempts=0,this.initiated_=!1,this.receiversAvailability_=null,this.audioLanguage_=null,this.subtitleLanguage_=null,this.locked_=!1,this.onCastingUpdateEventBind=this.onCastingUpdateEvent.bind(this),this.onMediaUpdateEventBind=this.onMediaUpdateEvent.bind(this),T.chrome&&T.chrome.cast&&(T.chrome.cast.empManager=this)}var t=e.prototype;return t.initiated=function(){return"EmpHLS-MSE"===this.player.techName_&&Fa("Tech EmpHLS-MSE does not support casting."),this.initiated_&&this.player&&"EmpHLS-MSE"!==this.player.techName_},t.ui=function(e){return e&&(this.ccButton_=e),this.ccButton_?(this.initiated()||this.ccButton_.hide(),this.ccButton_):this.dummyButton()},t.casting=function(e){this.casting_=e},t.isCasting=function(){return this.casting_},t.castSession=function(e){return e&&(this.castSession_&&e.sessionId===this.castSession_.sessionId?Fa("CC: Reuse CastSession",e):(Fa("CC: New CastSession",e),this.castSession_=e)),this.castSession_},t.clearSession=function(){Fa("CC: clear Castsession"),this.castSession_&&(this.castSession_.removeUpdateListener(this.onCastingUpdateEventBind),this.castSession_.removeMediaListener(this.onMediaUpdateEventBind)),this.castSession_=null},t.dispose=function(){this.isDispose_||(this.castSession_&&(this.castSession_.removeUpdateListener(this.onCastingUpdateEventBind),this.castSession_.removeMediaListener(this.onMediaUpdateEventBind),this.ccButton_=null),this.isDispose_=!0)},t.stopCasting=function(){var t=this;Fa("CC: stopCasting"),this.stopTime_=ts.baseCurrentTime(this.player),this.absoluteStopTime_=ts.getPlayheadTime(this.player),this.currentProgram_=ts.program(this.player),this.castSession().stop(function(){return t.onStopCasting()},function(e){return t.onCastError(e)})},t.showBrowserChromecastDialog=function(){var t=this;this.locked_||(this.locked_=!0,this.initiated()?T.chrome.cast.requestSession(function(e){return t.onJoin(e)},function(e){return t.onCastError(e)}):Fa.warn("CastSession not initialized"))},t.init=function(){var t=this;if(Fa("CC: ChromecastSender init"),As||ks){if(!T.chrome||!T.chrome.cast||!T.chrome.cast.isAvailable)return Fa("CC: Chromecast API not available."),this.initAttempts<this.INIT_MAX_ATTEMPTS?(setTimeout(this.init,this.INIT_ATTEMPT_INTERVAL),void++this.initAttempts):void Fa("CC: Chromecast API not available. Max attempts reached.");if(Fa("CC: Chromecast API is available."),this.initAttempts=0,this.CHROMECAST_APP_ID){var e=new T.chrome.cast.SessionRequest(this.CHROMECAST_APP_ID),i=new T.chrome.cast.ApiConfig(e,function(e){return t.onJoin(e)},function(e){return t.onAvailability(e)},T.chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED);T.chrome.cast.initialize(i,function(){return t.onInit()},function(e){return t.onCastError(e)})}else Fa("CC: Chromecast error: missing chromecast appId.")}},t.loadMedia=function(e,t){var i=this;if(void 0===t&&(t=1/0),Fa("CC: loadMedia"),!e||e.status!==T.chrome.cast.SessionStatus.CONNECTED)return this.playLocally(),void(this.locked_=!1);if(!this.initiated()&&(this.init(),!this.initiated()))return this.onCastError({code:T.chrome.cast.ErrorCode.API_NOT_INITIALIZED}),void(this.locked_=!1);e&&this.castSession(e);var n=this.player.options(),r={},a=ts.currentAsset(this.player),s=this.player.currentSources();if(this.player.playList()&&1<this.player.playList().length)this.loadQue(this.player.playList().src(),t);else if(!a&&s&&0<s.length)this.loadSources(s,t);else if(a&&s&&1<s.length)this.loadSources(s,t);else{if(!a)return this.player.one(va.ENTITLEMENT_CHANGE,function(){i.loadMedia(e,t)}),void(this.locked_=!1);var o;if(this.currentProgram_&&this.absoluteStartTime_){var l={playFrom:"startTime"};l.playFrom="startTime",l.startTime=this.absoluteStartTime_,o=this.currentProgram_.assetId?this.currentProgram_.assetId:this.currentProgram_.channelId,r.playbackProperties=l,this.currentProgram_=null,this.absoluteStartTime_=0}else o=a.assetId?a.assetId:a.channelId;this.setplayerOptions(r),ts.isLive(this.player)&&"DASH"===this.player.streamType&&"EmpCast"!==this.player.techName_&&t!==1/0&&(r.absoluteStartTime=ts.getAbsoluteTime(this.player).getTime(),t=1/0),0<t&&(r.useLastViewedOffset=!1);var u=new T.chrome.cast.media.MediaInfo(o,"video/emp"),c=new T.chrome.cast.media.LoadRequest(u);c.customData=r,t!==1/0&&(c.currentTime=t),c.autoplay=n.autoplay,this.requestLoadMedia_(c)}},t.imageSelector=function(e){var t;0<e.length&&(t=e[0]);for(var i=0;i<e.length;i++)if(e[i].url&&"chromecast"===e[i].type)return e[i];return t},t.requestLoadMedia_=function(e,t){var i=this;this.castSession()?(Fa("requestLoadMedia",e),this.player.trigger(va.CHROMECAST_CASTING),t?this.castSession().queueLoad(e,function(e){return i.onMediaLoaded(e,"LOADMEDIA")},function(e){return i.onCastError(e)}):this.castSession().loadMedia(e,function(e){return i.onMediaLoaded(e,"LOADMEDIA")},function(e){return i.onCastError(e)}),this.castSession().removeUpdateListener(this.onCastingUpdateEventBind),this.castSession().removeMediaListener(this.onMediaUpdateEventBind),this.castSession().addUpdateListener(this.onCastingUpdateEventBind),this.castSession().addMediaListener(this.onMediaUpdateEventBind)):(Fa.error("No ChromeCast session"),this.playLocally(),this.locked_=!1)},t.loadSources=function(e,t){void 0===t&&(t=1/0),Fa("CC: loadSources");for(var i=0;i<e.length;i++)e[i].options=void 0;var n=e[0];if(!n.src||!n.type){var r="CC sender, loadSources, no src";return Fa.error(r,n),void this.player.error(r)}var a=this.player.options(),s={},o=new T.chrome.cast.media.MediaInfo(n.src,n.type);if(a.empcast){var l=new T.chrome.cast.media.MovieMediaMetadata;if(l.title=a.empcast.title,l.subtitle=a.empcast.subtitle,a.empcast.image&&a.empcast.image.url){var u=new T.chrome.cast.Image(a.empcast.image.url);u.width=a.empcast.image.width?a.empcast.image.width:"155",u.height=a.empcast.image.height?a.empcast.image.height:"100",l.images=[u]}o.metadata=l,s.empcast=a.empcast}this.setplayerOptions(s),s.playFrom="defaultBehaviour",void 0!==s.absoluteStartTime&&(t=1/0),s.sources=e;var c=new T.chrome.cast.media.LoadRequest(o);c.customData=s,t!==1/0&&(c.currentTime=t),c.autoplay=a.autoplay,this.requestLoadMedia_(c)},t.loadQue=function(e,t){void 0===t&&(t=1/0);var i=this.player.options(),n={};this.setplayerOptions(n),void 0!==n.absoluteStartTime&&(t=1/0);for(var r=[],a=0;a<e.length;a++){var s=e[a];if(!s.src||!s.type){var o="CC sender, loadQue, no src";return Fa.error(o,s),void this.player.error(o)}var l=new T.chrome.cast.media.MediaInfo(s.src,s.type),u=new T.chrome.cast.media.MovieMediaMetadata;u.title=s.title?s.title:"",u.subtitle=s.subtitle?s.subtitle:"",l.metadata=u,r.push(new T.chrome.cast.media.QueueItem(l))}var c=new T.chrome.cast.media.QueueLoadRequest(r);c.startIndex=e.findIndex(function(e){return e.selected}),t!==1/0&&(c.startTime=t,c.items[c.startIndex].startTime=t);for(var h=0;h<c.items.length;h++)c.items[h].autoplay=i.autoplay,c.items[h].customData=Ta({keySystems:e[h].keySystems,licenseServer:e[h].licenseServer,certificateServer:e[h].certificateServer,playToken:e[h].playToken},n);this.requestLoadMedia_(c,!0)},t.setplayerOptions=function(e){var t=this.player.options();e.ericssonexposure=t.ericssonexposure,e.audioLanguage=this.player.hasStarted()&&"EmpCast"!==this.player.techName_?ts.getSelectedAudioTrack(this.player):t.audioLanguage,e.subtitleLanguage=this.player.hasStarted()&&"EmpCast"!==this.player.techName_?ts.getSelectedTextTrack(this.player):t.subtitleLanguage,e.subtitleLanguage=e.subtitleLanguage?e.subtitleLanguage:"None",e.timeShiftDisabled=this.player.hasStarted()&&"EmpCast"!==this.player.techName_?!ts.timeShiftEnabled(this.player):t.timeShiftDisabled,e.useLastViewedOffset=t.useLastViewedOffset,e.absoluteStartTime=t.absoluteStartTime,e.textTrackSettings=t.textTrackSettings,e.textTrackStyle=t.textTrackStyle,!e.textTrackStyle&&e.textTrackSettings&&this.player.textTrackSettings&&(e.textTrackStyle=this.player.textTrackSettings.getValues(),e.textTrackSettings=!0),e.volume={level:this.player.volume(),muted:this.player.muted()},e.language=this.player.language(),e.playlist=t.playlist},t.onInit=function(){Fa("CC: Chromecast is ready."),this.initiated_=!0;try{this.ui().show()}catch(e){}},t.isJoined=function(){return this.castSession_&&this.castSession_.status===T.chrome.cast.SessionStatus.CONNECTED},t.reJoin=function(){T.chrome.cast.empManager.castSession_&&!this.castSession_&&this.onJoin(T.chrome.cast.empManager.castSession_)},t.onJoin=function(t){var i=this;if(Fa("CC: onJoin Chromecast session arrived."),!this.initiated()&&t&&(Fa.warn("CC: not initiated, stop casting"),t.stop()),!this.player.el_)return Fa.warn("CC: No player.el_"),void(T.chrome.cast.empManager&&this!==T.chrome.cast.empManager&&(Fa("CC: rejoin"),T.chrome.cast.empManager.onJoin(t)));if(this.player.trigger(va.WAITING),t){this.castSession(t),this.audioLanguage_=this.player.options().audioLanguage,this.subtitleLanguage_=this.player.options().subtitleLanguage;var e=this.player.audioTracks();if(void 0!==e)for(var n=0;n<e.length;n++){var r=e[n];!0===r.enabled&&(this.audioLanguage_=r.language)}var a=this.player.textTracks();if(void 0!==a)for(var s=0;s<a.length;s++){var o=a[s];"showing"===o.mode&&(this.subtitleLanguage_=o.language)}if(0<t.media.length)this.player.ready(function(){var e=t.media[0].media;if(!e)return Fa.warn("CC: No media in session"),void setTimeout(function(){Fa("CC: rejoin"),i.onJoin(t)},2e3);e.empPayload&&e.empPayload.source&&"video/emp"!==e.empPayload.source.type?(i.player.cache_.source=e.empPayload.source,i.player.cache_.sources=[e.empPayload.source]):(ts.currentAsset(i.player,e.empPayload?e.empPayload.assetId:void 0,e.empPayload?e.empPayload.programId:void 0,e.empPayload?e.empPayload.channelId:void 0),i.player.cache_.sources=[{type:"video/emp",src:JSON.stringify(ts.currentAsset(i.player))}]),i.onMediaLoaded(t.media[0],"JOIN")});else if(this.player.hasStarted()){var l=ts.baseCurrentTime(this.player);this.absoluteStartTime_=ts.getPlayheadTime(this.player),this.currentProgram_=this.player.programService&&this.player.programService().currentProgram,ts.isLive(this.player)&&(!ts.timeShiftEnabled(this.player)||ts.timeBehindLive(this.player)<=15)&&(l=1/0),this.loadMedia(t,l)}this.castSession().removeUpdateListener(this.onCastingUpdateEventBind),this.castSession().removeMediaListener(this.onMediaUpdateEventBind),this.castSession().addUpdateListener(this.onCastingUpdateEventBind),this.castSession().addMediaListener(this.onMediaUpdateEventBind),this.player.trigger(va.CHROMECAST_JOIN)}},t.onAvailability=function(e){if(Fa("CC: Chromecast availability arrived: "+e),this.player.el_){if("available"===(this.receiversAvailability_=e))try{this.ui().show()}catch(e){Fa.error(e.message)}}else T.chrome.cast.empManager&&this!==T.chrome.cast.empManager&&T.chrome.cast.empManager.onAvailability(e)},t.onMediaLoaded=function(e,t){var i=this;if(!this.isDispose_){if(Fa("CC: Chromecast mediaSession was loaded.",t,e.customData?e.customData.playerState:"",e.extendedStatus?e.extendedStatus.playerState:"","sessionId:"+e.sessionId,"mediaSessionId:"+e.mediaSessionId,e.media),this.locked_=!1,e.items&&this.player.playList())if(Fa("CC: update playlist",e.currentItemId,e.items),1<e.items.length){var n=Da(e.currentItemId,e.items);this.player.trigger(va.CC_QUE_CHANGE,{sources:n})}else this.player.trigger(va.CC_QUE_CHANGE);if(this.player.tech_&&"EmpCast"===this.player.techName_?this.player.tech_.updateMediaSession(e):(this.player.cache_.volume=null,this.player.loadTech_("EmpCast",{type:"cast",mediaSession:e,castSession:this.castSession(),live:!!e.media&&"LIVE"===e.media.streamType})),this.player.tech_.one(va.PAUSE,function(){i.player.hasStarted()||i.player.hasStarted(!0)}),e&&e.media){var r=e.media;r.empPayload&&r.empPayload.source&&"video/emp"!==r.empPayload.source.type?(this.player.cache_.source=r.empPayload.source,this.player.cache_.sources=[r.empPayload.source]):(ts.currentAsset(this.player,r.empPayload?r.empPayload.assetId:void 0,r.empPayload?r.empPayload.programId:void 0,r.empPayload?r.empPayload.channelId:void 0),this.player.cache_.sources=[{type:"video/emp",src:JSON.stringify(ts.currentAsset(this.player))}]),this.player.trigger(va.DURATION_CHANGE)}this.casting(!0),this.player.ended_=!1,this.inactivityTimeout=this.player.options_.inactivityTimeout,this.player.options_.inactivityTimeout=0,this.player.userActive(!0);try{this.ui().casting(!0)}catch(e){Fa.error(e.message)}this.player.tech_.onMediaStatusUpdate(),this.player.trigger(va.CHROMECAST_CASTING)}},t.playExternalStreamLocally=function(){var e=this.player.tech_.currentSource?this.player.tech_.currentSource():null;Fa("CC: playExternalStreamLocally",e),(e=e||this.player.currentSource()).options=void 0,this.player.options_.autoplay="any",e&&this.player.playList&&!this.player.playList().currentSource(e)&&(this.player.reset(),this.player.src(e))},t.playProgramLocally=function(){if(this.currentProgram_&&(this.absoluteStopTime_&&(this.player.options_.absoluteStartTime=this.absoluteStopTime_),this.player.playList&&!this.player.playList().currentSource({type:"video/emp",src:this.currentProgram_.assetId}))){var e={playFrom:"defaultBehaviour"};this.absoluteStopTime_&&(e.playFrom="startTime",e.startTime=this.absoluteStopTime_),Fa("CC: playProgramLocally",this.currentProgram_),this.player.startPlayback(this.currentProgram_.assetId,this.currentProgram_.channelId,this.currentProgram_.programId,e)}this.currentProgram_=null,this.absoluteStopTime_=0},t.playLocally=function(e){var t=this,i=this.player.options();if(!i.empcast||!1!==i.empcast.takebacksession){var n=0;this.player.options_.inactivityTimeout=this.inactivityTimeout?this.inactivityTimeout:2e3,this.player.userActive(!1),0<=e&&(!ts.isLive(this.player)||ts.timeShiftEnabled(this.player))&&(!ts.isLive(this.player)||15<=ts.timeBehindLive(this.player))&&(n=e);var r={startTime:n,subtitleLanguage:this.player.tech_.options_.subtitleLanguage?this.player.tech_.options_.subtitleLanguage:"None",audioLanguage:this.player.tech_.options_.audioLanguage,timeShiftDisabled:this.player.tech_.options_.timeShiftDisabled,autoplay:this.player.tech_.options_.autoplay},a=this.player.muted();this.player.one(va.READY,function(){t.player.muted(a)}),this.player.options(r);var s=ts.currentAsset(this.player);Fa("CC: playLocally",this.player.options());var o=this.player.options_.useLastViewedOffset;0<=e&&(this.player.options_.useLastViewedOffset=!1),this.player.hasStarted()?ts.stop(this.player,function(){t.player.reset(),s?t.currentProgram_?t.playProgramLocally():t.playAssetLocally(s,o):t.playExternalStreamLocally()}):(this.player.reset(),s?this.currentProgram_?this.playProgramLocally():this.playAssetLocally(s,o):this.playExternalStreamLocally())}},t.playAssetLocally=function(e,t){var i=this;Fa("CC: playAssetLocally",e),this.player.one(va.LOADED_DATA,function(){i.player.options_.useLastViewedOffset=t}),this.player.options_.autoplay="any",this.player.playList&&!this.player.playList().currentSource({type:"video/emp",src:e.assetId})&&ts.loadAsset(this.player,e.assetId)},t.onCastError=function(e){this.locked_=!1;var t={code:e.code,message:e.description,details:e.details},i=t.details?t.details.customData:null;if(e.code!==T.chrome.cast.ErrorCode.CANCEL)if(e.code===T.chrome.cast.ErrorCode.SESSION_ERROR&&e.details&&"LOAD_CANCELLED"===e.details.type)Fa("CC: LOAD_CANCELLED:",e);else{if(e.code===T.chrome.cast.ErrorCode.SESSION_ERROR&&e.details&&"LOAD_FAILED"===e.details.type)return Fa("CC: LOAD_FAILED:",e),void this.player.error(i||e);switch(this.playLocally(),e.code){case T.chrome.cast.ErrorCode.API_NOT_INITIALIZED:case T.chrome.cast.ErrorCode.EXTENSION_MISSING:case T.chrome.cast.ErrorCode.EXTENSION_NOT_COMPATIBLE:case T.chrome.cast.ErrorCode.LOAD_MEDIA_FAILED:case T.chrome.cast.ErrorCode.RECEIVER_UNAVAILABLE:case T.chrome.cast.ErrorCode.SESSION_ERROR:case T.chrome.cast.ErrorCode.CHANNEL_ERROR:case T.chrome.cast.ErrorCode.TIMEOUT:try{this.ui().error()}catch(e){Fa.error(e.message)}break;case T.chrome.cast.ErrorCode.INVALID_PARAMETER:"No active session"===e.description&&(this.player.error("No active cast session"),this.onStopCasting(!1));break;case T.chrome.cast.ErrorCode.CANCEL:break;default:this.player.error(t)}Fa("CC: Cast Error:",e)}else Fa("CC: Cast CANCEL:",e)},t.onCastingUpdateEvent=function(){this.castSession()&&(Fa("CC: onCastingUpdateEvent",this.castSession().status),T.chrome.cast.SessionStatus.STOPPED===this.castSession().status&&(this.player.tech_.mediaSession?(this.stopTime_=ts.baseCurrentTime(this.player),this.absoluteStopTime_=ts.getPlayheadTime(this.player),this.currentProgram_=ts.program(this.player),this.onStopCasting(this.player.tech_.mediaSession)):this.onStopCasting(!1)))},t.onMediaUpdateEvent=function(e){Fa("CC: onMediaUpdateEvent",e),"ERROR"!==e.idleReason&&this.onMediaLoaded(e,"MEDIAUPDATE")},t.onStopCasting=function(e){var t=this;void 0===e&&(e=!0),Fa("CC: onStopCasting"),this.casting(!1);try{this.ui().casting(!1)}catch(e){Fa.error(e.message)}this.player.el()&&this.player.trigger(va.CHROMECAST_STOPPED),this.clearSession();var i=this.player.options();i.empcast&&!1===i.empcast.takebacksession||!e?ts.stop(this.player,function(){t.player.reset(),t.player.poster(null)}):this.playLocally(this.stopTime_)},t.canOverride=function(e){return"Cast"===e?this.initiated()&&this.isJoined():"Initiated"===e&&this.initiated()},t.cast=function(){this.isJoined()&&(this.player.trigger(va.WAITING),this.loadMedia(this.castSession(),this.player.options_.startTime||0))},t.dummyButton=function(){return{show:function(){},casting:function(){},error:function(){},hide:function(){}}},ua(e,[{key:"player",set:function(e){this.player_=e},get:function(){return this.player_}}]),e}(),tu=ga.getComponent("Component"),iu=function(n){function e(e,t){var i;return i=n.call(this,e,t)||this,e.ready(function(){i.moveButton(),e.castPlugin().addComponent("ChromecastSender","UI",ma(i))}),e.on(va.PLAYING,function(){i.removeClass("error"),"EmpCast"!==e.techName_&&(i.player().removeClass("vjs-casting"),i.removeClass("connected")),e.castPlugin&&e.castPlugin().canOverride("Initiated")?i.show():i.hide()}),i}ca(e,n);var t=e.prototype;return t.manager=function(){return this.player().castPlugin().get("ChromecastSender")},t.init=function(){this.manager().initiated()?this.show():this.hide()},t.moveButton=function(){if(this.player().controlBar.childNameIndex_.hasOwnProperty("ChromeCastButton")&&this.player().controlBar.childNameIndex_.hasOwnProperty("FullscreenToggle")){var e=this.player().controlBar.el().removeChild(this.el());this.player().controlBar.el().insertBefore(e,this.player().controlBar.fullscreenToggle.el())}},t.casting=function(e){e?(this.player().addClass("vjs-casting"),this.addClass("connected"),this.removeClass("error")):(this.player().removeClass("vjs-casting"),this.removeClass("connected"))},t.error=function(){this.addClass("error")},t.show=function(){n.prototype.show.call(this)},t.hide=function(){n.prototype.hide.call(this)},t.handleClick=function(){n.prototype.handleClick.call(this),this.manager().showBrowserChromecastDialog()},t.buildCSSClass=function(){return"vjs-chromecast-button "+n.prototype.buildCSSClass.call(this)},e}(ga.getComponent("Button"));iu.prototype.controlText_="Chromecast",tu.registerComponent("ChromeCastButton",iu);var nu=function(n){function e(e,t){var i;return i=n.call(this,e,t)||this,Fa("CastPlugin is being created"),i.options_=t,i.managers_={},i.init(),i}ca(e,n);var t=e.prototype;return t.init=function(){Fa("CastPlugin init"),this.addChromecastManager(),setTimeout(function(){this.load()}.bind(this),200)},t.addManager=function(e,t){this.managers_[e]=t},t.get=function(e){return this.managers_[e]},t.load=function(){var i=this;Fa("CastPlugin load",this.managers_),Object.keys(this.managers_).map(function(e,t){i.managers_[e].init()})},t.canOverride=function(n){var r=this;if("Cast"===n||"Initiated"===n){var e=Object.keys(this.managers_),a=!1;return e.map(function(e,t){var i=r.managers_[e].canOverride(n);a=a||i}),a}Fa("CastPlugin: unsupported functionality "+n)},t.cast=function(){var i=this;Object.keys(this.managers_).map(function(e,t){i.managers_[e].cast&&i.managers_[e].cast()})},t.dispose=function(){var i=this;Fa("CastPlugin is being disposed"),Object.keys(this.managers_).map(function(e,t){i.managers_[e].dispose&&i.managers_[e].dispose()}),n.prototype.dispose.call(this)},t.addComponent=function(e,t,i){if(this.managers_[e]){if("UI"===t)return this.managers_[e].ui(i),!0;Fa("CastPlugin: unsupported role for addComponent.")}return Fa("CastPlugin: manager not found for addComponent."),!1},t.addChromecastManager=function(){var e=this.getAppId();e?this.addManager("ChromecastSender",new eu(this.player,e)):Fa("CastPlugin: chromecast appId not present.")},t.getAppId=function(){var e=this.player.options();return e&&e.controlBar&&e.controlBar.chromeCastButton&&e.controlBar.chromeCastButton.appId?e.controlBar.chromeCastButton.appId:e&&e.empcast?e.empcast.appId:null},e}(ga.getPlugin("plugin"));return nu.VERSION="2.2.124-498",ga.getPlugin("castPlugin")?ga.log.warn('A plugin named "castPlugin" already exists.'):ga.registerPlugin("castPlugin",nu),El});
